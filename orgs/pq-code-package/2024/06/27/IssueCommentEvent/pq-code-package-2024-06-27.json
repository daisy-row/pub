{"id":"39668794719","type":"IssueCommentEvent","actor":{"id":3984960,"login":"mkannwischer","display_login":"mkannwischer","gravatar_id":"","url":"https://api.github.com/users/mkannwischer","avatar_url":"https://avatars.githubusercontent.com/u/3984960?"},"repo":{"id":773826502,"name":"pq-code-package/mlkem-c-aarch64","url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81","repository_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64","labels_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/labels{/name}","comments_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/comments","events_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/events","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81","id":2377687632,"node_id":"PR_kwDOLh-nxs5zv4CO","number":81,"title":"Add M1 benchmarking code","user":{"login":"mkannwischer","id":3984960,"node_id":"MDQ6VXNlcjM5ODQ5NjA=","avatar_url":"https://avatars.githubusercontent.com/u/3984960?v=4","gravatar_id":"","url":"https://api.github.com/users/mkannwischer","html_url":"https://github.com/mkannwischer","followers_url":"https://api.github.com/users/mkannwischer/followers","following_url":"https://api.github.com/users/mkannwischer/following{/other_user}","gists_url":"https://api.github.com/users/mkannwischer/gists{/gist_id}","starred_url":"https://api.github.com/users/mkannwischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mkannwischer/subscriptions","organizations_url":"https://api.github.com/users/mkannwischer/orgs","repos_url":"https://api.github.com/users/mkannwischer/repos","events_url":"https://api.github.com/users/mkannwischer/events{/privacy}","received_events_url":"https://api.github.com/users/mkannwischer/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-06-27T09:49:18Z","updated_at":"2024-06-27T09:53:47Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/pulls/81","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81","diff_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81.diff","patch_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81.patch","merged_at":null},"body":"This adds M1 benchmarking code based on based on https://gist.github.com/dougallj/5bafb113492047c865c0c8cfbc930155. \r\n\r\n@potsrevennil @hanno-becker, please test this on your M1 devices. Can you also each run it maybe 3 times and post the results here , so we can make sure we are getting stable results? \r\n\r\nCurrently this requires to be run as the `root` user, so I added a flag `--run-as-root` to the benchmarking script, but this may require the user to enter a password. If anyone knows a way to use performance counters on Apple Silicon without using `sudo`, please do let me know. \r\n\r\nI'd like to point out that this code has caused me significant pain. \r\nThe original code contains two calls to `configure_rdtsc()` right after each other. I thought this must be a mistake and naively removed one of the calls. This resulted in the code working fine on my M1 MacMini, but reporting wrong numbers (like 0/1/2/3/4 cycles rather than serveral 10ks) on mulitple different MacBooks we have tried.\r\nAfter some trial-and-error, we found out that the calls within  `configure_rdtsc()` seem to be in the wrong order resulting in some of them being ineffective on the first invocation (on some devices). \r\nThis is fixed by reordering\r\n`kpc_set_config`, `kpc_force_all_ctrs_set`, `kpc_set_counting`, `kpc_set_thread_counting`\r\nto \r\n`kpc_force_all_ctrs_set`, `kpc_set_counting`, `kpc_set_thread_counting`, `kpc_set_config`.\r\nThanks @hanno-becker for helping me with that!\r\n\r\nThen it should work with a single call to `configure_rdtsc`.","reactions":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/comments/2194265049","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81#issuecomment-2194265049","issue_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81","id":2194265049,"node_id":"IC_kwDOLh-nxs6CydPZ","user":{"login":"mkannwischer","id":3984960,"node_id":"MDQ6VXNlcjM5ODQ5NjA=","avatar_url":"https://avatars.githubusercontent.com/u/3984960?v=4","gravatar_id":"","url":"https://api.github.com/users/mkannwischer","html_url":"https://github.com/mkannwischer","followers_url":"https://api.github.com/users/mkannwischer/followers","following_url":"https://api.github.com/users/mkannwischer/following{/other_user}","gists_url":"https://api.github.com/users/mkannwischer/gists{/gist_id}","starred_url":"https://api.github.com/users/mkannwischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mkannwischer/subscriptions","organizations_url":"https://api.github.com/users/mkannwischer/orgs","repos_url":"https://api.github.com/users/mkannwischer/repos","events_url":"https://api.github.com/users/mkannwischer/events{/privacy}","received_events_url":"https://api.github.com/users/mkannwischer/received_events","type":"User","site_admin":false},"created_at":"2024-06-27T09:53:46Z","updated_at":"2024-06-27T09:53:46Z","author_association":"CONTRIBUTOR","body":"Here are results in a MacMini: \r\n\r\n```\r\n$ tests bench -c M1\r\nINFO  > benchmark\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nPassword:\r\nINFO  > MLKEM512\r\nINFO  > \r\nkeypair cycles=60631\r\nencaps cycles=75168\r\ndecaps cycles=93525\r\nCRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nINFO  > MLKEM768\r\nINFO  > \r\nkeypair cycles=102960\r\nencaps cycles=122862\r\ndecaps cycles=146195\r\nCRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nINFO  > MLKEM1024\r\nINFO  > \r\nkeypair cycles=160540\r\nencaps cycles=183845\r\ndecaps cycles=213977\r\nCRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568\r\n```\r\n\r\n```\r\n$ tests bench -c M1\r\nINFO  > benchmark\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nINFO  > MLKEM512\r\nINFO  > \r\nkeypair cycles=60625\r\nencaps cycles=75170\r\ndecaps cycles=93526\r\nCRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nINFO  > MLKEM768\r\nINFO  > \r\nkeypair cycles=102944\r\nencaps cycles=122856\r\ndecaps cycles=146182\r\nCRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nINFO  > MLKEM1024\r\nINFO  > \r\nkeypair cycles=160529\r\nencaps cycles=183868\r\ndecaps cycles=213992\r\nCRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568\r\n```\r\n\r\n```\r\n$ tests bench -c M1\r\nINFO  > benchmark\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nINFO  > MLKEM512\r\nINFO  > \r\nkeypair cycles=60627\r\nencaps cycles=75173\r\ndecaps cycles=93530\r\nCRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nINFO  > MLKEM768\r\nINFO  > \r\nkeypair cycles=102927\r\nencaps cycles=122873\r\ndecaps cycles=146183\r\nCRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nINFO  > MLKEM1024\r\nINFO  > \r\nkeypair cycles=160565\r\nencaps cycles=183881\r\ndecaps cycles=214010\r\nCRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568\r\n```","reactions":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/comments/2194265049/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-06-27T09:53:48Z","org":{"id":158063050,"login":"pq-code-package","gravatar_id":"","url":"https://api.github.com/orgs/pq-code-package","avatar_url":"https://avatars.githubusercontent.com/u/158063050?"}}
{"id":"39669314019","type":"IssueCommentEvent","actor":{"id":26892988,"login":"hanno-becker","display_login":"hanno-becker","gravatar_id":"","url":"https://api.github.com/users/hanno-becker","avatar_url":"https://avatars.githubusercontent.com/u/26892988?"},"repo":{"id":773826502,"name":"pq-code-package/mlkem-c-aarch64","url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81","repository_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64","labels_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/labels{/name}","comments_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/comments","events_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/events","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81","id":2377687632,"node_id":"PR_kwDOLh-nxs5zv4CO","number":81,"title":"Add M1 benchmarking code","user":{"login":"mkannwischer","id":3984960,"node_id":"MDQ6VXNlcjM5ODQ5NjA=","avatar_url":"https://avatars.githubusercontent.com/u/3984960?v=4","gravatar_id":"","url":"https://api.github.com/users/mkannwischer","html_url":"https://github.com/mkannwischer","followers_url":"https://api.github.com/users/mkannwischer/followers","following_url":"https://api.github.com/users/mkannwischer/following{/other_user}","gists_url":"https://api.github.com/users/mkannwischer/gists{/gist_id}","starred_url":"https://api.github.com/users/mkannwischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mkannwischer/subscriptions","organizations_url":"https://api.github.com/users/mkannwischer/orgs","repos_url":"https://api.github.com/users/mkannwischer/repos","events_url":"https://api.github.com/users/mkannwischer/events{/privacy}","received_events_url":"https://api.github.com/users/mkannwischer/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-06-27T09:49:18Z","updated_at":"2024-06-27T10:09:17Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/pulls/81","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81","diff_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81.diff","patch_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81.patch","merged_at":null},"body":"This adds M1 benchmarking code based on based on https://gist.github.com/dougallj/5bafb113492047c865c0c8cfbc930155. \r\n\r\n@potsrevennil @hanno-becker, please test this on your M1 devices. Can you also each run it maybe 3 times and post the results here , so we can make sure we are getting stable results? \r\n\r\nCurrently this requires to be run as the `root` user, so I added a flag `--run-as-root` to the benchmarking script, but this may require the user to enter a password. If anyone knows a way to use performance counters on Apple Silicon without using `sudo`, please do let me know. \r\n\r\nI'd like to point out that this code has caused me significant pain. \r\nThe original code contains two calls to `configure_rdtsc()` right after each other. I thought this must be a mistake and naively removed one of the calls. This resulted in the code working fine on a M1 MacMini, but reporting wrong numbers (like 0/1/2/3/4 cycles rather than serveral 10ks) on mulitple different MacBooks we have tried.\r\nAfter some trial-and-error, we found out that the calls within  `configure_rdtsc()` seem to be in the wrong order resulting in some of them being ineffective on the first invocation (on some devices). \r\nThis is fixed by reordering\r\n`kpc_set_config`, `kpc_force_all_ctrs_set`, `kpc_set_counting`, `kpc_set_thread_counting`\r\nto \r\n`kpc_force_all_ctrs_set`, `kpc_set_counting`, `kpc_set_thread_counting`, `kpc_set_config`.\r\nThanks @hanno-becker for helping me with that!\r\n\r\nThen it should work with a single call to `configure_rdtsc`.","reactions":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/comments/2194298927","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81#issuecomment-2194298927","issue_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81","id":2194298927,"node_id":"IC_kwDOLh-nxs6Cylgv","user":{"login":"hanno-becker","id":26892988,"node_id":"MDQ6VXNlcjI2ODkyOTg4","avatar_url":"https://avatars.githubusercontent.com/u/26892988?v=4","gravatar_id":"","url":"https://api.github.com/users/hanno-becker","html_url":"https://github.com/hanno-becker","followers_url":"https://api.github.com/users/hanno-becker/followers","following_url":"https://api.github.com/users/hanno-becker/following{/other_user}","gists_url":"https://api.github.com/users/hanno-becker/gists{/gist_id}","starred_url":"https://api.github.com/users/hanno-becker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanno-becker/subscriptions","organizations_url":"https://api.github.com/users/hanno-becker/orgs","repos_url":"https://api.github.com/users/hanno-becker/repos","events_url":"https://api.github.com/users/hanno-becker/events{/privacy}","received_events_url":"https://api.github.com/users/hanno-becker/received_events","type":"User","site_admin":false},"created_at":"2024-06-27T10:09:16Z","updated_at":"2024-06-27T10:09:16Z","author_association":"CONTRIBUTOR","body":"```\r\n884d7ce1daa2:mlkem-c-aarch64$ tests bench -c M1\r\nINFO  > benchmark\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nINFO  > MLKEM512\r\nINFO  >\r\nkeypair cycles=60653\r\nencaps cycles=75170\r\ndecaps cycles=93543\r\nCRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nINFO  > MLKEM768\r\nINFO  >\r\nkeypair cycles=102936\r\nencaps cycles=122875\r\ndecaps cycles=146212\r\nCRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nINFO  > MLKEM1024\r\nINFO  >\r\nkeypair cycles=169223\r\nencaps cycles=183824\r\ndecaps cycles=214011\r\nCRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568\r\n\r\n884d7ce1daa2:mlkem-c-aarch64$ make clean\r\n/bin/rm -rf *.gcno *.gcda *.lcov *.o *.so\r\n/bin/rm -rf test/bin\r\n/bin/rm -rf test/obj\r\n884d7ce1daa2:mlkem-c-aarch64$ tests bench -c M1\r\nINFO  > benchmark\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nINFO  > MLKEM512\r\nINFO  >\r\nkeypair cycles=60647\r\nencaps cycles=75171\r\ndecaps cycles=93546\r\nCRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nINFO  > MLKEM768\r\nINFO  >\r\nkeypair cycles=102936\r\nencaps cycles=122871\r\ndecaps cycles=146217\r\nCRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nINFO  > MLKEM1024\r\nINFO  >\r\nkeypair cycles=169236\r\nencaps cycles=183843\r\ndecaps cycles=214028\r\nCRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568\r\n\r\n884d7ce1daa2:mlkem-c-aarch64$ make clean\r\n/bin/rm -rf *.gcno *.gcda *.lcov *.o *.so\r\n/bin/rm -rf test/bin\r\n/bin/rm -rf test/obj\r\n884d7ce1daa2:mlkem-c-aarch64$ tests bench -c M1\r\nINFO  > benchmark\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nINFO  > MLKEM512\r\nINFO  >\r\nkeypair cycles=60639\r\nencaps cycles=75157\r\ndecaps cycles=93534\r\nCRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nINFO  > MLKEM768\r\nINFO  >\r\nkeypair cycles=102940\r\nencaps cycles=122870\r\ndecaps cycles=146210\r\nCRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nINFO  > MLKEM1024\r\nINFO  >\r\nkeypair cycles=169216\r\nencaps cycles=183813\r\ndecaps cycles=213988\r\nCRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568\r\n\r\n884d7ce1daa2:mlkem-c-aarch64$\r\n```","reactions":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/comments/2194298927/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-06-27T10:09:17Z","org":{"id":158063050,"login":"pq-code-package","gravatar_id":"","url":"https://api.github.com/orgs/pq-code-package","avatar_url":"https://avatars.githubusercontent.com/u/158063050?"}}
{"id":"39669433497","type":"IssueCommentEvent","actor":{"id":26892988,"login":"hanno-becker","display_login":"hanno-becker","gravatar_id":"","url":"https://api.github.com/users/hanno-becker","avatar_url":"https://avatars.githubusercontent.com/u/26892988?"},"repo":{"id":773826502,"name":"pq-code-package/mlkem-c-aarch64","url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81","repository_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64","labels_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/labels{/name}","comments_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/comments","events_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/events","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81","id":2377687632,"node_id":"PR_kwDOLh-nxs5zv4CO","number":81,"title":"Add M1 benchmarking code","user":{"login":"mkannwischer","id":3984960,"node_id":"MDQ6VXNlcjM5ODQ5NjA=","avatar_url":"https://avatars.githubusercontent.com/u/3984960?v=4","gravatar_id":"","url":"https://api.github.com/users/mkannwischer","html_url":"https://github.com/mkannwischer","followers_url":"https://api.github.com/users/mkannwischer/followers","following_url":"https://api.github.com/users/mkannwischer/following{/other_user}","gists_url":"https://api.github.com/users/mkannwischer/gists{/gist_id}","starred_url":"https://api.github.com/users/mkannwischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mkannwischer/subscriptions","organizations_url":"https://api.github.com/users/mkannwischer/orgs","repos_url":"https://api.github.com/users/mkannwischer/repos","events_url":"https://api.github.com/users/mkannwischer/events{/privacy}","received_events_url":"https://api.github.com/users/mkannwischer/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-06-27T09:49:18Z","updated_at":"2024-06-27T10:12:56Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/pulls/81","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81","diff_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81.diff","patch_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81.patch","merged_at":null},"body":"This adds M1 benchmarking code based on based on https://gist.github.com/dougallj/5bafb113492047c865c0c8cfbc930155. \r\n\r\n@potsrevennil @hanno-becker, please test this on your M1 devices. Can you also each run it maybe 3 times and post the results here , so we can make sure we are getting stable results? \r\n\r\nCurrently this requires to be run as the `root` user, so I added a flag `--run-as-root` to the benchmarking script, but this may require the user to enter a password. If anyone knows a way to use performance counters on Apple Silicon without using `sudo`, please do let me know. \r\n\r\nI'd like to point out that this code has caused me significant pain. \r\nThe original code contains two calls to `configure_rdtsc()` right after each other. I thought this must be a mistake and naively removed one of the calls. This resulted in the code working fine on a M1 MacMini, but reporting wrong numbers (like 0/1/2/3/4 cycles rather than serveral 10ks) on mulitple different MacBooks we have tried.\r\nAfter some trial-and-error, we found out that the calls within  `configure_rdtsc()` seem to be in the wrong order resulting in some of them being ineffective on the first invocation (on some devices). \r\nThis is fixed by reordering\r\n`kpc_set_config`, `kpc_force_all_ctrs_set`, `kpc_set_counting`, `kpc_set_thread_counting`\r\nto \r\n`kpc_force_all_ctrs_set`, `kpc_set_counting`, `kpc_set_thread_counting`, `kpc_set_config`.\r\nThanks @hanno-becker for helping me with that!\r\n\r\nThen it should work with a single call to `configure_rdtsc`.","reactions":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/comments/2194305628","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81#issuecomment-2194305628","issue_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81","id":2194305628,"node_id":"IC_kwDOLh-nxs6CynJc","user":{"login":"hanno-becker","id":26892988,"node_id":"MDQ6VXNlcjI2ODkyOTg4","avatar_url":"https://avatars.githubusercontent.com/u/26892988?v=4","gravatar_id":"","url":"https://api.github.com/users/hanno-becker","html_url":"https://github.com/hanno-becker","followers_url":"https://api.github.com/users/hanno-becker/followers","following_url":"https://api.github.com/users/hanno-becker/following{/other_user}","gists_url":"https://api.github.com/users/hanno-becker/gists{/gist_id}","starred_url":"https://api.github.com/users/hanno-becker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanno-becker/subscriptions","organizations_url":"https://api.github.com/users/hanno-becker/orgs","repos_url":"https://api.github.com/users/hanno-becker/repos","events_url":"https://api.github.com/users/hanno-becker/events{/privacy}","received_events_url":"https://api.github.com/users/hanno-becker/received_events","type":"User","site_admin":false},"created_at":"2024-06-27T10:12:56Z","updated_at":"2024-06-27T10:12:56Z","author_association":"CONTRIBUTOR","body":"And a little bit easier to look at:\r\n```\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1     INFO  > make test/bin/bench_kyber512 CYCLES=M1     INFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nkeypair cycles=60653                               keypair cycles=60647                               keypair cycles=60639\r\nencaps cycles=75170                                encaps cycles=75171                                encaps cycles=75157\r\ndecaps cycles=93543                                decaps cycles=93546                                decaps cycles=93534\r\nCRYPTO_SECRETKEYBYTES:  1632                       CRYPTO_SECRETKEYBYTES:  1632                       CRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800                        CRYPTO_PUBLICKEYBYTES:  800                        CRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768                        CRYPTO_CIPHERTEXTBYTES: 768                        CRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1     INFO  > make test/bin/bench_kyber768 CYCLES=M1     INFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nkeypair cycles=102936                              keypair cycles=102936                              keypair cycles=102940\r\nencaps cycles=122875                               encaps cycles=122871                               encaps cycles=122870\r\ndecaps cycles=146212                               decaps cycles=146217                               decaps cycles=146210\r\nCRYPTO_SECRETKEYBYTES:  2400                       CRYPTO_SECRETKEYBYTES:  2400                       CRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184                       CRYPTO_PUBLICKEYBYTES:  1184                       CRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088                       CRYPTO_CIPHERTEXTBYTES: 1088                       CRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1    INFO  > make test/bin/bench_kyber1024 CYCLES=M1    INFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nkeypair cycles=169236                              keypair cycles=169223                              keypair cycles=169216\r\nencaps cycles=183843                               encaps cycles=183824                               encaps cycles=183813\r\ndecaps cycles=214028                               decaps cycles=214011                               decaps cycles=213988\r\nCRYPTO_SECRETKEYBYTES:  3168                       CRYPTO_SECRETKEYBYTES:  3168                       CRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568                       CRYPTO_PUBLICKEYBYTES:  1568                       CRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568                       CRYPTO_CIPHERTEXTBYTES: 1568                       CRYPTO_CIPHERTEXTBYTES: 1568\r\n```","reactions":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/comments/2194305628/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-06-27T10:12:57Z","org":{"id":158063050,"login":"pq-code-package","gravatar_id":"","url":"https://api.github.com/orgs/pq-code-package","avatar_url":"https://avatars.githubusercontent.com/u/158063050?"}}
{"id":"39669627148","type":"IssueCommentEvent","actor":{"id":15379156,"login":"potsrevennil","display_login":"potsrevennil","gravatar_id":"","url":"https://api.github.com/users/potsrevennil","avatar_url":"https://avatars.githubusercontent.com/u/15379156?"},"repo":{"id":773826502,"name":"pq-code-package/mlkem-c-aarch64","url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81","repository_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64","labels_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/labels{/name}","comments_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/comments","events_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/events","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81","id":2377687632,"node_id":"PR_kwDOLh-nxs5zv4CO","number":81,"title":"Add M1 benchmarking code","user":{"login":"mkannwischer","id":3984960,"node_id":"MDQ6VXNlcjM5ODQ5NjA=","avatar_url":"https://avatars.githubusercontent.com/u/3984960?v=4","gravatar_id":"","url":"https://api.github.com/users/mkannwischer","html_url":"https://github.com/mkannwischer","followers_url":"https://api.github.com/users/mkannwischer/followers","following_url":"https://api.github.com/users/mkannwischer/following{/other_user}","gists_url":"https://api.github.com/users/mkannwischer/gists{/gist_id}","starred_url":"https://api.github.com/users/mkannwischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mkannwischer/subscriptions","organizations_url":"https://api.github.com/users/mkannwischer/orgs","repos_url":"https://api.github.com/users/mkannwischer/repos","events_url":"https://api.github.com/users/mkannwischer/events{/privacy}","received_events_url":"https://api.github.com/users/mkannwischer/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-06-27T09:49:18Z","updated_at":"2024-06-27T10:18:54Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/pulls/81","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81","diff_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81.diff","patch_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81.patch","merged_at":null},"body":"This adds M1 benchmarking code based on based on https://gist.github.com/dougallj/5bafb113492047c865c0c8cfbc930155. \r\n\r\n@potsrevennil @hanno-becker, please test this on your M1 devices. Can you also each run it maybe 3 times and post the results here , so we can make sure we are getting stable results? \r\n\r\nCurrently this requires to be run as the `root` user, so I added a flag `--run-as-root` to the benchmarking script, but this may require the user to enter a password. If anyone knows a way to use performance counters on Apple Silicon without using `sudo`, please do let me know. \r\n\r\nI'd like to point out that this code has caused me significant pain. \r\nThe original code contains two calls to `configure_rdtsc()` right after each other. I thought this must be a mistake and naively removed one of the calls. This resulted in the code working fine on a M1 MacMini, but reporting wrong numbers (like 0/1/2/3/4 cycles rather than serveral 10ks) on mulitple different MacBooks we have tried.\r\nAfter some trial-and-error, we found out that the calls within  `configure_rdtsc()` seem to be in the wrong order resulting in some of them being ineffective on the first invocation (on some devices). \r\nThis is fixed by reordering\r\n`kpc_set_config`, `kpc_force_all_ctrs_set`, `kpc_set_counting`, `kpc_set_thread_counting`\r\nto \r\n`kpc_force_all_ctrs_set`, `kpc_set_counting`, `kpc_set_thread_counting`, `kpc_set_config`.\r\nThanks @hanno-becker for helping me with that!\r\n\r\nThen it should work with a single call to `configure_rdtsc`.","reactions":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/comments/2194318633","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81#issuecomment-2194318633","issue_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81","id":2194318633,"node_id":"IC_kwDOLh-nxs6CyqUp","user":{"login":"potsrevennil","id":15379156,"node_id":"MDQ6VXNlcjE1Mzc5MTU2","avatar_url":"https://avatars.githubusercontent.com/u/15379156?v=4","gravatar_id":"","url":"https://api.github.com/users/potsrevennil","html_url":"https://github.com/potsrevennil","followers_url":"https://api.github.com/users/potsrevennil/followers","following_url":"https://api.github.com/users/potsrevennil/following{/other_user}","gists_url":"https://api.github.com/users/potsrevennil/gists{/gist_id}","starred_url":"https://api.github.com/users/potsrevennil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/potsrevennil/subscriptions","organizations_url":"https://api.github.com/users/potsrevennil/orgs","repos_url":"https://api.github.com/users/potsrevennil/repos","events_url":"https://api.github.com/users/potsrevennil/events{/privacy}","received_events_url":"https://api.github.com/users/potsrevennil/received_events","type":"User","site_admin":false},"created_at":"2024-06-27T10:18:53Z","updated_at":"2024-06-27T10:18:53Z","author_association":"CONTRIBUTOR","body":"@mkannwischer All seems to work for me! Nice!\r\n1.\r\n```\r\nINFO  > benchmark\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nPassword:\r\nINFO  > MLKEM512\r\nINFO  >\r\nkeypair cycles=60692\r\nencaps cycles=75221\r\ndecaps cycles=93599\r\nCRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nINFO  > MLKEM768\r\nINFO  >\r\nkeypair cycles=103059\r\nencaps cycles=122970\r\ndecaps cycles=146269\r\nCRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nINFO  > MLKEM1024\r\nINFO  >\r\nkeypair cycles=160665\r\nencaps cycles=183954\r\ndecaps cycles=214074\r\nCRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568\r\n```\r\n\r\n2.\r\n```\r\nINFO  > benchmark\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nINFO  > MLKEM512\r\nINFO  >\r\nkeypair cycles=60654\r\nencaps cycles=75187\r\ndecaps cycles=93559\r\nCRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nINFO  > MLKEM768\r\nINFO  >\r\nkeypair cycles=103082\r\nencaps cycles=122969\r\ndecaps cycles=146300\r\nCRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nINFO  > MLKEM1024\r\nINFO  >\r\nkeypair cycles=160835\r\nencaps cycles=184105\r\ndecaps cycles=214283\r\nCRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568\r\n```\r\n\r\n3.\r\n```\r\nINFO  > benchmark\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nINFO  > MLKEM512\r\nINFO  >\r\nkeypair cycles=60681\r\nencaps cycles=75217\r\ndecaps cycles=93593\r\nCRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nINFO  > MLKEM768\r\nINFO  >\r\nkeypair cycles=103041\r\nencaps cycles=122921\r\ndecaps cycles=146231\r\nCRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nINFO  > MLKEM1024\r\nINFO  >\r\nkeypair cycles=160689\r\nencaps cycles=183990\r\ndecaps cycles=214113\r\nCRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568\r\n```","reactions":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/comments/2194318633/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-06-27T10:18:54Z","org":{"id":158063050,"login":"pq-code-package","gravatar_id":"","url":"https://api.github.com/orgs/pq-code-package","avatar_url":"https://avatars.githubusercontent.com/u/158063050?"}}
{"id":"39682559517","type":"IssueCommentEvent","actor":{"id":9219016,"login":"cothan","display_login":"cothan","gravatar_id":"","url":"https://api.github.com/users/cothan","avatar_url":"https://avatars.githubusercontent.com/u/9219016?"},"repo":{"id":773826502,"name":"pq-code-package/mlkem-c-aarch64","url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81","repository_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64","labels_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/labels{/name}","comments_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/comments","events_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/events","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81","id":2377687632,"node_id":"PR_kwDOLh-nxs5zv4CO","number":81,"title":"Add M1 benchmarking code","user":{"login":"mkannwischer","id":3984960,"node_id":"MDQ6VXNlcjM5ODQ5NjA=","avatar_url":"https://avatars.githubusercontent.com/u/3984960?v=4","gravatar_id":"","url":"https://api.github.com/users/mkannwischer","html_url":"https://github.com/mkannwischer","followers_url":"https://api.github.com/users/mkannwischer/followers","following_url":"https://api.github.com/users/mkannwischer/following{/other_user}","gists_url":"https://api.github.com/users/mkannwischer/gists{/gist_id}","starred_url":"https://api.github.com/users/mkannwischer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mkannwischer/subscriptions","organizations_url":"https://api.github.com/users/mkannwischer/orgs","repos_url":"https://api.github.com/users/mkannwischer/repos","events_url":"https://api.github.com/users/mkannwischer/events{/privacy}","received_events_url":"https://api.github.com/users/mkannwischer/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2024-06-27T09:49:18Z","updated_at":"2024-06-27T16:33:10Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/pulls/81","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81","diff_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81.diff","patch_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81.patch","merged_at":null},"body":"This adds M1 benchmarking code based on based on https://gist.github.com/dougallj/5bafb113492047c865c0c8cfbc930155. \r\n\r\n@potsrevennil @hanno-becker, please test this on your M1 devices. Can you also each run it maybe 3 times and post the results here , so we can make sure we are getting stable results? \r\n\r\nCurrently this requires to be run as the `root` user, so I added a flag `--run-as-root` to the benchmarking script, but this may require the user to enter a password. If anyone knows a way to use performance counters on Apple Silicon without using `sudo`, please do let me know. \r\n\r\nI'd like to point out that this code has caused me significant pain. \r\nThe original code contains two calls to `configure_rdtsc()` right after each other. I thought this must be a mistake and naively removed one of the calls. This resulted in the code working fine on a M1 MacMini, but reporting wrong numbers (like 0/1/2/3/4 cycles rather than serveral 10ks) on mulitple different MacBooks we have tried.\r\nAfter some trial-and-error, we found out that the calls within  `configure_rdtsc()` seem to be in the wrong order resulting in some of them being ineffective on the first invocation (on some devices). \r\nThis is fixed by reordering\r\n`kpc_set_config`, `kpc_force_all_ctrs_set`, `kpc_set_counting`, `kpc_set_thread_counting`\r\nto \r\n`kpc_force_all_ctrs_set`, `kpc_set_counting`, `kpc_set_thread_counting`, `kpc_set_config`.\r\nThanks @hanno-becker for helping me with that!\r\n\r\nThen it should work with a single call to `configure_rdtsc`.","reactions":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/comments/2195177412","html_url":"https://github.com/pq-code-package/mlkem-c-aarch64/pull/81#issuecomment-2195177412","issue_url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/81","id":2195177412,"node_id":"IC_kwDOLh-nxs6C17_E","user":{"login":"cothan","id":9219016,"node_id":"MDQ6VXNlcjkyMTkwMTY=","avatar_url":"https://avatars.githubusercontent.com/u/9219016?v=4","gravatar_id":"","url":"https://api.github.com/users/cothan","html_url":"https://github.com/cothan","followers_url":"https://api.github.com/users/cothan/followers","following_url":"https://api.github.com/users/cothan/following{/other_user}","gists_url":"https://api.github.com/users/cothan/gists{/gist_id}","starred_url":"https://api.github.com/users/cothan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cothan/subscriptions","organizations_url":"https://api.github.com/users/cothan/orgs","repos_url":"https://api.github.com/users/cothan/repos","events_url":"https://api.github.com/users/cothan/events{/privacy}","received_events_url":"https://api.github.com/users/cothan/received_events","type":"User","site_admin":false},"created_at":"2024-06-27T16:33:08Z","updated_at":"2024-06-27T16:33:08Z","author_association":"CONTRIBUTOR","body":"Work for me:\r\n\r\n```\r\n(nix:nix-shell-env) cothans-air:mlkem-c-aarch64 cothan$ tests bench -c M1\r\nINFO  > benchmark\r\nINFO  > make test/bin/bench_kyber512 CYCLES=M1\r\nPassword:\r\nSorry, try again.\r\nPassword:\r\nINFO  > MLKEM512\r\nINFO  >\r\nkeypair cycles=60747\r\nencaps cycles=75338\r\ndecaps cycles=93781\r\nCRYPTO_SECRETKEYBYTES:  1632\r\nCRYPTO_PUBLICKEYBYTES:  800\r\nCRYPTO_CIPHERTEXTBYTES: 768\r\n\r\nINFO  > make test/bin/bench_kyber768 CYCLES=M1\r\nINFO  > MLKEM768\r\nINFO  >\r\nkeypair cycles=103177\r\nencaps cycles=123143\r\ndecaps cycles=146492\r\nCRYPTO_SECRETKEYBYTES:  2400\r\nCRYPTO_PUBLICKEYBYTES:  1184\r\nCRYPTO_CIPHERTEXTBYTES: 1088\r\n\r\nINFO  > make test/bin/bench_kyber1024 CYCLES=M1\r\nINFO  > MLKEM1024\r\nINFO  >\r\nkeypair cycles=165195\r\nencaps cycles=193480\r\ndecaps cycles=214599\r\nCRYPTO_SECRETKEYBYTES:  3168\r\nCRYPTO_PUBLICKEYBYTES:  1568\r\nCRYPTO_CIPHERTEXTBYTES: 1568\r\n```","reactions":{"url":"https://api.github.com/repos/pq-code-package/mlkem-c-aarch64/issues/comments/2195177412/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2024-06-27T16:33:10Z","org":{"id":158063050,"login":"pq-code-package","gravatar_id":"","url":"https://api.github.com/orgs/pq-code-package","avatar_url":"https://avatars.githubusercontent.com/u/158063050?"}}
