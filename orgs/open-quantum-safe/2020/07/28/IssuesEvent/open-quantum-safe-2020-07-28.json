{"id":"13040421130","type":"IssuesEvent","actor":{"id":16247285,"login":"christianpaquin","display_login":"christianpaquin","gravatar_id":"","url":"https://api.github.com/users/christianpaquin","avatar_url":"https://avatars.githubusercontent.com/u/16247285?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"closed","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/639","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/639/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/639/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/639/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/639","id":573673135,"node_id":"MDU6SXNzdWU1NzM2NzMxMzU=","number":639,"title":"Undefined behaviour in qTesla","user":{"login":"dstebila","id":8843219,"node_id":"MDQ6VXNlcjg4NDMyMTk=","avatar_url":"https://avatars0.githubusercontent.com/u/8843219?v=4","gravatar_id":"","url":"https://api.github.com/users/dstebila","html_url":"https://github.com/dstebila","followers_url":"https://api.github.com/users/dstebila/followers","following_url":"https://api.github.com/users/dstebila/following{/other_user}","gists_url":"https://api.github.com/users/dstebila/gists{/gist_id}","starred_url":"https://api.github.com/users/dstebila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dstebila/subscriptions","organizations_url":"https://api.github.com/users/dstebila/orgs","repos_url":"https://api.github.com/users/dstebila/repos","events_url":"https://api.github.com/users/dstebila/events{/privacy}","received_events_url":"https://api.github.com/users/dstebila/received_events","type":"User","site_admin":false},"labels":[{"id":423520874,"node_id":"MDU6TGFiZWw0MjM1MjA4NzQ=","url":"https://api.github.com/repos/open-quantum-safe/liboqs/labels/bug","name":"bug","color":"ee0701","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":{"login":"christianpaquin","id":16247285,"node_id":"MDQ6VXNlcjE2MjQ3Mjg1","avatar_url":"https://avatars0.githubusercontent.com/u/16247285?v=4","gravatar_id":"","url":"https://api.github.com/users/christianpaquin","html_url":"https://github.com/christianpaquin","followers_url":"https://api.github.com/users/christianpaquin/followers","following_url":"https://api.github.com/users/christianpaquin/following{/other_user}","gists_url":"https://api.github.com/users/christianpaquin/gists{/gist_id}","starred_url":"https://api.github.com/users/christianpaquin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/christianpaquin/subscriptions","organizations_url":"https://api.github.com/users/christianpaquin/orgs","repos_url":"https://api.github.com/users/christianpaquin/repos","events_url":"https://api.github.com/users/christianpaquin/events{/privacy}","received_events_url":"https://api.github.com/users/christianpaquin/received_events","type":"User","site_admin":false},"assignees":[{"login":"christianpaquin","id":16247285,"node_id":"MDQ6VXNlcjE2MjQ3Mjg1","avatar_url":"https://avatars0.githubusercontent.com/u/16247285?v=4","gravatar_id":"","url":"https://api.github.com/users/christianpaquin","html_url":"https://github.com/christianpaquin","followers_url":"https://api.github.com/users/christianpaquin/followers","following_url":"https://api.github.com/users/christianpaquin/following{/other_user}","gists_url":"https://api.github.com/users/christianpaquin/gists{/gist_id}","starred_url":"https://api.github.com/users/christianpaquin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/christianpaquin/subscriptions","organizations_url":"https://api.github.com/users/christianpaquin/orgs","repos_url":"https://api.github.com/users/christianpaquin/repos","events_url":"https://api.github.com/users/christianpaquin/events{/privacy}","received_events_url":"https://api.github.com/users/christianpaquin/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2020-03-02T02:14:16Z","updated_at":"2020-07-28T18:28:37Z","closed_at":"2020-07-28T18:28:36Z","author_association":"MEMBER","active_lock_reason":null,"body":"When enabling clang's UndefinedBehaviorSanitizer using the build sequence\r\n```\r\nmkdir build && cd build\r\ncmake -DCMAKE_C_COMPILER=clang-9 -DCMAKE_BUILD_TYPE=Debug -DUSE_SANITIZER=Undefined -GNinja ..\r\nninja\r\n```\r\nthere are several undefined behaviours identified in the qTesla code.  The log is below:\r\n\r\n```\r\nroot@8995fd9c66df:~/liboqs/build# tests/test_sig qTesla-p-I   \r\nConfiguration info\r\n==================\r\nTarget platform:  x86_64-Linux-4.19.76-linuxkit\r\nCompiler:         clang (9.0.0 (tags/RELEASE_900/final))\r\nOQS version:      0.2.1-dev\r\nGit commit:       b3ca583e00ceafc800cf0c1f75d4965bdc627b22\r\nOpenSSL enabled:  Yes (OpenSSL 1.1.1  11 Sep 2018)\r\nAES:              OpenSSL\r\nSHA-2:            OpenSSL\r\nSHA-3:            OpenSSL\r\nCFLAGS:            -fvisibility=hidden -Werror -Wall -Wextra -Wpedantic -Wimplicit -Wunused -Wcomment -Wchar-subscripts -Wuninitialized -Wstrict-prototypes -Wshadow -Wformat-security -Wwrite-strings -ggdb3 -fcolor-diagnostics -Wno-missing-braces\r\n\r\n================================================================================\r\nSample computation for signature qTesla-p-I\r\n================================================================================\r\n../src/sig/qtesla/portable/poly.c:56:9: runtime error: signed integer overflow: 2166416674282987 * 2205847551 cannot be represented in type 'long'\r\n../src/sig/qtesla/portable/pack.c:35:39: runtime error: left shift of 246699749 by 29 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:36:54: runtime error: left shift of 206969157 by 26 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:37:54: runtime error: left shift of 1873916 by 23 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:38:54: runtime error: left shift of 15185638 by 20 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:39:55: runtime error: left shift of 92158313 by 17 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:40:55: runtime error: left shift of 334355572 by 14 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:41:55: runtime error: left shift of 262515030 by 11 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:42:55: runtime error: left shift of 197729790 by 8 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:43:55: runtime error: left shift of 81422514 by 5 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:44:75: runtime error: left shift of 110070622 by 31 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:45:57: runtime error: left shift of 245323310 by 28 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:46:57: runtime error: left shift of 199127201 by 25 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:47:57: runtime error: left shift of 184835711 by 22 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:48:58: runtime error: left shift of 193430958 by 19 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:49:58: runtime error: left shift of 328772548 by 16 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:50:58: runtime error: left shift of 36545641 by 13 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:51:58: runtime error: left shift of 190441547 by 10 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:52:58: runtime error: left shift of 286033409 by 7 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:54:77: runtime error: left shift of 300802382 by 30 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:55:57: runtime error: left shift of 97290513 by 27 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:56:57: runtime error: left shift of 256512962 by 24 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:57:57: runtime error: left shift of 169602953 by 21 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:58:58: runtime error: left shift of 274007195 by 18 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:59:58: runtime error: left shift of 234881478 by 15 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:60:58: runtime error: left shift of 170294761 by 12 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:61:58: runtime error: left shift of 239736629 by 9 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:62:58: runtime error: left shift of 206304752 by 6 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:53:58: runtime error: left shift of 259039690 by 4 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:63:58: runtime error: left shift of 318490732 by 3 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/sample.c:29:11: runtime error: load of misaligned address 0x7fff8aff59c3 for type 'uint32_t' (aka 'unsigned int'), which requires 4 byte alignment\r\n0x7fff8aff59c3: note: pointer points here\r\n 00  5a 93 28 95 1f 2e 61 cb  2c 70 83 f4 5c 8e 08 f9  26 b0 d4 83 c7 bc 1e fb  e7 9d b4 40 28 cf b4\r\n              ^ \r\n../src/sig/qtesla/portable/sign.c:80:21: runtime error: left shift of negative value -6\r\n../src/sig/qtesla/portable/pack.c:139:31: runtime error: left shift of 2026479704 by 12 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:141:35: runtime error: left shift of 394621716 by 4 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:144:35: runtime error: left shift of negative value -1808122512\r\n../src/sig/qtesla/portable/pack.c:147:35: runtime error: left shift of negative value -478200594\r\n../src/sig/qtesla/portable/pack.c:149:36: runtime error: left shift of negative value -387570978\r\n../src/sig/qtesla/portable/pack.c:152:36: runtime error: left shift of negative value -1260274095\r\nverification passes as expected\r\nroot@8995fd9c66df:~/liboqs/build# tests/test_sig qTesla-p-III\r\nConfiguration info\r\n==================\r\nTarget platform:  x86_64-Linux-4.19.76-linuxkit\r\nCompiler:         clang (9.0.0 (tags/RELEASE_900/final))\r\nOQS version:      0.2.1-dev\r\nGit commit:       b3ca583e00ceafc800cf0c1f75d4965bdc627b22\r\nOpenSSL enabled:  Yes (OpenSSL 1.1.1  11 Sep 2018)\r\nAES:              OpenSSL\r\nSHA-2:            OpenSSL\r\nSHA-3:            OpenSSL\r\nCFLAGS:            -fvisibility=hidden -Werror -Wall -Wextra -Wpedantic -Wimplicit -Wunused -Wcomment -Wchar-subscripts -Wuninitialized -Wstrict-prototypes -Wshadow -Wformat-security -Wwrite-strings -ggdb3 -fcolor-diagnostics -Wno-missing-braces\r\n\r\n================================================================================\r\nSample computation for signature qTesla-p-III\r\n================================================================================\r\n../src/sig/qtesla/portable/poly.c:56:9: runtime error: signed integer overflow: 84243346629938046 * 587710463 cannot be represented in type 'long'\r\n../src/sig/qtesla/portable/pack.c:167:47: runtime error: left shift of 426560882 by 30 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:168:54: runtime error: left shift of 21783190 by 28 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:169:54: runtime error: left shift of 482744648 by 26 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:170:54: runtime error: left shift of 458096954 by 24 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:171:54: runtime error: left shift of 511833232 by 22 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:172:55: runtime error: left shift of 528622584 by 20 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:173:55: runtime error: left shift of 567386133 by 18 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:174:55: runtime error: left shift of 576341574 by 16 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:175:55: runtime error: left shift of 589182497 by 14 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:176:56: runtime error: left shift of 420513822 by 12 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:177:58: runtime error: left shift of 90879528 by 10 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:178:58: runtime error: left shift of 221161719 by 8 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:179:58: runtime error: left shift of 92118786 by 6 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:180:58: runtime error: left shift of 353596064 by 4 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:181:58: runtime error: left shift of 850706544 by 2 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/sample.c:29:11: runtime error: load of misaligned address 0x7ffd9adc4c03 for type 'uint32_t' (aka 'unsigned int'), which requires 4 byte alignment\r\n0x7ffd9adc4c03: note: pointer points here\r\n 00  2d ed 48 0f 1c 2a 37 76  bb af b9 7f bd 7a 04 e1  ae 1f ab 2e 4e c9 0a 7d  25 c9 26 c5 04 ba 52\r\n              ^ \r\n../src/sig/qtesla/portable/sign.c:80:21: runtime error: left shift of negative value -8\r\n../src/sig/qtesla/portable/pack.c:244:35: runtime error: left shift of negative value -1386477105\r\n../src/sig/qtesla/portable/pack.c:247:35: runtime error: left shift of negative value -501420167\r\n../src/sig/qtesla/portable/pack.c:250:35: runtime error: left shift of negative value -1021928367\r\n../src/sig/qtesla/portable/pack.c:253:35: runtime error: left shift of 1698644440 by 4 places cannot be represented in type 'int32_t' (aka 'int')\r\n../src/sig/qtesla/portable/pack.c:256:36: runtime error: left shift of negative value -977200591\r\nverification passes as expected\r\n```","performed_via_github_app":null}},"public":true,"created_at":"2020-07-28T18:28:37Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
