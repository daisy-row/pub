{"id":"11589399041","type":"IssuesEvent","actor":{"id":6852543,"login":"ReverseControl","display_login":"ReverseControl","gravatar_id":"","url":"https://api.github.com/users/ReverseControl","avatar_url":"https://avatars.githubusercontent.com/u/6852543?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"opened","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/150","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/150/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/150/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/150/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/150","id":569600986,"node_id":"MDU6SXNzdWU1Njk2MDA5ODY=","number":150,"title":"OQS-OpenSSL_1_1_1-stable TEST70 test_clienthello FAIL.","user":{"login":"ReverseControl","id":6852543,"node_id":"MDQ6VXNlcjY4NTI1NDM=","avatar_url":"https://avatars3.githubusercontent.com/u/6852543?v=4","gravatar_id":"","url":"https://api.github.com/users/ReverseControl","html_url":"https://github.com/ReverseControl","followers_url":"https://api.github.com/users/ReverseControl/followers","following_url":"https://api.github.com/users/ReverseControl/following{/other_user}","gists_url":"https://api.github.com/users/ReverseControl/gists{/gist_id}","starred_url":"https://api.github.com/users/ReverseControl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ReverseControl/subscriptions","organizations_url":"https://api.github.com/users/ReverseControl/orgs","repos_url":"https://api.github.com/users/ReverseControl/repos","events_url":"https://api.github.com/users/ReverseControl/events{/privacy}","received_events_url":"https://api.github.com/users/ReverseControl/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-02-24T02:00:47Z","updated_at":"2020-02-24T02:00:47Z","closed_at":null,"author_association":"NONE","body":"The error message:\r\n\r\n```\r\nroot@cbb4e2453d4c:/tmp/oqs_openssl# make test TESTS=test_clienthello  V=1\r\nmake depend && make _tests\r\nmake[1]: Entering directory '/tmp/oqs_openssl'\r\nmake[1]: Leaving directory '/tmp/oqs_openssl'\r\nmake[1]: Entering directory '/tmp/oqs_openssl'\r\n( cd test; \\\r\n  mkdir -p test-runs; \\\r\n  SRCTOP=../. \\\r\n  BLDTOP=../. \\\r\n  RESULT_D=test-runs \\\r\n  PERL=\"/usr/bin/perl\" \\\r\n  EXE_EXT= \\\r\n  OPENSSL_ENGINES=`cd .././engines 2>/dev/null && pwd` \\\r\n  OPENSSL_DEBUG_MEMORY=on \\\r\n    /usr/bin/perl .././test/run_tests.pl test_clienthello )\r\n../test/recipes/70-test_clienthello.t .. \r\n1..1\r\n    # Subtest: /tmp/oqs_openssl/test/clienthellotest\r\n    1..1\r\n        # Subtest: test_client_hello\r\n        1..2\r\n        ok 1 - iteration 1\r\n        not ok 2 - iteration 2\r\n    not ok 1 - test_client_hello\r\n/tmp/oqs_openssl/util/shlib_wrap.sh /tmp/oqs_openssl/test/clienthellotest /tmp/oqs_openssl/test/session.pem => 1\r\nnot ok 1 - running clienthellotest\r\n#   Failed test 'running clienthellotest'\r\n#   at ../test/recipes/70-test_clienthello.t line 20.\r\n# Looks like you failed 1 test of 1.\r\nDubious, test returned 1 (wstat 256, 0x100)\r\nFailed 1/1 subtests \r\n\r\nTest Summary Report\r\n-------------------\r\n../test/recipes/70-test_clienthello.t (Wstat: 256 Tests: 1 Failed: 1)\r\n  Failed test:  1\r\n  Non-zero exit status: 1\r\nFiles=1, Tests=1,  0 wallclock secs ( 0.01 usr  0.01 sys +  0.06 cusr  0.01 csys =  0.09 CPU)\r\nResult: FAIL\r\nmake[1]: *** [Makefile:208: _tests] Error 1\r\nmake[1]: Leaving directory '/tmp/oqs_openssl'\r\nmake: *** [Makefile:205: tests] Error 2\r\n\r\n```\r\n\r\nA Dockerfile to reproduce this:\r\n\r\n ```\r\nFROM ubuntu:19.10\r\n\r\n#Dependencies for OQS_OpenSSL\r\n#We note that 'libssl-dev' is also a requirement, but\r\n#we build that from source because we need a specific branch\r\nRUN apt update && apt install -y \\\r\n\tcmake                    \\\r\n\tgcc                      \\\r\n\tlibtool                  \\\r\n\tmake                     \\\r\n\tninja-build              \\\r\n\tunzip                    \\\r\n\txsltproc                 \\\r\n\tgit                      \\\r\n        linux-headers-$(uname -r)\r\n\r\n#We clone all the repos along with the branches that we need\r\nRUN cd /tmp                                                                                                         \\\r\n\t&& git clone --branch OQS-OpenSSL_1_1_1-stable https://github.com/open-quantum-safe/openssl.git oqs_openssl \\\r\n\t&& git clone --branch master                   https://github.com/open-quantum-safe/liboqs.git  oqs         \\\r\n\t&& git clone --branch OpenSSL_1_1_1d\t       https://github.com/openssl/openssl.git           openssl\r\n\r\n#Store the install instances of OpenSSL before installing anything\r\nRUN cd /tmp && find / -name libcrypto* > start_libcrypto.log\r\nRUN cd /tmp && find / -name openssl    > start_openssl.log\r\n\r\n#Build and install standard OpenSSL\r\nRUN cd /tmp/openssl    \\\r\n\t&& ./config    \\\r\n\t&& make        \\\r\n\t&& make test   \\\r\n\t&& make install\r\n\r\n#Store the install instances of OpenSSL after installing Standard OpenSSL\r\nRUN cd /tmp && find / -name libcrypto* > after_std_libcrypto.log\r\nRUN cd /tmp && find / -name openssl    > after_std_openssl.log\r\n\r\n#Build and install OQS\r\nRUN cd /tmp/oqs                                                          \\\r\n\t&& mkdir build                                                   \\\r\n\t&& cd build                                                      \\\r\n\t&& cmake -GNinja -DCMAKE_INSTALL_PREFIX=../../oqs_openssl/oqs .. \\\r\n\t&& ninja                                                         \\\r\n\t&& ninja install\r\n\r\n#Build and install OQS_OpenSSL\r\n#RUN cd /tmp/oqs_openssl                             \\\r\n#\t&& ./Configure no-shared linux-x86_64 -lm   \\\r\n#\t&& make                                     \\\r\n#\t&& make test                                \\\r\n#\t&& make install\r\n\r\n\r\n#Entrypoint\r\nCMD [ \"bash\" ]\r\n```\r\n\r\nWith this Dockerfile, run:\r\n```\r\n> docker build -t oqs_test .\r\n> docker run -ti oqs_test bash\r\nroot@hash> cd /tmp/oqs_openssl/ && ./Configure no-shared linux-x86_64 -lm\r\nroot@hash> make \r\nroot@hash> make test TESTS=test_clienthello  V=1\r\n```\r\n\r\nThis error is consistent.  Helps. Thanks."}},"public":true,"created_at":"2020-02-24T02:00:48Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
