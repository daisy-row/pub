{"id":"14267070198","type":"IssuesEvent","actor":{"id":10732757,"login":"crest42","display_login":"crest42","gravatar_id":"","url":"https://api.github.com/users/crest42","avatar_url":"https://avatars.githubusercontent.com/u/10732757?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"opened","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/256","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/256/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/256/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/256/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/256","id":747752315,"node_id":"MDU6SXNzdWU3NDc3NTIzMTU=","number":256,"title":"set_curves_list fails with more than ojne entry","user":{"login":"crest42","id":10732757,"node_id":"MDQ6VXNlcjEwNzMyNzU3","avatar_url":"https://avatars3.githubusercontent.com/u/10732757?v=4","gravatar_id":"","url":"https://api.github.com/users/crest42","html_url":"https://github.com/crest42","followers_url":"https://api.github.com/users/crest42/followers","following_url":"https://api.github.com/users/crest42/following{/other_user}","gists_url":"https://api.github.com/users/crest42/gists{/gist_id}","starred_url":"https://api.github.com/users/crest42/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/crest42/subscriptions","organizations_url":"https://api.github.com/users/crest42/orgs","repos_url":"https://api.github.com/users/crest42/repos","events_url":"https://api.github.com/users/crest42/events{/privacy}","received_events_url":"https://api.github.com/users/crest42/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2020-11-20T19:48:59Z","updated_at":"2020-11-20T19:48:59Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi everyone,\r\n\r\nIt seems, that the NTRU-Prime PR (#251 ) broke the implementation for me. After applying 094324c14 OpenSSL fails when setting the curve list. It works when only one entry is defined and breaks as soon as a second entry is added. Example:\r\n```\r\nopenssl s_server -cert p384_CA.crt -key p384.key -curves bike1l3cpa\r\nUsing default temp DH parameters\r\nACCEPT\r\n\r\nopenssl s_server -cert p384_CA.crt -key p384.key -curves bike1l3cpa:p384_bike1l3cpa             \r\nError with command: \"-curves bike1l3cpa:p384_bike1l3cpa\"           \r\n```\r\n\r\nAfter a little bit of debugging it seems that the problem is the duplicate check in tls1_set_groups in ssl/t1_lib.c.\r\n\r\nBefore 094324c14 the following line always results in 0:\r\nidmask = 1L << id;\r\n\r\nThis seems weird since the id returned by ```tls1_nid2group_id```, is an index in [0,31] for classical algos and the curve_id for PQ algos. Since the curve_id usually is much higher than 31 this should result in undefined behavior.\r\n\r\nSadly, IMHO there is not trivial fix available, since all values until 31 are already used by the classical algorithms from OpenSSL. Further, the id is stored in the resulting group list and is needed in the format as described above. \r\n \r\nI have designed a rather ugly fix, with the aim to preserve as much compatibility as possible. I will link this issue in the PR.\r\n\r\nCheers,\r\nRobin","performed_via_github_app":null}},"public":true,"created_at":"2020-11-20T19:49:00Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
