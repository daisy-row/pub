{"id":"14893975897","type":"PullRequestReviewCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":218087071,"name":"open-quantum-safe/oqs-demos","url":"https://api.github.com/repos/open-quantum-safe/oqs-demos"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561622239","pull_request_review_id":573003806,"id":561622239,"node_id":"MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTYyMjIzOQ==","diff_hunk":"@@ -0,0 +1,270 @@\n+# Purpose \n+\n+This is an [opensshd](https://https.openssh.com) docker image based on the [OQS OpenSSH 7.9 fork](https://github.com/open-quantum-safe/openssh), which allows ssh to quantum-safely negotiate session keys and use quantum-safe authentication with algorithms from the [Post-Quantum Cryptography Project by NIST](https://csrc.nist.gov/projects/post-quantum-cryptography).\n+\n+This image has a built-in non-root user to permit execution without particular [docker privileges](https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities). This is necessary as logging in as root in ssh is not recommended practice. But it is worth to note that this user, per default called `oqs`, is not set as the default user when the image starts. The reason for that is that the the start up script needs root permissions to generate all host keys and start the sshd service. This means that when executing a command as the user `oqs`, the `docker exec` command needs to be used together with the option `--user oqs`.\n+\n+If you built the docker image yourself following the instructions [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), exchange the name of the image from 'openquantumsafe/openssh' in the examples below suitably.\n+\n+# Quick start \n+\n+1. Start an OpenSSH server with post-quantum cryptography support by running\n+\n+        docker run --name oqs-openssh-server -dit --rm openquantumsafe/openssh\n+\n+2. Connect to that server running\n+\n+        docker exec --user oqs -it oqs-openssh-server ssh oqs@localhost\n+\n+3. Accept the host key and authenticate with the default password `oqs.pw`\n+\n+4. To clean up, exit the ssh session with `exit` and run\n+\n+        docker stop oqs-openssh-server\n+\n+   to stop (and remove) the container.\n+\n+*Note:* Due to the `--rm` option the container will be removed as soon as it is stopped, it may be omitted to keep the container. But because we're just testing its basic functionality right now this is not required.\n+   \n+# Limitations\n+\n+For limitations of the post-quantum algorithms themselves, refer to [this](https://github.com/open-quantum-safe/openssh#limitations-and-security).\n+\n+# Slightly more advanced usage options\n+\n+## Connect from container to container via OQS-SSH\n+\n+To easily connect from one container to another, we can make use of the docker's own networking capabilities.\n+\n+1. Create a docker network with\n+   \n+        docker network create oqs-openssh-net\n+\n+2. Start a new container that is connected to that network with\n+   \n+        docker run --rm -dit --net oqs-openssh-net --name oqs-openssh-server openquantumsafe/openssh\n+\n+3. Then access this server using OQS-SSH through the docker network with\n+        \n+        docker run --rm -it --net oqs-openssh-net openquantumsafe/openssh ssh oqs@oqs-openssh-server\n+\n+   type `yes` to add the host to the `known_hosts` and authenticate the user `oqs` with its default password `oqs.pw`.\n+\n+Congratulations, you just connected from one docker container to another in a quantum safe manner! To see how to use this in a more practical setting, see how to use docker to quantum safely connect to a remote host in [USAGE.md](USAGE.md#Using-oqs-ssh-for-quantum-safe-remote-access-with-minimal-intrusion).\n+\n+## Access the man pages of oqs-ssh\n+\n+Man pages for oqs-ssh are installed in `<INSTALL_DIR>/share/man` and can be viewed by for example \n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man1/ssh.1\n+```\n+or\n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man5/ssh.5\n+ ```\n+Note that those man pages do **not** differ from the original ssh man pages. So it might be easier to consult them on your local system or the internet.\n+\n+Direct links to man pages: [ssh(1)](https://linux.die.net/man/1/ssh), [sshd(8)](https://linux.die.net/man/8/sshd), [ssh_config(5)](https://linux.die.net/man/5/ssh_config), [sshd_config(5)](https://linux.die.net/man/5/sshd_config)\n+\n+## Key-based client authentication\n+\n+Key-based client authentication works just as it does with normal SSH. Just add your post-quantum public key (normally located in `~/.ssh/*.pub`) to the `authorized_keys` file on the server (normally located in `~/.ssh/authorized_keys`).\n+\n+## Using oqs-ssh for quantum-safe remote access with minimal intrusion\n+\n+One use case of quantum-safe ssh running in docker could be accessing a remote system without messing with its ssh(d) installation or other parts of the system you maybe don't want to interact with. This means minimal intrusion and everything can easily be removed again. This is done by running this docker image on said system and sharing its network space. Thus it is possible to access host ports from **within** the docker container. Normally, the use case of docker is one of isolation with some shared directories and published ports at max. So this solution works around the usual docker limitations.\n+\n+Additionally, it is advised to **change the default username and password** when building the image because your plan is to expose it to the world.\n+\n+```\n+Structure of quantum-safe remote access using docker containers\n+\n++------------------+                +----------------------+\n+|      Client      |                |         Host         |\n+|  +------------+  |                |  +----------------+  |\n+|  |            |  |                |  |                |  |\n+|  |   Docker   +--------------------->+     Docker     |  |\n+|  |            |  |       Port 2222|  |                |  |\n+|  +------------+  |                |  +-------+--------+  |\n+|                  |                |          |           |\n++------------------+                |  Port 22 v           |\n+                                    |  +-------+--------+  |\n+                                    |  |                |  |\n+                                    |  |  sshd on Host  |  |\n+                                    |  |                |  |\n+                                    |  +----------------+  |\n+                                    |                      |\n+                                    +----------------------+\n+```\n+### Set up the server (docker container on target host)\n+\n+To start the ssh server, meaning the docker container on the host system, follow those instructions:\n+- Run the docker image with\n+\n+       docker run -dit --network host --name oqs-ssh openquantumsafe/openssh\n+\n+- Or, if you want the container to automatically start with docker\n+\n+       docker run -dit --network host --name oqs-ssh --restart unless-stopped openquantumsafe/openssh\n+\n+The `--network host` option will attach the container directly to your host's network, sharing its IP. The sshd in the container is now accessible from the outside using the host's IP address and the specified port (2222 per default).\n+\n+Be aware that the port 2222 also needs to be open in any firewalls there may be!\n+\n+If you want to seriously use this image to connect to a machine, it is **strongly advised** to change the default password of the `oqs` user. This can be done in the **running** container with\n+```\n+docker exec -it oqs-ssh passwd oqs\n+```\n+Or you build the image yourself with a different default password from the sources on [Github](https://github.com/openquantumsafe/oqs-demos).\n+\n+#### Enable classical SSH\n+\n+Because we wan't to be able to connect to our host that does not run OQS-SSH, we first need to enable classical SSH capabilities for the client **on the host system**.\n+\n+1. After running the image, run a shell with `docker exec -it oqs-ssh /bin/bash`\n+\n+2. Run `nano /etc/oqs-ssh/ssh_config` and \n+   - uncomment the line `# IdentityFile ~/.ssh/id_ed25519`,\n+   - add `ssh-ed25519` to `HostkeyAlgorithms` and `PubkeyAcceptedKeyTypes` (comma-separated)\n+   - add `curve25519-sha256@libssh.org` to `KexAlgorithms` (comma-separated)\n+\n+3. Save and exit your editor\n+4. Run `rc-service oqs-ssh restart`\n+5. Run `/opt/oqs-ssh/scripts/key-gen.sh`\n+6. Run `ssh <username>@localhost -p 22` with `<username>` being your host's username to test your setup\n+7. If everything went smoothly, your docker container connected with your host's classical `sshd`\n+\n+### Set up the client\n+\n+For the client side, run the image with\n+```bash\n+docker run -it openquantumsafe/openssh ssh <username>@<remote-host-ip> -p 2222\n+```\n+You then are prompted to enter the password for the remote server. Defaults are `oqs` for `<username>` and `oqs.pw` as password. It is strongly adviced to change this password as described above.\n+\n+You may omit `-p 2222` if this port is configured accordingly in `ssh_config` on the client (which is the default).\n+\n+And most importantly, we can now access the host's `sshd` from within the docker image by addressing port 22 via the localhost, using the host's credentials.\n+```bash\n+ssh <username>@localhost -p 22\n+```\n+To omit the `-p 22` option, the specification of the port, this can be set as default in `ssh_config`.\n+\n+# Seriously more advanced usage options\n+\n+## Configuring `ssh` and `sshd`\n+\n+If you are using the pre-compiled image from [Dockerhub](https://hub.docker.com/r/openquantumsafe/openssh) you can only make changes to the configuration at run time. Those changes will only be specific to the current container and won't persist through multiple containers and will be lost upon removing the container. The configuration files [ssh_config](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/ssh_config) and [sshd_config](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/sshd_config) are located in `/opt/oqs-ssh/ssh_config` and `/opt/oqs-ssh/sshd_config` respectively. \n+\n+If you built the docker image yourself following [these instructions](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), you can make changes to `ssh_config` and `sshd_config` before building the image (they will be copied to the image at build time). Firstly, this will make your changes the default for your containers and secondly you won't lose them in case you remove the container.\n+\n+The configuration files can be edited with pre-installed `nano` or `vi` editors, e.g.:\n+```\n+docker exec -it <name-or-hash-of-container> nano /opt/oqs-ssh/ssh_config\n+```\n+After changing anything in and only in `sshd_config`, run\n+```\n+docker exec -it <name-or-hash-of-container> rc-service oqs-sshd restart\n+```\n+After adding new `IdentityKey` or `HostKey` values, generate those new keys with\n+```\n+docker exec -it <name-or-hash-of-container> /opt/oqs-ssh/scripts/key-gen.sh\n+```\n+\n+## Choosing the SIG and KEX algorithms\n+\n+For a list of all signature and key exchange algorithms see [here](https://github.com/open-quantum-safe/openssh#supported-algorithms). Be aware that there is a limitation of what algorithms are enabled in PQS-OpenSSH per default, more information in the section **Enabling additional PQC algorithms** below. It is recommended to only use the hybrid variants to maintain established classical security. The post-quantum safe algorithms have not yet received enough confidence to be relied on as the only security mechanism.\n+\n+The image's default key exchange algorithm is `ecdh-nistp384-kyber-1024-sha384@openquantumsafe.org`. For host and identity key (authentication) algorithms `ssh-p256-dilithium2` is used. Those algorithms may be changed by adjusting the files `ssh_config` and `sshd_config` respectively.\n+\n+**In `ssh_config` (client side)**\n+- `KexAlgorithms`: Comma-separated list of enabled key-exchange algorithms. Priority given by order. Names according to [this KEX naming scheme](https://github.com/open-quantum-safe/openssh#key-exchange).\n+- `IdentityKey`: Path to identity key files. One entry for one file, can have multiple entries. SSH will look for those files when connecting to a host. Names of the key files need to be `~/.ssh/id_<SIG>` in order for them to be successfully generated. `<SIG>` is a post-quantum signature algorithm according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature), with every `-` replace by `_`. A list with of some possible `IdentityKey` values can be found [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/ssh_config).","path":"openssh/USAGE.md","position":182,"original_position":182,"commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","original_commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars1.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"body":"Nit: \"replace\" -> \"replaced\"","created_at":"2021-01-21T06:02:52Z","updated_at":"2021-01-21T06:38:54Z","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561622239","pull_request_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","author_association":"MEMBER","_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561622239"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561622239"},"pull_request":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"}},"start_line":null,"original_start_line":null,"start_side":null,"line":182,"original_line":182,"side":"RIGHT"},"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","id":540179821,"node_id":"MDExOlB1bGxSZXF1ZXN0NTQwMTc5ODIx","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65","diff_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.diff","patch_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.patch","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65","number":65,"state":"open","locked":false,"title":"Added OQS-OpenSSH demo","user":{"login":"xykro","id":9986471,"node_id":"MDQ6VXNlcjk5ODY0NzE=","avatar_url":"https://avatars0.githubusercontent.com/u/9986471?v=4","gravatar_id":"","url":"https://api.github.com/users/xykro","html_url":"https://github.com/xykro","followers_url":"https://api.github.com/users/xykro/followers","following_url":"https://api.github.com/users/xykro/following{/other_user}","gists_url":"https://api.github.com/users/xykro/gists{/gist_id}","starred_url":"https://api.github.com/users/xykro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xykro/subscriptions","organizations_url":"https://api.github.com/users/xykro/orgs","repos_url":"https://api.github.com/users/xykro/repos","events_url":"https://api.github.com/users/xykro/events{/privacy}","received_events_url":"https://api.github.com/users/xykro/received_events","type":"User","site_admin":false},"body":"Hi @baentsch and @dstebila\r\n\r\nReferring to issue #54. \r\n\r\nAs we talked about, we have (the [ISE institute](https://www.fhnw.ch/en/about-fhnw/schools/school-of-engineering/institutes/institute-for-sensors-and-electronics) from [FHNW](https://www.fhnw.ch/en)) have created a docker demo image that uses your OQS-OpenSSH implementation.\r\n\r\nThe [README.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/README.md) contains setup and general information while the [USAGE.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/USAGE.md) describes some more advanced use cases, like using this demo to connect to a remote OQS-OpenSSH instance.\r\n\r\nI've added a new job for [CircleCI](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/.circleci/config.yml) for this demo image. The test it does is connecting to itself (localhost) using chosen PQC algorithms via OQS-SSH. Defaults are p256-dilithium2 and ecdh-nistp384-kyber-1024, chosen more or less randomly. Those algorithms may be changed by passing the SIG and/or KEM variables to the docker run command.\r\nReturn code is 0 if the connection to localhost using the ubkey method was successful, 1 otherwise.\r\n\r\nI have **not** added OQS-OpenSSH to the \"Push all images\" step, I reckoned as you will be hosting the image I'll let you set that up properly.\r\n\r\nGit history is squashed down to 1 commit, I do not want to bring my mess over :-)\r\n\r\nLet me know if any adjustments are required.","created_at":"2020-12-15T11:27:41Z","updated_at":"2021-01-21T06:38:54Z","closed_at":null,"merged_at":null,"merge_commit_sha":"cd0b5c1b0ec4ba7908103eb23e10c7da38c4fbfb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits","review_comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments","review_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34","head":{"label":"fhnw-ise-qcrypt:pull-request","ref":"pull-request","sha":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"repo":{"id":299259879,"node_id":"MDEwOlJlcG9zaXRvcnkyOTkyNTk4Nzk=","name":"oqs-demos","full_name":"fhnw-ise-qcrypt/oqs-demos","private":false,"owner":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":true,"url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos","forks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/forks","keys_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/teams","hooks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/events","assignees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/tags","blobs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscription","commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/merges","archive_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/downloads","issues_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/deployments","created_at":"2020-09-28T09:35:41Z","updated_at":"2020-12-15T11:37:14Z","pushed_at":"2021-01-20T16:30:56Z","git_url":"git://github.com/fhnw-ise-qcrypt/oqs-demos.git","ssh_url":"git@github.com:fhnw-ise-qcrypt/oqs-demos.git","clone_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos.git","svn_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","homepage":"https://openquantumsafe.org/","size":205,"stargazers_count":0,"watchers_count":0,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":null,"forks":0,"open_issues":2,"watchers":0,"default_branch":"main"}},"base":{"label":"open-quantum-safe:main","ref":"main","sha":"cb71ca0e3abce4a27c9030c1fa044816241921ef","user":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"repo":{"id":218087071,"node_id":"MDEwOlJlcG9zaXRvcnkyMTgwODcwNzE=","name":"oqs-demos","full_name":"open-quantum-safe/oqs-demos","private":false,"owner":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/open-quantum-safe/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":false,"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos","forks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/forks","keys_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/teams","hooks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/events","assignees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/tags","blobs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscription","commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/merges","archive_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/downloads","issues_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/deployments","created_at":"2019-10-28T15:57:00Z","updated_at":"2021-01-17T20:05:26Z","pushed_at":"2021-01-20T16:30:58Z","git_url":"git://github.com/open-quantum-safe/oqs-demos.git","ssh_url":"git@github.com:open-quantum-safe/oqs-demos.git","clone_url":"https://github.com/open-quantum-safe/oqs-demos.git","svn_url":"https://github.com/open-quantum-safe/oqs-demos","homepage":"https://openquantumsafe.org/","size":129,"stargazers_count":17,"watchers_count":17,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":11,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":6,"license":null,"forks":11,"open_issues":6,"watchers":17,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65"},"issue":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65"},"comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments"},"review_comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments"},"review_comment":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits"},"statuses":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34"}},"author_association":"NONE","active_lock_reason":null}},"public":true,"created_at":"2021-01-21T06:02:52Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"14893975914","type":"PullRequestReviewCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":218087071,"name":"open-quantum-safe/oqs-demos","url":"https://api.github.com/repos/open-quantum-safe/oqs-demos"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561622466","pull_request_review_id":573003806,"id":561622466,"node_id":"MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTYyMjQ2Ng==","diff_hunk":"@@ -0,0 +1,270 @@\n+# Purpose \n+\n+This is an [opensshd](https://https.openssh.com) docker image based on the [OQS OpenSSH 7.9 fork](https://github.com/open-quantum-safe/openssh), which allows ssh to quantum-safely negotiate session keys and use quantum-safe authentication with algorithms from the [Post-Quantum Cryptography Project by NIST](https://csrc.nist.gov/projects/post-quantum-cryptography).\n+\n+This image has a built-in non-root user to permit execution without particular [docker privileges](https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities). This is necessary as logging in as root in ssh is not recommended practice. But it is worth to note that this user, per default called `oqs`, is not set as the default user when the image starts. The reason for that is that the the start up script needs root permissions to generate all host keys and start the sshd service. This means that when executing a command as the user `oqs`, the `docker exec` command needs to be used together with the option `--user oqs`.\n+\n+If you built the docker image yourself following the instructions [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), exchange the name of the image from 'openquantumsafe/openssh' in the examples below suitably.\n+\n+# Quick start \n+\n+1. Start an OpenSSH server with post-quantum cryptography support by running\n+\n+        docker run --name oqs-openssh-server -dit --rm openquantumsafe/openssh\n+\n+2. Connect to that server running\n+\n+        docker exec --user oqs -it oqs-openssh-server ssh oqs@localhost\n+\n+3. Accept the host key and authenticate with the default password `oqs.pw`\n+\n+4. To clean up, exit the ssh session with `exit` and run\n+\n+        docker stop oqs-openssh-server\n+\n+   to stop (and remove) the container.\n+\n+*Note:* Due to the `--rm` option the container will be removed as soon as it is stopped, it may be omitted to keep the container. But because we're just testing its basic functionality right now this is not required.\n+   \n+# Limitations\n+\n+For limitations of the post-quantum algorithms themselves, refer to [this](https://github.com/open-quantum-safe/openssh#limitations-and-security).\n+\n+# Slightly more advanced usage options\n+\n+## Connect from container to container via OQS-SSH\n+\n+To easily connect from one container to another, we can make use of the docker's own networking capabilities.\n+\n+1. Create a docker network with\n+   \n+        docker network create oqs-openssh-net\n+\n+2. Start a new container that is connected to that network with\n+   \n+        docker run --rm -dit --net oqs-openssh-net --name oqs-openssh-server openquantumsafe/openssh\n+\n+3. Then access this server using OQS-SSH through the docker network with\n+        \n+        docker run --rm -it --net oqs-openssh-net openquantumsafe/openssh ssh oqs@oqs-openssh-server\n+\n+   type `yes` to add the host to the `known_hosts` and authenticate the user `oqs` with its default password `oqs.pw`.\n+\n+Congratulations, you just connected from one docker container to another in a quantum safe manner! To see how to use this in a more practical setting, see how to use docker to quantum safely connect to a remote host in [USAGE.md](USAGE.md#Using-oqs-ssh-for-quantum-safe-remote-access-with-minimal-intrusion).\n+\n+## Access the man pages of oqs-ssh\n+\n+Man pages for oqs-ssh are installed in `<INSTALL_DIR>/share/man` and can be viewed by for example \n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man1/ssh.1\n+```\n+or\n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man5/ssh.5\n+ ```\n+Note that those man pages do **not** differ from the original ssh man pages. So it might be easier to consult them on your local system or the internet.\n+\n+Direct links to man pages: [ssh(1)](https://linux.die.net/man/1/ssh), [sshd(8)](https://linux.die.net/man/8/sshd), [ssh_config(5)](https://linux.die.net/man/5/ssh_config), [sshd_config(5)](https://linux.die.net/man/5/sshd_config)\n+\n+## Key-based client authentication\n+\n+Key-based client authentication works just as it does with normal SSH. Just add your post-quantum public key (normally located in `~/.ssh/*.pub`) to the `authorized_keys` file on the server (normally located in `~/.ssh/authorized_keys`).\n+\n+## Using oqs-ssh for quantum-safe remote access with minimal intrusion\n+\n+One use case of quantum-safe ssh running in docker could be accessing a remote system without messing with its ssh(d) installation or other parts of the system you maybe don't want to interact with. This means minimal intrusion and everything can easily be removed again. This is done by running this docker image on said system and sharing its network space. Thus it is possible to access host ports from **within** the docker container. Normally, the use case of docker is one of isolation with some shared directories and published ports at max. So this solution works around the usual docker limitations.\n+\n+Additionally, it is advised to **change the default username and password** when building the image because your plan is to expose it to the world.\n+\n+```\n+Structure of quantum-safe remote access using docker containers\n+\n++------------------+                +----------------------+\n+|      Client      |                |         Host         |\n+|  +------------+  |                |  +----------------+  |\n+|  |            |  |                |  |                |  |\n+|  |   Docker   +--------------------->+     Docker     |  |\n+|  |            |  |       Port 2222|  |                |  |\n+|  +------------+  |                |  +-------+--------+  |\n+|                  |                |          |           |\n++------------------+                |  Port 22 v           |\n+                                    |  +-------+--------+  |\n+                                    |  |                |  |\n+                                    |  |  sshd on Host  |  |\n+                                    |  |                |  |\n+                                    |  +----------------+  |\n+                                    |                      |\n+                                    +----------------------+\n+```\n+### Set up the server (docker container on target host)\n+\n+To start the ssh server, meaning the docker container on the host system, follow those instructions:\n+- Run the docker image with\n+\n+       docker run -dit --network host --name oqs-ssh openquantumsafe/openssh\n+\n+- Or, if you want the container to automatically start with docker\n+\n+       docker run -dit --network host --name oqs-ssh --restart unless-stopped openquantumsafe/openssh\n+\n+The `--network host` option will attach the container directly to your host's network, sharing its IP. The sshd in the container is now accessible from the outside using the host's IP address and the specified port (2222 per default).\n+\n+Be aware that the port 2222 also needs to be open in any firewalls there may be!\n+\n+If you want to seriously use this image to connect to a machine, it is **strongly advised** to change the default password of the `oqs` user. This can be done in the **running** container with\n+```\n+docker exec -it oqs-ssh passwd oqs\n+```\n+Or you build the image yourself with a different default password from the sources on [Github](https://github.com/openquantumsafe/oqs-demos).\n+\n+#### Enable classical SSH\n+\n+Because we wan't to be able to connect to our host that does not run OQS-SSH, we first need to enable classical SSH capabilities for the client **on the host system**.\n+\n+1. After running the image, run a shell with `docker exec -it oqs-ssh /bin/bash`\n+\n+2. Run `nano /etc/oqs-ssh/ssh_config` and \n+   - uncomment the line `# IdentityFile ~/.ssh/id_ed25519`,\n+   - add `ssh-ed25519` to `HostkeyAlgorithms` and `PubkeyAcceptedKeyTypes` (comma-separated)\n+   - add `curve25519-sha256@libssh.org` to `KexAlgorithms` (comma-separated)\n+\n+3. Save and exit your editor\n+4. Run `rc-service oqs-ssh restart`\n+5. Run `/opt/oqs-ssh/scripts/key-gen.sh`\n+6. Run `ssh <username>@localhost -p 22` with `<username>` being your host's username to test your setup\n+7. If everything went smoothly, your docker container connected with your host's classical `sshd`\n+\n+### Set up the client\n+\n+For the client side, run the image with\n+```bash\n+docker run -it openquantumsafe/openssh ssh <username>@<remote-host-ip> -p 2222\n+```\n+You then are prompted to enter the password for the remote server. Defaults are `oqs` for `<username>` and `oqs.pw` as password. It is strongly adviced to change this password as described above.\n+\n+You may omit `-p 2222` if this port is configured accordingly in `ssh_config` on the client (which is the default).\n+\n+And most importantly, we can now access the host's `sshd` from within the docker image by addressing port 22 via the localhost, using the host's credentials.\n+```bash\n+ssh <username>@localhost -p 22\n+```\n+To omit the `-p 22` option, the specification of the port, this can be set as default in `ssh_config`.\n+\n+# Seriously more advanced usage options\n+\n+## Configuring `ssh` and `sshd`\n+\n+If you are using the pre-compiled image from [Dockerhub](https://hub.docker.com/r/openquantumsafe/openssh) you can only make changes to the configuration at run time. Those changes will only be specific to the current container and won't persist through multiple containers and will be lost upon removing the container. The configuration files [ssh_config](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/ssh_config) and [sshd_config](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/sshd_config) are located in `/opt/oqs-ssh/ssh_config` and `/opt/oqs-ssh/sshd_config` respectively. \n+\n+If you built the docker image yourself following [these instructions](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), you can make changes to `ssh_config` and `sshd_config` before building the image (they will be copied to the image at build time). Firstly, this will make your changes the default for your containers and secondly you won't lose them in case you remove the container.\n+\n+The configuration files can be edited with pre-installed `nano` or `vi` editors, e.g.:\n+```\n+docker exec -it <name-or-hash-of-container> nano /opt/oqs-ssh/ssh_config\n+```\n+After changing anything in and only in `sshd_config`, run\n+```\n+docker exec -it <name-or-hash-of-container> rc-service oqs-sshd restart\n+```\n+After adding new `IdentityKey` or `HostKey` values, generate those new keys with\n+```\n+docker exec -it <name-or-hash-of-container> /opt/oqs-ssh/scripts/key-gen.sh\n+```\n+\n+## Choosing the SIG and KEX algorithms\n+\n+For a list of all signature and key exchange algorithms see [here](https://github.com/open-quantum-safe/openssh#supported-algorithms). Be aware that there is a limitation of what algorithms are enabled in PQS-OpenSSH per default, more information in the section **Enabling additional PQC algorithms** below. It is recommended to only use the hybrid variants to maintain established classical security. The post-quantum safe algorithms have not yet received enough confidence to be relied on as the only security mechanism.\n+\n+The image's default key exchange algorithm is `ecdh-nistp384-kyber-1024-sha384@openquantumsafe.org`. For host and identity key (authentication) algorithms `ssh-p256-dilithium2` is used. Those algorithms may be changed by adjusting the files `ssh_config` and `sshd_config` respectively.\n+\n+**In `ssh_config` (client side)**\n+- `KexAlgorithms`: Comma-separated list of enabled key-exchange algorithms. Priority given by order. Names according to [this KEX naming scheme](https://github.com/open-quantum-safe/openssh#key-exchange).\n+- `IdentityKey`: Path to identity key files. One entry for one file, can have multiple entries. SSH will look for those files when connecting to a host. Names of the key files need to be `~/.ssh/id_<SIG>` in order for them to be successfully generated. `<SIG>` is a post-quantum signature algorithm according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature), with every `-` replace by `_`. A list with of some possible `IdentityKey` values can be found [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/ssh_config).\n+- `PubkeyAcceptedKeyTypes`: Comma-separated list of identity keys the client offers to the host. Priority given by order. Note that if no corresponding `IdentityFile` is specified, this algorithm is ignored.\n+- `HostKeyAlgorithms`: Comma-separated list of the host key types the client accepts from the server. Names according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature).\n+\n+**In `sshd_config` (server side)**\n+- `KexAlgorithms`: Comma-separated list of enabled key-exchange algorithms. Priority given by order. Names according to [this KEX naming scheme](https://github.com/open-quantum-safe/openssh#key-exchange).\n+- `HostKey`: Path to host key files. One entry for one file, can have multiple entries. SSHD will look for those files when offering a host key to a client. Names of the key files need to be `/opt/oqs-ssh/ssh_host_<SIG>_key` in order for them to be successfully generated. `<SIG>` is a post-quantum signature algorithm according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature), with every `-` replace by `_`. A list with of some possible `HostKey` values can be found [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/sshd_config).","path":"openssh/USAGE.md","position":188,"original_position":188,"commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","original_commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars1.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"body":"Nit: \"replace\" -> \"replaced\"","created_at":"2021-01-21T06:03:38Z","updated_at":"2021-01-21T06:38:54Z","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561622466","pull_request_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","author_association":"MEMBER","_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561622466"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561622466"},"pull_request":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"}},"start_line":null,"original_start_line":null,"start_side":null,"line":188,"original_line":188,"side":"RIGHT"},"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","id":540179821,"node_id":"MDExOlB1bGxSZXF1ZXN0NTQwMTc5ODIx","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65","diff_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.diff","patch_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.patch","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65","number":65,"state":"open","locked":false,"title":"Added OQS-OpenSSH demo","user":{"login":"xykro","id":9986471,"node_id":"MDQ6VXNlcjk5ODY0NzE=","avatar_url":"https://avatars0.githubusercontent.com/u/9986471?v=4","gravatar_id":"","url":"https://api.github.com/users/xykro","html_url":"https://github.com/xykro","followers_url":"https://api.github.com/users/xykro/followers","following_url":"https://api.github.com/users/xykro/following{/other_user}","gists_url":"https://api.github.com/users/xykro/gists{/gist_id}","starred_url":"https://api.github.com/users/xykro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xykro/subscriptions","organizations_url":"https://api.github.com/users/xykro/orgs","repos_url":"https://api.github.com/users/xykro/repos","events_url":"https://api.github.com/users/xykro/events{/privacy}","received_events_url":"https://api.github.com/users/xykro/received_events","type":"User","site_admin":false},"body":"Hi @baentsch and @dstebila\r\n\r\nReferring to issue #54. \r\n\r\nAs we talked about, we have (the [ISE institute](https://www.fhnw.ch/en/about-fhnw/schools/school-of-engineering/institutes/institute-for-sensors-and-electronics) from [FHNW](https://www.fhnw.ch/en)) have created a docker demo image that uses your OQS-OpenSSH implementation.\r\n\r\nThe [README.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/README.md) contains setup and general information while the [USAGE.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/USAGE.md) describes some more advanced use cases, like using this demo to connect to a remote OQS-OpenSSH instance.\r\n\r\nI've added a new job for [CircleCI](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/.circleci/config.yml) for this demo image. The test it does is connecting to itself (localhost) using chosen PQC algorithms via OQS-SSH. Defaults are p256-dilithium2 and ecdh-nistp384-kyber-1024, chosen more or less randomly. Those algorithms may be changed by passing the SIG and/or KEM variables to the docker run command.\r\nReturn code is 0 if the connection to localhost using the ubkey method was successful, 1 otherwise.\r\n\r\nI have **not** added OQS-OpenSSH to the \"Push all images\" step, I reckoned as you will be hosting the image I'll let you set that up properly.\r\n\r\nGit history is squashed down to 1 commit, I do not want to bring my mess over :-)\r\n\r\nLet me know if any adjustments are required.","created_at":"2020-12-15T11:27:41Z","updated_at":"2021-01-21T06:38:54Z","closed_at":null,"merged_at":null,"merge_commit_sha":"cd0b5c1b0ec4ba7908103eb23e10c7da38c4fbfb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits","review_comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments","review_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34","head":{"label":"fhnw-ise-qcrypt:pull-request","ref":"pull-request","sha":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"repo":{"id":299259879,"node_id":"MDEwOlJlcG9zaXRvcnkyOTkyNTk4Nzk=","name":"oqs-demos","full_name":"fhnw-ise-qcrypt/oqs-demos","private":false,"owner":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":true,"url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos","forks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/forks","keys_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/teams","hooks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/events","assignees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/tags","blobs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscription","commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/merges","archive_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/downloads","issues_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/deployments","created_at":"2020-09-28T09:35:41Z","updated_at":"2020-12-15T11:37:14Z","pushed_at":"2021-01-20T16:30:56Z","git_url":"git://github.com/fhnw-ise-qcrypt/oqs-demos.git","ssh_url":"git@github.com:fhnw-ise-qcrypt/oqs-demos.git","clone_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos.git","svn_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","homepage":"https://openquantumsafe.org/","size":205,"stargazers_count":0,"watchers_count":0,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":null,"forks":0,"open_issues":2,"watchers":0,"default_branch":"main"}},"base":{"label":"open-quantum-safe:main","ref":"main","sha":"cb71ca0e3abce4a27c9030c1fa044816241921ef","user":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"repo":{"id":218087071,"node_id":"MDEwOlJlcG9zaXRvcnkyMTgwODcwNzE=","name":"oqs-demos","full_name":"open-quantum-safe/oqs-demos","private":false,"owner":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/open-quantum-safe/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":false,"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos","forks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/forks","keys_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/teams","hooks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/events","assignees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/tags","blobs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscription","commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/merges","archive_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/downloads","issues_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/deployments","created_at":"2019-10-28T15:57:00Z","updated_at":"2021-01-17T20:05:26Z","pushed_at":"2021-01-20T16:30:58Z","git_url":"git://github.com/open-quantum-safe/oqs-demos.git","ssh_url":"git@github.com:open-quantum-safe/oqs-demos.git","clone_url":"https://github.com/open-quantum-safe/oqs-demos.git","svn_url":"https://github.com/open-quantum-safe/oqs-demos","homepage":"https://openquantumsafe.org/","size":129,"stargazers_count":17,"watchers_count":17,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":11,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":6,"license":null,"forks":11,"open_issues":6,"watchers":17,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65"},"issue":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65"},"comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments"},"review_comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments"},"review_comment":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits"},"statuses":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34"}},"author_association":"NONE","active_lock_reason":null}},"public":true,"created_at":"2021-01-21T06:03:38Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"14893975928","type":"PullRequestReviewCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":218087071,"name":"open-quantum-safe/oqs-demos","url":"https://api.github.com/repos/open-quantum-safe/oqs-demos"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561623279","pull_request_review_id":573003806,"id":561623279,"node_id":"MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTYyMzI3OQ==","diff_hunk":"@@ -0,0 +1,270 @@\n+# Purpose \n+\n+This is an [opensshd](https://https.openssh.com) docker image based on the [OQS OpenSSH 7.9 fork](https://github.com/open-quantum-safe/openssh), which allows ssh to quantum-safely negotiate session keys and use quantum-safe authentication with algorithms from the [Post-Quantum Cryptography Project by NIST](https://csrc.nist.gov/projects/post-quantum-cryptography).\n+\n+This image has a built-in non-root user to permit execution without particular [docker privileges](https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities). This is necessary as logging in as root in ssh is not recommended practice. But it is worth to note that this user, per default called `oqs`, is not set as the default user when the image starts. The reason for that is that the the start up script needs root permissions to generate all host keys and start the sshd service. This means that when executing a command as the user `oqs`, the `docker exec` command needs to be used together with the option `--user oqs`.\n+\n+If you built the docker image yourself following the instructions [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), exchange the name of the image from 'openquantumsafe/openssh' in the examples below suitably.\n+\n+# Quick start \n+\n+1. Start an OpenSSH server with post-quantum cryptography support by running\n+\n+        docker run --name oqs-openssh-server -dit --rm openquantumsafe/openssh\n+\n+2. Connect to that server running\n+\n+        docker exec --user oqs -it oqs-openssh-server ssh oqs@localhost\n+\n+3. Accept the host key and authenticate with the default password `oqs.pw`\n+\n+4. To clean up, exit the ssh session with `exit` and run\n+\n+        docker stop oqs-openssh-server\n+\n+   to stop (and remove) the container.\n+\n+*Note:* Due to the `--rm` option the container will be removed as soon as it is stopped, it may be omitted to keep the container. But because we're just testing its basic functionality right now this is not required.\n+   \n+# Limitations\n+\n+For limitations of the post-quantum algorithms themselves, refer to [this](https://github.com/open-quantum-safe/openssh#limitations-and-security).\n+\n+# Slightly more advanced usage options\n+\n+## Connect from container to container via OQS-SSH\n+\n+To easily connect from one container to another, we can make use of the docker's own networking capabilities.\n+\n+1. Create a docker network with\n+   \n+        docker network create oqs-openssh-net\n+\n+2. Start a new container that is connected to that network with\n+   \n+        docker run --rm -dit --net oqs-openssh-net --name oqs-openssh-server openquantumsafe/openssh\n+\n+3. Then access this server using OQS-SSH through the docker network with\n+        \n+        docker run --rm -it --net oqs-openssh-net openquantumsafe/openssh ssh oqs@oqs-openssh-server\n+\n+   type `yes` to add the host to the `known_hosts` and authenticate the user `oqs` with its default password `oqs.pw`.\n+\n+Congratulations, you just connected from one docker container to another in a quantum safe manner! To see how to use this in a more practical setting, see how to use docker to quantum safely connect to a remote host in [USAGE.md](USAGE.md#Using-oqs-ssh-for-quantum-safe-remote-access-with-minimal-intrusion).\n+\n+## Access the man pages of oqs-ssh\n+\n+Man pages for oqs-ssh are installed in `<INSTALL_DIR>/share/man` and can be viewed by for example \n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man1/ssh.1\n+```\n+or\n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man5/ssh.5\n+ ```\n+Note that those man pages do **not** differ from the original ssh man pages. So it might be easier to consult them on your local system or the internet.\n+\n+Direct links to man pages: [ssh(1)](https://linux.die.net/man/1/ssh), [sshd(8)](https://linux.die.net/man/8/sshd), [ssh_config(5)](https://linux.die.net/man/5/ssh_config), [sshd_config(5)](https://linux.die.net/man/5/sshd_config)\n+\n+## Key-based client authentication\n+\n+Key-based client authentication works just as it does with normal SSH. Just add your post-quantum public key (normally located in `~/.ssh/*.pub`) to the `authorized_keys` file on the server (normally located in `~/.ssh/authorized_keys`).\n+\n+## Using oqs-ssh for quantum-safe remote access with minimal intrusion\n+\n+One use case of quantum-safe ssh running in docker could be accessing a remote system without messing with its ssh(d) installation or other parts of the system you maybe don't want to interact with. This means minimal intrusion and everything can easily be removed again. This is done by running this docker image on said system and sharing its network space. Thus it is possible to access host ports from **within** the docker container. Normally, the use case of docker is one of isolation with some shared directories and published ports at max. So this solution works around the usual docker limitations.\n+\n+Additionally, it is advised to **change the default username and password** when building the image because your plan is to expose it to the world.\n+\n+```\n+Structure of quantum-safe remote access using docker containers\n+\n++------------------+                +----------------------+\n+|      Client      |                |         Host         |\n+|  +------------+  |                |  +----------------+  |\n+|  |            |  |                |  |                |  |\n+|  |   Docker   +--------------------->+     Docker     |  |\n+|  |            |  |       Port 2222|  |                |  |\n+|  +------------+  |                |  +-------+--------+  |\n+|                  |                |          |           |\n++------------------+                |  Port 22 v           |\n+                                    |  +-------+--------+  |\n+                                    |  |                |  |\n+                                    |  |  sshd on Host  |  |\n+                                    |  |                |  |\n+                                    |  +----------------+  |\n+                                    |                      |\n+                                    +----------------------+\n+```\n+### Set up the server (docker container on target host)\n+\n+To start the ssh server, meaning the docker container on the host system, follow those instructions:\n+- Run the docker image with\n+\n+       docker run -dit --network host --name oqs-ssh openquantumsafe/openssh\n+\n+- Or, if you want the container to automatically start with docker\n+\n+       docker run -dit --network host --name oqs-ssh --restart unless-stopped openquantumsafe/openssh\n+\n+The `--network host` option will attach the container directly to your host's network, sharing its IP. The sshd in the container is now accessible from the outside using the host's IP address and the specified port (2222 per default).\n+\n+Be aware that the port 2222 also needs to be open in any firewalls there may be!\n+\n+If you want to seriously use this image to connect to a machine, it is **strongly advised** to change the default password of the `oqs` user. This can be done in the **running** container with\n+```\n+docker exec -it oqs-ssh passwd oqs\n+```\n+Or you build the image yourself with a different default password from the sources on [Github](https://github.com/openquantumsafe/oqs-demos).\n+\n+#### Enable classical SSH\n+\n+Because we wan't to be able to connect to our host that does not run OQS-SSH, we first need to enable classical SSH capabilities for the client **on the host system**.\n+\n+1. After running the image, run a shell with `docker exec -it oqs-ssh /bin/bash`\n+\n+2. Run `nano /etc/oqs-ssh/ssh_config` and \n+   - uncomment the line `# IdentityFile ~/.ssh/id_ed25519`,\n+   - add `ssh-ed25519` to `HostkeyAlgorithms` and `PubkeyAcceptedKeyTypes` (comma-separated)\n+   - add `curve25519-sha256@libssh.org` to `KexAlgorithms` (comma-separated)\n+\n+3. Save and exit your editor\n+4. Run `rc-service oqs-ssh restart`\n+5. Run `/opt/oqs-ssh/scripts/key-gen.sh`\n+6. Run `ssh <username>@localhost -p 22` with `<username>` being your host's username to test your setup\n+7. If everything went smoothly, your docker container connected with your host's classical `sshd`\n+\n+### Set up the client\n+\n+For the client side, run the image with\n+```bash\n+docker run -it openquantumsafe/openssh ssh <username>@<remote-host-ip> -p 2222\n+```\n+You then are prompted to enter the password for the remote server. Defaults are `oqs` for `<username>` and `oqs.pw` as password. It is strongly adviced to change this password as described above.\n+\n+You may omit `-p 2222` if this port is configured accordingly in `ssh_config` on the client (which is the default).\n+\n+And most importantly, we can now access the host's `sshd` from within the docker image by addressing port 22 via the localhost, using the host's credentials.\n+```bash\n+ssh <username>@localhost -p 22\n+```\n+To omit the `-p 22` option, the specification of the port, this can be set as default in `ssh_config`.\n+\n+# Seriously more advanced usage options\n+\n+## Configuring `ssh` and `sshd`\n+\n+If you are using the pre-compiled image from [Dockerhub](https://hub.docker.com/r/openquantumsafe/openssh) you can only make changes to the configuration at run time. Those changes will only be specific to the current container and won't persist through multiple containers and will be lost upon removing the container. The configuration files [ssh_config](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/ssh_config) and [sshd_config](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/sshd_config) are located in `/opt/oqs-ssh/ssh_config` and `/opt/oqs-ssh/sshd_config` respectively. \n+\n+If you built the docker image yourself following [these instructions](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), you can make changes to `ssh_config` and `sshd_config` before building the image (they will be copied to the image at build time). Firstly, this will make your changes the default for your containers and secondly you won't lose them in case you remove the container.\n+\n+The configuration files can be edited with pre-installed `nano` or `vi` editors, e.g.:\n+```\n+docker exec -it <name-or-hash-of-container> nano /opt/oqs-ssh/ssh_config\n+```\n+After changing anything in and only in `sshd_config`, run\n+```\n+docker exec -it <name-or-hash-of-container> rc-service oqs-sshd restart\n+```\n+After adding new `IdentityKey` or `HostKey` values, generate those new keys with\n+```\n+docker exec -it <name-or-hash-of-container> /opt/oqs-ssh/scripts/key-gen.sh\n+```\n+\n+## Choosing the SIG and KEX algorithms\n+\n+For a list of all signature and key exchange algorithms see [here](https://github.com/open-quantum-safe/openssh#supported-algorithms). Be aware that there is a limitation of what algorithms are enabled in PQS-OpenSSH per default, more information in the section **Enabling additional PQC algorithms** below. It is recommended to only use the hybrid variants to maintain established classical security. The post-quantum safe algorithms have not yet received enough confidence to be relied on as the only security mechanism.\n+\n+The image's default key exchange algorithm is `ecdh-nistp384-kyber-1024-sha384@openquantumsafe.org`. For host and identity key (authentication) algorithms `ssh-p256-dilithium2` is used. Those algorithms may be changed by adjusting the files `ssh_config` and `sshd_config` respectively.\n+\n+**In `ssh_config` (client side)**\n+- `KexAlgorithms`: Comma-separated list of enabled key-exchange algorithms. Priority given by order. Names according to [this KEX naming scheme](https://github.com/open-quantum-safe/openssh#key-exchange).\n+- `IdentityKey`: Path to identity key files. One entry for one file, can have multiple entries. SSH will look for those files when connecting to a host. Names of the key files need to be `~/.ssh/id_<SIG>` in order for them to be successfully generated. `<SIG>` is a post-quantum signature algorithm according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature), with every `-` replace by `_`. A list with of some possible `IdentityKey` values can be found [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/ssh_config).\n+- `PubkeyAcceptedKeyTypes`: Comma-separated list of identity keys the client offers to the host. Priority given by order. Note that if no corresponding `IdentityFile` is specified, this algorithm is ignored.\n+- `HostKeyAlgorithms`: Comma-separated list of the host key types the client accepts from the server. Names according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature).\n+\n+**In `sshd_config` (server side)**\n+- `KexAlgorithms`: Comma-separated list of enabled key-exchange algorithms. Priority given by order. Names according to [this KEX naming scheme](https://github.com/open-quantum-safe/openssh#key-exchange).\n+- `HostKey`: Path to host key files. One entry for one file, can have multiple entries. SSHD will look for those files when offering a host key to a client. Names of the key files need to be `/opt/oqs-ssh/ssh_host_<SIG>_key` in order for them to be successfully generated. `<SIG>` is a post-quantum signature algorithm according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature), with every `-` replace by `_`. A list with of some possible `HostKey` values can be found [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/sshd_config).\n+- `HostKeyAlgorithms`: Comma-separated list of the host offers to the client. Priority given by order. Note that if no corresponding `HostKey` is specified, this algorithm is ignored. Names according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature)\n+- `PubkeyAcceptedKeyTypes`: Comma-separated list of public keys the host will accept from the client.\n+\n+Be aware that configurations for `sshd` and `ssh` may be entirely different as long as you don't want to connect to `localhost`. For example can `ssh`  be configured like a classical `ssh` client and `sshd` may support post-quantum algorithms only with no backwards compatibility at all.\n+\n+*Note(s):*\n+- After changing any of the settings above, don't forget to `rc-service oqs-sshd restart` to apply the changes.\n+- After adding either a new host or identity key, run `/opt/oqs-ssh/key-gen.sh` to generate the key files as specified. Already existing files won't be altered during this process.\n+- New keys won't have any effect if they are not configured to be used in `HostKeyAlgorithms` or `PubkeyAcceptedKeyTypes` or if other keys have higher priority (first listed in `HostKeyAlgorithms`/`PubkeyAcceptedKeyTypes` has highest priority).\n+\n+## Automatic key generation\n+\n+The generation of the host and identity keys happens via the script [key-gen.sh](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/key-gen.sh) that is executed automatically every time the container started or run. The script checks if the required key already exist and gerenates it if necessary. This script is called every time the container is started, meaning the first time the container is run (`docker run ...`) and it is startet again (`docker start ...`) after a reboot or a `docker stop ...` command. It checks for existing keys before it generates new ones so it will **never** overwrite an already existing key. It also makes sure `sshd` is startet after at boot time or is restartet after new host keys were generated.","path":"openssh/USAGE.md","position":201,"original_position":201,"commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","original_commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars1.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"body":"Nits: \"gerenates\" -> \"generates\"; \"startet\" -> \"started\"","created_at":"2021-01-21T06:06:08Z","updated_at":"2021-01-21T06:38:54Z","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561623279","pull_request_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","author_association":"MEMBER","_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561623279"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561623279"},"pull_request":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"}},"start_line":null,"original_start_line":null,"start_side":null,"line":201,"original_line":201,"side":"RIGHT"},"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","id":540179821,"node_id":"MDExOlB1bGxSZXF1ZXN0NTQwMTc5ODIx","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65","diff_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.diff","patch_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.patch","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65","number":65,"state":"open","locked":false,"title":"Added OQS-OpenSSH demo","user":{"login":"xykro","id":9986471,"node_id":"MDQ6VXNlcjk5ODY0NzE=","avatar_url":"https://avatars0.githubusercontent.com/u/9986471?v=4","gravatar_id":"","url":"https://api.github.com/users/xykro","html_url":"https://github.com/xykro","followers_url":"https://api.github.com/users/xykro/followers","following_url":"https://api.github.com/users/xykro/following{/other_user}","gists_url":"https://api.github.com/users/xykro/gists{/gist_id}","starred_url":"https://api.github.com/users/xykro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xykro/subscriptions","organizations_url":"https://api.github.com/users/xykro/orgs","repos_url":"https://api.github.com/users/xykro/repos","events_url":"https://api.github.com/users/xykro/events{/privacy}","received_events_url":"https://api.github.com/users/xykro/received_events","type":"User","site_admin":false},"body":"Hi @baentsch and @dstebila\r\n\r\nReferring to issue #54. \r\n\r\nAs we talked about, we have (the [ISE institute](https://www.fhnw.ch/en/about-fhnw/schools/school-of-engineering/institutes/institute-for-sensors-and-electronics) from [FHNW](https://www.fhnw.ch/en)) have created a docker demo image that uses your OQS-OpenSSH implementation.\r\n\r\nThe [README.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/README.md) contains setup and general information while the [USAGE.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/USAGE.md) describes some more advanced use cases, like using this demo to connect to a remote OQS-OpenSSH instance.\r\n\r\nI've added a new job for [CircleCI](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/.circleci/config.yml) for this demo image. The test it does is connecting to itself (localhost) using chosen PQC algorithms via OQS-SSH. Defaults are p256-dilithium2 and ecdh-nistp384-kyber-1024, chosen more or less randomly. Those algorithms may be changed by passing the SIG and/or KEM variables to the docker run command.\r\nReturn code is 0 if the connection to localhost using the ubkey method was successful, 1 otherwise.\r\n\r\nI have **not** added OQS-OpenSSH to the \"Push all images\" step, I reckoned as you will be hosting the image I'll let you set that up properly.\r\n\r\nGit history is squashed down to 1 commit, I do not want to bring my mess over :-)\r\n\r\nLet me know if any adjustments are required.","created_at":"2020-12-15T11:27:41Z","updated_at":"2021-01-21T06:38:54Z","closed_at":null,"merged_at":null,"merge_commit_sha":"cd0b5c1b0ec4ba7908103eb23e10c7da38c4fbfb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits","review_comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments","review_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34","head":{"label":"fhnw-ise-qcrypt:pull-request","ref":"pull-request","sha":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"repo":{"id":299259879,"node_id":"MDEwOlJlcG9zaXRvcnkyOTkyNTk4Nzk=","name":"oqs-demos","full_name":"fhnw-ise-qcrypt/oqs-demos","private":false,"owner":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":true,"url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos","forks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/forks","keys_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/teams","hooks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/events","assignees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/tags","blobs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscription","commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/merges","archive_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/downloads","issues_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/deployments","created_at":"2020-09-28T09:35:41Z","updated_at":"2020-12-15T11:37:14Z","pushed_at":"2021-01-20T16:30:56Z","git_url":"git://github.com/fhnw-ise-qcrypt/oqs-demos.git","ssh_url":"git@github.com:fhnw-ise-qcrypt/oqs-demos.git","clone_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos.git","svn_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","homepage":"https://openquantumsafe.org/","size":205,"stargazers_count":0,"watchers_count":0,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":null,"forks":0,"open_issues":2,"watchers":0,"default_branch":"main"}},"base":{"label":"open-quantum-safe:main","ref":"main","sha":"cb71ca0e3abce4a27c9030c1fa044816241921ef","user":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"repo":{"id":218087071,"node_id":"MDEwOlJlcG9zaXRvcnkyMTgwODcwNzE=","name":"oqs-demos","full_name":"open-quantum-safe/oqs-demos","private":false,"owner":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/open-quantum-safe/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":false,"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos","forks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/forks","keys_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/teams","hooks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/events","assignees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/tags","blobs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscription","commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/merges","archive_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/downloads","issues_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/deployments","created_at":"2019-10-28T15:57:00Z","updated_at":"2021-01-17T20:05:26Z","pushed_at":"2021-01-20T16:30:58Z","git_url":"git://github.com/open-quantum-safe/oqs-demos.git","ssh_url":"git@github.com:open-quantum-safe/oqs-demos.git","clone_url":"https://github.com/open-quantum-safe/oqs-demos.git","svn_url":"https://github.com/open-quantum-safe/oqs-demos","homepage":"https://openquantumsafe.org/","size":129,"stargazers_count":17,"watchers_count":17,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":11,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":6,"license":null,"forks":11,"open_issues":6,"watchers":17,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65"},"issue":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65"},"comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments"},"review_comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments"},"review_comment":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits"},"statuses":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34"}},"author_association":"NONE","active_lock_reason":null}},"public":true,"created_at":"2021-01-21T06:06:08Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"14893975932","type":"PullRequestReviewCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":218087071,"name":"open-quantum-safe/oqs-demos","url":"https://api.github.com/repos/open-quantum-safe/oqs-demos"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561625911","pull_request_review_id":573003806,"id":561625911,"node_id":"MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTYyNTkxMQ==","diff_hunk":"@@ -0,0 +1,270 @@\n+# Purpose \n+\n+This is an [opensshd](https://https.openssh.com) docker image based on the [OQS OpenSSH 7.9 fork](https://github.com/open-quantum-safe/openssh), which allows ssh to quantum-safely negotiate session keys and use quantum-safe authentication with algorithms from the [Post-Quantum Cryptography Project by NIST](https://csrc.nist.gov/projects/post-quantum-cryptography).\n+\n+This image has a built-in non-root user to permit execution without particular [docker privileges](https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities). This is necessary as logging in as root in ssh is not recommended practice. But it is worth to note that this user, per default called `oqs`, is not set as the default user when the image starts. The reason for that is that the the start up script needs root permissions to generate all host keys and start the sshd service. This means that when executing a command as the user `oqs`, the `docker exec` command needs to be used together with the option `--user oqs`.\n+\n+If you built the docker image yourself following the instructions [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), exchange the name of the image from 'openquantumsafe/openssh' in the examples below suitably.\n+\n+# Quick start \n+\n+1. Start an OpenSSH server with post-quantum cryptography support by running\n+\n+        docker run --name oqs-openssh-server -dit --rm openquantumsafe/openssh\n+\n+2. Connect to that server running\n+\n+        docker exec --user oqs -it oqs-openssh-server ssh oqs@localhost\n+\n+3. Accept the host key and authenticate with the default password `oqs.pw`\n+\n+4. To clean up, exit the ssh session with `exit` and run\n+\n+        docker stop oqs-openssh-server\n+\n+   to stop (and remove) the container.\n+\n+*Note:* Due to the `--rm` option the container will be removed as soon as it is stopped, it may be omitted to keep the container. But because we're just testing its basic functionality right now this is not required.\n+   \n+# Limitations\n+\n+For limitations of the post-quantum algorithms themselves, refer to [this](https://github.com/open-quantum-safe/openssh#limitations-and-security).\n+\n+# Slightly more advanced usage options\n+\n+## Connect from container to container via OQS-SSH\n+\n+To easily connect from one container to another, we can make use of the docker's own networking capabilities.\n+\n+1. Create a docker network with\n+   \n+        docker network create oqs-openssh-net\n+\n+2. Start a new container that is connected to that network with\n+   \n+        docker run --rm -dit --net oqs-openssh-net --name oqs-openssh-server openquantumsafe/openssh\n+\n+3. Then access this server using OQS-SSH through the docker network with\n+        \n+        docker run --rm -it --net oqs-openssh-net openquantumsafe/openssh ssh oqs@oqs-openssh-server\n+\n+   type `yes` to add the host to the `known_hosts` and authenticate the user `oqs` with its default password `oqs.pw`.\n+\n+Congratulations, you just connected from one docker container to another in a quantum safe manner! To see how to use this in a more practical setting, see how to use docker to quantum safely connect to a remote host in [USAGE.md](USAGE.md#Using-oqs-ssh-for-quantum-safe-remote-access-with-minimal-intrusion).\n+\n+## Access the man pages of oqs-ssh\n+\n+Man pages for oqs-ssh are installed in `<INSTALL_DIR>/share/man` and can be viewed by for example \n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man1/ssh.1\n+```\n+or\n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man5/ssh.5\n+ ```\n+Note that those man pages do **not** differ from the original ssh man pages. So it might be easier to consult them on your local system or the internet.\n+\n+Direct links to man pages: [ssh(1)](https://linux.die.net/man/1/ssh), [sshd(8)](https://linux.die.net/man/8/sshd), [ssh_config(5)](https://linux.die.net/man/5/ssh_config), [sshd_config(5)](https://linux.die.net/man/5/sshd_config)\n+\n+## Key-based client authentication\n+\n+Key-based client authentication works just as it does with normal SSH. Just add your post-quantum public key (normally located in `~/.ssh/*.pub`) to the `authorized_keys` file on the server (normally located in `~/.ssh/authorized_keys`).\n+\n+## Using oqs-ssh for quantum-safe remote access with minimal intrusion\n+\n+One use case of quantum-safe ssh running in docker could be accessing a remote system without messing with its ssh(d) installation or other parts of the system you maybe don't want to interact with. This means minimal intrusion and everything can easily be removed again. This is done by running this docker image on said system and sharing its network space. Thus it is possible to access host ports from **within** the docker container. Normally, the use case of docker is one of isolation with some shared directories and published ports at max. So this solution works around the usual docker limitations.\n+\n+Additionally, it is advised to **change the default username and password** when building the image because your plan is to expose it to the world.\n+\n+```\n+Structure of quantum-safe remote access using docker containers\n+\n++------------------+                +----------------------+\n+|      Client      |                |         Host         |\n+|  +------------+  |                |  +----------------+  |\n+|  |            |  |                |  |                |  |\n+|  |   Docker   +--------------------->+     Docker     |  |\n+|  |            |  |       Port 2222|  |                |  |\n+|  +------------+  |                |  +-------+--------+  |\n+|                  |                |          |           |\n++------------------+                |  Port 22 v           |\n+                                    |  +-------+--------+  |\n+                                    |  |                |  |\n+                                    |  |  sshd on Host  |  |\n+                                    |  |                |  |\n+                                    |  +----------------+  |\n+                                    |                      |\n+                                    +----------------------+\n+```\n+### Set up the server (docker container on target host)\n+\n+To start the ssh server, meaning the docker container on the host system, follow those instructions:\n+- Run the docker image with\n+\n+       docker run -dit --network host --name oqs-ssh openquantumsafe/openssh\n+\n+- Or, if you want the container to automatically start with docker\n+\n+       docker run -dit --network host --name oqs-ssh --restart unless-stopped openquantumsafe/openssh\n+\n+The `--network host` option will attach the container directly to your host's network, sharing its IP. The sshd in the container is now accessible from the outside using the host's IP address and the specified port (2222 per default).\n+\n+Be aware that the port 2222 also needs to be open in any firewalls there may be!\n+\n+If you want to seriously use this image to connect to a machine, it is **strongly advised** to change the default password of the `oqs` user. This can be done in the **running** container with\n+```\n+docker exec -it oqs-ssh passwd oqs\n+```\n+Or you build the image yourself with a different default password from the sources on [Github](https://github.com/openquantumsafe/oqs-demos).\n+\n+#### Enable classical SSH\n+\n+Because we wan't to be able to connect to our host that does not run OQS-SSH, we first need to enable classical SSH capabilities for the client **on the host system**.\n+\n+1. After running the image, run a shell with `docker exec -it oqs-ssh /bin/bash`\n+\n+2. Run `nano /etc/oqs-ssh/ssh_config` and \n+   - uncomment the line `# IdentityFile ~/.ssh/id_ed25519`,\n+   - add `ssh-ed25519` to `HostkeyAlgorithms` and `PubkeyAcceptedKeyTypes` (comma-separated)\n+   - add `curve25519-sha256@libssh.org` to `KexAlgorithms` (comma-separated)\n+\n+3. Save and exit your editor\n+4. Run `rc-service oqs-ssh restart`\n+5. Run `/opt/oqs-ssh/scripts/key-gen.sh`\n+6. Run `ssh <username>@localhost -p 22` with `<username>` being your host's username to test your setup\n+7. If everything went smoothly, your docker container connected with your host's classical `sshd`\n+\n+### Set up the client\n+\n+For the client side, run the image with\n+```bash\n+docker run -it openquantumsafe/openssh ssh <username>@<remote-host-ip> -p 2222\n+```\n+You then are prompted to enter the password for the remote server. Defaults are `oqs` for `<username>` and `oqs.pw` as password. It is strongly adviced to change this password as described above.\n+\n+You may omit `-p 2222` if this port is configured accordingly in `ssh_config` on the client (which is the default).\n+\n+And most importantly, we can now access the host's `sshd` from within the docker image by addressing port 22 via the localhost, using the host's credentials.\n+```bash\n+ssh <username>@localhost -p 22\n+```\n+To omit the `-p 22` option, the specification of the port, this can be set as default in `ssh_config`.\n+\n+# Seriously more advanced usage options\n+\n+## Configuring `ssh` and `sshd`\n+\n+If you are using the pre-compiled image from [Dockerhub](https://hub.docker.com/r/openquantumsafe/openssh) you can only make changes to the configuration at run time. Those changes will only be specific to the current container and won't persist through multiple containers and will be lost upon removing the container. The configuration files [ssh_config](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/ssh_config) and [sshd_config](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/sshd_config) are located in `/opt/oqs-ssh/ssh_config` and `/opt/oqs-ssh/sshd_config` respectively. \n+\n+If you built the docker image yourself following [these instructions](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), you can make changes to `ssh_config` and `sshd_config` before building the image (they will be copied to the image at build time). Firstly, this will make your changes the default for your containers and secondly you won't lose them in case you remove the container.\n+\n+The configuration files can be edited with pre-installed `nano` or `vi` editors, e.g.:\n+```\n+docker exec -it <name-or-hash-of-container> nano /opt/oqs-ssh/ssh_config\n+```\n+After changing anything in and only in `sshd_config`, run\n+```\n+docker exec -it <name-or-hash-of-container> rc-service oqs-sshd restart\n+```\n+After adding new `IdentityKey` or `HostKey` values, generate those new keys with\n+```\n+docker exec -it <name-or-hash-of-container> /opt/oqs-ssh/scripts/key-gen.sh\n+```\n+\n+## Choosing the SIG and KEX algorithms\n+\n+For a list of all signature and key exchange algorithms see [here](https://github.com/open-quantum-safe/openssh#supported-algorithms). Be aware that there is a limitation of what algorithms are enabled in PQS-OpenSSH per default, more information in the section **Enabling additional PQC algorithms** below. It is recommended to only use the hybrid variants to maintain established classical security. The post-quantum safe algorithms have not yet received enough confidence to be relied on as the only security mechanism.\n+\n+The image's default key exchange algorithm is `ecdh-nistp384-kyber-1024-sha384@openquantumsafe.org`. For host and identity key (authentication) algorithms `ssh-p256-dilithium2` is used. Those algorithms may be changed by adjusting the files `ssh_config` and `sshd_config` respectively.\n+\n+**In `ssh_config` (client side)**\n+- `KexAlgorithms`: Comma-separated list of enabled key-exchange algorithms. Priority given by order. Names according to [this KEX naming scheme](https://github.com/open-quantum-safe/openssh#key-exchange).\n+- `IdentityKey`: Path to identity key files. One entry for one file, can have multiple entries. SSH will look for those files when connecting to a host. Names of the key files need to be `~/.ssh/id_<SIG>` in order for them to be successfully generated. `<SIG>` is a post-quantum signature algorithm according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature), with every `-` replace by `_`. A list with of some possible `IdentityKey` values can be found [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/ssh_config).\n+- `PubkeyAcceptedKeyTypes`: Comma-separated list of identity keys the client offers to the host. Priority given by order. Note that if no corresponding `IdentityFile` is specified, this algorithm is ignored.\n+- `HostKeyAlgorithms`: Comma-separated list of the host key types the client accepts from the server. Names according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature).\n+\n+**In `sshd_config` (server side)**\n+- `KexAlgorithms`: Comma-separated list of enabled key-exchange algorithms. Priority given by order. Names according to [this KEX naming scheme](https://github.com/open-quantum-safe/openssh#key-exchange).\n+- `HostKey`: Path to host key files. One entry for one file, can have multiple entries. SSHD will look for those files when offering a host key to a client. Names of the key files need to be `/opt/oqs-ssh/ssh_host_<SIG>_key` in order for them to be successfully generated. `<SIG>` is a post-quantum signature algorithm according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature), with every `-` replace by `_`. A list with of some possible `HostKey` values can be found [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/sshd_config).\n+- `HostKeyAlgorithms`: Comma-separated list of the host offers to the client. Priority given by order. Note that if no corresponding `HostKey` is specified, this algorithm is ignored. Names according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature)\n+- `PubkeyAcceptedKeyTypes`: Comma-separated list of public keys the host will accept from the client.\n+\n+Be aware that configurations for `sshd` and `ssh` may be entirely different as long as you don't want to connect to `localhost`. For example can `ssh`  be configured like a classical `ssh` client and `sshd` may support post-quantum algorithms only with no backwards compatibility at all.\n+\n+*Note(s):*\n+- After changing any of the settings above, don't forget to `rc-service oqs-sshd restart` to apply the changes.\n+- After adding either a new host or identity key, run `/opt/oqs-ssh/key-gen.sh` to generate the key files as specified. Already existing files won't be altered during this process.\n+- New keys won't have any effect if they are not configured to be used in `HostKeyAlgorithms` or `PubkeyAcceptedKeyTypes` or if other keys have higher priority (first listed in `HostKeyAlgorithms`/`PubkeyAcceptedKeyTypes` has highest priority).\n+\n+## Automatic key generation\n+\n+The generation of the host and identity keys happens via the script [key-gen.sh](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/key-gen.sh) that is executed automatically every time the container started or run. The script checks if the required key already exist and gerenates it if necessary. This script is called every time the container is started, meaning the first time the container is run (`docker run ...`) and it is startet again (`docker start ...`) after a reboot or a `docker stop ...` command. It checks for existing keys before it generates new ones so it will **never** overwrite an already existing key. It also makes sure `sshd` is startet after at boot time or is restartet after new host keys were generated.\n+\n+Which keys to generate is determined using the configuration files (`ssh_config` and `sshd_config`). A key's necessity is determinded based on the following parameters:\n+1. `IdentityFile` (in `ssh_config`) for **identity keys**: For every entry (there may be multiple) the corresponding identity key is generated.\n+   - e.g. `IdentityFile ~/.ssh/id_ed25519` or\n+   - `IdentityFile ~/.ssh/id_p256_dilithium2`\n+2. `HostKey` (in `sshd_config`) for **host keys**: For every entry (there may be multiple) the corresponding host key is generated.\n+   - e.g. `HostKey /opt/oqs-ssh/ssh_host_p256_dilithium2_key` or\n+   - `HostKey /opt/oqs-ssh/ssh_host_falcon512_key`\n+\n+In order to generate the host keys and start the `sshd` the image needs to be run as the `root` user, meaning the `docker run` command shall not contain the `--user oqs` option.\n+\n+As mentioned above, those keys will only be generated if they don't yet exist. So even though the script is executed every time a container is started (or run), it usually only does something the first time. If any host key was generated, the `sshd` service will be restarted.\n+\n+The location where `key-gen.sh` is looking for `ssh_config`/`sshd_config` is the install directory of `oqs-ssh`, normally `/opt/oqs-ssh/`.\n+\n+## Enabling additional PQC algorithms\n+\n+Post-quantum safe algorithms must (in theory) be enabled at docker image build time when compiling [OQS-OpenSSH](https://github.com/open-quantum-safe/openssh). For this reason, in this pre-built image on Dockerhub no more algorithms can be enabled. However, before jumping over to the [build instructions](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), please continue reading as there is a big BUT.\n+\n+Long story short: Thus far, no more algorithms may be enabled for this Docker image than described [here](https://github.com/open-quantum-safe/openssh/tree/OQS-OpenSSH-snapshot-2020-08#supported-algorithms). Find out **More details on the why** below.\n+\n+### More details on the why\n+It is not quite straight forward how to figure out what PQC algorithms are actually enabled, where to enable them and how. The supported algorithms in release `OQS-OpenSSH-snapshot-2020-08` (the one used when building this Docker image) are listed [in this section](https://github.com/open-quantum-safe/openssh/tree/OQS-OpenSSH-snapshot-2020-08#supported-algorithms). Be especially aware of the limitation for the signature algorithms, where only all L1 signature algorithms and all **Rainbow Classic** variants are enabled by default. **Classic** rainbow only, documentation has it slightly wrong there. This is already corrected in newer releases.\n+\n+Enabling more algorithms would require changing [openssh/oqs_templates/generate.yml](https://github.com/open-quantum-safe/openssh/blob/OQS-master/oqs-template/generate.yml) according to [this documentation](https://github.com/open-quantum-safe/openssh/wiki/Using-liboqs-supported-algorithms-in-the-fork#code-generation). Additionally, you need to make sure that the algorithms are enabled in [liboqs](https://github.com/open-quantum-safe/liboqs) as well (see [here for more information](https://github.com/open-quantum-safe/liboqs/wiki/Customizing-liboqs#oqs_enable_kem_algoqs_enable_sig_alg)). Enabling more algorithms in `liboqs` can be done at Docker build time using the build option `LIBOQS_BUILD_DEFINES`. But enabling them in `OpenSSH` would require changing [openssh/oqs_templates/generate.yml](https://github.com/open-quantum-safe/openssh/blob/OQS-master/oqs-template/generate.yml) after checking out `openssh` in the [Dockerfile](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/Dockerfile), and this is just not implemented at this moment in time.","path":"openssh/USAGE.md","position":226,"original_position":226,"commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","original_commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars1.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"body":"Suggest adding \"in this docker image\" at the end of the sentence for further clarification: You did an excellent job describing all that someone needs to know who really wants to do it manually. It also is clear that automating this via docker parameters is significant effort.","created_at":"2021-01-21T06:15:00Z","updated_at":"2021-01-21T06:38:54Z","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561625911","pull_request_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","author_association":"MEMBER","_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561625911"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561625911"},"pull_request":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"}},"start_line":null,"original_start_line":null,"start_side":null,"line":226,"original_line":226,"side":"RIGHT"},"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","id":540179821,"node_id":"MDExOlB1bGxSZXF1ZXN0NTQwMTc5ODIx","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65","diff_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.diff","patch_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.patch","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65","number":65,"state":"open","locked":false,"title":"Added OQS-OpenSSH demo","user":{"login":"xykro","id":9986471,"node_id":"MDQ6VXNlcjk5ODY0NzE=","avatar_url":"https://avatars0.githubusercontent.com/u/9986471?v=4","gravatar_id":"","url":"https://api.github.com/users/xykro","html_url":"https://github.com/xykro","followers_url":"https://api.github.com/users/xykro/followers","following_url":"https://api.github.com/users/xykro/following{/other_user}","gists_url":"https://api.github.com/users/xykro/gists{/gist_id}","starred_url":"https://api.github.com/users/xykro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xykro/subscriptions","organizations_url":"https://api.github.com/users/xykro/orgs","repos_url":"https://api.github.com/users/xykro/repos","events_url":"https://api.github.com/users/xykro/events{/privacy}","received_events_url":"https://api.github.com/users/xykro/received_events","type":"User","site_admin":false},"body":"Hi @baentsch and @dstebila\r\n\r\nReferring to issue #54. \r\n\r\nAs we talked about, we have (the [ISE institute](https://www.fhnw.ch/en/about-fhnw/schools/school-of-engineering/institutes/institute-for-sensors-and-electronics) from [FHNW](https://www.fhnw.ch/en)) have created a docker demo image that uses your OQS-OpenSSH implementation.\r\n\r\nThe [README.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/README.md) contains setup and general information while the [USAGE.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/USAGE.md) describes some more advanced use cases, like using this demo to connect to a remote OQS-OpenSSH instance.\r\n\r\nI've added a new job for [CircleCI](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/.circleci/config.yml) for this demo image. The test it does is connecting to itself (localhost) using chosen PQC algorithms via OQS-SSH. Defaults are p256-dilithium2 and ecdh-nistp384-kyber-1024, chosen more or less randomly. Those algorithms may be changed by passing the SIG and/or KEM variables to the docker run command.\r\nReturn code is 0 if the connection to localhost using the ubkey method was successful, 1 otherwise.\r\n\r\nI have **not** added OQS-OpenSSH to the \"Push all images\" step, I reckoned as you will be hosting the image I'll let you set that up properly.\r\n\r\nGit history is squashed down to 1 commit, I do not want to bring my mess over :-)\r\n\r\nLet me know if any adjustments are required.","created_at":"2020-12-15T11:27:41Z","updated_at":"2021-01-21T06:38:54Z","closed_at":null,"merged_at":null,"merge_commit_sha":"cd0b5c1b0ec4ba7908103eb23e10c7da38c4fbfb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits","review_comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments","review_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34","head":{"label":"fhnw-ise-qcrypt:pull-request","ref":"pull-request","sha":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"repo":{"id":299259879,"node_id":"MDEwOlJlcG9zaXRvcnkyOTkyNTk4Nzk=","name":"oqs-demos","full_name":"fhnw-ise-qcrypt/oqs-demos","private":false,"owner":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":true,"url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos","forks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/forks","keys_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/teams","hooks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/events","assignees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/tags","blobs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscription","commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/merges","archive_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/downloads","issues_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/deployments","created_at":"2020-09-28T09:35:41Z","updated_at":"2020-12-15T11:37:14Z","pushed_at":"2021-01-20T16:30:56Z","git_url":"git://github.com/fhnw-ise-qcrypt/oqs-demos.git","ssh_url":"git@github.com:fhnw-ise-qcrypt/oqs-demos.git","clone_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos.git","svn_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","homepage":"https://openquantumsafe.org/","size":205,"stargazers_count":0,"watchers_count":0,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":null,"forks":0,"open_issues":2,"watchers":0,"default_branch":"main"}},"base":{"label":"open-quantum-safe:main","ref":"main","sha":"cb71ca0e3abce4a27c9030c1fa044816241921ef","user":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"repo":{"id":218087071,"node_id":"MDEwOlJlcG9zaXRvcnkyMTgwODcwNzE=","name":"oqs-demos","full_name":"open-quantum-safe/oqs-demos","private":false,"owner":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/open-quantum-safe/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":false,"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos","forks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/forks","keys_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/teams","hooks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/events","assignees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/tags","blobs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscription","commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/merges","archive_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/downloads","issues_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/deployments","created_at":"2019-10-28T15:57:00Z","updated_at":"2021-01-17T20:05:26Z","pushed_at":"2021-01-20T16:30:58Z","git_url":"git://github.com/open-quantum-safe/oqs-demos.git","ssh_url":"git@github.com:open-quantum-safe/oqs-demos.git","clone_url":"https://github.com/open-quantum-safe/oqs-demos.git","svn_url":"https://github.com/open-quantum-safe/oqs-demos","homepage":"https://openquantumsafe.org/","size":129,"stargazers_count":17,"watchers_count":17,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":11,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":6,"license":null,"forks":11,"open_issues":6,"watchers":17,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65"},"issue":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65"},"comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments"},"review_comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments"},"review_comment":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits"},"statuses":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34"}},"author_association":"NONE","active_lock_reason":null}},"public":true,"created_at":"2021-01-21T06:15:00Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"14893975937","type":"PullRequestReviewCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":218087071,"name":"open-quantum-safe/oqs-demos","url":"https://api.github.com/repos/open-quantum-safe/oqs-demos"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561629581","pull_request_review_id":573003806,"id":561629581,"node_id":"MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTYyOTU4MQ==","diff_hunk":"@@ -0,0 +1,270 @@\n+# Purpose \n+\n+This is an [opensshd](https://https.openssh.com) docker image based on the [OQS OpenSSH 7.9 fork](https://github.com/open-quantum-safe/openssh), which allows ssh to quantum-safely negotiate session keys and use quantum-safe authentication with algorithms from the [Post-Quantum Cryptography Project by NIST](https://csrc.nist.gov/projects/post-quantum-cryptography).\n+\n+This image has a built-in non-root user to permit execution without particular [docker privileges](https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities). This is necessary as logging in as root in ssh is not recommended practice. But it is worth to note that this user, per default called `oqs`, is not set as the default user when the image starts. The reason for that is that the the start up script needs root permissions to generate all host keys and start the sshd service. This means that when executing a command as the user `oqs`, the `docker exec` command needs to be used together with the option `--user oqs`.\n+\n+If you built the docker image yourself following the instructions [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), exchange the name of the image from 'openquantumsafe/openssh' in the examples below suitably.\n+\n+# Quick start \n+\n+1. Start an OpenSSH server with post-quantum cryptography support by running\n+\n+        docker run --name oqs-openssh-server -dit --rm openquantumsafe/openssh\n+\n+2. Connect to that server running\n+\n+        docker exec --user oqs -it oqs-openssh-server ssh oqs@localhost\n+\n+3. Accept the host key and authenticate with the default password `oqs.pw`\n+\n+4. To clean up, exit the ssh session with `exit` and run\n+\n+        docker stop oqs-openssh-server\n+\n+   to stop (and remove) the container.\n+\n+*Note:* Due to the `--rm` option the container will be removed as soon as it is stopped, it may be omitted to keep the container. But because we're just testing its basic functionality right now this is not required.\n+   \n+# Limitations\n+\n+For limitations of the post-quantum algorithms themselves, refer to [this](https://github.com/open-quantum-safe/openssh#limitations-and-security).\n+\n+# Slightly more advanced usage options\n+\n+## Connect from container to container via OQS-SSH\n+\n+To easily connect from one container to another, we can make use of the docker's own networking capabilities.\n+\n+1. Create a docker network with\n+   \n+        docker network create oqs-openssh-net\n+\n+2. Start a new container that is connected to that network with\n+   \n+        docker run --rm -dit --net oqs-openssh-net --name oqs-openssh-server openquantumsafe/openssh\n+\n+3. Then access this server using OQS-SSH through the docker network with\n+        \n+        docker run --rm -it --net oqs-openssh-net openquantumsafe/openssh ssh oqs@oqs-openssh-server\n+\n+   type `yes` to add the host to the `known_hosts` and authenticate the user `oqs` with its default password `oqs.pw`.\n+\n+Congratulations, you just connected from one docker container to another in a quantum safe manner! To see how to use this in a more practical setting, see how to use docker to quantum safely connect to a remote host in [USAGE.md](USAGE.md#Using-oqs-ssh-for-quantum-safe-remote-access-with-minimal-intrusion).\n+\n+## Access the man pages of oqs-ssh\n+\n+Man pages for oqs-ssh are installed in `<INSTALL_DIR>/share/man` and can be viewed by for example \n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man1/ssh.1\n+```\n+or\n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man5/ssh.5\n+ ```\n+Note that those man pages do **not** differ from the original ssh man pages. So it might be easier to consult them on your local system or the internet.\n+\n+Direct links to man pages: [ssh(1)](https://linux.die.net/man/1/ssh), [sshd(8)](https://linux.die.net/man/8/sshd), [ssh_config(5)](https://linux.die.net/man/5/ssh_config), [sshd_config(5)](https://linux.die.net/man/5/sshd_config)\n+\n+## Key-based client authentication\n+\n+Key-based client authentication works just as it does with normal SSH. Just add your post-quantum public key (normally located in `~/.ssh/*.pub`) to the `authorized_keys` file on the server (normally located in `~/.ssh/authorized_keys`).\n+\n+## Using oqs-ssh for quantum-safe remote access with minimal intrusion\n+\n+One use case of quantum-safe ssh running in docker could be accessing a remote system without messing with its ssh(d) installation or other parts of the system you maybe don't want to interact with. This means minimal intrusion and everything can easily be removed again. This is done by running this docker image on said system and sharing its network space. Thus it is possible to access host ports from **within** the docker container. Normally, the use case of docker is one of isolation with some shared directories and published ports at max. So this solution works around the usual docker limitations.\n+\n+Additionally, it is advised to **change the default username and password** when building the image because your plan is to expose it to the world.\n+\n+```\n+Structure of quantum-safe remote access using docker containers\n+\n++------------------+                +----------------------+\n+|      Client      |                |         Host         |\n+|  +------------+  |                |  +----------------+  |\n+|  |            |  |                |  |                |  |\n+|  |   Docker   +--------------------->+     Docker     |  |\n+|  |            |  |       Port 2222|  |                |  |\n+|  +------------+  |                |  +-------+--------+  |\n+|                  |                |          |           |\n++------------------+                |  Port 22 v           |\n+                                    |  +-------+--------+  |\n+                                    |  |                |  |\n+                                    |  |  sshd on Host  |  |\n+                                    |  |                |  |\n+                                    |  +----------------+  |\n+                                    |                      |\n+                                    +----------------------+\n+```\n+### Set up the server (docker container on target host)\n+\n+To start the ssh server, meaning the docker container on the host system, follow those instructions:\n+- Run the docker image with\n+\n+       docker run -dit --network host --name oqs-ssh openquantumsafe/openssh\n+\n+- Or, if you want the container to automatically start with docker\n+\n+       docker run -dit --network host --name oqs-ssh --restart unless-stopped openquantumsafe/openssh\n+\n+The `--network host` option will attach the container directly to your host's network, sharing its IP. The sshd in the container is now accessible from the outside using the host's IP address and the specified port (2222 per default).\n+\n+Be aware that the port 2222 also needs to be open in any firewalls there may be!\n+\n+If you want to seriously use this image to connect to a machine, it is **strongly advised** to change the default password of the `oqs` user. This can be done in the **running** container with\n+```\n+docker exec -it oqs-ssh passwd oqs\n+```\n+Or you build the image yourself with a different default password from the sources on [Github](https://github.com/openquantumsafe/oqs-demos).\n+\n+#### Enable classical SSH\n+\n+Because we wan't to be able to connect to our host that does not run OQS-SSH, we first need to enable classical SSH capabilities for the client **on the host system**.\n+\n+1. After running the image, run a shell with `docker exec -it oqs-ssh /bin/bash`\n+\n+2. Run `nano /etc/oqs-ssh/ssh_config` and ","path":"openssh/USAGE.md","position":126,"original_position":126,"commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","original_commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars1.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"body":"Now, this unfortunately doesn't work: `/etc/oqs-ssh` doesn't exist. Do you mean `/opt/oqs-ssh`?","created_at":"2021-01-21T06:26:11Z","updated_at":"2021-01-21T06:38:54Z","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561629581","pull_request_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","author_association":"MEMBER","_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561629581"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561629581"},"pull_request":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"}},"start_line":null,"original_start_line":null,"start_side":null,"line":126,"original_line":126,"side":"RIGHT"},"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","id":540179821,"node_id":"MDExOlB1bGxSZXF1ZXN0NTQwMTc5ODIx","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65","diff_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.diff","patch_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.patch","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65","number":65,"state":"open","locked":false,"title":"Added OQS-OpenSSH demo","user":{"login":"xykro","id":9986471,"node_id":"MDQ6VXNlcjk5ODY0NzE=","avatar_url":"https://avatars0.githubusercontent.com/u/9986471?v=4","gravatar_id":"","url":"https://api.github.com/users/xykro","html_url":"https://github.com/xykro","followers_url":"https://api.github.com/users/xykro/followers","following_url":"https://api.github.com/users/xykro/following{/other_user}","gists_url":"https://api.github.com/users/xykro/gists{/gist_id}","starred_url":"https://api.github.com/users/xykro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xykro/subscriptions","organizations_url":"https://api.github.com/users/xykro/orgs","repos_url":"https://api.github.com/users/xykro/repos","events_url":"https://api.github.com/users/xykro/events{/privacy}","received_events_url":"https://api.github.com/users/xykro/received_events","type":"User","site_admin":false},"body":"Hi @baentsch and @dstebila\r\n\r\nReferring to issue #54. \r\n\r\nAs we talked about, we have (the [ISE institute](https://www.fhnw.ch/en/about-fhnw/schools/school-of-engineering/institutes/institute-for-sensors-and-electronics) from [FHNW](https://www.fhnw.ch/en)) have created a docker demo image that uses your OQS-OpenSSH implementation.\r\n\r\nThe [README.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/README.md) contains setup and general information while the [USAGE.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/USAGE.md) describes some more advanced use cases, like using this demo to connect to a remote OQS-OpenSSH instance.\r\n\r\nI've added a new job for [CircleCI](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/.circleci/config.yml) for this demo image. The test it does is connecting to itself (localhost) using chosen PQC algorithms via OQS-SSH. Defaults are p256-dilithium2 and ecdh-nistp384-kyber-1024, chosen more or less randomly. Those algorithms may be changed by passing the SIG and/or KEM variables to the docker run command.\r\nReturn code is 0 if the connection to localhost using the ubkey method was successful, 1 otherwise.\r\n\r\nI have **not** added OQS-OpenSSH to the \"Push all images\" step, I reckoned as you will be hosting the image I'll let you set that up properly.\r\n\r\nGit history is squashed down to 1 commit, I do not want to bring my mess over :-)\r\n\r\nLet me know if any adjustments are required.","created_at":"2020-12-15T11:27:41Z","updated_at":"2021-01-21T06:38:54Z","closed_at":null,"merged_at":null,"merge_commit_sha":"cd0b5c1b0ec4ba7908103eb23e10c7da38c4fbfb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits","review_comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments","review_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34","head":{"label":"fhnw-ise-qcrypt:pull-request","ref":"pull-request","sha":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"repo":{"id":299259879,"node_id":"MDEwOlJlcG9zaXRvcnkyOTkyNTk4Nzk=","name":"oqs-demos","full_name":"fhnw-ise-qcrypt/oqs-demos","private":false,"owner":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":true,"url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos","forks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/forks","keys_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/teams","hooks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/events","assignees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/tags","blobs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscription","commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/merges","archive_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/downloads","issues_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/deployments","created_at":"2020-09-28T09:35:41Z","updated_at":"2020-12-15T11:37:14Z","pushed_at":"2021-01-20T16:30:56Z","git_url":"git://github.com/fhnw-ise-qcrypt/oqs-demos.git","ssh_url":"git@github.com:fhnw-ise-qcrypt/oqs-demos.git","clone_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos.git","svn_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","homepage":"https://openquantumsafe.org/","size":205,"stargazers_count":0,"watchers_count":0,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":null,"forks":0,"open_issues":2,"watchers":0,"default_branch":"main"}},"base":{"label":"open-quantum-safe:main","ref":"main","sha":"cb71ca0e3abce4a27c9030c1fa044816241921ef","user":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"repo":{"id":218087071,"node_id":"MDEwOlJlcG9zaXRvcnkyMTgwODcwNzE=","name":"oqs-demos","full_name":"open-quantum-safe/oqs-demos","private":false,"owner":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/open-quantum-safe/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":false,"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos","forks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/forks","keys_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/teams","hooks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/events","assignees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/tags","blobs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscription","commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/merges","archive_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/downloads","issues_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/deployments","created_at":"2019-10-28T15:57:00Z","updated_at":"2021-01-17T20:05:26Z","pushed_at":"2021-01-20T16:30:58Z","git_url":"git://github.com/open-quantum-safe/oqs-demos.git","ssh_url":"git@github.com:open-quantum-safe/oqs-demos.git","clone_url":"https://github.com/open-quantum-safe/oqs-demos.git","svn_url":"https://github.com/open-quantum-safe/oqs-demos","homepage":"https://openquantumsafe.org/","size":129,"stargazers_count":17,"watchers_count":17,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":11,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":6,"license":null,"forks":11,"open_issues":6,"watchers":17,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65"},"issue":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65"},"comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments"},"review_comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments"},"review_comment":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits"},"statuses":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34"}},"author_association":"NONE","active_lock_reason":null}},"public":true,"created_at":"2021-01-21T06:26:11Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"14893975945","type":"PullRequestReviewCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":218087071,"name":"open-quantum-safe/oqs-demos","url":"https://api.github.com/repos/open-quantum-safe/oqs-demos"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561623711","pull_request_review_id":573003806,"id":561623711,"node_id":"MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTYyMzcxMQ==","diff_hunk":"@@ -0,0 +1,270 @@\n+# Purpose \n+\n+This is an [opensshd](https://https.openssh.com) docker image based on the [OQS OpenSSH 7.9 fork](https://github.com/open-quantum-safe/openssh), which allows ssh to quantum-safely negotiate session keys and use quantum-safe authentication with algorithms from the [Post-Quantum Cryptography Project by NIST](https://csrc.nist.gov/projects/post-quantum-cryptography).\n+\n+This image has a built-in non-root user to permit execution without particular [docker privileges](https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities). This is necessary as logging in as root in ssh is not recommended practice. But it is worth to note that this user, per default called `oqs`, is not set as the default user when the image starts. The reason for that is that the the start up script needs root permissions to generate all host keys and start the sshd service. This means that when executing a command as the user `oqs`, the `docker exec` command needs to be used together with the option `--user oqs`.\n+\n+If you built the docker image yourself following the instructions [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), exchange the name of the image from 'openquantumsafe/openssh' in the examples below suitably.\n+\n+# Quick start \n+\n+1. Start an OpenSSH server with post-quantum cryptography support by running\n+\n+        docker run --name oqs-openssh-server -dit --rm openquantumsafe/openssh\n+\n+2. Connect to that server running\n+\n+        docker exec --user oqs -it oqs-openssh-server ssh oqs@localhost\n+\n+3. Accept the host key and authenticate with the default password `oqs.pw`\n+\n+4. To clean up, exit the ssh session with `exit` and run\n+\n+        docker stop oqs-openssh-server\n+\n+   to stop (and remove) the container.\n+\n+*Note:* Due to the `--rm` option the container will be removed as soon as it is stopped, it may be omitted to keep the container. But because we're just testing its basic functionality right now this is not required.\n+   \n+# Limitations\n+\n+For limitations of the post-quantum algorithms themselves, refer to [this](https://github.com/open-quantum-safe/openssh#limitations-and-security).\n+\n+# Slightly more advanced usage options\n+\n+## Connect from container to container via OQS-SSH\n+\n+To easily connect from one container to another, we can make use of the docker's own networking capabilities.\n+\n+1. Create a docker network with\n+   \n+        docker network create oqs-openssh-net\n+\n+2. Start a new container that is connected to that network with\n+   \n+        docker run --rm -dit --net oqs-openssh-net --name oqs-openssh-server openquantumsafe/openssh\n+\n+3. Then access this server using OQS-SSH through the docker network with\n+        \n+        docker run --rm -it --net oqs-openssh-net openquantumsafe/openssh ssh oqs@oqs-openssh-server\n+\n+   type `yes` to add the host to the `known_hosts` and authenticate the user `oqs` with its default password `oqs.pw`.\n+\n+Congratulations, you just connected from one docker container to another in a quantum safe manner! To see how to use this in a more practical setting, see how to use docker to quantum safely connect to a remote host in [USAGE.md](USAGE.md#Using-oqs-ssh-for-quantum-safe-remote-access-with-minimal-intrusion).\n+\n+## Access the man pages of oqs-ssh\n+\n+Man pages for oqs-ssh are installed in `<INSTALL_DIR>/share/man` and can be viewed by for example \n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man1/ssh.1\n+```\n+or\n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man5/ssh.5\n+ ```\n+Note that those man pages do **not** differ from the original ssh man pages. So it might be easier to consult them on your local system or the internet.\n+\n+Direct links to man pages: [ssh(1)](https://linux.die.net/man/1/ssh), [sshd(8)](https://linux.die.net/man/8/sshd), [ssh_config(5)](https://linux.die.net/man/5/ssh_config), [sshd_config(5)](https://linux.die.net/man/5/sshd_config)\n+\n+## Key-based client authentication\n+\n+Key-based client authentication works just as it does with normal SSH. Just add your post-quantum public key (normally located in `~/.ssh/*.pub`) to the `authorized_keys` file on the server (normally located in `~/.ssh/authorized_keys`).\n+\n+## Using oqs-ssh for quantum-safe remote access with minimal intrusion\n+\n+One use case of quantum-safe ssh running in docker could be accessing a remote system without messing with its ssh(d) installation or other parts of the system you maybe don't want to interact with. This means minimal intrusion and everything can easily be removed again. This is done by running this docker image on said system and sharing its network space. Thus it is possible to access host ports from **within** the docker container. Normally, the use case of docker is one of isolation with some shared directories and published ports at max. So this solution works around the usual docker limitations.\n+\n+Additionally, it is advised to **change the default username and password** when building the image because your plan is to expose it to the world.\n+\n+```\n+Structure of quantum-safe remote access using docker containers\n+\n++------------------+                +----------------------+\n+|      Client      |                |         Host         |\n+|  +------------+  |                |  +----------------+  |\n+|  |            |  |                |  |                |  |\n+|  |   Docker   +--------------------->+     Docker     |  |\n+|  |            |  |       Port 2222|  |                |  |\n+|  +------------+  |                |  +-------+--------+  |\n+|                  |                |          |           |\n++------------------+                |  Port 22 v           |\n+                                    |  +-------+--------+  |\n+                                    |  |                |  |\n+                                    |  |  sshd on Host  |  |\n+                                    |  |                |  |\n+                                    |  +----------------+  |\n+                                    |                      |\n+                                    +----------------------+\n+```\n+### Set up the server (docker container on target host)\n+\n+To start the ssh server, meaning the docker container on the host system, follow those instructions:\n+- Run the docker image with\n+\n+       docker run -dit --network host --name oqs-ssh openquantumsafe/openssh\n+\n+- Or, if you want the container to automatically start with docker\n+\n+       docker run -dit --network host --name oqs-ssh --restart unless-stopped openquantumsafe/openssh\n+\n+The `--network host` option will attach the container directly to your host's network, sharing its IP. The sshd in the container is now accessible from the outside using the host's IP address and the specified port (2222 per default).\n+\n+Be aware that the port 2222 also needs to be open in any firewalls there may be!\n+\n+If you want to seriously use this image to connect to a machine, it is **strongly advised** to change the default password of the `oqs` user. This can be done in the **running** container with\n+```\n+docker exec -it oqs-ssh passwd oqs\n+```\n+Or you build the image yourself with a different default password from the sources on [Github](https://github.com/openquantumsafe/oqs-demos).\n+\n+#### Enable classical SSH\n+\n+Because we wan't to be able to connect to our host that does not run OQS-SSH, we first need to enable classical SSH capabilities for the client **on the host system**.\n+\n+1. After running the image, run a shell with `docker exec -it oqs-ssh /bin/bash`\n+\n+2. Run `nano /etc/oqs-ssh/ssh_config` and \n+   - uncomment the line `# IdentityFile ~/.ssh/id_ed25519`,\n+   - add `ssh-ed25519` to `HostkeyAlgorithms` and `PubkeyAcceptedKeyTypes` (comma-separated)\n+   - add `curve25519-sha256@libssh.org` to `KexAlgorithms` (comma-separated)\n+\n+3. Save and exit your editor\n+4. Run `rc-service oqs-ssh restart`\n+5. Run `/opt/oqs-ssh/scripts/key-gen.sh`\n+6. Run `ssh <username>@localhost -p 22` with `<username>` being your host's username to test your setup\n+7. If everything went smoothly, your docker container connected with your host's classical `sshd`\n+\n+### Set up the client\n+\n+For the client side, run the image with\n+```bash\n+docker run -it openquantumsafe/openssh ssh <username>@<remote-host-ip> -p 2222\n+```\n+You then are prompted to enter the password for the remote server. Defaults are `oqs` for `<username>` and `oqs.pw` as password. It is strongly adviced to change this password as described above.\n+\n+You may omit `-p 2222` if this port is configured accordingly in `ssh_config` on the client (which is the default).\n+\n+And most importantly, we can now access the host's `sshd` from within the docker image by addressing port 22 via the localhost, using the host's credentials.\n+```bash\n+ssh <username>@localhost -p 22\n+```\n+To omit the `-p 22` option, the specification of the port, this can be set as default in `ssh_config`.\n+\n+# Seriously more advanced usage options\n+\n+## Configuring `ssh` and `sshd`\n+\n+If you are using the pre-compiled image from [Dockerhub](https://hub.docker.com/r/openquantumsafe/openssh) you can only make changes to the configuration at run time. Those changes will only be specific to the current container and won't persist through multiple containers and will be lost upon removing the container. The configuration files [ssh_config](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/ssh_config) and [sshd_config](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/sshd_config) are located in `/opt/oqs-ssh/ssh_config` and `/opt/oqs-ssh/sshd_config` respectively. \n+\n+If you built the docker image yourself following [these instructions](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), you can make changes to `ssh_config` and `sshd_config` before building the image (they will be copied to the image at build time). Firstly, this will make your changes the default for your containers and secondly you won't lose them in case you remove the container.\n+\n+The configuration files can be edited with pre-installed `nano` or `vi` editors, e.g.:\n+```\n+docker exec -it <name-or-hash-of-container> nano /opt/oqs-ssh/ssh_config\n+```\n+After changing anything in and only in `sshd_config`, run\n+```\n+docker exec -it <name-or-hash-of-container> rc-service oqs-sshd restart\n+```\n+After adding new `IdentityKey` or `HostKey` values, generate those new keys with\n+```\n+docker exec -it <name-or-hash-of-container> /opt/oqs-ssh/scripts/key-gen.sh\n+```\n+\n+## Choosing the SIG and KEX algorithms\n+\n+For a list of all signature and key exchange algorithms see [here](https://github.com/open-quantum-safe/openssh#supported-algorithms). Be aware that there is a limitation of what algorithms are enabled in PQS-OpenSSH per default, more information in the section **Enabling additional PQC algorithms** below. It is recommended to only use the hybrid variants to maintain established classical security. The post-quantum safe algorithms have not yet received enough confidence to be relied on as the only security mechanism.\n+\n+The image's default key exchange algorithm is `ecdh-nistp384-kyber-1024-sha384@openquantumsafe.org`. For host and identity key (authentication) algorithms `ssh-p256-dilithium2` is used. Those algorithms may be changed by adjusting the files `ssh_config` and `sshd_config` respectively.\n+\n+**In `ssh_config` (client side)**\n+- `KexAlgorithms`: Comma-separated list of enabled key-exchange algorithms. Priority given by order. Names according to [this KEX naming scheme](https://github.com/open-quantum-safe/openssh#key-exchange).\n+- `IdentityKey`: Path to identity key files. One entry for one file, can have multiple entries. SSH will look for those files when connecting to a host. Names of the key files need to be `~/.ssh/id_<SIG>` in order for them to be successfully generated. `<SIG>` is a post-quantum signature algorithm according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature), with every `-` replace by `_`. A list with of some possible `IdentityKey` values can be found [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/ssh_config).\n+- `PubkeyAcceptedKeyTypes`: Comma-separated list of identity keys the client offers to the host. Priority given by order. Note that if no corresponding `IdentityFile` is specified, this algorithm is ignored.\n+- `HostKeyAlgorithms`: Comma-separated list of the host key types the client accepts from the server. Names according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature).\n+\n+**In `sshd_config` (server side)**\n+- `KexAlgorithms`: Comma-separated list of enabled key-exchange algorithms. Priority given by order. Names according to [this KEX naming scheme](https://github.com/open-quantum-safe/openssh#key-exchange).\n+- `HostKey`: Path to host key files. One entry for one file, can have multiple entries. SSHD will look for those files when offering a host key to a client. Names of the key files need to be `/opt/oqs-ssh/ssh_host_<SIG>_key` in order for them to be successfully generated. `<SIG>` is a post-quantum signature algorithm according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature), with every `-` replace by `_`. A list with of some possible `HostKey` values can be found [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/sshd_config).\n+- `HostKeyAlgorithms`: Comma-separated list of the host offers to the client. Priority given by order. Note that if no corresponding `HostKey` is specified, this algorithm is ignored. Names according to [this SIG naming scheme](https://github.com/open-quantum-safe/openssh#digital-signature)\n+- `PubkeyAcceptedKeyTypes`: Comma-separated list of public keys the host will accept from the client.\n+\n+Be aware that configurations for `sshd` and `ssh` may be entirely different as long as you don't want to connect to `localhost`. For example can `ssh`  be configured like a classical `ssh` client and `sshd` may support post-quantum algorithms only with no backwards compatibility at all.\n+\n+*Note(s):*\n+- After changing any of the settings above, don't forget to `rc-service oqs-sshd restart` to apply the changes.\n+- After adding either a new host or identity key, run `/opt/oqs-ssh/key-gen.sh` to generate the key files as specified. Already existing files won't be altered during this process.\n+- New keys won't have any effect if they are not configured to be used in `HostKeyAlgorithms` or `PubkeyAcceptedKeyTypes` or if other keys have higher priority (first listed in `HostKeyAlgorithms`/`PubkeyAcceptedKeyTypes` has highest priority).\n+\n+## Automatic key generation\n+\n+The generation of the host and identity keys happens via the script [key-gen.sh](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh/key-gen.sh) that is executed automatically every time the container started or run. The script checks if the required key already exist and gerenates it if necessary. This script is called every time the container is started, meaning the first time the container is run (`docker run ...`) and it is startet again (`docker start ...`) after a reboot or a `docker stop ...` command. It checks for existing keys before it generates new ones so it will **never** overwrite an already existing key. It also makes sure `sshd` is startet after at boot time or is restartet after new host keys were generated.\n+\n+Which keys to generate is determined using the configuration files (`ssh_config` and `sshd_config`). A key's necessity is determinded based on the following parameters:","path":"openssh/USAGE.md","position":203,"original_position":203,"commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","original_commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars1.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"body":"Nit: \"determinded\" -> \"determined\" or maybe even \"The need for a specific key is determined based...\"","created_at":"2021-01-21T06:07:35Z","updated_at":"2021-01-21T06:38:54Z","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561623711","pull_request_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","author_association":"MEMBER","_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561623711"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561623711"},"pull_request":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"}},"start_line":null,"original_start_line":null,"start_side":null,"line":203,"original_line":203,"side":"RIGHT"},"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","id":540179821,"node_id":"MDExOlB1bGxSZXF1ZXN0NTQwMTc5ODIx","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65","diff_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.diff","patch_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.patch","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65","number":65,"state":"open","locked":false,"title":"Added OQS-OpenSSH demo","user":{"login":"xykro","id":9986471,"node_id":"MDQ6VXNlcjk5ODY0NzE=","avatar_url":"https://avatars0.githubusercontent.com/u/9986471?v=4","gravatar_id":"","url":"https://api.github.com/users/xykro","html_url":"https://github.com/xykro","followers_url":"https://api.github.com/users/xykro/followers","following_url":"https://api.github.com/users/xykro/following{/other_user}","gists_url":"https://api.github.com/users/xykro/gists{/gist_id}","starred_url":"https://api.github.com/users/xykro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xykro/subscriptions","organizations_url":"https://api.github.com/users/xykro/orgs","repos_url":"https://api.github.com/users/xykro/repos","events_url":"https://api.github.com/users/xykro/events{/privacy}","received_events_url":"https://api.github.com/users/xykro/received_events","type":"User","site_admin":false},"body":"Hi @baentsch and @dstebila\r\n\r\nReferring to issue #54. \r\n\r\nAs we talked about, we have (the [ISE institute](https://www.fhnw.ch/en/about-fhnw/schools/school-of-engineering/institutes/institute-for-sensors-and-electronics) from [FHNW](https://www.fhnw.ch/en)) have created a docker demo image that uses your OQS-OpenSSH implementation.\r\n\r\nThe [README.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/README.md) contains setup and general information while the [USAGE.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/USAGE.md) describes some more advanced use cases, like using this demo to connect to a remote OQS-OpenSSH instance.\r\n\r\nI've added a new job for [CircleCI](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/.circleci/config.yml) for this demo image. The test it does is connecting to itself (localhost) using chosen PQC algorithms via OQS-SSH. Defaults are p256-dilithium2 and ecdh-nistp384-kyber-1024, chosen more or less randomly. Those algorithms may be changed by passing the SIG and/or KEM variables to the docker run command.\r\nReturn code is 0 if the connection to localhost using the ubkey method was successful, 1 otherwise.\r\n\r\nI have **not** added OQS-OpenSSH to the \"Push all images\" step, I reckoned as you will be hosting the image I'll let you set that up properly.\r\n\r\nGit history is squashed down to 1 commit, I do not want to bring my mess over :-)\r\n\r\nLet me know if any adjustments are required.","created_at":"2020-12-15T11:27:41Z","updated_at":"2021-01-21T06:38:54Z","closed_at":null,"merged_at":null,"merge_commit_sha":"cd0b5c1b0ec4ba7908103eb23e10c7da38c4fbfb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits","review_comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments","review_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34","head":{"label":"fhnw-ise-qcrypt:pull-request","ref":"pull-request","sha":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"repo":{"id":299259879,"node_id":"MDEwOlJlcG9zaXRvcnkyOTkyNTk4Nzk=","name":"oqs-demos","full_name":"fhnw-ise-qcrypt/oqs-demos","private":false,"owner":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":true,"url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos","forks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/forks","keys_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/teams","hooks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/events","assignees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/tags","blobs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscription","commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/merges","archive_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/downloads","issues_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/deployments","created_at":"2020-09-28T09:35:41Z","updated_at":"2020-12-15T11:37:14Z","pushed_at":"2021-01-20T16:30:56Z","git_url":"git://github.com/fhnw-ise-qcrypt/oqs-demos.git","ssh_url":"git@github.com:fhnw-ise-qcrypt/oqs-demos.git","clone_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos.git","svn_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","homepage":"https://openquantumsafe.org/","size":205,"stargazers_count":0,"watchers_count":0,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":null,"forks":0,"open_issues":2,"watchers":0,"default_branch":"main"}},"base":{"label":"open-quantum-safe:main","ref":"main","sha":"cb71ca0e3abce4a27c9030c1fa044816241921ef","user":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"repo":{"id":218087071,"node_id":"MDEwOlJlcG9zaXRvcnkyMTgwODcwNzE=","name":"oqs-demos","full_name":"open-quantum-safe/oqs-demos","private":false,"owner":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/open-quantum-safe/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":false,"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos","forks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/forks","keys_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/teams","hooks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/events","assignees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/tags","blobs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscription","commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/merges","archive_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/downloads","issues_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/deployments","created_at":"2019-10-28T15:57:00Z","updated_at":"2021-01-17T20:05:26Z","pushed_at":"2021-01-20T16:30:58Z","git_url":"git://github.com/open-quantum-safe/oqs-demos.git","ssh_url":"git@github.com:open-quantum-safe/oqs-demos.git","clone_url":"https://github.com/open-quantum-safe/oqs-demos.git","svn_url":"https://github.com/open-quantum-safe/oqs-demos","homepage":"https://openquantumsafe.org/","size":129,"stargazers_count":17,"watchers_count":17,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":11,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":6,"license":null,"forks":11,"open_issues":6,"watchers":17,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65"},"issue":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65"},"comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments"},"review_comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments"},"review_comment":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits"},"statuses":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34"}},"author_association":"NONE","active_lock_reason":null}},"public":true,"created_at":"2021-01-21T06:07:35Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"14893975950","type":"PullRequestReviewCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":218087071,"name":"open-quantum-safe/oqs-demos","url":"https://api.github.com/repos/open-quantum-safe/oqs-demos"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561630018","pull_request_review_id":573003806,"id":561630018,"node_id":"MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTYzMDAxOA==","diff_hunk":"@@ -0,0 +1,270 @@\n+# Purpose \n+\n+This is an [opensshd](https://https.openssh.com) docker image based on the [OQS OpenSSH 7.9 fork](https://github.com/open-quantum-safe/openssh), which allows ssh to quantum-safely negotiate session keys and use quantum-safe authentication with algorithms from the [Post-Quantum Cryptography Project by NIST](https://csrc.nist.gov/projects/post-quantum-cryptography).\n+\n+This image has a built-in non-root user to permit execution without particular [docker privileges](https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities). This is necessary as logging in as root in ssh is not recommended practice. But it is worth to note that this user, per default called `oqs`, is not set as the default user when the image starts. The reason for that is that the the start up script needs root permissions to generate all host keys and start the sshd service. This means that when executing a command as the user `oqs`, the `docker exec` command needs to be used together with the option `--user oqs`.\n+\n+If you built the docker image yourself following the instructions [here](https://github.com/open-quantum-safe/oqs-demos/tree/main/openssh), exchange the name of the image from 'openquantumsafe/openssh' in the examples below suitably.\n+\n+# Quick start \n+\n+1. Start an OpenSSH server with post-quantum cryptography support by running\n+\n+        docker run --name oqs-openssh-server -dit --rm openquantumsafe/openssh\n+\n+2. Connect to that server running\n+\n+        docker exec --user oqs -it oqs-openssh-server ssh oqs@localhost\n+\n+3. Accept the host key and authenticate with the default password `oqs.pw`\n+\n+4. To clean up, exit the ssh session with `exit` and run\n+\n+        docker stop oqs-openssh-server\n+\n+   to stop (and remove) the container.\n+\n+*Note:* Due to the `--rm` option the container will be removed as soon as it is stopped, it may be omitted to keep the container. But because we're just testing its basic functionality right now this is not required.\n+   \n+# Limitations\n+\n+For limitations of the post-quantum algorithms themselves, refer to [this](https://github.com/open-quantum-safe/openssh#limitations-and-security).\n+\n+# Slightly more advanced usage options\n+\n+## Connect from container to container via OQS-SSH\n+\n+To easily connect from one container to another, we can make use of the docker's own networking capabilities.\n+\n+1. Create a docker network with\n+   \n+        docker network create oqs-openssh-net\n+\n+2. Start a new container that is connected to that network with\n+   \n+        docker run --rm -dit --net oqs-openssh-net --name oqs-openssh-server openquantumsafe/openssh\n+\n+3. Then access this server using OQS-SSH through the docker network with\n+        \n+        docker run --rm -it --net oqs-openssh-net openquantumsafe/openssh ssh oqs@oqs-openssh-server\n+\n+   type `yes` to add the host to the `known_hosts` and authenticate the user `oqs` with its default password `oqs.pw`.\n+\n+Congratulations, you just connected from one docker container to another in a quantum safe manner! To see how to use this in a more practical setting, see how to use docker to quantum safely connect to a remote host in [USAGE.md](USAGE.md#Using-oqs-ssh-for-quantum-safe-remote-access-with-minimal-intrusion).\n+\n+## Access the man pages of oqs-ssh\n+\n+Man pages for oqs-ssh are installed in `<INSTALL_DIR>/share/man` and can be viewed by for example \n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man1/ssh.1\n+```\n+or\n+```\n+docker run -it --rm openquantumsafe/openssh man -l /opt/oqs-ssh/share/man/man5/ssh.5\n+ ```\n+Note that those man pages do **not** differ from the original ssh man pages. So it might be easier to consult them on your local system or the internet.\n+\n+Direct links to man pages: [ssh(1)](https://linux.die.net/man/1/ssh), [sshd(8)](https://linux.die.net/man/8/sshd), [ssh_config(5)](https://linux.die.net/man/5/ssh_config), [sshd_config(5)](https://linux.die.net/man/5/sshd_config)\n+\n+## Key-based client authentication\n+\n+Key-based client authentication works just as it does with normal SSH. Just add your post-quantum public key (normally located in `~/.ssh/*.pub`) to the `authorized_keys` file on the server (normally located in `~/.ssh/authorized_keys`).\n+\n+## Using oqs-ssh for quantum-safe remote access with minimal intrusion\n+\n+One use case of quantum-safe ssh running in docker could be accessing a remote system without messing with its ssh(d) installation or other parts of the system you maybe don't want to interact with. This means minimal intrusion and everything can easily be removed again. This is done by running this docker image on said system and sharing its network space. Thus it is possible to access host ports from **within** the docker container. Normally, the use case of docker is one of isolation with some shared directories and published ports at max. So this solution works around the usual docker limitations.\n+\n+Additionally, it is advised to **change the default username and password** when building the image because your plan is to expose it to the world.\n+\n+```\n+Structure of quantum-safe remote access using docker containers\n+\n++------------------+                +----------------------+\n+|      Client      |                |         Host         |\n+|  +------------+  |                |  +----------------+  |\n+|  |            |  |                |  |                |  |\n+|  |   Docker   +--------------------->+     Docker     |  |\n+|  |            |  |       Port 2222|  |                |  |\n+|  +------------+  |                |  +-------+--------+  |\n+|                  |                |          |           |\n++------------------+                |  Port 22 v           |\n+                                    |  +-------+--------+  |\n+                                    |  |                |  |\n+                                    |  |  sshd on Host  |  |\n+                                    |  |                |  |\n+                                    |  +----------------+  |\n+                                    |                      |\n+                                    +----------------------+\n+```\n+### Set up the server (docker container on target host)\n+\n+To start the ssh server, meaning the docker container on the host system, follow those instructions:\n+- Run the docker image with\n+\n+       docker run -dit --network host --name oqs-ssh openquantumsafe/openssh\n+\n+- Or, if you want the container to automatically start with docker\n+\n+       docker run -dit --network host --name oqs-ssh --restart unless-stopped openquantumsafe/openssh\n+\n+The `--network host` option will attach the container directly to your host's network, sharing its IP. The sshd in the container is now accessible from the outside using the host's IP address and the specified port (2222 per default).\n+\n+Be aware that the port 2222 also needs to be open in any firewalls there may be!\n+\n+If you want to seriously use this image to connect to a machine, it is **strongly advised** to change the default password of the `oqs` user. This can be done in the **running** container with\n+```\n+docker exec -it oqs-ssh passwd oqs\n+```\n+Or you build the image yourself with a different default password from the sources on [Github](https://github.com/openquantumsafe/oqs-demos).\n+\n+#### Enable classical SSH\n+\n+Because we wan't to be able to connect to our host that does not run OQS-SSH, we first need to enable classical SSH capabilities for the client **on the host system**.\n+\n+1. After running the image, run a shell with `docker exec -it oqs-ssh /bin/bash`\n+\n+2. Run `nano /etc/oqs-ssh/ssh_config` and \n+   - uncomment the line `# IdentityFile ~/.ssh/id_ed25519`,\n+   - add `ssh-ed25519` to `HostkeyAlgorithms` and `PubkeyAcceptedKeyTypes` (comma-separated)\n+   - add `curve25519-sha256@libssh.org` to `KexAlgorithms` (comma-separated)\n+\n+3. Save and exit your editor\n+4. Run `rc-service oqs-ssh restart`","path":"openssh/USAGE.md","position":132,"original_position":132,"commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","original_commit_id":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars1.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"body":"Fails as follows: \r\n> rc-service: service `oqs-ssh' does not exist","created_at":"2021-01-21T06:27:21Z","updated_at":"2021-01-21T06:38:54Z","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561630018","pull_request_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","author_association":"MEMBER","_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments/561630018"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65#discussion_r561630018"},"pull_request":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"}},"start_line":null,"original_start_line":null,"start_side":null,"line":132,"original_line":132,"side":"RIGHT"},"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65","id":540179821,"node_id":"MDExOlB1bGxSZXF1ZXN0NTQwMTc5ODIx","html_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65","diff_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.diff","patch_url":"https://github.com/open-quantum-safe/oqs-demos/pull/65.patch","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65","number":65,"state":"open","locked":false,"title":"Added OQS-OpenSSH demo","user":{"login":"xykro","id":9986471,"node_id":"MDQ6VXNlcjk5ODY0NzE=","avatar_url":"https://avatars0.githubusercontent.com/u/9986471?v=4","gravatar_id":"","url":"https://api.github.com/users/xykro","html_url":"https://github.com/xykro","followers_url":"https://api.github.com/users/xykro/followers","following_url":"https://api.github.com/users/xykro/following{/other_user}","gists_url":"https://api.github.com/users/xykro/gists{/gist_id}","starred_url":"https://api.github.com/users/xykro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xykro/subscriptions","organizations_url":"https://api.github.com/users/xykro/orgs","repos_url":"https://api.github.com/users/xykro/repos","events_url":"https://api.github.com/users/xykro/events{/privacy}","received_events_url":"https://api.github.com/users/xykro/received_events","type":"User","site_admin":false},"body":"Hi @baentsch and @dstebila\r\n\r\nReferring to issue #54. \r\n\r\nAs we talked about, we have (the [ISE institute](https://www.fhnw.ch/en/about-fhnw/schools/school-of-engineering/institutes/institute-for-sensors-and-electronics) from [FHNW](https://www.fhnw.ch/en)) have created a docker demo image that uses your OQS-OpenSSH implementation.\r\n\r\nThe [README.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/README.md) contains setup and general information while the [USAGE.md](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/openssh/USAGE.md) describes some more advanced use cases, like using this demo to connect to a remote OQS-OpenSSH instance.\r\n\r\nI've added a new job for [CircleCI](https://github.com/fhnw-ise-qcrypt/oqs-demos/blob/pull-request/.circleci/config.yml) for this demo image. The test it does is connecting to itself (localhost) using chosen PQC algorithms via OQS-SSH. Defaults are p256-dilithium2 and ecdh-nistp384-kyber-1024, chosen more or less randomly. Those algorithms may be changed by passing the SIG and/or KEM variables to the docker run command.\r\nReturn code is 0 if the connection to localhost using the ubkey method was successful, 1 otherwise.\r\n\r\nI have **not** added OQS-OpenSSH to the \"Push all images\" step, I reckoned as you will be hosting the image I'll let you set that up properly.\r\n\r\nGit history is squashed down to 1 commit, I do not want to bring my mess over :-)\r\n\r\nLet me know if any adjustments are required.","created_at":"2020-12-15T11:27:41Z","updated_at":"2021-01-21T06:38:54Z","closed_at":null,"merged_at":null,"merge_commit_sha":"cd0b5c1b0ec4ba7908103eb23e10c7da38c4fbfb","assignee":null,"assignees":[],"requested_reviewers":[],"requested_teams":[],"labels":[],"milestone":null,"draft":false,"commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits","review_comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments","review_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34","head":{"label":"fhnw-ise-qcrypt:pull-request","ref":"pull-request","sha":"605f6c9c74a37c0c1c062f2224b26109b6483d34","user":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"repo":{"id":299259879,"node_id":"MDEwOlJlcG9zaXRvcnkyOTkyNTk4Nzk=","name":"oqs-demos","full_name":"fhnw-ise-qcrypt/oqs-demos","private":false,"owner":{"login":"fhnw-ise-qcrypt","id":72196109,"node_id":"MDEyOk9yZ2FuaXphdGlvbjcyMTk2MTA5","avatar_url":"https://avatars1.githubusercontent.com/u/72196109?v=4","gravatar_id":"","url":"https://api.github.com/users/fhnw-ise-qcrypt","html_url":"https://github.com/fhnw-ise-qcrypt","followers_url":"https://api.github.com/users/fhnw-ise-qcrypt/followers","following_url":"https://api.github.com/users/fhnw-ise-qcrypt/following{/other_user}","gists_url":"https://api.github.com/users/fhnw-ise-qcrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/fhnw-ise-qcrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fhnw-ise-qcrypt/subscriptions","organizations_url":"https://api.github.com/users/fhnw-ise-qcrypt/orgs","repos_url":"https://api.github.com/users/fhnw-ise-qcrypt/repos","events_url":"https://api.github.com/users/fhnw-ise-qcrypt/events{/privacy}","received_events_url":"https://api.github.com/users/fhnw-ise-qcrypt/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":true,"url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos","forks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/forks","keys_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/teams","hooks_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/events","assignees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/tags","blobs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/subscription","commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/merges","archive_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/downloads","issues_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/fhnw-ise-qcrypt/oqs-demos/deployments","created_at":"2020-09-28T09:35:41Z","updated_at":"2020-12-15T11:37:14Z","pushed_at":"2021-01-20T16:30:56Z","git_url":"git://github.com/fhnw-ise-qcrypt/oqs-demos.git","ssh_url":"git@github.com:fhnw-ise-qcrypt/oqs-demos.git","clone_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos.git","svn_url":"https://github.com/fhnw-ise-qcrypt/oqs-demos","homepage":"https://openquantumsafe.org/","size":205,"stargazers_count":0,"watchers_count":0,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2,"license":null,"forks":0,"open_issues":2,"watchers":0,"default_branch":"main"}},"base":{"label":"open-quantum-safe:main","ref":"main","sha":"cb71ca0e3abce4a27c9030c1fa044816241921ef","user":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"repo":{"id":218087071,"node_id":"MDEwOlJlcG9zaXRvcnkyMTgwODcwNzE=","name":"oqs-demos","full_name":"open-quantum-safe/oqs-demos","private":false,"owner":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/open-quantum-safe/oqs-demos","description":"Instructions for enabling the use of quantum-safe cryptography in assorted software using the OQS suite","fork":false,"url":"https://api.github.com/repos/open-quantum-safe/oqs-demos","forks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/forks","keys_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/keys{/key_id}","collaborators_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/teams","hooks_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/hooks","issue_events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/events{/number}","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/events","assignees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/assignees{/user}","branches_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/branches{/branch}","tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/tags","blobs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/refs{/sha}","trees_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/trees{/sha}","statuses_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/{sha}","languages_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/languages","stargazers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/stargazers","contributors_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contributors","subscribers_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscribers","subscription_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/subscription","commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/commits{/sha}","git_commits_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/git/commits{/sha}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/comments{/number}","issue_comment_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/comments{/number}","contents_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/contents/{+path}","compare_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/compare/{base}...{head}","merges_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/merges","archive_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/downloads","issues_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues{/number}","pulls_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls{/number}","milestones_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/milestones{/number}","notifications_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/labels{/name}","releases_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/releases{/id}","deployments_url":"https://api.github.com/repos/open-quantum-safe/oqs-demos/deployments","created_at":"2019-10-28T15:57:00Z","updated_at":"2021-01-17T20:05:26Z","pushed_at":"2021-01-20T16:30:58Z","git_url":"git://github.com/open-quantum-safe/oqs-demos.git","ssh_url":"git@github.com:open-quantum-safe/oqs-demos.git","clone_url":"https://github.com/open-quantum-safe/oqs-demos.git","svn_url":"https://github.com/open-quantum-safe/oqs-demos","homepage":"https://openquantumsafe.org/","size":129,"stargazers_count":17,"watchers_count":17,"language":"Dockerfile","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"forks_count":11,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":6,"license":null,"forks":11,"open_issues":6,"watchers":17,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65"},"html":{"href":"https://github.com/open-quantum-safe/oqs-demos/pull/65"},"issue":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65"},"comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/issues/65/comments"},"review_comments":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/comments"},"review_comment":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/pulls/65/commits"},"statuses":{"href":"https://api.github.com/repos/open-quantum-safe/oqs-demos/statuses/605f6c9c74a37c0c1c062f2224b26109b6483d34"}},"author_association":"NONE","active_lock_reason":null}},"public":true,"created_at":"2021-01-21T06:27:21Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
