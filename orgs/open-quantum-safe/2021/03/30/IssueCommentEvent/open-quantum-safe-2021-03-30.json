{"id":"15738895143","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/301","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/301/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/301/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/301/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/301","id":843997088,"node_id":"MDU6SXNzdWU4NDM5OTcwODg=","number":301,"title":"How to change the supported algorithm and use self-defined algorithm","user":{"login":"Hannah336","id":76058344,"node_id":"MDQ6VXNlcjc2MDU4MzQ0","avatar_url":"https://avatars.githubusercontent.com/u/76058344?v=4","gravatar_id":"","url":"https://api.github.com/users/Hannah336","html_url":"https://github.com/Hannah336","followers_url":"https://api.github.com/users/Hannah336/followers","following_url":"https://api.github.com/users/Hannah336/following{/other_user}","gists_url":"https://api.github.com/users/Hannah336/gists{/gist_id}","starred_url":"https://api.github.com/users/Hannah336/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hannah336/subscriptions","organizations_url":"https://api.github.com/users/Hannah336/orgs","repos_url":"https://api.github.com/users/Hannah336/repos","events_url":"https://api.github.com/users/Hannah336/events{/privacy}","received_events_url":"https://api.github.com/users/Hannah336/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-03-30T02:21:50Z","updated_at":"2021-03-30T06:08:00Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"I saw in some blogs that you can change algorithm with engine and mark the changed algorithm in RSA_mothod, DSA_method etc. If I want to change signature algorithm in this case, what should I do? What's the relation between RSA and dilithium for example?","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/809938796","html_url":"https://github.com/open-quantum-safe/openssl/issues/301#issuecomment-809938796","issue_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/301","id":809938796,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTkzODc5Ng==","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T06:08:00Z","updated_at":"2021-03-30T06:08:00Z","author_association":"MEMBER","body":"Thanks for your interest in OQS-OpenSSL. Did you read [the TLS demo section in the README](https://github.com/open-quantum-safe/openssl#tls-demo)? I'm a bit uncertain, though, what you mean by \"relation\" between RSA and dilithium? Both can operate as signature algorithms, but obviously have pretty different cryptographic properties. Would it be helpful to point to the blog you read? If you want to use an OpenSSL engine, please check out [this subproject](https://github.com/open-quantum-safe/oqs-engine) but be aware that both the engine concept as well as that code base is not exactly actively supported any more (see [OpenSSL Strategic Architecture on engines vs providers](https://www.openssl.org/docs/OpenSSLStrategicArchitecture.html)).","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T06:08:00Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15738939606","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/295","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/295/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/295/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/295/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/295","id":837206565,"node_id":"MDU6SXNzdWU4MzcyMDY1NjU=","number":295,"title":"Issue when signing with new algorithms","user":{"login":"opencrypto","id":7943812,"node_id":"MDQ6VXNlcjc5NDM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/7943812?v=4","gravatar_id":"","url":"https://api.github.com/users/opencrypto","html_url":"https://github.com/opencrypto","followers_url":"https://api.github.com/users/opencrypto/followers","following_url":"https://api.github.com/users/opencrypto/following{/other_user}","gists_url":"https://api.github.com/users/opencrypto/gists{/gist_id}","starred_url":"https://api.github.com/users/opencrypto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opencrypto/subscriptions","organizations_url":"https://api.github.com/users/opencrypto/orgs","repos_url":"https://api.github.com/users/opencrypto/repos","events_url":"https://api.github.com/users/opencrypto/events{/privacy}","received_events_url":"https://api.github.com/users/opencrypto/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":17,"created_at":"2021-03-21T23:08:27Z","updated_at":"2021-03-30T06:12:40Z","closed_at":"2021-03-29T14:57:47Z","author_association":"NONE","active_lock_reason":null,"body":"Hello Everybody. I am trying to use the new algorithms in our wrapper library (LibPKI) that builds on top of OpenSSL. One thing I am having difficulties is to understand how to properly use the signing functions. \r\n\r\nSpecifically, I am trying to implement a generic signing function for DER encoded data (PKI_X509_sign(der (data), md (digest algor), evp_pkey) -> signature), and although the same functions work with RSA or ECDSA, they fail when I try with falcon, dilithium, or sphincs+.\r\n\r\nHere's the first code I tried:\r\n\r\n```\r\n// Creates the context\r\nif ((ctx = EVP_MD_CTX_create()) == NULL) {\r\n\tPKI_ERROR(PKI_ERR_MEMORY_ALLOC, NULL);\r\n\tif (out_mem) PKI_MEM_free(out_mem);\r\n\treturn NULL;\r\n}\r\n\r\n// Initializes the Context\r\nEVP_MD_CTX_init(ctx);\r\n\r\n// Initializes the Signature\r\nEVP_SignInit_ex(ctx, md, NULL);\r\nEVP_SignUpdate (ctx, der->data, der->size);\r\n\r\n// Finalizes the signature\r\nif (!EVP_SignFinal(ctx, out_mem->data, (unsigned int *) &ossl_ret, pkey))\r\n{\r\n\tPKI_ERROR(PKI_ERR_SIGNATURE_CREATE, \"Cannot finalize signature (%s)\", \r\n\t\tHSM_OPENSSL_get_errdesc(HSM_OPENSSL_get_errno(), NULL, 0));\r\n\r\n\tPKI_MEM_free(out_mem);\r\n\tout_mem = NULL;\r\n}\r\nelse out_mem->size = (size_t) ossl_ret;\r\n```\r\nI also tried the DigestSign version:\r\n```\r\n// Creates the context\r\nif ((ctx = EVP_MD_CTX_create()) == NULL) {\r\n\tPKI_ERROR(PKI_ERR_MEMORY_ALLOC, NULL);\r\n\tif (out_mem) PKI_MEM_free(out_mem);\r\n\treturn NULL;\r\n}\r\n\r\n// Initializes the Context\r\nEVP_MD_CTX_init(ctx);\r\n\r\nif (!EVP_DigestSignInit(ctx, &pCtx, md, NULL, pkey)) {\r\n    PKI_ERROR(PKI_ERR_SIGNATURE_CREATE, \"Cannot Initialize EVP_DigestSignInit()\");\r\n    goto err;\r\n}\r\n\r\nif (EVP_DigestSignUpdate(ctx, \r\n                                            der->data,\r\n   \t                                    der->size) <= 0) {\r\n   PKI_ERROR(PKI_ERR_SIGNATURE_CREATE, \"Cannot Update EVP_DigestSignUpdate()\");\r\n   goto err;\r\n}\r\n\r\nif (EVP_DigestSignFinal(ctx,\r\n                                        out_mem->data,\r\n                                        &ossl_ret) <= 0) {\r\n    PKI_ERROR(PKI_ERR_SIGNATURE_CREATE, \"Cannot Finalize EVP_DigestSignFinal()\");\r\n    goto err;\r\n}\r\nelse out_mem->size = (size_t) ossl_ret;\r\n```\r\nThe error seems to be related to the digest used (\"md\"). Specifically, if the md is not NULL, the EVP_SignFinal()/EVP_DigestSignFinal() fail with the following error trace:\r\n\r\n```\r\nMar 21 22:48:28 2021 GMT [91455] ERROR: [openssl_hsm.c:349] Can not create signature (117): Cannot finalize signature (  H??)\r\nMar 21 22:48:28 2021 GMT [91455] ERROR: [openssl_hsm.c:392] [HSM_OPENSSL_sign()] [ERROR] PKEY Type => 1294, falcon512\r\nMar 21 22:48:28 2021 GMT [91455] INFO: [openssl_hsm.c:395] [HSM_OPENSSL_sign()] [DEBUG]: [Signature Generated: 0 bytes (estimated: 690 bytes)]\r\nMar 21 22:48:28 2021 GMT [91455] INFO: [hsm_main.c:614] [PKI_sign()] [DEBUG]: Can not generate signature (returned from sign cb)\r\nMar 21 22:48:28 2021 GMT [91455] ERROR: [hsm_main.c:541] Can not create signature (117):\r\nMar 21 22:48:28 2021 GMT [91455] INFO: [pki_x509_req.c:222] [PKI_X509_REQ_new()] [DEBUG] REQ::ERROR 0 signing the Request [error:1012F0B1:elliptic curve routines:pkey_oqs_ctrl:wrong digest]\r\n```\r\nI know I am doing something wrong here, but I am not sure what... \r\n\r\nTo probe a bit further, I forced the use of a specific hashing algorithm - since the error was related to that, somehow: md = EVP_sha512(). If I do that, I get a success return code but the signature in the data is all zeroes.\r\n\r\n```\r\nMar 21 22:54:41 2021 GMT [97064] INFO: [pki_x509_req.c:61] [PKI_X509_REQ_new()] [DEBUG]: No Digest Associated with used algorithm\r\nMar 21 22:54:41 2021 GMT [97064] ERROR: [openssl_hsm.c:392] [HSM_OPENSSL_sign()] [ERROR] PKEY Type => 1294, falcon512\r\nMar 21 22:54:41 2021 GMT [97064] INFO: [openssl_hsm.c:395] [HSM_OPENSSL_sign()] [DEBUG]: [Signature Generated: 690 bytes (estimated: 690 bytes)]\r\n```\r\n\r\nJust to be very precise, when I use the standard apps/ tools (i.e., openssl req -new ...) I am able to generate things correctly.\r\n\r\nAnybody experiencing similar issues and/or know what I might be doing wrong?\r\n","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/809941210","html_url":"https://github.com/open-quantum-safe/openssl/issues/295#issuecomment-809941210","issue_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/295","id":809941210,"node_id":"MDEyOklzc3VlQ29tbWVudDgwOTk0MTIxMA==","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T06:12:40Z","updated_at":"2021-03-30T06:12:40Z","author_association":"MEMBER","body":"@dstebila Would it be sensible to keep this issue open as indeed signing presently only works using CMS, not via the generic EVP APIs? Time permitting, one (e.g., me :) could look into this -- unless of course the above-mentioned PR arrives quick which promises a more complete/generic integration (and would thus resolve this issue).","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T06:12:40Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15742042469","type":"IssueCommentEvent","actor":{"id":149199,"login":"bhess","display_login":"bhess","gravatar_id":"","url":"https://api.github.com/users/bhess","avatar_url":"https://avatars.githubusercontent.com/u/149199?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/16","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/16/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/16/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/16/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/16","id":832909463,"node_id":"MDExOlB1bGxSZXF1ZXN0NTkzOTk0NjIz","number":16,"title":"Hybrid KEM support","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-03-16T15:14:51Z","updated_at":"2021-03-30T10:07:38Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/pulls/16","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/16","diff_url":"https://github.com/open-quantum-safe/oqs-provider/pull/16.diff","patch_url":"https://github.com/open-quantum-safe/oqs-provider/pull/16.patch"},"body":"Hybrid KEM support for the oqs-provider (#3):\r\n- Combines OQS KEMs with OpenSSL EC-kex\r\n- Uses EVP API for OpenSSL EC-kex\r\n- Wraps hybrid KEM in OpenSSL3 KEM-API\r\n- Extends oqsx.h structures to accomodate KEM and KEX contexts\r\n- Refactoring to use preprocessor for hybrid combinations\r\n- Refactors oqs_test_groups: test iterates over all tls-groups in the oqs-provider\r\n- OQS/ECP and OQS/ECX hybrids\r\n- Updated fragments\r\n- Added generate-extras.yml with `nid_ecx_hybrid` code points. They are added by generate.py to the generate.yml elements fetched from the OSSL111 repo.\r\n- NIST-CAT5/X448 hybrids not enabled (see https://github.com/open-quantum-safe/openssl/issues/296)\r\n- Unrelated: A new run of generate.py also updated the Rainbow OIDs.","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/810094520","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/16#issuecomment-810094520","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/16","id":810094520,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDA5NDUyMA==","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T10:07:38Z","updated_at":"2021-03-30T10:07:38Z","author_association":"NONE","body":"Thanks a lot for the review and for the additional suggestions! I think many of the ideas can be addressed by adopting more of the new provider API. I'd like to dig more into those and revisit them after this PR.\r\nI'm sure why CI doesn't run. Might there be a project setting to activate CI after PRs? (like in the liboqs project)\r\nLocally I'm able to run circleci and the tests pass.","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T10:07:38Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15743470907","type":"IssueCommentEvent","actor":{"id":37668804,"login":"taimoorgit","display_login":"taimoorgit","gravatar_id":"","url":"https://api.github.com/users/taimoorgit","avatar_url":"https://avatars.githubusercontent.com/u/37668804?"},"repo":{"id":247826799,"name":"open-quantum-safe/liboqs-java","url":"https://api.github.com/repos/open-quantum-safe/liboqs-java"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/14","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/14/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/14/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/14/events","html_url":"https://github.com/open-quantum-safe/liboqs-java/issues/14","id":842527991,"node_id":"MDU6SXNzdWU4NDI1Mjc5OTE=","number":14,"title":"JAVA_HOME is set, but jni.h not found","user":{"login":"taimoorgit","id":37668804,"node_id":"MDQ6VXNlcjM3NjY4ODA0","avatar_url":"https://avatars.githubusercontent.com/u/37668804?v=4","gravatar_id":"","url":"https://api.github.com/users/taimoorgit","html_url":"https://github.com/taimoorgit","followers_url":"https://api.github.com/users/taimoorgit/followers","following_url":"https://api.github.com/users/taimoorgit/following{/other_user}","gists_url":"https://api.github.com/users/taimoorgit/gists{/gist_id}","starred_url":"https://api.github.com/users/taimoorgit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/taimoorgit/subscriptions","organizations_url":"https://api.github.com/users/taimoorgit/orgs","repos_url":"https://api.github.com/users/taimoorgit/repos","events_url":"https://api.github.com/users/taimoorgit/events{/privacy}","received_events_url":"https://api.github.com/users/taimoorgit/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-03-27T15:32:15Z","updated_at":"2021-03-30T11:53:42Z","closed_at":"2021-03-30T11:53:42Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\r\n\r\nI am trying to build the Maven package on WSL/Ubuntu. I have liboqs installed with shared libs enabled. I have installed JDK 11 and set my JAVA_HOME environment variable, but it seems like jni.h still isn't found. Is there a step I am missing that can fix this? \r\n\r\n```\r\ntaimoor@GAMING-PC:~/liboqs-java$ lsb_release -a\r\nNo LSB modules are available.\r\nDistributor ID: Ubuntu\r\nDescription:    Ubuntu 20.04.1 LTS\r\nRelease:        20.04\r\nCodename:       focal\r\ntaimoor@GAMING-PC:~/liboqs-java$ java --version\r\nopenjdk 11.0.10 2021-01-19\r\nOpenJDK Runtime Environment (build 11.0.10+9-Ubuntu-0ubuntu1.20.04)\r\nOpenJDK 64-Bit Server VM (build 11.0.10+9-Ubuntu-0ubuntu1.20.04, mixed mode, sharing)\r\ntaimoor@GAMING-PC:~/liboqs-java$ echo $JAVA_HOME && ls $JAVA_HOME\r\n/usr/lib/jvm/java-1.11.0-openjdk-amd64\r\nbin  conf  docs  legal  lib  man  release\r\ntaimoor@GAMING-PC:~/liboqs-java$ mvn package -P linux -Dliboqs.include.dir=\"/usr/local/include\" -Dliboqs.lib.dir=\"/usr/local/lib\"\r\nWARNING: An illegal reflective access operation has occurred\r\nWARNING: Illegal reflective access by com.google.inject.internal.cglib.core.$ReflectUtils$1 (file:/usr/share/maven/lib/guice.jar) to method java.lang.ClassLoader.defineClass(java.lang.String,byte[],int,int,java.security.ProtectionDomain)\r\nWARNING: Please consider reporting this to the maintainers of com.google.inject.internal.cglib.core.$ReflectUtils$1\r\nWARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations\r\nWARNING: All illegal access operations will be denied in a future release\r\n[INFO] Scanning for projects...\r\n[INFO]\r\n[INFO] ------------------< org.openquantumsafe:liboqs-java >-------------------\r\n[INFO] Building liboqs-java: Java wrapper for liboqs 1.0\r\n[INFO] --------------------------------[ jar ]---------------------------------\r\n[INFO]\r\n[INFO] --- maven-antrun-plugin:3.0.0:run (default) @ liboqs-java ---\r\n[INFO] Executing tasks\r\n[INFO] Executed tasks\r\n[INFO]\r\n[INFO] --- maven-resources-plugin:3.1.0:resources (default-resources) @ liboqs-java ---\r\n[INFO] Using 'UTF-8' encoding to copy filtered resources.\r\n[INFO] Copying 0 resource\r\n[INFO]\r\n[INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ liboqs-java ---\r\n[INFO] Nothing to compile - all classes are up to date\r\n[INFO]\r\n[INFO] --- native-maven-plugin:1.0-alpha-9:initialize (generate-shared-oqs-library) @ liboqs-java ---\r\n[INFO]\r\n[INFO] --- native-maven-plugin:1.0-alpha-9:compile (generate-shared-oqs-library) @ liboqs-java ---\r\n[INFO] /bin/sh -c cd '/home/taimoor/liboqs-java' && 'gcc' '-I/usr/lib/jvm/java-1.11.0-openjdk-amd64/include' '-I/usr/lib/jvm/java-1.11.0-openjdk-amd64/include/linux' '-fPIC' '-Wall' '-O3' '-I/usr/local/include' '-I/home/taimoor/liboqs-java/src/main/c' '-I/home/taimoor/liboqs-java/target/generated-sources/annotations' '-o/home/taimoor/liboqs-java/target/objs/handle.o' '-c' '/home/taimoor/liboqs-java/src/main/c/handle.c'\r\nIn file included from /home/taimoor/liboqs-java/src/main/c/handle.c:1:\r\n/home/taimoor/liboqs-java/src/main/c/handle.h:4:10: fatal error: jni.h: No such file or directory\r\n    4 | #include <jni.h>\r\n      |          ^~~~~~~\r\ncompilation terminated.\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] BUILD FAILURE\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Total time:  0.905 s\r\n[INFO] Finished at: 2021-03-27T11:21:45-04:00\r\n[INFO] ------------------------------------------------------------------------\r\n[ERROR] Failed to execute goal org.codehaus.mojo:native-maven-plugin:1.0-alpha-9:compile (generate-shared-oqs-library) on project liboqs-java: Error executing command line. Exit code:1 -> [Help 1]\r\n[ERROR]\r\n[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.\r\n[ERROR] Re-run Maven using the -X switch to enable full debug logging.\r\n[ERROR]\r\n[ERROR] For more information about the errors and possible solutions, please read the following articles:\r\n[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException\r\n```\r\n\r\nThank you","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/comments/810159097","html_url":"https://github.com/open-quantum-safe/liboqs-java/issues/14#issuecomment-810159097","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/14","id":810159097,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDE1OTA5Nw==","user":{"login":"taimoorgit","id":37668804,"node_id":"MDQ6VXNlcjM3NjY4ODA0","avatar_url":"https://avatars.githubusercontent.com/u/37668804?v=4","gravatar_id":"","url":"https://api.github.com/users/taimoorgit","html_url":"https://github.com/taimoorgit","followers_url":"https://api.github.com/users/taimoorgit/followers","following_url":"https://api.github.com/users/taimoorgit/following{/other_user}","gists_url":"https://api.github.com/users/taimoorgit/gists{/gist_id}","starred_url":"https://api.github.com/users/taimoorgit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/taimoorgit/subscriptions","organizations_url":"https://api.github.com/users/taimoorgit/orgs","repos_url":"https://api.github.com/users/taimoorgit/repos","events_url":"https://api.github.com/users/taimoorgit/events{/privacy}","received_events_url":"https://api.github.com/users/taimoorgit/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T11:53:42Z","updated_at":"2021-03-30T11:53:42Z","author_association":"NONE","body":"Thanks @jimouris, my issue was completely irrelevant to liboqs-java, I feel silly!\r\n\r\nAfter installing the JRE in addition to the JDK I already have `mvn package` works fine!","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T11:53:42Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15743515856","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/16","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/16/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/16/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/16/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/16","id":832909463,"node_id":"MDExOlB1bGxSZXF1ZXN0NTkzOTk0NjIz","number":16,"title":"Hybrid KEM support","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-03-16T15:14:51Z","updated_at":"2021-03-30T11:56:58Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/pulls/16","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/16","diff_url":"https://github.com/open-quantum-safe/oqs-provider/pull/16.diff","patch_url":"https://github.com/open-quantum-safe/oqs-provider/pull/16.patch"},"body":"Hybrid KEM support for the oqs-provider (#3):\r\n- Combines OQS KEMs with OpenSSL EC-kex\r\n- Uses EVP API for OpenSSL EC-kex\r\n- Wraps hybrid KEM in OpenSSL3 KEM-API\r\n- Extends oqsx.h structures to accomodate KEM and KEX contexts\r\n- Refactoring to use preprocessor for hybrid combinations\r\n- Refactors oqs_test_groups: test iterates over all tls-groups in the oqs-provider\r\n- OQS/ECP and OQS/ECX hybrids\r\n- Updated fragments\r\n- Added generate-extras.yml with `nid_ecx_hybrid` code points. They are added by generate.py to the generate.yml elements fetched from the OSSL111 repo.\r\n- NIST-CAT5/X448 hybrids not enabled (see https://github.com/open-quantum-safe/openssl/issues/296)\r\n- Unrelated: A new run of generate.py also updated the Rainbow OIDs.","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/810160987","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/16#issuecomment-810160987","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/16","id":810160987,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDE2MDk4Nw==","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T11:56:58Z","updated_at":"2021-03-30T11:56:58Z","author_association":"MEMBER","body":"> Might there be a project setting to activate CI after PRs?\r\n\r\nI just enabled CCI for PRs from forked repos (OK in this case as we don't have environment secrets in this project). Could you please do a minor touchup commit to see whether CCI then runs? Otherwise it'd be good to provide future PRs from a local branch.","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T11:56:58Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15745579929","type":"IssueCommentEvent","actor":{"id":8843219,"login":"dstebila","display_login":"dstebila","gravatar_id":"","url":"https://api.github.com/users/dstebila","avatar_url":"https://avatars.githubusercontent.com/u/8843219?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/295","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/295/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/295/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/295/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/295","id":837206565,"node_id":"MDU6SXNzdWU4MzcyMDY1NjU=","number":295,"title":"Issue when signing with new algorithms","user":{"login":"opencrypto","id":7943812,"node_id":"MDQ6VXNlcjc5NDM4MTI=","avatar_url":"https://avatars.githubusercontent.com/u/7943812?v=4","gravatar_id":"","url":"https://api.github.com/users/opencrypto","html_url":"https://github.com/opencrypto","followers_url":"https://api.github.com/users/opencrypto/followers","following_url":"https://api.github.com/users/opencrypto/following{/other_user}","gists_url":"https://api.github.com/users/opencrypto/gists{/gist_id}","starred_url":"https://api.github.com/users/opencrypto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/opencrypto/subscriptions","organizations_url":"https://api.github.com/users/opencrypto/orgs","repos_url":"https://api.github.com/users/opencrypto/repos","events_url":"https://api.github.com/users/opencrypto/events{/privacy}","received_events_url":"https://api.github.com/users/opencrypto/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":18,"created_at":"2021-03-21T23:08:27Z","updated_at":"2021-03-30T13:56:15Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hello Everybody. I am trying to use the new algorithms in our wrapper library (LibPKI) that builds on top of OpenSSL. One thing I am having difficulties is to understand how to properly use the signing functions. \r\n\r\nSpecifically, I am trying to implement a generic signing function for DER encoded data (PKI_X509_sign(der (data), md (digest algor), evp_pkey) -> signature), and although the same functions work with RSA or ECDSA, they fail when I try with falcon, dilithium, or sphincs+.\r\n\r\nHere's the first code I tried:\r\n\r\n```\r\n// Creates the context\r\nif ((ctx = EVP_MD_CTX_create()) == NULL) {\r\n\tPKI_ERROR(PKI_ERR_MEMORY_ALLOC, NULL);\r\n\tif (out_mem) PKI_MEM_free(out_mem);\r\n\treturn NULL;\r\n}\r\n\r\n// Initializes the Context\r\nEVP_MD_CTX_init(ctx);\r\n\r\n// Initializes the Signature\r\nEVP_SignInit_ex(ctx, md, NULL);\r\nEVP_SignUpdate (ctx, der->data, der->size);\r\n\r\n// Finalizes the signature\r\nif (!EVP_SignFinal(ctx, out_mem->data, (unsigned int *) &ossl_ret, pkey))\r\n{\r\n\tPKI_ERROR(PKI_ERR_SIGNATURE_CREATE, \"Cannot finalize signature (%s)\", \r\n\t\tHSM_OPENSSL_get_errdesc(HSM_OPENSSL_get_errno(), NULL, 0));\r\n\r\n\tPKI_MEM_free(out_mem);\r\n\tout_mem = NULL;\r\n}\r\nelse out_mem->size = (size_t) ossl_ret;\r\n```\r\nI also tried the DigestSign version:\r\n```\r\n// Creates the context\r\nif ((ctx = EVP_MD_CTX_create()) == NULL) {\r\n\tPKI_ERROR(PKI_ERR_MEMORY_ALLOC, NULL);\r\n\tif (out_mem) PKI_MEM_free(out_mem);\r\n\treturn NULL;\r\n}\r\n\r\n// Initializes the Context\r\nEVP_MD_CTX_init(ctx);\r\n\r\nif (!EVP_DigestSignInit(ctx, &pCtx, md, NULL, pkey)) {\r\n    PKI_ERROR(PKI_ERR_SIGNATURE_CREATE, \"Cannot Initialize EVP_DigestSignInit()\");\r\n    goto err;\r\n}\r\n\r\nif (EVP_DigestSignUpdate(ctx, \r\n                                            der->data,\r\n   \t                                    der->size) <= 0) {\r\n   PKI_ERROR(PKI_ERR_SIGNATURE_CREATE, \"Cannot Update EVP_DigestSignUpdate()\");\r\n   goto err;\r\n}\r\n\r\nif (EVP_DigestSignFinal(ctx,\r\n                                        out_mem->data,\r\n                                        &ossl_ret) <= 0) {\r\n    PKI_ERROR(PKI_ERR_SIGNATURE_CREATE, \"Cannot Finalize EVP_DigestSignFinal()\");\r\n    goto err;\r\n}\r\nelse out_mem->size = (size_t) ossl_ret;\r\n```\r\nThe error seems to be related to the digest used (\"md\"). Specifically, if the md is not NULL, the EVP_SignFinal()/EVP_DigestSignFinal() fail with the following error trace:\r\n\r\n```\r\nMar 21 22:48:28 2021 GMT [91455] ERROR: [openssl_hsm.c:349] Can not create signature (117): Cannot finalize signature (  H??)\r\nMar 21 22:48:28 2021 GMT [91455] ERROR: [openssl_hsm.c:392] [HSM_OPENSSL_sign()] [ERROR] PKEY Type => 1294, falcon512\r\nMar 21 22:48:28 2021 GMT [91455] INFO: [openssl_hsm.c:395] [HSM_OPENSSL_sign()] [DEBUG]: [Signature Generated: 0 bytes (estimated: 690 bytes)]\r\nMar 21 22:48:28 2021 GMT [91455] INFO: [hsm_main.c:614] [PKI_sign()] [DEBUG]: Can not generate signature (returned from sign cb)\r\nMar 21 22:48:28 2021 GMT [91455] ERROR: [hsm_main.c:541] Can not create signature (117):\r\nMar 21 22:48:28 2021 GMT [91455] INFO: [pki_x509_req.c:222] [PKI_X509_REQ_new()] [DEBUG] REQ::ERROR 0 signing the Request [error:1012F0B1:elliptic curve routines:pkey_oqs_ctrl:wrong digest]\r\n```\r\nI know I am doing something wrong here, but I am not sure what... \r\n\r\nTo probe a bit further, I forced the use of a specific hashing algorithm - since the error was related to that, somehow: md = EVP_sha512(). If I do that, I get a success return code but the signature in the data is all zeroes.\r\n\r\n```\r\nMar 21 22:54:41 2021 GMT [97064] INFO: [pki_x509_req.c:61] [PKI_X509_REQ_new()] [DEBUG]: No Digest Associated with used algorithm\r\nMar 21 22:54:41 2021 GMT [97064] ERROR: [openssl_hsm.c:392] [HSM_OPENSSL_sign()] [ERROR] PKEY Type => 1294, falcon512\r\nMar 21 22:54:41 2021 GMT [97064] INFO: [openssl_hsm.c:395] [HSM_OPENSSL_sign()] [DEBUG]: [Signature Generated: 690 bytes (estimated: 690 bytes)]\r\n```\r\n\r\nJust to be very precise, when I use the standard apps/ tools (i.e., openssl req -new ...) I am able to generate things correctly.\r\n\r\nAnybody experiencing similar issues and/or know what I might be doing wrong?\r\n","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/810274018","html_url":"https://github.com/open-quantum-safe/openssl/issues/295#issuecomment-810274018","issue_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/295","id":810274018,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDI3NDAxOA==","user":{"login":"dstebila","id":8843219,"node_id":"MDQ6VXNlcjg4NDMyMTk=","avatar_url":"https://avatars.githubusercontent.com/u/8843219?v=4","gravatar_id":"","url":"https://api.github.com/users/dstebila","html_url":"https://github.com/dstebila","followers_url":"https://api.github.com/users/dstebila/followers","following_url":"https://api.github.com/users/dstebila/following{/other_user}","gists_url":"https://api.github.com/users/dstebila/gists{/gist_id}","starred_url":"https://api.github.com/users/dstebila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dstebila/subscriptions","organizations_url":"https://api.github.com/users/dstebila/orgs","repos_url":"https://api.github.com/users/dstebila/repos","events_url":"https://api.github.com/users/dstebila/events{/privacy}","received_events_url":"https://api.github.com/users/dstebila/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T13:56:15Z","updated_at":"2021-03-30T13:56:15Z","author_association":"MEMBER","body":"Sorry, I wasn't following the discussion fully. I'll reopen it and tag as future work.","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T13:56:15Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15746742990","type":"IssueCommentEvent","actor":{"id":37668804,"login":"taimoorgit","display_login":"taimoorgit","gravatar_id":"","url":"https://api.github.com/users/taimoorgit","avatar_url":"https://avatars.githubusercontent.com/u/37668804?"},"repo":{"id":247826799,"name":"open-quantum-safe/liboqs-java","url":"https://api.github.com/repos/open-quantum-safe/liboqs-java"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/events","html_url":"https://github.com/open-quantum-safe/liboqs-java/issues/11","id":778307621,"node_id":"MDU6SXNzdWU3NzgzMDc2MjE=","number":11,"title":"Enable Build for other Platforms like ARM (Android)","user":{"login":"Hatzen","id":21283655,"node_id":"MDQ6VXNlcjIxMjgzNjU1","avatar_url":"https://avatars.githubusercontent.com/u/21283655?v=4","gravatar_id":"","url":"https://api.github.com/users/Hatzen","html_url":"https://github.com/Hatzen","followers_url":"https://api.github.com/users/Hatzen/followers","following_url":"https://api.github.com/users/Hatzen/following{/other_user}","gists_url":"https://api.github.com/users/Hatzen/gists{/gist_id}","starred_url":"https://api.github.com/users/Hatzen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hatzen/subscriptions","organizations_url":"https://api.github.com/users/Hatzen/orgs","repos_url":"https://api.github.com/users/Hatzen/repos","events_url":"https://api.github.com/users/Hatzen/events{/privacy}","received_events_url":"https://api.github.com/users/Hatzen/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2021-01-04T19:23:54Z","updated_at":"2021-03-30T14:56:58Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"First of all thanks for your good work :)  \r\nI am trying to get the lib working for android.  Regarding https://github.com/open-quantum-safe/liboqs/issues/594 i am able to get a working .so file for android and the passed abi.  \r\nBut i am struggeling to get it working with this repository and jni.  \r\nWhen i just compile the library for armv8a and then using this repo to get the jni wrapper it fails as the target system (x86) differs at compile time.     \r\n\r\n<details>    \r\n<summary>Excerpt of the error message</summary>   \r\n\r\n```\r\n[INFO] /bin/sh -c cd '/home/hatzen/liboqs-java' && 'gcc' '-shared' '-L/home/hatzen/liboqs/build/lib' '-o/home/hatzen/liboqs-java/target/liboqs-java.jar' 'target/objs/handle.o' 'target/objs/KEMs.o' 'target/objs/KeyEncapsulation.o' 'target/objs/Rand.o' 'target/objs/Signature.o' 'target/objs/Sigs.o' '-o' '/home/hatzen/liboqs-java/src/main/resources/liboqs-jni.so' '-loqs'\r\n/usr/bin/ld: skipping incompatible /home/hatzen/liboqs/build/lib/liboqs.so when searching for -loqs\r\n/usr/bin/ld: cannot find -loqs\r\ncollect2: error: ld returned 1 exit status\r\n```\r\n</details>  \r\n  \r\nSo i tried to copy the necessary files and build jni and liboqs at a single time with the given cmake files.  \r\nI copied all c sources and tried to add them to the cmakefile. Buti get errors when running the java test.    \r\n  \r\n<details>\r\n<summary>Excerpts of changed files</summary>  \r\n  \r\nsrc/CMakeList.txt\r\n```cmake  \r\n...\r\ninclude_directories(jni)\r\nlink_directories(jni oqs)\r\n\r\nadd_library(jni SHARED\r\njni/handle.c\r\njni/KEMs.c\r\njni/KeyEncapsulation.c\r\njni/Rand.c\r\njni/Signature.c\r\njni/Sigs.c)\r\n\r\nset_target_properties(\r\n    jni\r\n    PROPERTIES\r\n    COMPILE_FLAGS \"-w\"\r\n    #COMPILE_WARNING_DISABLED high\r\n)\r\ntarget_link_libraries(jni oqs)\r\n\r\nset_target_properties(jni PROPERTIES PUBLIC_HEADER \"jni/handle.h;jni/KEMs.h;jni/KeyEncapsulation.h;jni/Rand.h;jni/Signature.h;jni/Sigs.h\")\r\n\r\nINSTALL(TARGETS jni\r\n        LIBRARY DESTINATION lib\r\n        PUBLIC_HEADER DESTINATION lib\r\n)\r\n...\r\n```   \r\nAnd i have overriden the Common Class of this Repo: \r\n\r\n```java\r\npublic class Common {\r\n    ...\r\n    public static void loadNativeLibrary() {\r\n        // overrides all changes from this repo method.\r\n        System.loadLibrary(\"oqs\");\r\n        System.loadLibrary(\"jni\");\r\n   }\r\n   ...\r\n}\r\n```\r\nI did override all packages and paths like:  \r\n```\r\nJava_org_openquantumsafe => Java_de_hartz_software_parannoying_helper_security_liboqs_java\r\norg/openquantumsafe => de/hartz/software/parannoying/helper/security/liboqs/java\r\n```\r\n\r\nThe crash occours probably on the equivalent of:  \r\nhttps://github.com/open-quantum-safe/liboqs-java/blob/109534741ace8442129b20dce9cfce62aa54048a/src/test/java/org/openquantumsafe/KEMTest.java#L37  \r\nwhich is calling JNI  \r\nhttps://github.com/open-quantum-safe/liboqs-java/blob/109534741ace8442129b20dce9cfce62aa54048a/src/main/c/KeyEncapsulation.c#L41  \r\n\r\n```\r\n2021-01-02 20:21:08.357 7642-7697/de.hartz.software.parannoying E/zygote64: JNI ERROR (app bug): accessed stale Local 0x76e6ea9241  (index 1852746020 in a table of size 2)\r\n2021-01-02 20:21:08.388 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534] JNI DETECTED ERROR IN APPLICATION: use of deleted local reference 0x76e6ea9241\r\n2021-01-02 20:21:08.389 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534]     from de.hartz.software.parannoying.helper.security.liboqs.java.KeyEncapsulation$KeyEncapsulationDetails de.hartz.software.parannoying.helper.security.liboqs.java.KeyEncapsulation.get_KEM_details()\r\n2021-01-02 20:21:08.389 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534] \"Instr: androidx.test.runner.AndroidJUnitRunner\" prio=5 tid=22 Runnable\r\n```\r\n  \r\n</details>\r\n  \r\nI am not very familiar with writing c and never had contact with JNI before.   \r\nSo i am not sure whether it could be simple to solve. So my question is will you consider to make this repo be able to build for different abis at a time?  ","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/comments/810330859","html_url":"https://github.com/open-quantum-safe/liboqs-java/issues/11#issuecomment-810330859","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11","id":810330859,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDMzMDg1OQ==","user":{"login":"taimoorgit","id":37668804,"node_id":"MDQ6VXNlcjM3NjY4ODA0","avatar_url":"https://avatars.githubusercontent.com/u/37668804?v=4","gravatar_id":"","url":"https://api.github.com/users/taimoorgit","html_url":"https://github.com/taimoorgit","followers_url":"https://api.github.com/users/taimoorgit/followers","following_url":"https://api.github.com/users/taimoorgit/following{/other_user}","gists_url":"https://api.github.com/users/taimoorgit/gists{/gist_id}","starred_url":"https://api.github.com/users/taimoorgit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/taimoorgit/subscriptions","organizations_url":"https://api.github.com/users/taimoorgit/orgs","repos_url":"https://api.github.com/users/taimoorgit/repos","events_url":"https://api.github.com/users/taimoorgit/events{/privacy}","received_events_url":"https://api.github.com/users/taimoorgit/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T14:56:58Z","updated_at":"2021-03-30T14:56:58Z","author_association":"NONE","body":"I'm encountering a similar issue with Android, is it related or should I make a new issue? \r\n\r\nWhat I've done:\r\n\r\n1. Compiled liboqs on Android:\r\n\r\n```\r\nbash scripts/build-android.sh ~/android-ndk-r21e -s 29 -a x86_64\r\n```\r\n\r\n2. Created the liboqs-java.jar file after building liboqs for Android:\r\n\r\n```\r\nmvn package -P linux -Dliboqs.include.dir=\"/home/taimoor/liboqs/build/include\" -Dliboqs.lib.dir=\"/home/taimoor/liboqs/build/lib\"\r\n```\r\n\r\n3. Included liboqs-java.jar to my Android Studio app/build.gradle file and added liboqs-jni.so to src/main/jniLibs/\r\n\r\nAfter that, I got this error in my logcat:\r\n\r\n```\r\n2021-03-30 10:54:29.786 11628-11628/com.example.liboqsonandroid W/System.err: java.lang.UnsatisfiedLinkError: dlopen failed: library \"liboqs.so\" not found: needed by /data/app/~~BEHa0EfGtjL9yubMwThyaw==/com.example.liboqsonandroid-CsJr0h_qqgQgMAFan_FSGA==/base.apk!/lib/x86_64/liboqs-jni.so in namespace classloader-namespace\r\n```\r\n\r\nSo I copied over the liboqs.so for x86_64 and now it's asking me for another library (libc):\r\n\r\n```\r\n2021-03-30 10:56:15.320 11991-11991/com.example.liboqsonandroid W/System.err: java.lang.UnsatisfiedLinkError: dlopen failed: library \"libc.so.6\" not found: needed by /data/app/~~FFF8vcK_c0XdGabfz32FGQ==/com.example.liboqsonandroid-xDUSBEPJYdxuuULhNoJ_8Q==/base.apk!/lib/x86_64/liboqs-jni.so in namespace classloader-namespace\r\n```\r\n\r\nI guess from here the next step would be to compile libc for x86_64 and include the .so? Or is there something else I should be doing to remedy this? ","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T14:56:58Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15746807084","type":"IssueCommentEvent","actor":{"id":37668804,"login":"taimoorgit","display_login":"taimoorgit","gravatar_id":"","url":"https://api.github.com/users/taimoorgit","avatar_url":"https://avatars.githubusercontent.com/u/37668804?"},"repo":{"id":247826799,"name":"open-quantum-safe/liboqs-java","url":"https://api.github.com/repos/open-quantum-safe/liboqs-java"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/events","html_url":"https://github.com/open-quantum-safe/liboqs-java/issues/11","id":778307621,"node_id":"MDU6SXNzdWU3NzgzMDc2MjE=","number":11,"title":"Enable Build for other Platforms like ARM (Android)","user":{"login":"Hatzen","id":21283655,"node_id":"MDQ6VXNlcjIxMjgzNjU1","avatar_url":"https://avatars.githubusercontent.com/u/21283655?v=4","gravatar_id":"","url":"https://api.github.com/users/Hatzen","html_url":"https://github.com/Hatzen","followers_url":"https://api.github.com/users/Hatzen/followers","following_url":"https://api.github.com/users/Hatzen/following{/other_user}","gists_url":"https://api.github.com/users/Hatzen/gists{/gist_id}","starred_url":"https://api.github.com/users/Hatzen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hatzen/subscriptions","organizations_url":"https://api.github.com/users/Hatzen/orgs","repos_url":"https://api.github.com/users/Hatzen/repos","events_url":"https://api.github.com/users/Hatzen/events{/privacy}","received_events_url":"https://api.github.com/users/Hatzen/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2021-01-04T19:23:54Z","updated_at":"2021-03-30T15:00:17Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"First of all thanks for your good work :)  \r\nI am trying to get the lib working for android.  Regarding https://github.com/open-quantum-safe/liboqs/issues/594 i am able to get a working .so file for android and the passed abi.  \r\nBut i am struggeling to get it working with this repository and jni.  \r\nWhen i just compile the library for armv8a and then using this repo to get the jni wrapper it fails as the target system (x86) differs at compile time.     \r\n\r\n<details>    \r\n<summary>Excerpt of the error message</summary>   \r\n\r\n```\r\n[INFO] /bin/sh -c cd '/home/hatzen/liboqs-java' && 'gcc' '-shared' '-L/home/hatzen/liboqs/build/lib' '-o/home/hatzen/liboqs-java/target/liboqs-java.jar' 'target/objs/handle.o' 'target/objs/KEMs.o' 'target/objs/KeyEncapsulation.o' 'target/objs/Rand.o' 'target/objs/Signature.o' 'target/objs/Sigs.o' '-o' '/home/hatzen/liboqs-java/src/main/resources/liboqs-jni.so' '-loqs'\r\n/usr/bin/ld: skipping incompatible /home/hatzen/liboqs/build/lib/liboqs.so when searching for -loqs\r\n/usr/bin/ld: cannot find -loqs\r\ncollect2: error: ld returned 1 exit status\r\n```\r\n</details>  \r\n  \r\nSo i tried to copy the necessary files and build jni and liboqs at a single time with the given cmake files.  \r\nI copied all c sources and tried to add them to the cmakefile. Buti get errors when running the java test.    \r\n  \r\n<details>\r\n<summary>Excerpts of changed files</summary>  \r\n  \r\nsrc/CMakeList.txt\r\n```cmake  \r\n...\r\ninclude_directories(jni)\r\nlink_directories(jni oqs)\r\n\r\nadd_library(jni SHARED\r\njni/handle.c\r\njni/KEMs.c\r\njni/KeyEncapsulation.c\r\njni/Rand.c\r\njni/Signature.c\r\njni/Sigs.c)\r\n\r\nset_target_properties(\r\n    jni\r\n    PROPERTIES\r\n    COMPILE_FLAGS \"-w\"\r\n    #COMPILE_WARNING_DISABLED high\r\n)\r\ntarget_link_libraries(jni oqs)\r\n\r\nset_target_properties(jni PROPERTIES PUBLIC_HEADER \"jni/handle.h;jni/KEMs.h;jni/KeyEncapsulation.h;jni/Rand.h;jni/Signature.h;jni/Sigs.h\")\r\n\r\nINSTALL(TARGETS jni\r\n        LIBRARY DESTINATION lib\r\n        PUBLIC_HEADER DESTINATION lib\r\n)\r\n...\r\n```   \r\nAnd i have overriden the Common Class of this Repo: \r\n\r\n```java\r\npublic class Common {\r\n    ...\r\n    public static void loadNativeLibrary() {\r\n        // overrides all changes from this repo method.\r\n        System.loadLibrary(\"oqs\");\r\n        System.loadLibrary(\"jni\");\r\n   }\r\n   ...\r\n}\r\n```\r\nI did override all packages and paths like:  \r\n```\r\nJava_org_openquantumsafe => Java_de_hartz_software_parannoying_helper_security_liboqs_java\r\norg/openquantumsafe => de/hartz/software/parannoying/helper/security/liboqs/java\r\n```\r\n\r\nThe crash occours probably on the equivalent of:  \r\nhttps://github.com/open-quantum-safe/liboqs-java/blob/109534741ace8442129b20dce9cfce62aa54048a/src/test/java/org/openquantumsafe/KEMTest.java#L37  \r\nwhich is calling JNI  \r\nhttps://github.com/open-quantum-safe/liboqs-java/blob/109534741ace8442129b20dce9cfce62aa54048a/src/main/c/KeyEncapsulation.c#L41  \r\n\r\n```\r\n2021-01-02 20:21:08.357 7642-7697/de.hartz.software.parannoying E/zygote64: JNI ERROR (app bug): accessed stale Local 0x76e6ea9241  (index 1852746020 in a table of size 2)\r\n2021-01-02 20:21:08.388 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534] JNI DETECTED ERROR IN APPLICATION: use of deleted local reference 0x76e6ea9241\r\n2021-01-02 20:21:08.389 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534]     from de.hartz.software.parannoying.helper.security.liboqs.java.KeyEncapsulation$KeyEncapsulationDetails de.hartz.software.parannoying.helper.security.liboqs.java.KeyEncapsulation.get_KEM_details()\r\n2021-01-02 20:21:08.389 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534] \"Instr: androidx.test.runner.AndroidJUnitRunner\" prio=5 tid=22 Runnable\r\n```\r\n  \r\n</details>\r\n  \r\nI am not very familiar with writing c and never had contact with JNI before.   \r\nSo i am not sure whether it could be simple to solve. So my question is will you consider to make this repo be able to build for different abis at a time?  ","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/comments/810333588","html_url":"https://github.com/open-quantum-safe/liboqs-java/issues/11#issuecomment-810333588","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11","id":810333588,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDMzMzU4OA==","user":{"login":"taimoorgit","id":37668804,"node_id":"MDQ6VXNlcjM3NjY4ODA0","avatar_url":"https://avatars.githubusercontent.com/u/37668804?v=4","gravatar_id":"","url":"https://api.github.com/users/taimoorgit","html_url":"https://github.com/taimoorgit","followers_url":"https://api.github.com/users/taimoorgit/followers","following_url":"https://api.github.com/users/taimoorgit/following{/other_user}","gists_url":"https://api.github.com/users/taimoorgit/gists{/gist_id}","starred_url":"https://api.github.com/users/taimoorgit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/taimoorgit/subscriptions","organizations_url":"https://api.github.com/users/taimoorgit/orgs","repos_url":"https://api.github.com/users/taimoorgit/repos","events_url":"https://api.github.com/users/taimoorgit/events{/privacy}","received_events_url":"https://api.github.com/users/taimoorgit/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T15:00:17Z","updated_at":"2021-03-30T15:00:17Z","author_association":"NONE","body":"I'd also mention that whenever I try to run it on my phone that is arm64-v8a I get:\r\n\r\n```\r\n2021-03-30 10:58:37.179 14395-14395/com.example.liboqsonandroid W/System.err: java.lang.UnsatisfiedLinkError: dlopen failed: \"/data/app/com.example.liboqsonandroid-pIjCbrQ_jRPC5qk7PU7wPA==/base.apk!/lib/arm64-v8a/liboqs-jni.so\" is for EM_X86_64 (62) instead of EM_AARCH64 (183)\r\n```\r\n\r\nHowever I did compile liboqs (and packaged liboqs-java afterwards) for arm64-v8a and included the liboqs-jni.so to the correct folder src/main/jniLibs/arm64-v8a","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T15:00:18Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15746905839","type":"IssueCommentEvent","actor":{"id":21283655,"login":"Hatzen","display_login":"Hatzen","gravatar_id":"","url":"https://api.github.com/users/Hatzen","avatar_url":"https://avatars.githubusercontent.com/u/21283655?"},"repo":{"id":247826799,"name":"open-quantum-safe/liboqs-java","url":"https://api.github.com/repos/open-quantum-safe/liboqs-java"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/events","html_url":"https://github.com/open-quantum-safe/liboqs-java/issues/11","id":778307621,"node_id":"MDU6SXNzdWU3NzgzMDc2MjE=","number":11,"title":"Enable Build for other Platforms like ARM (Android)","user":{"login":"Hatzen","id":21283655,"node_id":"MDQ6VXNlcjIxMjgzNjU1","avatar_url":"https://avatars.githubusercontent.com/u/21283655?v=4","gravatar_id":"","url":"https://api.github.com/users/Hatzen","html_url":"https://github.com/Hatzen","followers_url":"https://api.github.com/users/Hatzen/followers","following_url":"https://api.github.com/users/Hatzen/following{/other_user}","gists_url":"https://api.github.com/users/Hatzen/gists{/gist_id}","starred_url":"https://api.github.com/users/Hatzen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hatzen/subscriptions","organizations_url":"https://api.github.com/users/Hatzen/orgs","repos_url":"https://api.github.com/users/Hatzen/repos","events_url":"https://api.github.com/users/Hatzen/events{/privacy}","received_events_url":"https://api.github.com/users/Hatzen/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2021-01-04T19:23:54Z","updated_at":"2021-03-30T15:05:29Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"First of all thanks for your good work :)  \r\nI am trying to get the lib working for android.  Regarding https://github.com/open-quantum-safe/liboqs/issues/594 i am able to get a working .so file for android and the passed abi.  \r\nBut i am struggeling to get it working with this repository and jni.  \r\nWhen i just compile the library for armv8a and then using this repo to get the jni wrapper it fails as the target system (x86) differs at compile time.     \r\n\r\n<details>    \r\n<summary>Excerpt of the error message</summary>   \r\n\r\n```\r\n[INFO] /bin/sh -c cd '/home/hatzen/liboqs-java' && 'gcc' '-shared' '-L/home/hatzen/liboqs/build/lib' '-o/home/hatzen/liboqs-java/target/liboqs-java.jar' 'target/objs/handle.o' 'target/objs/KEMs.o' 'target/objs/KeyEncapsulation.o' 'target/objs/Rand.o' 'target/objs/Signature.o' 'target/objs/Sigs.o' '-o' '/home/hatzen/liboqs-java/src/main/resources/liboqs-jni.so' '-loqs'\r\n/usr/bin/ld: skipping incompatible /home/hatzen/liboqs/build/lib/liboqs.so when searching for -loqs\r\n/usr/bin/ld: cannot find -loqs\r\ncollect2: error: ld returned 1 exit status\r\n```\r\n</details>  \r\n  \r\nSo i tried to copy the necessary files and build jni and liboqs at a single time with the given cmake files.  \r\nI copied all c sources and tried to add them to the cmakefile. Buti get errors when running the java test.    \r\n  \r\n<details>\r\n<summary>Excerpts of changed files</summary>  \r\n  \r\nsrc/CMakeList.txt\r\n```cmake  \r\n...\r\ninclude_directories(jni)\r\nlink_directories(jni oqs)\r\n\r\nadd_library(jni SHARED\r\njni/handle.c\r\njni/KEMs.c\r\njni/KeyEncapsulation.c\r\njni/Rand.c\r\njni/Signature.c\r\njni/Sigs.c)\r\n\r\nset_target_properties(\r\n    jni\r\n    PROPERTIES\r\n    COMPILE_FLAGS \"-w\"\r\n    #COMPILE_WARNING_DISABLED high\r\n)\r\ntarget_link_libraries(jni oqs)\r\n\r\nset_target_properties(jni PROPERTIES PUBLIC_HEADER \"jni/handle.h;jni/KEMs.h;jni/KeyEncapsulation.h;jni/Rand.h;jni/Signature.h;jni/Sigs.h\")\r\n\r\nINSTALL(TARGETS jni\r\n        LIBRARY DESTINATION lib\r\n        PUBLIC_HEADER DESTINATION lib\r\n)\r\n...\r\n```   \r\nAnd i have overriden the Common Class of this Repo: \r\n\r\n```java\r\npublic class Common {\r\n    ...\r\n    public static void loadNativeLibrary() {\r\n        // overrides all changes from this repo method.\r\n        System.loadLibrary(\"oqs\");\r\n        System.loadLibrary(\"jni\");\r\n   }\r\n   ...\r\n}\r\n```\r\nI did override all packages and paths like:  \r\n```\r\nJava_org_openquantumsafe => Java_de_hartz_software_parannoying_helper_security_liboqs_java\r\norg/openquantumsafe => de/hartz/software/parannoying/helper/security/liboqs/java\r\n```\r\n\r\nThe crash occours probably on the equivalent of:  \r\nhttps://github.com/open-quantum-safe/liboqs-java/blob/109534741ace8442129b20dce9cfce62aa54048a/src/test/java/org/openquantumsafe/KEMTest.java#L37  \r\nwhich is calling JNI  \r\nhttps://github.com/open-quantum-safe/liboqs-java/blob/109534741ace8442129b20dce9cfce62aa54048a/src/main/c/KeyEncapsulation.c#L41  \r\n\r\n```\r\n2021-01-02 20:21:08.357 7642-7697/de.hartz.software.parannoying E/zygote64: JNI ERROR (app bug): accessed stale Local 0x76e6ea9241  (index 1852746020 in a table of size 2)\r\n2021-01-02 20:21:08.388 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534] JNI DETECTED ERROR IN APPLICATION: use of deleted local reference 0x76e6ea9241\r\n2021-01-02 20:21:08.389 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534]     from de.hartz.software.parannoying.helper.security.liboqs.java.KeyEncapsulation$KeyEncapsulationDetails de.hartz.software.parannoying.helper.security.liboqs.java.KeyEncapsulation.get_KEM_details()\r\n2021-01-02 20:21:08.389 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534] \"Instr: androidx.test.runner.AndroidJUnitRunner\" prio=5 tid=22 Runnable\r\n```\r\n  \r\n</details>\r\n  \r\nI am not very familiar with writing c and never had contact with JNI before.   \r\nSo i am not sure whether it could be simple to solve. So my question is will you consider to make this repo be able to build for different abis at a time?  ","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/comments/810337984","html_url":"https://github.com/open-quantum-safe/liboqs-java/issues/11#issuecomment-810337984","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11","id":810337984,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDMzNzk4NA==","user":{"login":"Hatzen","id":21283655,"node_id":"MDQ6VXNlcjIxMjgzNjU1","avatar_url":"https://avatars.githubusercontent.com/u/21283655?v=4","gravatar_id":"","url":"https://api.github.com/users/Hatzen","html_url":"https://github.com/Hatzen","followers_url":"https://api.github.com/users/Hatzen/followers","following_url":"https://api.github.com/users/Hatzen/following{/other_user}","gists_url":"https://api.github.com/users/Hatzen/gists{/gist_id}","starred_url":"https://api.github.com/users/Hatzen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hatzen/subscriptions","organizations_url":"https://api.github.com/users/Hatzen/orgs","repos_url":"https://api.github.com/users/Hatzen/repos","events_url":"https://api.github.com/users/Hatzen/events{/privacy}","received_events_url":"https://api.github.com/users/Hatzen/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T15:05:29Z","updated_at":"2021-03-30T15:05:29Z","author_association":"NONE","body":"The Problem is when running maven on your pc you compile the jni files for x86_64 but they have to be compiled the same as you compile liboqs with the Android Script.  \r\nI tried that within My repo, No luck for now..","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T15:05:29Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15747343900","type":"IssueCommentEvent","actor":{"id":37668804,"login":"taimoorgit","display_login":"taimoorgit","gravatar_id":"","url":"https://api.github.com/users/taimoorgit","avatar_url":"https://avatars.githubusercontent.com/u/37668804?"},"repo":{"id":247826799,"name":"open-quantum-safe/liboqs-java","url":"https://api.github.com/repos/open-quantum-safe/liboqs-java"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11/events","html_url":"https://github.com/open-quantum-safe/liboqs-java/issues/11","id":778307621,"node_id":"MDU6SXNzdWU3NzgzMDc2MjE=","number":11,"title":"Enable Build for other Platforms like ARM (Android)","user":{"login":"Hatzen","id":21283655,"node_id":"MDQ6VXNlcjIxMjgzNjU1","avatar_url":"https://avatars.githubusercontent.com/u/21283655?v=4","gravatar_id":"","url":"https://api.github.com/users/Hatzen","html_url":"https://github.com/Hatzen","followers_url":"https://api.github.com/users/Hatzen/followers","following_url":"https://api.github.com/users/Hatzen/following{/other_user}","gists_url":"https://api.github.com/users/Hatzen/gists{/gist_id}","starred_url":"https://api.github.com/users/Hatzen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hatzen/subscriptions","organizations_url":"https://api.github.com/users/Hatzen/orgs","repos_url":"https://api.github.com/users/Hatzen/repos","events_url":"https://api.github.com/users/Hatzen/events{/privacy}","received_events_url":"https://api.github.com/users/Hatzen/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2021-01-04T19:23:54Z","updated_at":"2021-03-30T15:29:56Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"First of all thanks for your good work :)  \r\nI am trying to get the lib working for android.  Regarding https://github.com/open-quantum-safe/liboqs/issues/594 i am able to get a working .so file for android and the passed abi.  \r\nBut i am struggeling to get it working with this repository and jni.  \r\nWhen i just compile the library for armv8a and then using this repo to get the jni wrapper it fails as the target system (x86) differs at compile time.     \r\n\r\n<details>    \r\n<summary>Excerpt of the error message</summary>   \r\n\r\n```\r\n[INFO] /bin/sh -c cd '/home/hatzen/liboqs-java' && 'gcc' '-shared' '-L/home/hatzen/liboqs/build/lib' '-o/home/hatzen/liboqs-java/target/liboqs-java.jar' 'target/objs/handle.o' 'target/objs/KEMs.o' 'target/objs/KeyEncapsulation.o' 'target/objs/Rand.o' 'target/objs/Signature.o' 'target/objs/Sigs.o' '-o' '/home/hatzen/liboqs-java/src/main/resources/liboqs-jni.so' '-loqs'\r\n/usr/bin/ld: skipping incompatible /home/hatzen/liboqs/build/lib/liboqs.so when searching for -loqs\r\n/usr/bin/ld: cannot find -loqs\r\ncollect2: error: ld returned 1 exit status\r\n```\r\n</details>  \r\n  \r\nSo i tried to copy the necessary files and build jni and liboqs at a single time with the given cmake files.  \r\nI copied all c sources and tried to add them to the cmakefile. Buti get errors when running the java test.    \r\n  \r\n<details>\r\n<summary>Excerpts of changed files</summary>  \r\n  \r\nsrc/CMakeList.txt\r\n```cmake  \r\n...\r\ninclude_directories(jni)\r\nlink_directories(jni oqs)\r\n\r\nadd_library(jni SHARED\r\njni/handle.c\r\njni/KEMs.c\r\njni/KeyEncapsulation.c\r\njni/Rand.c\r\njni/Signature.c\r\njni/Sigs.c)\r\n\r\nset_target_properties(\r\n    jni\r\n    PROPERTIES\r\n    COMPILE_FLAGS \"-w\"\r\n    #COMPILE_WARNING_DISABLED high\r\n)\r\ntarget_link_libraries(jni oqs)\r\n\r\nset_target_properties(jni PROPERTIES PUBLIC_HEADER \"jni/handle.h;jni/KEMs.h;jni/KeyEncapsulation.h;jni/Rand.h;jni/Signature.h;jni/Sigs.h\")\r\n\r\nINSTALL(TARGETS jni\r\n        LIBRARY DESTINATION lib\r\n        PUBLIC_HEADER DESTINATION lib\r\n)\r\n...\r\n```   \r\nAnd i have overriden the Common Class of this Repo: \r\n\r\n```java\r\npublic class Common {\r\n    ...\r\n    public static void loadNativeLibrary() {\r\n        // overrides all changes from this repo method.\r\n        System.loadLibrary(\"oqs\");\r\n        System.loadLibrary(\"jni\");\r\n   }\r\n   ...\r\n}\r\n```\r\nI did override all packages and paths like:  \r\n```\r\nJava_org_openquantumsafe => Java_de_hartz_software_parannoying_helper_security_liboqs_java\r\norg/openquantumsafe => de/hartz/software/parannoying/helper/security/liboqs/java\r\n```\r\n\r\nThe crash occours probably on the equivalent of:  \r\nhttps://github.com/open-quantum-safe/liboqs-java/blob/109534741ace8442129b20dce9cfce62aa54048a/src/test/java/org/openquantumsafe/KEMTest.java#L37  \r\nwhich is calling JNI  \r\nhttps://github.com/open-quantum-safe/liboqs-java/blob/109534741ace8442129b20dce9cfce62aa54048a/src/main/c/KeyEncapsulation.c#L41  \r\n\r\n```\r\n2021-01-02 20:21:08.357 7642-7697/de.hartz.software.parannoying E/zygote64: JNI ERROR (app bug): accessed stale Local 0x76e6ea9241  (index 1852746020 in a table of size 2)\r\n2021-01-02 20:21:08.388 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534] JNI DETECTED ERROR IN APPLICATION: use of deleted local reference 0x76e6ea9241\r\n2021-01-02 20:21:08.389 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534]     from de.hartz.software.parannoying.helper.security.liboqs.java.KeyEncapsulation$KeyEncapsulationDetails de.hartz.software.parannoying.helper.security.liboqs.java.KeyEncapsulation.get_KEM_details()\r\n2021-01-02 20:21:08.389 7642-7697/de.hartz.software.parannoying A/zygote64: java_vm_ext.cc:534] \"Instr: androidx.test.runner.AndroidJUnitRunner\" prio=5 tid=22 Runnable\r\n```\r\n  \r\n</details>\r\n  \r\nI am not very familiar with writing c and never had contact with JNI before.   \r\nSo i am not sure whether it could be simple to solve. So my question is will you consider to make this repo be able to build for different abis at a time?  ","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/comments/810356729","html_url":"https://github.com/open-quantum-safe/liboqs-java/issues/11#issuecomment-810356729","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs-java/issues/11","id":810356729,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDM1NjcyOQ==","user":{"login":"taimoorgit","id":37668804,"node_id":"MDQ6VXNlcjM3NjY4ODA0","avatar_url":"https://avatars.githubusercontent.com/u/37668804?v=4","gravatar_id":"","url":"https://api.github.com/users/taimoorgit","html_url":"https://github.com/taimoorgit","followers_url":"https://api.github.com/users/taimoorgit/followers","following_url":"https://api.github.com/users/taimoorgit/following{/other_user}","gists_url":"https://api.github.com/users/taimoorgit/gists{/gist_id}","starred_url":"https://api.github.com/users/taimoorgit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/taimoorgit/subscriptions","organizations_url":"https://api.github.com/users/taimoorgit/orgs","repos_url":"https://api.github.com/users/taimoorgit/repos","events_url":"https://api.github.com/users/taimoorgit/events{/privacy}","received_events_url":"https://api.github.com/users/taimoorgit/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T15:29:56Z","updated_at":"2021-03-30T15:29:56Z","author_association":"NONE","body":"I think you are right, trying to build the Java wrapper for arm64-v8a did not work according to the [build logs](https://gist.github.com/taimoorgit/4b6f2357674da998c4c2e77f1656fd13), so I'm guessing it just used x86_64 since that's what I have installed on my system?\r\n\r\n```\r\n/usr/bin/ld: skipping incompatible /home/taimoor/liboqs/build/lib/liboqs.so when searching for -loqs\r\n```","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T15:29:56Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15747371876","type":"IssueCommentEvent","actor":{"id":25615540,"login":"jschanck","display_login":"jschanck","gravatar_id":"","url":"https://api.github.com/users/jschanck","avatar_url":"https://avatars.githubusercontent.com/u/25615540?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/953","id":844709380,"node_id":"MDU6SXNzdWU4NDQ3MDkzODA=","number":953,"title":"Two tests fail on the current master","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-03-30T15:09:48Z","updated_at":"2021-03-30T15:31:29Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"MacOS Catalina 10.15.7, Xcode-12.4. Current master.\r\n\r\n```\r\n.  .  .  .  .\r\n======================================================= FAILURES ========================================================\r\n___________________________________________________ test_kem[HQC-128] ___________________________________________________\r\n[gw16] darwin -- Python 3.9.2 /opt/local/bin/python3\r\n\r\nkem_name = 'HQC-128'\r\n\r\n    @helpers.filtered_test\r\n    @pytest.mark.parametrize('kem_name', helpers.available_kems_by_name())\r\n    def test_kem(kem_name):\r\n        if not(helpers.is_kem_enabled_by_name(kem_name)): pytest.skip('Not enabled')\r\n>       helpers.run_subprocess(\r\n            [helpers.path_to_executable('test_kem'), kem_name],\r\n        )\r\n\r\ntests/test_cmdline.py:19: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n\r\ncommand = ['./build/tests/test_kem', 'HQC-128'], working_dir = '.'\r\nenv = {'ANT_OPTS': '-Dhttp.proxyHost=llproxy.llan.ll.mit.edu -Dhttp.proxyPort=8080', 'AS': 'yasm -m amd64 -f macho64 -p gas -X gnu ', 'AS_INTEGRATED_ASSEMBLER': '1', 'BASH_SILENCE_DEPRECATION_WARNING': '1', ...}\r\nexpected_returncode = 0, input = None, ignore_returncode = False\r\n\r\n    def run_subprocess(command, working_dir='.', env=None, expected_returncode=0, input=None, ignore_returncode=False):\r\n        \"\"\"\r\n        Helper function to run a shell command and report success/failure\r\n        depending on the exit status of the shell command.\r\n        \"\"\"\r\n        env_ = os.environ.copy()\r\n        if env is not None:\r\n            env_.update(env)\r\n        env = env_\r\n    \r\n        # Note we need to capture stdout/stderr from the subprocess,\r\n        # then print it, which pytest will then capture and\r\n        # buffer appropriately\r\n        print(working_dir + \" > \" + \" \".join(command))\r\n    \r\n        result = subprocess.run(\r\n                command,\r\n                input=input,\r\n                stdout=subprocess.PIPE,\r\n                stderr=subprocess.STDOUT,\r\n                cwd=working_dir,\r\n                env=env,\r\n            )\r\n    \r\n        if not(ignore_returncode) and (result.returncode != expected_returncode):\r\n            print(result.stdout.decode('utf-8'))\r\n>           assert False, \"Got unexpected return code {}\".format(result.returncode)\r\nE           AssertionError: Got unexpected return code -10\r\n\r\ntests/helpers.py:41: AssertionError\r\n------------------------------------------------- Captured stdout call --------------------------------------------------\r\n. > ./build/tests/test_kem HQC-128\r\n\r\n___________________________________________________ test_kem[HQC-192] ___________________________________________________\r\n[gw17] darwin -- Python 3.9.2 /opt/local/bin/python3\r\n\r\nkem_name = 'HQC-192'\r\n\r\n    @helpers.filtered_test\r\n    @pytest.mark.parametrize('kem_name', helpers.available_kems_by_name())\r\n    def test_kem(kem_name):\r\n        if not(helpers.is_kem_enabled_by_name(kem_name)): pytest.skip('Not enabled')\r\n>       helpers.run_subprocess(\r\n            [helpers.path_to_executable('test_kem'), kem_name],\r\n        )\r\n\r\ntests/test_cmdline.py:19: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n\r\ncommand = ['./build/tests/test_kem', 'HQC-192'], working_dir = '.'\r\nenv = {'ANT_OPTS': '-Dhttp.proxyHost=llproxy.llan.ll.mit.edu -Dhttp.proxyPort=8080', 'AS': 'yasm -m amd64 -f macho64 -p gas -X gnu ', 'AS_INTEGRATED_ASSEMBLER': '1', 'BASH_SILENCE_DEPRECATION_WARNING': '1', ...}\r\nexpected_returncode = 0, input = None, ignore_returncode = False\r\n\r\n    def run_subprocess(command, working_dir='.', env=None, expected_returncode=0, input=None, ignore_returncode=False):\r\n        \"\"\"\r\n        Helper function to run a shell command and report success/failure\r\n        depending on the exit status of the shell command.\r\n        \"\"\"\r\n        env_ = os.environ.copy()\r\n        if env is not None:\r\n            env_.update(env)\r\n        env = env_\r\n    \r\n        # Note we need to capture stdout/stderr from the subprocess,\r\n        # then print it, which pytest will then capture and\r\n        # buffer appropriately\r\n        print(working_dir + \" > \" + \" \".join(command))\r\n    \r\n        result = subprocess.run(\r\n                command,\r\n                input=input,\r\n                stdout=subprocess.PIPE,\r\n                stderr=subprocess.STDOUT,\r\n                cwd=working_dir,\r\n                env=env,\r\n            )\r\n    \r\n        if not(ignore_returncode) and (result.returncode != expected_returncode):\r\n            print(result.stdout.decode('utf-8'))\r\n>           assert False, \"Got unexpected return code {}\".format(result.returncode)\r\nE           AssertionError: Got unexpected return code -10\r\n\r\ntests/helpers.py:41: AssertionError\r\n------------------------------------------------- Captured stdout call --------------------------------------------------\r\n. > ./build/tests/test_kem HQC-192\r\n\r\n================================================ short test summary info ================================================\r\nFAILED tests/test_cmdline.py::test_kem[HQC-128] - AssertionError: Got unexpected return code -10\r\nFAILED tests/test_cmdline.py::test_kem[HQC-192] - AssertionError: Got unexpected return code -10\r\n====================================== 2 failed, 502 passed, 254 skipped in 44.37s ===============\r\n```","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/810357945","html_url":"https://github.com/open-quantum-safe/liboqs/issues/953#issuecomment-810357945","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953","id":810357945,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDM1Nzk0NQ==","user":{"login":"jschanck","id":25615540,"node_id":"MDQ6VXNlcjI1NjE1NTQw","avatar_url":"https://avatars.githubusercontent.com/u/25615540?v=4","gravatar_id":"","url":"https://api.github.com/users/jschanck","html_url":"https://github.com/jschanck","followers_url":"https://api.github.com/users/jschanck/followers","following_url":"https://api.github.com/users/jschanck/following{/other_user}","gists_url":"https://api.github.com/users/jschanck/gists{/gist_id}","starred_url":"https://api.github.com/users/jschanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jschanck/subscriptions","organizations_url":"https://api.github.com/users/jschanck/orgs","repos_url":"https://api.github.com/users/jschanck/repos","events_url":"https://api.github.com/users/jschanck/events{/privacy}","received_events_url":"https://api.github.com/users/jschanck/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T15:31:29Z","updated_at":"2021-03-30T15:31:29Z","author_association":"CONTRIBUTOR","body":"Strange to get a -10 return code here. Does this happen reliably on your system? What happens if you run `./build/test/test_kem HQC-128` directly?","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T15:31:29Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15747569273","type":"IssueCommentEvent","actor":{"id":5923577,"login":"mouse07410","display_login":"mouse07410","gravatar_id":"","url":"https://api.github.com/users/mouse07410","avatar_url":"https://avatars.githubusercontent.com/u/5923577?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/953","id":844709380,"node_id":"MDU6SXNzdWU4NDQ3MDkzODA=","number":953,"title":"Two tests fail on the current master","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2021-03-30T15:09:48Z","updated_at":"2021-03-30T15:42:32Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"MacOS Catalina 10.15.7, Xcode-12.4. Current master.\r\n\r\n```\r\n.  .  .  .  .\r\n======================================================= FAILURES ========================================================\r\n___________________________________________________ test_kem[HQC-128] ___________________________________________________\r\n[gw16] darwin -- Python 3.9.2 /opt/local/bin/python3\r\n\r\nkem_name = 'HQC-128'\r\n\r\n    @helpers.filtered_test\r\n    @pytest.mark.parametrize('kem_name', helpers.available_kems_by_name())\r\n    def test_kem(kem_name):\r\n        if not(helpers.is_kem_enabled_by_name(kem_name)): pytest.skip('Not enabled')\r\n>       helpers.run_subprocess(\r\n            [helpers.path_to_executable('test_kem'), kem_name],\r\n        )\r\n\r\ntests/test_cmdline.py:19: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n\r\ncommand = ['./build/tests/test_kem', 'HQC-128'], working_dir = '.'\r\nenv = {'ANT_OPTS': '-Dhttp.proxyHost=llproxy.llan.ll.mit.edu -Dhttp.proxyPort=8080', 'AS': 'yasm -m amd64 -f macho64 -p gas -X gnu ', 'AS_INTEGRATED_ASSEMBLER': '1', 'BASH_SILENCE_DEPRECATION_WARNING': '1', ...}\r\nexpected_returncode = 0, input = None, ignore_returncode = False\r\n\r\n    def run_subprocess(command, working_dir='.', env=None, expected_returncode=0, input=None, ignore_returncode=False):\r\n        \"\"\"\r\n        Helper function to run a shell command and report success/failure\r\n        depending on the exit status of the shell command.\r\n        \"\"\"\r\n        env_ = os.environ.copy()\r\n        if env is not None:\r\n            env_.update(env)\r\n        env = env_\r\n    \r\n        # Note we need to capture stdout/stderr from the subprocess,\r\n        # then print it, which pytest will then capture and\r\n        # buffer appropriately\r\n        print(working_dir + \" > \" + \" \".join(command))\r\n    \r\n        result = subprocess.run(\r\n                command,\r\n                input=input,\r\n                stdout=subprocess.PIPE,\r\n                stderr=subprocess.STDOUT,\r\n                cwd=working_dir,\r\n                env=env,\r\n            )\r\n    \r\n        if not(ignore_returncode) and (result.returncode != expected_returncode):\r\n            print(result.stdout.decode('utf-8'))\r\n>           assert False, \"Got unexpected return code {}\".format(result.returncode)\r\nE           AssertionError: Got unexpected return code -10\r\n\r\ntests/helpers.py:41: AssertionError\r\n------------------------------------------------- Captured stdout call --------------------------------------------------\r\n. > ./build/tests/test_kem HQC-128\r\n\r\n___________________________________________________ test_kem[HQC-192] ___________________________________________________\r\n[gw17] darwin -- Python 3.9.2 /opt/local/bin/python3\r\n\r\nkem_name = 'HQC-192'\r\n\r\n    @helpers.filtered_test\r\n    @pytest.mark.parametrize('kem_name', helpers.available_kems_by_name())\r\n    def test_kem(kem_name):\r\n        if not(helpers.is_kem_enabled_by_name(kem_name)): pytest.skip('Not enabled')\r\n>       helpers.run_subprocess(\r\n            [helpers.path_to_executable('test_kem'), kem_name],\r\n        )\r\n\r\ntests/test_cmdline.py:19: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n\r\ncommand = ['./build/tests/test_kem', 'HQC-192'], working_dir = '.'\r\nenv = {'ANT_OPTS': '-Dhttp.proxyHost=llproxy.llan.ll.mit.edu -Dhttp.proxyPort=8080', 'AS': 'yasm -m amd64 -f macho64 -p gas -X gnu ', 'AS_INTEGRATED_ASSEMBLER': '1', 'BASH_SILENCE_DEPRECATION_WARNING': '1', ...}\r\nexpected_returncode = 0, input = None, ignore_returncode = False\r\n\r\n    def run_subprocess(command, working_dir='.', env=None, expected_returncode=0, input=None, ignore_returncode=False):\r\n        \"\"\"\r\n        Helper function to run a shell command and report success/failure\r\n        depending on the exit status of the shell command.\r\n        \"\"\"\r\n        env_ = os.environ.copy()\r\n        if env is not None:\r\n            env_.update(env)\r\n        env = env_\r\n    \r\n        # Note we need to capture stdout/stderr from the subprocess,\r\n        # then print it, which pytest will then capture and\r\n        # buffer appropriately\r\n        print(working_dir + \" > \" + \" \".join(command))\r\n    \r\n        result = subprocess.run(\r\n                command,\r\n                input=input,\r\n                stdout=subprocess.PIPE,\r\n                stderr=subprocess.STDOUT,\r\n                cwd=working_dir,\r\n                env=env,\r\n            )\r\n    \r\n        if not(ignore_returncode) and (result.returncode != expected_returncode):\r\n            print(result.stdout.decode('utf-8'))\r\n>           assert False, \"Got unexpected return code {}\".format(result.returncode)\r\nE           AssertionError: Got unexpected return code -10\r\n\r\ntests/helpers.py:41: AssertionError\r\n------------------------------------------------- Captured stdout call --------------------------------------------------\r\n. > ./build/tests/test_kem HQC-192\r\n\r\n================================================ short test summary info ================================================\r\nFAILED tests/test_cmdline.py::test_kem[HQC-128] - AssertionError: Got unexpected return code -10\r\nFAILED tests/test_cmdline.py::test_kem[HQC-192] - AssertionError: Got unexpected return code -10\r\n====================================== 2 failed, 502 passed, 254 skipped in 44.37s ===============\r\n```","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/810369846","html_url":"https://github.com/open-quantum-safe/liboqs/issues/953#issuecomment-810369846","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953","id":810369846,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDM2OTg0Ng==","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T15:42:32Z","updated_at":"2021-03-30T15:42:32Z","author_association":"NONE","body":"> Strange to get a -10 return code here. Does this happen reliably on your system? \r\n\r\nIt happened reliably on *two* different systems (running the same software).\r\n\r\n> What happens if you run `./build/tests/test_kem HQC-128` directly?\r\n\r\n```\r\n$ ./build/tests/test_kem HQC-128\r\nConfiguration info\r\n==================\r\nTarget platform:  x86_64-Darwin-19.6.0\r\nCompiler:         clang (12.0.0 (clang-1200.0.32.29))\r\nCompile options:  [-Werror;-Wall;-Wextra;-Wpedantic;-Wno-unused-command-line-argument;-O3;-fomit-frame-pointer;-Wbad-function-cast;-Wcast-qual;-Wnarrowing;-Wconversion]\r\nOQS version:      0.6.0-dev\r\nGit commit:       3f2da47b366e241641ac2a08c85543200a6302ff\r\nOpenSSL enabled:  Yes (OpenSSL 1.1.1k  25 Mar 2021)\r\nAES:              OpenSSL\r\nSHA-2:            OpenSSL\r\nSHA-3:            C\r\nCPU exts active:  AES-AVX-AVX2-BMI1-BMI2-POPCNT-SSE-SSE2-SSE3 (portable build)\r\n\r\n================================================================================\r\nSample computation for KEM HQC-128\r\n================================================================================\r\nzsh: bus error  ./build/tests/test_kem HQC-128\r\n```\r\n\r\nAnd here's an excerpt from the crash report:\r\n```\r\nProcess:               test_kem [61973]\r\nPath:                  /Users/USER/*/test_kem\r\nIdentifier:            test_kem\r\nVersion:               0\r\nCode Type:             X86-64 (Native)\r\nParent Process:        zsh [8220]\r\nResponsible:           Terminal [7870]\r\nUser ID:               501\r\n\r\nDate/Time:             2021-03-30 11:38:27.787 -0400\r\nOS Version:            Mac OS X 10.15.7 (19H524)\r\nReport Version:        12\r\nBridge OS Version:     5.2 (18P4346)\r\nAnonymous UUID:        BD844EB9-9C6F-867E-78EB-1ACDA55970A0\r\n\r\n\r\nTime Awake Since Boot: 610000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        1\r\n\r\nException Type:        EXC_BAD_ACCESS (SIGBUS)\r\nException Codes:       KERN_PROTECTION_FAILURE at 0x0000700001e98ff8\r\nException Note:        EXC_CORPSE_NOTIFY\r\n\r\nTermination Signal:    Bus error: 10\r\nTermination Reason:    Namespace SIGNAL, Code 0xa\r\nTerminating Process:   exc handler [61973]\r\n\r\nVM Regions Near 0x700001e98ff8:\r\n    __LINKEDIT             00000001116db000-0000000111713000 [  224K] r--/r-- SM=COW  /usr/lib/dyld\r\n--> STACK GUARD            0000700001e98000-0000700001e99000 [    4K] ---/rwx SM=NUL  stack guard for thread 1\r\n    Stack                  0000700001e99000-0000700001f1b000 [  520K] rw-/rwx SM=COW  thread 1\r\n\r\nApplication Specific Information:\r\ndyld2 mode\r\n\r\nThread 0:: Dispatch queue: com.apple.main-thread\r\n0   libsystem_kernel.dylib        \t0x00007fff6dda055e __ulock_wait + 10\r\n1   libsystem_pthread.dylib       \t0x00007fff6de635c2 _pthread_join + 347\r\n2   test_kem                      \t0x000000010b7c48ea main + 1210\r\n\r\nThread 1 Crashed:\r\n0   libsystem_pthread.dylib       \t0x00007fff6de5dbc7 ___chkstk_darwin + 55\r\n1   liboqs.0.6.0-dev.dylib        \t0x000000010bc18578 PQCLEAN_HQCRMRS128_AVX2_hqc_pke_keygen + 392\r\n2   liboqs.0.6.0-dev.dylib        \t0x000000010bc18996 PQCLEAN_HQCRMRS128_AVX2_crypto_kem_keypair + 6\r\n\r\nThread 1 crashed with X86 Thread State (64-bit):\r\n  rax: 0x0000000000123660  rbx: 0x0000700001f17260  rcx: 0x0000700001e99000  rdx: 0x0000700001f17260\r\n  rdi: 0x0000700001f16060  rsi: 0x0000700001f17b60  rbp: 0x0000700001f16030  rsp: 0x0000700001f15ff0\r\n   r8: 0x00000000000008a0   r9: 0x0000000000000114  r10: 0x00000000000008a0  r11: 0xffffffffffffd230\r\n  r12: 0x0000700001f18460  r13: 0x0000700001f18d60  r14: 0x0000700001f17b60  r15: 0x0000700001f16060\r\n  rip: 0x00007fff6de5dbc7  rfl: 0x0000000000010206  cr2: 0x0000700001e98ff8\r\n  \r\nLogical CPU:     0\r\nError Code:      0x00000004 (no mapping for user data read)\r\nTrap Number:     14\r\n.  .  .  .  .\r\n```\r\n\r\nI do recall that the later Mac Xcode had more stringent treatment of the stack alignment, and `liboqs` is notorious for playing with pointer alignments :-( \r\nStill, out of *all* the included implementations, HQC is the only one that barfed.\r\n","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T15:42:32Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"15747876364","type":"IssueCommentEvent","actor":{"id":25615540,"login":"jschanck","display_login":"jschanck","gravatar_id":"","url":"https://api.github.com/users/jschanck","avatar_url":"https://avatars.githubusercontent.com/u/25615540?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/953","id":844709380,"node_id":"MDU6SXNzdWU4NDQ3MDkzODA=","number":953,"title":"Two tests fail on the current master","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-03-30T15:09:48Z","updated_at":"2021-03-30T15:59:18Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"MacOS Catalina 10.15.7, Xcode-12.4. Current master.\r\n\r\n```\r\n.  .  .  .  .\r\n======================================================= FAILURES ========================================================\r\n___________________________________________________ test_kem[HQC-128] ___________________________________________________\r\n[gw16] darwin -- Python 3.9.2 /opt/local/bin/python3\r\n\r\nkem_name = 'HQC-128'\r\n\r\n    @helpers.filtered_test\r\n    @pytest.mark.parametrize('kem_name', helpers.available_kems_by_name())\r\n    def test_kem(kem_name):\r\n        if not(helpers.is_kem_enabled_by_name(kem_name)): pytest.skip('Not enabled')\r\n>       helpers.run_subprocess(\r\n            [helpers.path_to_executable('test_kem'), kem_name],\r\n        )\r\n\r\ntests/test_cmdline.py:19: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n\r\ncommand = ['./build/tests/test_kem', 'HQC-128'], working_dir = '.'\r\nenv = {'ANT_OPTS': '-Dhttp.proxyHost=llproxy.llan.ll.mit.edu -Dhttp.proxyPort=8080', 'AS': 'yasm -m amd64 -f macho64 -p gas -X gnu ', 'AS_INTEGRATED_ASSEMBLER': '1', 'BASH_SILENCE_DEPRECATION_WARNING': '1', ...}\r\nexpected_returncode = 0, input = None, ignore_returncode = False\r\n\r\n    def run_subprocess(command, working_dir='.', env=None, expected_returncode=0, input=None, ignore_returncode=False):\r\n        \"\"\"\r\n        Helper function to run a shell command and report success/failure\r\n        depending on the exit status of the shell command.\r\n        \"\"\"\r\n        env_ = os.environ.copy()\r\n        if env is not None:\r\n            env_.update(env)\r\n        env = env_\r\n    \r\n        # Note we need to capture stdout/stderr from the subprocess,\r\n        # then print it, which pytest will then capture and\r\n        # buffer appropriately\r\n        print(working_dir + \" > \" + \" \".join(command))\r\n    \r\n        result = subprocess.run(\r\n                command,\r\n                input=input,\r\n                stdout=subprocess.PIPE,\r\n                stderr=subprocess.STDOUT,\r\n                cwd=working_dir,\r\n                env=env,\r\n            )\r\n    \r\n        if not(ignore_returncode) and (result.returncode != expected_returncode):\r\n            print(result.stdout.decode('utf-8'))\r\n>           assert False, \"Got unexpected return code {}\".format(result.returncode)\r\nE           AssertionError: Got unexpected return code -10\r\n\r\ntests/helpers.py:41: AssertionError\r\n------------------------------------------------- Captured stdout call --------------------------------------------------\r\n. > ./build/tests/test_kem HQC-128\r\n\r\n___________________________________________________ test_kem[HQC-192] ___________________________________________________\r\n[gw17] darwin -- Python 3.9.2 /opt/local/bin/python3\r\n\r\nkem_name = 'HQC-192'\r\n\r\n    @helpers.filtered_test\r\n    @pytest.mark.parametrize('kem_name', helpers.available_kems_by_name())\r\n    def test_kem(kem_name):\r\n        if not(helpers.is_kem_enabled_by_name(kem_name)): pytest.skip('Not enabled')\r\n>       helpers.run_subprocess(\r\n            [helpers.path_to_executable('test_kem'), kem_name],\r\n        )\r\n\r\ntests/test_cmdline.py:19: \r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n\r\ncommand = ['./build/tests/test_kem', 'HQC-192'], working_dir = '.'\r\nenv = {'ANT_OPTS': '-Dhttp.proxyHost=llproxy.llan.ll.mit.edu -Dhttp.proxyPort=8080', 'AS': 'yasm -m amd64 -f macho64 -p gas -X gnu ', 'AS_INTEGRATED_ASSEMBLER': '1', 'BASH_SILENCE_DEPRECATION_WARNING': '1', ...}\r\nexpected_returncode = 0, input = None, ignore_returncode = False\r\n\r\n    def run_subprocess(command, working_dir='.', env=None, expected_returncode=0, input=None, ignore_returncode=False):\r\n        \"\"\"\r\n        Helper function to run a shell command and report success/failure\r\n        depending on the exit status of the shell command.\r\n        \"\"\"\r\n        env_ = os.environ.copy()\r\n        if env is not None:\r\n            env_.update(env)\r\n        env = env_\r\n    \r\n        # Note we need to capture stdout/stderr from the subprocess,\r\n        # then print it, which pytest will then capture and\r\n        # buffer appropriately\r\n        print(working_dir + \" > \" + \" \".join(command))\r\n    \r\n        result = subprocess.run(\r\n                command,\r\n                input=input,\r\n                stdout=subprocess.PIPE,\r\n                stderr=subprocess.STDOUT,\r\n                cwd=working_dir,\r\n                env=env,\r\n            )\r\n    \r\n        if not(ignore_returncode) and (result.returncode != expected_returncode):\r\n            print(result.stdout.decode('utf-8'))\r\n>           assert False, \"Got unexpected return code {}\".format(result.returncode)\r\nE           AssertionError: Got unexpected return code -10\r\n\r\ntests/helpers.py:41: AssertionError\r\n------------------------------------------------- Captured stdout call --------------------------------------------------\r\n. > ./build/tests/test_kem HQC-192\r\n\r\n================================================ short test summary info ================================================\r\nFAILED tests/test_cmdline.py::test_kem[HQC-128] - AssertionError: Got unexpected return code -10\r\nFAILED tests/test_cmdline.py::test_kem[HQC-192] - AssertionError: Got unexpected return code -10\r\n====================================== 2 failed, 502 passed, 254 skipped in 44.37s ===============\r\n```","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/810382267","html_url":"https://github.com/open-quantum-safe/liboqs/issues/953#issuecomment-810382267","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/953","id":810382267,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMDM4MjI2Nw==","user":{"login":"jschanck","id":25615540,"node_id":"MDQ6VXNlcjI1NjE1NTQw","avatar_url":"https://avatars.githubusercontent.com/u/25615540?v=4","gravatar_id":"","url":"https://api.github.com/users/jschanck","html_url":"https://github.com/jschanck","followers_url":"https://api.github.com/users/jschanck/followers","following_url":"https://api.github.com/users/jschanck/following{/other_user}","gists_url":"https://api.github.com/users/jschanck/gists{/gist_id}","starred_url":"https://api.github.com/users/jschanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jschanck/subscriptions","organizations_url":"https://api.github.com/users/jschanck/orgs","repos_url":"https://api.github.com/users/jschanck/repos","events_url":"https://api.github.com/users/jschanck/events{/privacy}","received_events_url":"https://api.github.com/users/jschanck/received_events","type":"User","site_admin":false},"created_at":"2021-03-30T15:59:18Z","updated_at":"2021-03-30T15:59:18Z","author_association":"CONTRIBUTOR","body":"Upstream is aware of the issue and hopefully it will be fixed soon https://github.com/PQClean/PQClean/issues/375. ","performed_via_github_app":null}},"public":true,"created_at":"2021-03-30T15:59:19Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
