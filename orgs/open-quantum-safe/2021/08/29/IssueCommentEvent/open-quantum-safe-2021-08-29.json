{"id":"17758492990","type":"IssueCommentEvent","actor":{"id":36664211,"login":"vt-alt","display_login":"vt-alt","gravatar_id":"","url":"https://api.github.com/users/vt-alt","avatar_url":"https://avatars.githubusercontent.com/u/36664211?"},"repo":{"id":113904471,"name":"open-quantum-safe/openssh","url":"https://api.github.com/repos/open-quantum-safe/openssh"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111","repository_url":"https://api.github.com/repos/open-quantum-safe/openssh","labels_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111/events","html_url":"https://github.com/open-quantum-safe/openssh/issues/111","id":976457755,"node_id":"MDU6SXNzdWU5NzY0NTc3NTU=","number":111,"title":"ssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size","user":{"login":"vt-alt","id":36664211,"node_id":"MDQ6VXNlcjM2NjY0MjEx","avatar_url":"https://avatars.githubusercontent.com/u/36664211?v=4","gravatar_id":"","url":"https://api.github.com/users/vt-alt","html_url":"https://github.com/vt-alt","followers_url":"https://api.github.com/users/vt-alt/followers","following_url":"https://api.github.com/users/vt-alt/following{/other_user}","gists_url":"https://api.github.com/users/vt-alt/gists{/gist_id}","starred_url":"https://api.github.com/users/vt-alt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vt-alt/subscriptions","organizations_url":"https://api.github.com/users/vt-alt/orgs","repos_url":"https://api.github.com/users/vt-alt/repos","events_url":"https://api.github.com/users/vt-alt/events{/privacy}","received_events_url":"https://api.github.com/users/vt-alt/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-08-22T19:59:02Z","updated_at":"2021-08-29T08:27:12Z","closed_at":"2021-08-28T22:19:26Z","author_association":"NONE","active_lock_reason":null,"body":"After upgrading to OQS-OpenSSH-snapshot-2021-08 ssh-keygen crashes failing sshd.service.\r\n```\r\n# /usr/bin/ssh-keygen -A\r\nssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size\r\nAborted (core dumped)\r\n```\r\n```\r\n# gdb -q --args /usr/bin/ssh-keygen -A\r\nReading symbols from /usr/bin/ssh-keygen...\r\nReading symbols from /usr/lib/debug/usr/bin/ssh-keygen.debug...\r\n(gdb) r\r\nStarting program: /usr/bin/ssh-keygen -A\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\r\nssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size\r\n\r\nProgram received signal SIGABRT, Aborted.\r\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:49\r\n49        return ret;\r\n(gdb) bt\r\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:49\r\n#1  0x00007ffff72c6538 in __GI_abort () at abort.c:79\r\n#2  0x00007ffff731ee77 in __libc_message (action=action@entry=do_abort, fmt=fmt@entry=0x7ffff742f399 \"%s\\n\") at ../sysdeps/posix/libc_fatal.c:155\r\n#3  0x00007ffff732695c in malloc_printerr (str=str@entry=0x7ffff742d634 \"malloc(): corrupted top size\") at malloc.c:5389\r\n#4  0x00007ffff732a354 in _int_malloc (av=av@entry=0x7ffff7461a00 <main_arena>, bytes=bytes@entry=200) at malloc.c:4135\r\n#5  0x00007ffff732c161 in __libc_calloc (n=n@entry=1, elem_size=elem_size@entry=200) at malloc.c:3448\r\n#6  0x000055555556f6a8 in sshkey_new (type=19) at sshkey.c:689\r\n#7  0x00005555555713e2 in sshkey_from_private (k=0x5555555e4ff0, pkp=pkp@entry=0x7fffffffd698) at sshkey.c:2190\r\n#8  0x00005555555650f5 in do_gen_all_hostkeys (pw=pw@entry=0x5555555e47b0) at ssh-keygen.c:1247\r\n#9  0x0000555555560797 in main (argc=0, argv=0x7fffffffe4f8) at ssh-keygen.c:3788\r\n(gdb)\r\n```\r\nRun in valgrind does not crash but produces multiple warnings::\r\n```\r\n/etc/openquantumsafe-openssh# rm ./ssh_host_dilithium3_key\r\nrm: remove regular file './ssh_host_dilithium3_key'? y\r\n/etc/openquantumsafe-openssh# /usr/bin/ssh-keygen  -A\r\nssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size\r\nAborted (core dumped)\r\n/etc/openquantumsafe-openssh# valgrind /usr/bin/ssh-keygen  -A\r\n==14133== Memcheck, a memory error detector\r\n==14133== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\r\n==14133== Using Valgrind-3.17.0 and LibVEX; rerun with -h for copyright info\r\n==14133== Command: /usr/bin/ssh-keygen -A\r\n==14133==\r\nssh-keygen: generating new host keys: DILITHIUM_3 ==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DFD: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:896)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c10 is 0 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9E0E: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:899)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c12 is 2 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9E16: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:898)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c11 is 1 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D70: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:880)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c13 is 3 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D7E: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:882)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c14 is 4 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D8D: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:883)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c15 is 5 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D9F: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:885)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c16 is 6 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DB7: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:887)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c17 is 7 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DBB: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:888)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c18 is 8 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DC9: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:890)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c19 is 9 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DD7: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:891)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c1a is 10 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DE6: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:893)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c1b is 11 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DF9: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:895)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c1c is 12 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n\r\n==14133==\r\n==14133== HEAP SUMMARY:\r\n==14133==     in use at exit: 303 bytes in 8 blocks\r\n==14133==   total heap usage: 894 allocs, 886 frees, 353,146 bytes allocated\r\n==14133==\r\n==14133== LEAK SUMMARY:\r\n==14133==    definitely lost: 248 bytes in 2 blocks\r\n==14133==    indirectly lost: 44 bytes in 5 blocks\r\n==14133==      possibly lost: 0 bytes in 0 blocks\r\n==14133==    still reachable: 11 bytes in 1 blocks\r\n==14133==         suppressed: 0 bytes in 0 blocks\r\n==14133== Rerun with --leak-check=full to see details of leaked memory\r\n==14133==\r\n==14133== For lists of detected and suppressed errors, rerun with: -s\r\n==14133== ERROR SUMMARY: 16 errors from 13 contexts (suppressed: 0 from 0)\r\n```\r\n","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/comments/907751920","html_url":"https://github.com/open-quantum-safe/openssh/issues/111#issuecomment-907751920","issue_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111","id":907751920,"node_id":"IC_kwDOBsoLV842GzHw","user":{"login":"vt-alt","id":36664211,"node_id":"MDQ6VXNlcjM2NjY0MjEx","avatar_url":"https://avatars.githubusercontent.com/u/36664211?v=4","gravatar_id":"","url":"https://api.github.com/users/vt-alt","html_url":"https://github.com/vt-alt","followers_url":"https://api.github.com/users/vt-alt/followers","following_url":"https://api.github.com/users/vt-alt/following{/other_user}","gists_url":"https://api.github.com/users/vt-alt/gists{/gist_id}","starred_url":"https://api.github.com/users/vt-alt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vt-alt/subscriptions","organizations_url":"https://api.github.com/users/vt-alt/orgs","repos_url":"https://api.github.com/users/vt-alt/repos","events_url":"https://api.github.com/users/vt-alt/events{/privacy}","received_events_url":"https://api.github.com/users/vt-alt/received_events","type":"User","site_admin":false},"created_at":"2021-08-29T08:27:12Z","updated_at":"2021-08-29T08:27:12Z","author_association":"NONE","body":"I try to think over this problem, and I think it's partly because of incorrect _library versioning_ of the `liboqs`. Currently, it just mirrors it project versioning, but library versioning (or 'API versioning') is a different thing and should be maintained separately. See https://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html\r\nCmake have SOVERSION attribute for this too.\r\n\r\n`liboqs` _library_ versions change like 0.5.0, 0.6.0, 0.7.0 which meant (in all these releases) that in its API only new functions are added and no backward incompatible changes happened. Which seems incorrect.\r\n\r\nMore links on the subject:\r\nhttps://stackoverflow.com/questions/12637841/what-is-the-soname-option-for-building-shared-libraries-for\r\nhttps://cmake.org/cmake/help/latest/prop_tgt/SOVERSION.html\r\n\r\nThere is tool to compare ABIs (it may not catch all subtle changes though):\r\n```\r\n$ abipkgdiff liboqs-0.4.0-alt1.x86_64.rpm --d1 liboqs-debuginfo-0.4.0-alt1.x86_64.rpm \\\r\n             liboqs-0.7.0-alt1.x86_64.rpm --d2 liboqs-debuginfo-0.7.0-alt1.x86_64.rpm\r\n================ changes of 'liboqs.so.0.5.0-dev'===============\r\n  Functions changes summary: 2 Removed, 0 Changed (45 filtered out), 2 Added functions\r\n  Variables changes summary: 0 Removed, 0 Changed, 0 Added variable\r\n  Function symbols changes summary: 0 Removed, 12 Added function symbols not referenced by debug info\r\n  Variable symbols changes summary: 0 Removed, 0 Added variable symbol not referenced by debug info\r\n\r\n  2 Removed functions:\r\n\r\n    [D] 'function OQS_CPU_EXTENSIONS OQS_get_available_CPU_extensions()'    {OQS_get_available_CPU_extensions}\r\n    [D] 'function const char* OQS_get_cpu_extension_name(unsigned int)'    {OQS_get_cpu_extension_name}\r\n\r\n  2 Added functions:\r\n\r\n    [A] 'function int OQS_CPU_has_extension(OQS_CPU_EXT)'    {OQS_CPU_has_extension}\r\n    [A] 'function int OQS_MEM_secure_bcmp(void*, void*, size_t)'    {OQS_MEM_secure_bcmp}\r\n\r\n  12 Added function symbols not referenced by debug info:\r\n\r\n    [A] KeccakF1600_FastLoop_Absorb_avx2\r\n    [A] KeccakP1600_12rounds_FastLoop_Absorb_avx2\r\n    [A] KeccakP1600_AddByte_avx2\r\n    [A] KeccakP1600_AddBytes_avx2\r\n    [A] KeccakP1600_ExtractAndAddBytes_avx2\r\n    [A] KeccakP1600_ExtractBytes_avx2\r\n    [A] KeccakP1600_Initialize_avx2\r\n    [A] KeccakP1600_OverwriteBytes_avx2\r\n    [A] KeccakP1600_OverwriteWithZeroes_avx2\r\n    [A] KeccakP1600_Permute_12rounds_avx2\r\n    [A] KeccakP1600_Permute_24rounds_avx2\r\n    [A] KeccakP1600_Permute_Nrounds_avx2\r\n\r\n================ end of changes of 'liboqs.so.0.5.0-dev'===============\r\n```\r\n\r\nCertainly, functions removal is backward incompatible change to the library, so major library version should have been incremented.\r\n","performed_via_github_app":null}},"public":true,"created_at":"2021-08-29T08:27:12Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"17759131516","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":113904471,"name":"open-quantum-safe/openssh","url":"https://api.github.com/repos/open-quantum-safe/openssh"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111","repository_url":"https://api.github.com/repos/open-quantum-safe/openssh","labels_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111/events","html_url":"https://github.com/open-quantum-safe/openssh/issues/111","id":976457755,"node_id":"MDU6SXNzdWU5NzY0NTc3NTU=","number":111,"title":"ssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size","user":{"login":"vt-alt","id":36664211,"node_id":"MDQ6VXNlcjM2NjY0MjEx","avatar_url":"https://avatars.githubusercontent.com/u/36664211?v=4","gravatar_id":"","url":"https://api.github.com/users/vt-alt","html_url":"https://github.com/vt-alt","followers_url":"https://api.github.com/users/vt-alt/followers","following_url":"https://api.github.com/users/vt-alt/following{/other_user}","gists_url":"https://api.github.com/users/vt-alt/gists{/gist_id}","starred_url":"https://api.github.com/users/vt-alt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vt-alt/subscriptions","organizations_url":"https://api.github.com/users/vt-alt/orgs","repos_url":"https://api.github.com/users/vt-alt/repos","events_url":"https://api.github.com/users/vt-alt/events{/privacy}","received_events_url":"https://api.github.com/users/vt-alt/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2021-08-22T19:59:02Z","updated_at":"2021-08-29T10:59:58Z","closed_at":"2021-08-28T22:19:26Z","author_association":"NONE","active_lock_reason":null,"body":"After upgrading to OQS-OpenSSH-snapshot-2021-08 ssh-keygen crashes failing sshd.service.\r\n```\r\n# /usr/bin/ssh-keygen -A\r\nssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size\r\nAborted (core dumped)\r\n```\r\n```\r\n# gdb -q --args /usr/bin/ssh-keygen -A\r\nReading symbols from /usr/bin/ssh-keygen...\r\nReading symbols from /usr/lib/debug/usr/bin/ssh-keygen.debug...\r\n(gdb) r\r\nStarting program: /usr/bin/ssh-keygen -A\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\r\nssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size\r\n\r\nProgram received signal SIGABRT, Aborted.\r\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:49\r\n49        return ret;\r\n(gdb) bt\r\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:49\r\n#1  0x00007ffff72c6538 in __GI_abort () at abort.c:79\r\n#2  0x00007ffff731ee77 in __libc_message (action=action@entry=do_abort, fmt=fmt@entry=0x7ffff742f399 \"%s\\n\") at ../sysdeps/posix/libc_fatal.c:155\r\n#3  0x00007ffff732695c in malloc_printerr (str=str@entry=0x7ffff742d634 \"malloc(): corrupted top size\") at malloc.c:5389\r\n#4  0x00007ffff732a354 in _int_malloc (av=av@entry=0x7ffff7461a00 <main_arena>, bytes=bytes@entry=200) at malloc.c:4135\r\n#5  0x00007ffff732c161 in __libc_calloc (n=n@entry=1, elem_size=elem_size@entry=200) at malloc.c:3448\r\n#6  0x000055555556f6a8 in sshkey_new (type=19) at sshkey.c:689\r\n#7  0x00005555555713e2 in sshkey_from_private (k=0x5555555e4ff0, pkp=pkp@entry=0x7fffffffd698) at sshkey.c:2190\r\n#8  0x00005555555650f5 in do_gen_all_hostkeys (pw=pw@entry=0x5555555e47b0) at ssh-keygen.c:1247\r\n#9  0x0000555555560797 in main (argc=0, argv=0x7fffffffe4f8) at ssh-keygen.c:3788\r\n(gdb)\r\n```\r\nRun in valgrind does not crash but produces multiple warnings::\r\n```\r\n/etc/openquantumsafe-openssh# rm ./ssh_host_dilithium3_key\r\nrm: remove regular file './ssh_host_dilithium3_key'? y\r\n/etc/openquantumsafe-openssh# /usr/bin/ssh-keygen  -A\r\nssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size\r\nAborted (core dumped)\r\n/etc/openquantumsafe-openssh# valgrind /usr/bin/ssh-keygen  -A\r\n==14133== Memcheck, a memory error detector\r\n==14133== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\r\n==14133== Using Valgrind-3.17.0 and LibVEX; rerun with -h for copyright info\r\n==14133== Command: /usr/bin/ssh-keygen -A\r\n==14133==\r\nssh-keygen: generating new host keys: DILITHIUM_3 ==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DFD: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:896)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c10 is 0 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9E0E: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:899)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c12 is 2 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9E16: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:898)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c11 is 1 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D70: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:880)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c13 is 3 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D7E: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:882)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c14 is 4 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D8D: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:883)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c15 is 5 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D9F: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:885)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c16 is 6 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DB7: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:887)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c17 is 7 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DBB: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:888)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c18 is 8 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DC9: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:890)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c19 is 9 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DD7: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:891)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c1a is 10 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DE6: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:893)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c1b is 11 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DF9: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:895)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c1c is 12 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n\r\n==14133==\r\n==14133== HEAP SUMMARY:\r\n==14133==     in use at exit: 303 bytes in 8 blocks\r\n==14133==   total heap usage: 894 allocs, 886 frees, 353,146 bytes allocated\r\n==14133==\r\n==14133== LEAK SUMMARY:\r\n==14133==    definitely lost: 248 bytes in 2 blocks\r\n==14133==    indirectly lost: 44 bytes in 5 blocks\r\n==14133==      possibly lost: 0 bytes in 0 blocks\r\n==14133==    still reachable: 11 bytes in 1 blocks\r\n==14133==         suppressed: 0 bytes in 0 blocks\r\n==14133== Rerun with --leak-check=full to see details of leaked memory\r\n==14133==\r\n==14133== For lists of detected and suppressed errors, rerun with: -s\r\n==14133== ERROR SUMMARY: 16 errors from 13 contexts (suppressed: 0 from 0)\r\n```\r\n","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/comments/907771986","html_url":"https://github.com/open-quantum-safe/openssh/issues/111#issuecomment-907771986","issue_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111","id":907771986,"node_id":"IC_kwDOBsoLV842G4BS","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2021-08-29T10:59:58Z","updated_at":"2021-08-29T10:59:58Z","author_association":"MEMBER","body":"Thanks very much for the pointers and education. I tend to agree that we're indeed not following reasonable practices.\r\n\r\n> Certainly, functions removal is backward incompatible change to the library, so major library version should have been incremented.\r\n\r\nPersonally I tend to agree and we'd need to improve. The function removal pointed out above also comes a bit as a surprise to me.\r\n\r\n--> Would you want to rename (and re-open) this issue or create a separate new one only highlighting this library versioning issue?","performed_via_github_app":null}},"public":true,"created_at":"2021-08-29T10:59:58Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"17762218466","type":"IssueCommentEvent","actor":{"id":36664211,"login":"vt-alt","display_login":"vt-alt","gravatar_id":"","url":"https://api.github.com/users/vt-alt","avatar_url":"https://avatars.githubusercontent.com/u/36664211?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1081","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1081/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1081/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1081/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1081","id":982093901,"node_id":"MDU6SXNzdWU5ODIwOTM5MDE=","number":1081,"title":"Shared library versioning scheme (SOVERSION)","user":{"login":"vt-alt","id":36664211,"node_id":"MDQ6VXNlcjM2NjY0MjEx","avatar_url":"https://avatars.githubusercontent.com/u/36664211?v=4","gravatar_id":"","url":"https://api.github.com/users/vt-alt","html_url":"https://github.com/vt-alt","followers_url":"https://api.github.com/users/vt-alt/followers","following_url":"https://api.github.com/users/vt-alt/following{/other_user}","gists_url":"https://api.github.com/users/vt-alt/gists{/gist_id}","starred_url":"https://api.github.com/users/vt-alt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vt-alt/subscriptions","organizations_url":"https://api.github.com/users/vt-alt/orgs","repos_url":"https://api.github.com/users/vt-alt/repos","events_url":"https://api.github.com/users/vt-alt/events{/privacy}","received_events_url":"https://api.github.com/users/vt-alt/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2021-08-29T13:03:22Z","updated_at":"2021-08-29T22:38:14Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"As pointed there https://github.com/open-quantum-safe/openssh/issues/111#issuecomment-907751920 `liboqs` would benefit from proper _library versioning_. (Sometimes called _API version_ or _SOVERSION_). This is different thing than usual project versioning. It's purpose to maintain binary (ABI) compatibility between executable binaries and shared libraries. Currently, liboqs just copy project version into SOVERSION which does not reflect backward incompatible ABI changes (which may cause obscure program errors when binary that is linked to a newer library used on system with older library — current versioning allows this, because major version number (that signifying backward-incompatible ABI change) is not incremented (while library does have backward incompatible ABI changes).\r\n\r\nReferences:\r\n* General explanation https://stackoverflow.com/questions/12637841/what-is-the-soname-option-for-building-shared-libraries-for\r\n* GNU tooling https://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html (Note that their `-version-info` arguments order is different from what will actually appear in the library suffix - they say `current:revision:age`, but library will be named like `liboqs.so..current.age.revision`).\r\n* Cmake property https://cmake.org/cmake/help/latest/prop_tgt/SOVERSION.html\r\n\r\n","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/907888307","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1081#issuecomment-907888307","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1081","id":907888307,"node_id":"IC_kwDOA-eq3c42HUaz","user":{"login":"vt-alt","id":36664211,"node_id":"MDQ6VXNlcjM2NjY0MjEx","avatar_url":"https://avatars.githubusercontent.com/u/36664211?v=4","gravatar_id":"","url":"https://api.github.com/users/vt-alt","html_url":"https://github.com/vt-alt","followers_url":"https://api.github.com/users/vt-alt/followers","following_url":"https://api.github.com/users/vt-alt/following{/other_user}","gists_url":"https://api.github.com/users/vt-alt/gists{/gist_id}","starred_url":"https://api.github.com/users/vt-alt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vt-alt/subscriptions","organizations_url":"https://api.github.com/users/vt-alt/orgs","repos_url":"https://api.github.com/users/vt-alt/repos","events_url":"https://api.github.com/users/vt-alt/events{/privacy}","received_events_url":"https://api.github.com/users/vt-alt/received_events","type":"User","site_admin":false},"created_at":"2021-08-29T22:38:14Z","updated_at":"2021-08-29T22:38:14Z","author_association":"CONTRIBUTOR","body":"I found you currently using `SOVERSION 0` in `src/CMakeLists.txt` for `oqs` target. Perhaps, you just need to increment it sometimes. I tried already — it looked unusual in compare to what libtool does, but seems valid too. I tried to set `SOVERSION` to `1`. It creates [SONAME](https://en.wikipedia.org/wiki/Soname) `liboqs.so.1` with symlink to `liboqs.so.0.7.0`. In that case binaries will link to `liboqs.so.1` which is good.\r\n","performed_via_github_app":null}},"public":true,"created_at":"2021-08-29T22:38:14Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"17762339152","type":"IssueCommentEvent","actor":{"id":36664211,"login":"vt-alt","display_login":"vt-alt","gravatar_id":"","url":"https://api.github.com/users/vt-alt","avatar_url":"https://avatars.githubusercontent.com/u/36664211?"},"repo":{"id":113904471,"name":"open-quantum-safe/openssh","url":"https://api.github.com/repos/open-quantum-safe/openssh"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111","repository_url":"https://api.github.com/repos/open-quantum-safe/openssh","labels_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111/events","html_url":"https://github.com/open-quantum-safe/openssh/issues/111","id":976457755,"node_id":"MDU6SXNzdWU5NzY0NTc3NTU=","number":111,"title":"ssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size","user":{"login":"vt-alt","id":36664211,"node_id":"MDQ6VXNlcjM2NjY0MjEx","avatar_url":"https://avatars.githubusercontent.com/u/36664211?v=4","gravatar_id":"","url":"https://api.github.com/users/vt-alt","html_url":"https://github.com/vt-alt","followers_url":"https://api.github.com/users/vt-alt/followers","following_url":"https://api.github.com/users/vt-alt/following{/other_user}","gists_url":"https://api.github.com/users/vt-alt/gists{/gist_id}","starred_url":"https://api.github.com/users/vt-alt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vt-alt/subscriptions","organizations_url":"https://api.github.com/users/vt-alt/orgs","repos_url":"https://api.github.com/users/vt-alt/repos","events_url":"https://api.github.com/users/vt-alt/events{/privacy}","received_events_url":"https://api.github.com/users/vt-alt/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2021-08-22T19:59:02Z","updated_at":"2021-08-29T23:09:39Z","closed_at":"2021-08-28T22:19:26Z","author_association":"NONE","active_lock_reason":null,"body":"After upgrading to OQS-OpenSSH-snapshot-2021-08 ssh-keygen crashes failing sshd.service.\r\n```\r\n# /usr/bin/ssh-keygen -A\r\nssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size\r\nAborted (core dumped)\r\n```\r\n```\r\n# gdb -q --args /usr/bin/ssh-keygen -A\r\nReading symbols from /usr/bin/ssh-keygen...\r\nReading symbols from /usr/lib/debug/usr/bin/ssh-keygen.debug...\r\n(gdb) r\r\nStarting program: /usr/bin/ssh-keygen -A\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib64/libthread_db.so.1\".\r\nssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size\r\n\r\nProgram received signal SIGABRT, Aborted.\r\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:49\r\n49        return ret;\r\n(gdb) bt\r\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:49\r\n#1  0x00007ffff72c6538 in __GI_abort () at abort.c:79\r\n#2  0x00007ffff731ee77 in __libc_message (action=action@entry=do_abort, fmt=fmt@entry=0x7ffff742f399 \"%s\\n\") at ../sysdeps/posix/libc_fatal.c:155\r\n#3  0x00007ffff732695c in malloc_printerr (str=str@entry=0x7ffff742d634 \"malloc(): corrupted top size\") at malloc.c:5389\r\n#4  0x00007ffff732a354 in _int_malloc (av=av@entry=0x7ffff7461a00 <main_arena>, bytes=bytes@entry=200) at malloc.c:4135\r\n#5  0x00007ffff732c161 in __libc_calloc (n=n@entry=1, elem_size=elem_size@entry=200) at malloc.c:3448\r\n#6  0x000055555556f6a8 in sshkey_new (type=19) at sshkey.c:689\r\n#7  0x00005555555713e2 in sshkey_from_private (k=0x5555555e4ff0, pkp=pkp@entry=0x7fffffffd698) at sshkey.c:2190\r\n#8  0x00005555555650f5 in do_gen_all_hostkeys (pw=pw@entry=0x5555555e47b0) at ssh-keygen.c:1247\r\n#9  0x0000555555560797 in main (argc=0, argv=0x7fffffffe4f8) at ssh-keygen.c:3788\r\n(gdb)\r\n```\r\nRun in valgrind does not crash but produces multiple warnings::\r\n```\r\n/etc/openquantumsafe-openssh# rm ./ssh_host_dilithium3_key\r\nrm: remove regular file './ssh_host_dilithium3_key'? y\r\n/etc/openquantumsafe-openssh# /usr/bin/ssh-keygen  -A\r\nssh-keygen: generating new host keys: DILITHIUM_3 malloc(): corrupted top size\r\nAborted (core dumped)\r\n/etc/openquantumsafe-openssh# valgrind /usr/bin/ssh-keygen  -A\r\n==14133== Memcheck, a memory error detector\r\n==14133== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.\r\n==14133== Using Valgrind-3.17.0 and LibVEX; rerun with -h for copyright info\r\n==14133== Command: /usr/bin/ssh-keygen -A\r\n==14133==\r\nssh-keygen: generating new host keys: DILITHIUM_3 ==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DFD: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:896)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c10 is 0 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9E0E: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:899)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c12 is 2 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9E16: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:898)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c11 is 1 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D70: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:880)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c13 is 3 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D7E: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:882)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c14 is 4 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D8D: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:883)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c15 is 5 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9D9F: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:885)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c16 is 6 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DB7: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:887)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c17 is 7 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DBB: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:888)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c18 is 8 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DC9: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:890)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c19 is 9 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DD7: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:891)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c1a is 10 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DE6: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:893)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c1b is 11 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n==14133== Invalid write of size 1\r\n==14133==    at 0x4AE9DF9: pqcrystals_dilithium3_avx2_polyt0_pack (poly.c:895)\r\n==14133==    by 0x4AEB750: pqcrystals_dilithium3_avx2_keypair (sign.c:164)\r\n==14133==    by 0x12523C: sshkey_generate (sshkey.c:2066)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==  Address 0x5618c1c is 12 bytes after a block of size 4,000 alloc'd\r\n==14133==    at 0x483C79B: malloc (vg_replace_malloc.c:380)\r\n==14133==    by 0x124FA6: sshkey_generate (sshkey.c:2012)\r\n==14133==    by 0x1190DD: do_gen_all_hostkeys (ssh-keygen.c:1243)\r\n==14133==    by 0x114796: main (ssh-keygen.c:3788)\r\n==14133==\r\n\r\n==14133==\r\n==14133== HEAP SUMMARY:\r\n==14133==     in use at exit: 303 bytes in 8 blocks\r\n==14133==   total heap usage: 894 allocs, 886 frees, 353,146 bytes allocated\r\n==14133==\r\n==14133== LEAK SUMMARY:\r\n==14133==    definitely lost: 248 bytes in 2 blocks\r\n==14133==    indirectly lost: 44 bytes in 5 blocks\r\n==14133==      possibly lost: 0 bytes in 0 blocks\r\n==14133==    still reachable: 11 bytes in 1 blocks\r\n==14133==         suppressed: 0 bytes in 0 blocks\r\n==14133== Rerun with --leak-check=full to see details of leaked memory\r\n==14133==\r\n==14133== For lists of detected and suppressed errors, rerun with: -s\r\n==14133== ERROR SUMMARY: 16 errors from 13 contexts (suppressed: 0 from 0)\r\n```\r\n","performed_via_github_app":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/comments/907893794","html_url":"https://github.com/open-quantum-safe/openssh/issues/111#issuecomment-907893794","issue_url":"https://api.github.com/repos/open-quantum-safe/openssh/issues/111","id":907893794,"node_id":"IC_kwDOBsoLV842HVwi","user":{"login":"vt-alt","id":36664211,"node_id":"MDQ6VXNlcjM2NjY0MjEx","avatar_url":"https://avatars.githubusercontent.com/u/36664211?v=4","gravatar_id":"","url":"https://api.github.com/users/vt-alt","html_url":"https://github.com/vt-alt","followers_url":"https://api.github.com/users/vt-alt/followers","following_url":"https://api.github.com/users/vt-alt/following{/other_user}","gists_url":"https://api.github.com/users/vt-alt/gists{/gist_id}","starred_url":"https://api.github.com/users/vt-alt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vt-alt/subscriptions","organizations_url":"https://api.github.com/users/vt-alt/orgs","repos_url":"https://api.github.com/users/vt-alt/repos","events_url":"https://api.github.com/users/vt-alt/events{/privacy}","received_events_url":"https://api.github.com/users/vt-alt/received_events","type":"User","site_admin":false},"created_at":"2021-08-29T23:09:39Z","updated_at":"2021-08-29T23:09:39Z","author_association":"NONE","body":"JFYI. To fix the problem with our package I just increased `SOVERSION` of liboqs to `1` (see the patch below) and rebuilt both liboqs 0.7.0 and OQS openssh 8.6p1.202108 so they get linked properly and would be updated in accord. (That solution looked better than manually setting version dependency).\r\n\r\n```\r\ndiff --git a/src/CMakeLists.txt b/src/CMakeLists.txt\r\nindex a68c5619..01cf1e73 100644\r\n--- a/src/CMakeLists.txt\r\n+++ b/src/CMakeLists.txt\r\n@@ -84,7 +84,7 @@ set_target_properties(oqs\r\n     ARCHIVE_OUTPUT_DIRECTORY \"${CMAKE_BINARY_DIR}/lib\"\r\n     LIBRARY_OUTPUT_DIRECTORY \"${CMAKE_BINARY_DIR}/lib\"\r\n     VERSION ${OQS_VERSION_TEXT}\r\n-    SOVERSION 0\r\n+    SOVERSION 1\r\n     # For Windows DLLs\r\n     RUNTIME_OUTPUT_DIRECTORY \"${CMAKE_BINARY_DIR}/bin\")\r\n\r\n```","performed_via_github_app":null}},"public":true,"created_at":"2021-08-29T23:09:39Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
