{"id":"25259997746","type":"IssuesEvent","actor":{"id":8843219,"login":"dstebila","display_login":"dstebila","gravatar_id":"","url":"https://api.github.com/users/dstebila","avatar_url":"https://avatars.githubusercontent.com/u/8843219?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"closed","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1304","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1304/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1304/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1304/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1304","id":1372236460,"node_id":"I_kwDOA-eq3c5Ryqqs","number":1304,"title":"Inconsistencies in optimizations on ARM platforms","user":{"login":"dstebila","id":8843219,"node_id":"MDQ6VXNlcjg4NDMyMTk=","avatar_url":"https://avatars.githubusercontent.com/u/8843219?v=4","gravatar_id":"","url":"https://api.github.com/users/dstebila","html_url":"https://github.com/dstebila","followers_url":"https://api.github.com/users/dstebila/followers","following_url":"https://api.github.com/users/dstebila/following{/other_user}","gists_url":"https://api.github.com/users/dstebila/gists{/gist_id}","starred_url":"https://api.github.com/users/dstebila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dstebila/subscriptions","organizations_url":"https://api.github.com/users/dstebila/orgs","repos_url":"https://api.github.com/users/dstebila/repos","events_url":"https://api.github.com/users/dstebila/events{/privacy}","received_events_url":"https://api.github.com/users/dstebila/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-14T02:28:09Z","updated_at":"2022-11-15T21:47:37Z","closed_at":"2022-11-15T21:47:37Z","author_association":"MEMBER","active_lock_reason":null,"body":"I had to do some benchmarking of liboqs on an ARM Cortex A-53 a couple of weeks ago and found a variety of weird things in how various optimizations are configured on ARM that I think is suboptimal.  I'll try to quickly note them here, but I might not be recalling all of them quite right.\r\n\r\n1. In src/common/aes/aes.c, the C_OR_NI_OR_ARM macro doesn't seem to properly address the case of distributable builds on ARM, it will revert to the C code always in that case.\r\n2. Are the OQS_USE_ARM_*_INSTRUCTIONS CMake flags actually being set automatically?  In the various builds I think there were times when they weren't set (I realize that's not very actionable feedback).\r\n3. In tests/system_info.c, ideally we would use the same macros from src/common/aes/aes.c and src/common/sha2/sha2.c (possibly by including them rather than copying and pasting) to indicate whether C or NI or ARM is being used, rather than having slightly different versions here, to be sure that the diagnostic information in tests/system_info.c actually matches the behaviour in the code.\r\n4. In the profiling scripts for ARM (https://github.com/open-quantum-safe/profiling/blob/main/perf/Dockerfile-arm64-start), why is there a toolchain file to enable cross compiling?  I think our CMake configuration is set up so that if you're cross compiling an a build with OQS_OPT_TARGET=auto then you immediately switch back to OQS_OPT_TARGET=generic since you can't properly detect CPU optimizations.\r\n5. In general I think we need to go through and do some sanity checking of which optimizations are actually being enabled in our different build configurations on our various platforms, both for builds that users would make by following our instructions and the builds in the profiling system, since those might be built slightly differently (i.e., the cross compilation issue in item 4).","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1304/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1304/timeline","performed_via_github_app":null,"state_reason":"completed"}},"public":true,"created_at":"2022-11-15T21:47:38Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
