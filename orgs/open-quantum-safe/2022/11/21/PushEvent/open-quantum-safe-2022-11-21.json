{"id":"25378957436","type":"PushEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"push_id":11737317321,"size":1,"distinct_size":1,"ref":"refs/heads/OQS-OpenSSL_1_1_1-stable","head":"63b48cdde3cdf8dab966e31ea277e03e2d233f57","before":"82b5b1dcd786e13e3af8fe23823dedf2ed25d206","commits":[{"sha":"63b48cdde3cdf8dab966e31ea277e03e2d233f57","author":{"email":"57787676+baentsch@users.noreply.github.com","name":"Michael Baentsch"},"message":"Upstream 1.1.1s (#407)\n\n* Update copyright year\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Run make update\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Prepare for 1.1.1l release\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Prepare for 1.1.1m-dev\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Fix the array size of dtlsseq in tls1_enc\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16385)\r\n\r\n(cherry picked from commit 562d4cd3c35b32f2bc6ac0770b80ce394f8d76a4)\r\n\r\n* Avoid using undefined value in generate_stateless_cookie_callback\r\n\r\nReviewed-by: Paul Yang <kaishen.yy@antfin.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16381)\r\n\r\n* Fix some strict gcc-12 warnings\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16375)\r\n\r\n* apps/ciphers: Fix wrong return value when using -convert parameter\r\n\r\nCommand 'openssl ciphers -convert <name>' always returns failure,\r\nthis patch set the correct return value.\r\n\r\nSigned-off-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>\r\n\r\nReviewed-by: Paul Yang <kaishen.yy@antfin.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16383)\r\n\r\n(cherry picked from commit 8b4e9c5265ffd3457ad37133502a9d8a4e8daccd)\r\n\r\n* Check for null-pointer dereference in dh_cms_set_peerkey\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16382)\r\n\r\n* ts: fix memleaks caused by TS_VERIFY_CTX_set_imprint\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16347)\r\n\r\n(cherry picked from commit 62bae84d4587ec9a56d0ce830e36e4a5b2fa8a33)\r\n\r\n* Darwin platform allows to build on releases before Yosemite/ios 8.\r\n\r\nissue #16407 #16408\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16409)\r\n\r\n* cms: fix memleaks in cms_env.c\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16403)\r\n\r\n* Fix instances of pointer addition with the NULL pointer\r\n\r\nubsan found undefined pointer addtions in\r\ncrypto/bio/bss_mem.c (mem_ctrl),\r\ncrypto/pem/pem_lib.c (PEM_read_bio_ex),\r\ntest/testutil/format_output.c (test_fail_string_common,\r\ntest_fail_memory_common).\r\n\r\nMostly a straight back-port-of: a07dc81\r\n\r\nAdditionally enable the ubsan run-checker, to prevent regressions.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16423)\r\n\r\n* Fix enable-asan with C++ buildtest\r\n\r\nthe following config:\r\n\r\n./config no-shared enable-asan enable-buildtest-c++ enable-external-tests\r\n\r\nfails to build with unresolved asan symbols when linking\r\ntest/ossl_shim/ossl_shim\r\n\r\nFixed by passing all sanitizer-flags to cxxflags.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16434)\r\n\r\n* Fix the \"Out of memory\" EVP KDF scrypt test\r\n\r\nThis test did not really execute, since usually\r\nthe OPENSSL_malloc(0) will fail and prevent the\r\nexecution of the KDF.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16446)\r\n\r\n* Ensure that _GNU_SOURCE is defined for bss_dgram.c\r\n\r\nThis fixes the following error with gcc10 under strict ANSI conditions:\r\n\r\n.../crypto/bio/bss_dgram.c:373:20: error: 'const struct in6_addr' has no member named 's6_addr32'\r\n\r\nCLA: trivial\r\nFixes #16449\r\n\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16451)\r\n\r\n(cherry picked from commit e8e1f6d1a9e599d575431f559200018b8f822e0f)\r\n\r\n* Fix no-tls1_3 tests\r\n\r\nThis recently added test needs DH2048 to work without tls1_3.\r\n\r\nFixes: #16335\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16453)\r\n\r\n* Add tests for i2d_TYPE_fp and d2i_TYPE_fp\r\n\r\nThese functions are part of the public API but we don't have tests\r\ncovering their usage.\r\nThey are actually implemented as macros and the absence of tests has\r\ncaused them to fall out-of-sync with the latest changes to ASN1 related\r\nfunctions and cause compilation warnings.\r\n\r\n@@ Note: This commit limits to ECPKParameters as a type.\r\n\r\n(cherry picked from commit ea1128e94e36fa9fa25278dc6b3f5b42d8735782)\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/12457)\r\n\r\n* Fix d2i_ECPKParameters_fp and i2d_ECPKParameters_fp macros\r\n\r\nThese functions are part of the public API but we don't have tests\r\ncovering their usage.\r\nThey are actually implemented as macros and the absence of tests has\r\ncaused them to fall out-of-sync with the latest changes to ASN1 related\r\nfunctions and cause compilation warnings.\r\n\r\nThis commit fixes the public headers to reflect these changes.\r\n\r\nFixes #12443\r\n\r\n(cherry picked from commit cca8a4cedaafe63b0b5729b72133661ece24ff08)\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/12457)\r\n\r\n* [ec] Do not default to OPENSSL_EC_NAMED_CURVE for curves without OID\r\n\r\nSome curves don't have an associated OID: for those we should not\r\ndefault to `OPENSSL_EC_NAMED_CURVE` encoding of parameters and instead\r\nset the ASN1 flag to `OPENSSL_EC_EXPLICIT_CURVE`.\r\n\r\nThis is a follow-up to https://github.com/openssl/openssl/pull/12312\r\n\r\n(cherry picked from commit 7aa3dfc42104588f65301d20324388ac2c9a6b11)\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/12457)\r\n\r\n* Use applink to fix windows tests\r\n\r\n(cherry picked from commit <https://github.com/bernd-edlinger/openssl/commit/96a463cede0070aa5c86629d683a214657a9ba9e>)\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/12457)\r\n\r\n* Make the -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION pass tests\r\n\r\nFixes #16428\r\n\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16441)\r\n\r\n* ci: Add -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION to asan build\r\n\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16441)\r\n\r\n* Openssl fails to compile on Debian with kfreebsd kernels\r\n(kfreebsd-amd64, kfreebsd-i386). The error reported by the compiler\r\nis:\r\n\r\n../crypto/uid.c: In function 'OPENSSL_issetugid':\r\n../crypto/uid.c:50:22: error: 'AT_SECURE' undeclared (first use in this function)\r\n   50 |     return getauxval(AT_SECURE) != 0;\r\n      |                      ^~~~~~~~~\r\n\r\nThis commit changes the code to use the freebsd code in this case.\r\nThis fixes the compilation.\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16477)\r\n\r\n(cherry picked from commit 3a1fa0116a92235ba200228e4bb60d6a3a7f4113)\r\n\r\n* doc: document the rsa_oaep_md: pkeyopt\r\n\r\nThis was missing but essential for using non-SHA1 digests with OAEP.\r\n\r\nFixes #15998\r\n\r\nManual backport of #16410\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Tim Hudson <tjh@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16488)\r\n\r\n* Prioritise DANE TLSA issuer certs over peer certs\r\n\r\nWhen building the certificate chain, prioritise any Cert(0) Full(0)\r\ncertificates from TLSA records over certificates received from the peer.\r\n\r\nThis is important when the server sends a cross cert, but TLSA records include\r\nthe underlying root CA cert.  We want to construct a chain with the issuer from\r\nthe TLSA record, which can then match the TLSA records (while the associated\r\ncross cert may not).\r\n\r\nReviewed-by: Tomáš Mráz <tomas@openssl.org>\r\n\r\n* Test for DANE cross cert fix\r\n\r\nReviewed-by: Tomáš Mráz <tomas@openssl.org>\r\n\r\n* test/ec_internal_test: link with libapps.a too\r\n\r\nWhenever the source from $target{apps_init_src} is added to the source\r\nof a test program, it needs to be linked with libapps.a as well.  Some\r\ninit sources depend on that.\r\n\r\nWithout this, builds break on VMS because of the unresolved symbol\r\n'app_malloc'.\r\n\r\nOn platforms that do not need anything from libapps.a, adding it is a\r\nno-op.\r\n\r\nThis is for OpenSSL 1.1.1 only.  OpenSSL 3.0 and beyond have a\r\ndifferent solution.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16512)\r\n\r\n* VMS: Compensate for compiler type incompatibility\r\n\r\nThe compiler says that 'unsigned long long' isn't the same as\r\n'unsigned __int64'.  Sure, and considering that crypto/rand/rand_vms.c\r\nis specific VMS only code, it's easy to just change the type to the\r\nexact same as what's specified in the system headers.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/15613)\r\n\r\n* DOCS: Update the page for 'openssl passwd' to not duplicate some info\r\n\r\nThe options -1 and -apr1 were mentioned in DESCRIPTION, not mentioning\r\nany other options or even mentioning that there are more algorithms.\r\nThe simple fix is to remove that sentence and let the OPTIONS section\r\nspeak for itself.\r\n\r\nFixes #16529\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16531)\r\n\r\n(cherry picked from commit 116799ff6a8fc803ec4685fc432c7329d0511e23)\r\n\r\n* VMS: Fix misspelt type\r\n\r\n'__int64', not 'int64_t'\r\n\r\nRef: commit 2e5cdbc18a1a26bfc817070a52689886fa0669c2\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16557)\r\n\r\n* Fix nc_email to check ASN1 strings with NULL byte in the middle\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16524)\r\n\r\n(cherry picked from commit 485d0790ac1a29a0d4e7391d804810d485890376)\r\n\r\n* MacOS prior to 10.12 does not support random API correctly\r\n\r\nFixes #16517\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16587)\r\n\r\n* Clarify what SSL_get_session() does on the server side in TLSv1.3\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16582)\r\n\r\n(cherry picked from commit 9e51f877930dbd4216438a5da3c9612bf4d0a918)\r\n\r\n* Correct the documentation for SSL_set_num_tickets()\r\n\r\nThe behaviour for what happens in a resumption connection was not quite\r\ndescribed correctly.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16582)\r\n\r\n(cherry picked from commit 4603b782e6dbed493d2f38db111abc05df66fb99)\r\n\r\n* ssl: Correct filename in README\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16671)\r\n\r\n* Add sm2 encryption test case from GM/T 0003.5-2012\r\n\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16511)\r\n\r\n(cherry picked from commit 8ba65c35ea3af347c3b2adc8e665066b541a1c35)\r\n\r\n* doc/man3/SSL_set_fd.pod: add note about Windows compiler warning\r\n\r\nAccording to an old stackoverflow thread [1], citing an even older comment by\r\nAndy Polyakov (1875e6db29, Pull up Win64 support from 0.9.8., 2005-07-05),\r\na cast of 'SOCKET' (UINT_PTR) to 'int' does not create a problem, because although\r\nthe documentation [2] claims that the upper limit is INVALID_SOCKET-1 (2^64 - 2),\r\nin practice the socket() implementation on Windows returns an index into the kernel\r\nhandle table, the size of which is limited to 2^24 [3].\r\n\r\nAdd this note to the manual page to avoid unnecessary roundtrips to StackOverflow.\r\n\r\n[1] https://stackoverflow.com/questions/1953639/is-it-safe-to-cast-socket-to-int-under-win64\r\n[2] https://docs.microsoft.com/en-us/windows/win32/winsock/socket-data-type-2\r\n[3] https://docs.microsoft.com/en-us/windows/win32/sysinfo/kernel-objects\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16699)\r\n\r\n(cherry picked from commit f8dd5869bca047a23599ac925aace70efcf487ad)\r\n\r\n* Fix a NPD bug in engines/e_dasync.c\r\n\r\nThe dasync_aes_128_cbc_hmac_sha1 cipher depends on\r\nEVP_aes_128_cbc_hmac_sha1() returning a NON-NULL value.\r\nWe should simply not advertise this cipher otherwise.\r\n\r\nFixes: #7950\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16722)\r\n\r\n* Fix a memory leak in the afalg engine\r\n\r\nFixes: #16743\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16744)\r\n\r\n(cherry picked from commit 6f6a5e0c7c41b6b3639e51f435cd98bb3ae061bc)\r\n\r\n* Fix some possible memory leaks in EVP_CipherInit_ex\r\n\r\nAn EVP_CONTEXT with zero cipher but non-zero engine,\r\nand/or cipher_data is possible if an error happens\r\nin EVP_CTRL_INIT or in EVP_CTRL_COPY, the error handling\r\nwill just clear the cipher in that case.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16756)\r\n\r\n* Fix double-free in e_dasync.c\r\n\r\nWhen the cipher is copied, the inner_cihper_data\r\nneed to be copied as well, using the EVP_CTRL_COPY method.\r\nThe EVP_CIPH_CUSTOM_COPY bit needs to be set as well.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16751)\r\n\r\n* Bindhost/bindport should be freed\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16775)\r\n\r\n(cherry picked from commit 0ce0c455862ed29bd7f2acdbddbe8d0b1783c1c9)\r\n\r\n* New extensions can be sent in a certificate request\r\n\r\nNormally we expect a client to send new  extensions in the ClientHello,\r\nwhich may be echoed back by the server in subsequent messages. However the\r\nserver can also send a new extension in the certificate request message to\r\nbe echoed back in a certificate message\r\n\r\nFixes #16632\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16634)\r\n\r\n(cherry picked from commit cbb862fbaaa1ec5a3e33836bc92a6dbea97ceba0)\r\n\r\n* Extend custom extension testing\r\n\r\nTest the scenario where we add a custom extension to a cetificate\r\nrequest and expect a response in the client's certificate message.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16634)\r\n\r\n(cherry picked from commit 0db3a9904fa00569905be130854a31dab7b8f49d)\r\n\r\n* Fix test/recipes/01-test_symbol_presence.t to allow for stripped libraries\r\n\r\nIt's a small change to the 'nm' call, to have it look at dynamic symbols\r\nrather than the normal ones.\r\n\r\nFixes #16810\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16822)\r\n\r\n(cherry picked from commit a85b4de6a6cbe03c46219d4b1c3b2828ca3fd51c)\r\n\r\n* Fix test/recipes/01-test_symbol_presence.t to disregard version info\r\n\r\nThe output of 'nm -DPg' contains version info attached to the symbols,\r\nwhich makes the test fail.  Simply dropping the version info makes the\r\ntest work again.\r\n\r\nFixes #16810 (followup)\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16840)\r\n\r\n(cherry picked from commit 73970cb91fdf8e7b4b434d479b875a47a0aa0dbc)\r\n\r\n* test/ssl_old_test.c: Fix potential leak\r\n\r\nReviewed-by: Kurt Roeckx <kurt@roeckx.be>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16806)\r\n\r\n(cherry picked from commit 34563be5368fb8e6ade7d06d8376522ba83cd6ac)\r\n\r\n* Ensure pkey_set_type handles ENGINE references correctly\r\n\r\npkey_set_type should not consume the ENGINE references that may be\r\npassed to it.\r\n\r\nFixes #16757\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16860)\r\n\r\n* Add tests for ENGINE problems\r\n\r\nAdd some tests which would have caught the issues fixed in the previous\r\ncommit related to engine handling.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16860)\r\n\r\n* Fix some documentation errors related to return values\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16794)\r\n\r\n(cherry picked from commit f1d077f1108b1bc2334350a4d53a46e29e082910)\r\n\r\n* Fix BIO_get_md_ctx return value check\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16792)\r\n\r\n* Fix the s_server psk_server_cb for use in DTLS\r\n\r\nCommit 0007ff257c added a protocol version check to psk_server_cb but\r\nfailed to take account of DTLS causing DTLS based psk connections to\r\nfail.\r\n\r\nFixes #16707\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\n(Merged from https://github.com/openssl/openssl/pull/16838)\r\n\r\n(cherry picked from commit 8b09a9c76d873f62c2507fa9628a9c96c1d66d5c)\r\n\r\n* Fix no-cmac\r\n\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16894)\r\n\r\n(cherry picked from commit ef2fb64f9dfde1965cb0b8a5f8765c4f467c1604)\r\n\r\n* Fix a gcc 11.2.0 warning\r\n\r\ngcc 11.2.0 is the default on Ubuntu 21.10. It emits a (spurious) warning\r\nwhen compiling test/packettest.c, which causes --strict-warnings builds\r\nto fail. A simple fix avoids the warning.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16887)\r\n\r\n(cherry picked from commit 37467b2752f75ce80437120f704452982b7c1998)\r\n\r\n* speed: range check the argument given to -multi for 1.1.1\r\n\r\nFixes #16899 for 1.1.1 branch.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16922)\r\n\r\n* check the return value of BN_new() and BN_dup()\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16948)\r\n\r\n(cherry picked from commit d99004fe5de934120765d342586f08d22131b8ed)\r\n\r\n* Fix a memory leak in tls_parse_stoc_key_share\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16957)\r\n\r\n* Fix a memory leak in ssl_create_cipher_list\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16955)\r\n\r\n* Fix: invoking x509_name_cannon improperly\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16974)\r\n\r\n(cherry picked from commit 09235289c377ff998964bb6b074bb2a3ad768fd2)\r\n\r\n* Reset the rwstate before calling ASYNC_start_job()\r\n\r\nIf an async job pauses while processing a TLS connection then the\r\nrwstate gets set to SSL_ASYNC_PAUSED. When resuming the job we should\r\nreset the rwstate back to SSL_NOTHING. In fact we can do this\r\nunconditionally since if we're about to call ASYNC_start_job() then either\r\nwe are about to start the async job for the first time (in which case the\r\nrwstate should already by SSL_NOTHING), or we are restarting it after a\r\npause (in which case reseting it to SSL_NOTHING is the correct action).\r\n\r\nFixes #16809\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17013)\r\n\r\n(cherry picked from commit 07f620e3acf0dd76a3a03ada9911c544aa483aa7)\r\n\r\n* free the Post-Handshake Auth digest when there is an error saving the digest\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16924)\r\n\r\n* evp: fix EVP_PKEY_get0_EC_KEY when EC_KEY is SM2\r\n\r\nEVP_PKEY_set_alias_type(pkey, EVP_PKEY_SM2) will change pkey->type to EVP_PKEY_SM2\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17015)\r\n\r\n* Avoid loading of a dynamic engine twice\r\n\r\nUse the address of the bind function as a DYNAMIC_ID,\r\nsince the true name of the engine is not known\r\nbefore the bind function returns,\r\nbut invoking the bind function before the engine\r\nis unloaded results in memory corruption.\r\n\r\nFixes #17023\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17073)\r\n\r\n(cherry picked from commit e2571e02d2b0cd83ed1c79d384fe941f27e603c0)\r\n\r\n* ERR: Add a missing common reason string\r\n\r\nThere was no string present for ERR_R_PASSED_INVALID_ARGUMENT\r\n\r\nReviewed-by: David von Oheimb <david.von.oheimb@siemens.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17069)\r\n\r\n* Add a test case for duplicate engine loading\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17083)\r\n\r\n* DOC: Add a few previously documented functions\r\n\r\nd2i_X509_bio(), d2i_X509_fp(), i2d_X509_bio(), and i2d_X509_fp()\r\nwere documented in OpenSSL 1.0.2.  In a grand unification of the\r\ndocumentation of (almost) all d2i and i2d functions, these were\r\ndropped, most likely by mistake.\r\n\r\nThis simply adds them back.\r\n\r\nFixes #17091\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17093)\r\n\r\n* Fix detection of ARMv7 and ARM64 CPU features on FreeBSD\r\n\r\nOpenSSL assumes AT_HWCAP = 16 (as on Linux), but on FreeBSD AT_HWCAP = 25\r\nSwitch to using AT_HWCAP, and setting it to 16 if it is not defined.\r\n\r\nOpenSSL calls elf_auxv_info() with AT_CANARY which returns ENOENT\r\nresulting in all ARM acceleration features being disabled.\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17082)\r\n\r\n(cherry picked from commit c1dabe26e3e96cdce0ffc929e9677840ad089ba5)\r\n\r\n* Clarify and correct the EVP_CTRL_AEAD_SET_TAG docs\r\n\r\nThe restriction about setting a tag length prior to setting the IV only\r\napplies to OCB mode. We clarify when in the process EVP_CTRL_AEAD_SET_TAG\r\ncan be called.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17111)\r\n\r\n(cherry picked from commit 3607b8ad8ee1980a079e985333a196e0c79f8f00)\r\n\r\n* doc: fix macro name\r\n\r\nOSSL_STORE_INFO_X509 doesn't exist.  It should be OSSL_STORE_INFO_CERT.\r\n\r\nFixes #17121\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17125)\r\n\r\n(cherry picked from commit 01fde90eec721b64bc0e1c01cd94a9fd431adcc6)\r\n\r\n* BIO_push.pod: fix confusing text and add details on corner cases\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17086)\r\n\r\n(cherry picked from commit 7a37fd09a8f3607ed8acf55e03479861595be069)\r\n\r\n* Fix speed, use OPENSSL_free instead of free\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17132)\r\n\r\n* TEST: Enable and fix test_bn2padded() in test/bntest.c\r\n\r\nThis looks like old code, written when the padded variety of BN_bn2bin()\r\nwas developped, and disabled by default...  and forgotten.\r\n\r\nA few simple changes to update it to the current API is all that was\r\nneeded to enable it.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17133)\r\n\r\n(cherry picked from commit 23750f677ef61b6bea4e81f23f335ad08fc49b51)\r\n\r\n* No EtM for GOST ciphers\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17158)\r\n\r\n* Fix ssl_free() and thus BIO_free() to respect BIO_NOCLOSE\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17135)\r\n\r\n* BIO_f_ssl.pod: Make clear where an SSL BIOs are expected as an argument\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17135)\r\n\r\n* Fix documentation for tlsext_ticket_key\r\n\r\nThe tlsext_ticket_key functions are documented as returning 0 on success.\r\nIn fact they return 1 on success.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17210)\r\n\r\n(cherry picked from commit b0be101326f369f0dd547556d2f3eb3ef5ed0e33)\r\n\r\n* OBJ_nid2obj.pod: Replace remaining 'B<' by 'I<' were appropriate\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17221)\r\n\r\n* Fix a deadlock in OBJ_NAME_add\r\n\r\nThis happened after an out of memory error:\r\nCRYPTO_THREAD_write_lock may hang in OBJ_NAME_add.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17236)\r\n\r\n* CI: Replace windows-2016 with windows-2022\r\n\r\nWindows 2016 environment is going to be discontinued.\r\n\r\nWe also replace windows-latest with windows-2019 so\r\nthere aren't two identical builds done once windows-latest\r\nis switched to mean windows-2022.\r\n\r\nFixes #17177\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17211)\r\n\r\n* Fix faulty detail in BN_rand() manual\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17131)\r\n\r\n* Fix a carry overflow bug in bn_sqr_comba4/8 for mips 32-bit targets\r\n\r\nbn_sqr_comba8 does for instance compute a wrong result for the value:\r\na=0x4aaac919 62056c84 fba7334e 1a6be678 022181ba fd3aa878 899b2346 ee210f45\r\n\r\nThe correct result is:\r\nr=0x15c72e32 605a3061 d11b1012 3c187483 6df96999 bd0c22ba d3e7d437 4724a82f\r\n    912c5e61 6a187efe 8f7c47fc f6945fe5 75be8e3d 97ed17d4 7950b465 3cb32899\r\n\r\nbut the actual result was:\r\nr=0x15c72e32 605a3061 d11b1012 3c187483 6df96999 bd0c22ba d3e7d437 4724a82f\r\n    912c5e61 6a187efe 8f7c47fc f6945fe5 75be8e3c 97ed17d4 7950b465 3cb32899\r\n\r\nso the forth word of the result was 0x75be8e3c but should have been\r\n0x75be8e3d instead.\r\n\r\nLikewise bn_sqr_comba4 has an identical bug for the same value as well:\r\na=0x022181ba fd3aa878 899b2346 ee210f45\r\n\r\ncorrect result:\r\nr=0x00048a69 9fe82f8b 62bd2ed1 88781335 75be8e3d 97ed17d4 7950b465 3cb32899\r\n\r\nwrong result:\r\nr=0x00048a69 9fe82f8b 62bd2ed1 88781335 75be8e3c 97ed17d4 7950b465 3cb32899\r\n\r\nFortunately the bn_mul_comba4/8 code paths are not affected.\r\n\r\nAlso the mips64 target does in fact not handle the carry propagation\r\ncorrectly.\r\n\r\nExample:\r\na=0x4aaac91900000000 62056c8400000000 fba7334e00000000 1a6be67800000000\r\n    022181ba00000000 fd3aa87800000000 899b234635dad283 ee210f4500000001\r\n\r\ncorrect result:\r\nr=0x15c72e32272c4471 392debf018c679c8 b85496496bf8254c d0204f36611e2be1\r\n    0cdb3db8f3c081d8 c94ba0e1bacc5061 191b83d47ff929f6 5be0aebfc13ae68d\r\n    3eea7a7fdf2f5758 42f7ec656cab3cb5 6a28095be34756f2 64f24687bf37de06\r\n    2822309cd1d292f9 6fa698c972372f09 771e97d3a868cda0 dc421e8a00000001\r\n\r\nwrong result:\r\nr=0x15c72e32272c4471 392debf018c679c8 b85496496bf8254c d0204f36611e2be1\r\n    0cdb3db8f3c081d8 c94ba0e1bacc5061 191b83d47ff929f6 5be0aebfc13ae68d\r\n    3eea7a7fdf2f5758 42f7ec656cab3cb5 6a28095be34756f2 64f24687bf37de06\r\n    2822309cd1d292f8 6fa698c972372f09 771e97d3a868cda0 dc421e8a00000001\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17258)\r\n\r\n(cherry picked from commit 336923c0c8d705cb8af5216b29a205662db0d590)\r\n\r\n* Add some CHANGES entries for 1.1.1m\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17269)\r\n\r\n* Update copyright year\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17271)\r\n\r\n* Update NEWS for 1.1.1m\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17273)\r\n\r\n* Prepare for 1.1.1m release\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Prepare for 1.1.1n-dev\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Fix the null pointer dereference\r\n\r\nFixed #17296\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17302)\r\n\r\n* Fix Configure variable spill\r\n\r\n* Evaluating code-refs in Configure can sometimes set the default\r\nvariable `$_`\r\n* Prevent spillage influencing the target property by using named\r\nvariable in loop\r\n\r\nCLA: trivial\r\n\r\nFixes gh-17321\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17322)\r\n\r\n(cherry picked from commit a595e3286ae9f033c56452967b3add2145f9085f)\r\n\r\n* document additional stack push error code\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17351)\r\n\r\n* Ensure s_client sends SNI data when used with -proxy\r\n\r\nThe use of -proxy prevented s_client from correctly sending the target\r\nhostname as SNI data.\r\n\r\nFixes #17232\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17249)\r\n\r\n* Add support for BSD-riscv64 target\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n(cherry picked from commit c2d1ad0e048dd3bfa60e6aa0b5ee343cc6d97a15)\r\n(cherry picked from commit fb72a093f88f7332069659994b67f6b19aceb865)\r\n\r\n(Merged from https://github.com/openssl/openssl/pull/17341)\r\n\r\n* OBJ_obj2txt(): fix off-by-one documentation of the result\r\n\r\nThis backports the doc improvements of #17188.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n\r\n(cherry picked from commit e36d10925396b6519e1abd338e1ef62cd5b1c9e6)\r\n\r\n* Update troublesome copyright years of auto-generated files to 2022\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17401)\r\n\r\n* apps/passwd.c: free before error exiting\r\n\r\nuse goto instead of returning directly while error handling\r\n\r\nSigned-off-by: Peiwei Hu <jlu.hpw@foxmail.com>\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17404)\r\n\r\n(cherry picked from commit ea4d16bc60dee53feb71997c1e78379eeb69b7ac)\r\n\r\n* close_console: Always unlock as the lock is always held\r\n\r\nFixes #17364\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17395)\r\n\r\n* Fix password_callback to handle short passwords\r\n\r\nFixes #17426\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17439)\r\n\r\n* Remove unsafe call to OPENSSL_cpuid_setup\r\n\r\nThis function is inherently thread-unsafe,\r\nand moreover it is unnecessary here, because\r\nOPENSSL_init_crypto always calls it in a thread-safe way.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17468)\r\n\r\n* Fix a leak in EVP_DigestInit_ex()\r\n\r\nIf an EVP_MD_CTX is reused then memory allocated and stored in md_data\r\ncan be leaked unless the EVP_MD's cleanup function is called.\r\n\r\nFixes #17149\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\n(Merged from https://github.com/openssl/openssl/pull/17472)\r\n\r\n* Add a test for a custom digest created via EVP_MD_meth_new()\r\n\r\nWe check that the init and cleanup functions for the custom method are\r\ncalled as expected.\r\n\r\nBased on an original reproducer by Dmitry Belyavsky from issue #17149.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\n(Merged from https://github.com/openssl/openssl/pull/17472)\r\n\r\n* lhash: Avoid 32 bit right shift of a 32 bit value\r\n\r\nFixes #17583\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17589)\r\n\r\n(cherry picked from commit 2ce0a3d19005271e7e3c351b562d9da93e2d4c80)\r\n\r\n* Ensure X509_STORE_CTX_purpose_inherit handles a 0 default purpose\r\n\r\nThe function X509_STORE_CTX_purpose_inherit() can be called with a 0\r\ndefault purpose. If the main purpose was set to X509_PURPOSE_ANY this\r\nwould case the function to incorrectly return an error response.\r\n\r\nFixes #17367\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17604)\r\n\r\n* Add a test for X509_STORE_CTX_set_purpose()\r\n\r\nThis function was previously incorrectly failing if it is called with\r\nX509_PURPOSE_ANY. Add a test to catch this.\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17604)\r\n\r\n* Document purpose and trust setting functions\r\n\r\nIn particular:\r\nX509_STORE_CTX_set_purpose()\r\nX509_STORE_CTX_set_trust();\r\nX509_STORE_CTX_purpose_inherit();\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17604)\r\n\r\n* Fix builds with DJGPP\r\n\r\nCLA: trivial\r\n\r\nTo get the master branch compiled with DJGPP some minor\r\nadjustments are required. They will have no impact on any other ports.\r\nThe DJGPP port uses the Watt-32 library to provide the required network\r\nfunctionality and some of its headers need to be included.\r\n\r\nNeither DJGPP nor the Watt-32 library provide in_addr_t thus it must be\r\nprovided as it is done for OPENSSL_SYS_WINDOWS in crypto/bio/b_addr.c.\r\n\r\nIn the DJGPP section of include/internal/sockets.h the following Watt-32\r\nheaders must be added:\r\n\r\n  -  arpa/inet.h: to provide declaration of inet_ntoa required in crypto/bio/b_addr.c\r\n  -  netinet/tcp.h: to provide defintion of TCP_NODELAY required in crypto/bio/b_sock2.c\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17623)\r\n\r\n(cherry picked from commit b9b211fcb6b9068ef1d8729a4971fbe693fd2cde)\r\n\r\n* Don't link test/ec_internal_test with libapps.a\r\n\r\nIt's not at all necessary, and on some platforms, it's disruptive\r\n(leads to unresolved symbols because of object files that get included\r\nin the link that depend on libssl).\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17637)\r\n\r\n* Correct return type for BIO_ptr_ctrl\r\n\r\nFixes #17549\r\nCLA: trivial\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17636)\r\n\r\n(cherry picked from commit 984cc9a0284ee4800862aa305f9f178827baf459)\r\n\r\n* scrypt: increase memory usage beyond limit\r\n\r\nThis brings these tests in line with 3.0 and master and makes them\r\nfail correctly.\r\n\r\nFixes #17612\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17619)\r\n\r\n* Prevent crash with engine using different openssl runtime\r\n\r\nThis problem happens usually because an application\r\nlinks libcrypto and/or libssl statically which\r\ninstalls an atexit handler, but later an engine using\r\na shared instance of libcrypto is installed.\r\nThe problem is in simple words that both instances\r\nof libcrypto have an atexit handler installed,\r\nbut both are unable to coordinate with each other,\r\nwhich causes a crash, typically a use-after-free\r\nin the engine's destroy function.\r\n\r\nWork around that by preventing the engine's\r\nlibcrypto to install the atexit handler.\r\nThis may result in a small memory leak, but that\r\nmemory is still reachable.\r\n\r\nFixes #15898\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17541)\r\n\r\n* Check for presence of 3.x openssl runtime\r\n\r\nif the newly loaded engine contains the symbol\r\nEVP_PKEY_get_base_id, we know it is linked to 3.x openssl.\r\nAbort loading this engine, as it will definitely crash.\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17541)\r\n\r\n* crypto/x509/v3_utl.c: Add missing check for OPENSSL_strndup\r\n\r\nSince the potential failure of memory allocation, it\r\nshould be better to check the return value of the\r\nOPENSSL_strndup(), like x509v3_add_len_value().\r\nAnd following the comment of 'if (astrlen < 0)',\r\nreturn -1 if fails.\r\n\r\nSigned-off-by: Jiasheng Jiang <jiasheng@iscas.ac.cn>\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17737)\r\n\r\n(cherry picked from commit 366a16263959c0b6599f0b9ec18124d75560c6ef)\r\n\r\n* Improve documentation of BIO_FLAGS_BASE64_NO_NL flag.\r\n\r\nFixes #12491.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17744)\r\n\r\n(cherry picked from commit 8bfb7506d210841f2ee4eda8afe96441a0e33fa5)\r\n\r\n* Fix NULL pointer dereference for BN_mod_exp2_mont\r\n\r\nThis fixes a bug whereby BN_mod_exp2_mont can dereference a NULL pointer\r\nif BIGNUM argument m represents zero.\r\n\r\nRegression test added. Fixes #17648. Backport from master to 1.1.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Todd Short <todd.short@me.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17787)\r\n\r\n* VMS: move copy_argc to its own module and make it an aux source\r\n\r\ncopy_argv was never initialization code.\r\n\r\nMake it self-cleaning too.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17746)\r\n\r\n* [ssl] Prefer SSL_k(EC)?DHE to the SSL_kE(EC)?DH alias\r\n\r\n`SSL_kECDHE` and `SSL_kEECDH`, and `SSL_kDHE` and `SSL_kEDH` are already\r\nmarked as aliases of each other in the headers.\r\nThis commit, for each pair, replaces the leftover uses of the latter\r\nsynonym with the first one, which is considered more common.\r\n\r\n(manually cherry picked from commit 66914fc024cfe0fec00dc0f2c7bd8a7957da5ec4)\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17791)\r\n\r\n* [ssl] Add SSL_kDHEPSK and SSL_kECDHEPSK as PFS ciphersuites for SECLEVEL >= 3\r\n\r\nFixes #17743\r\n\r\n(manually cherry picked from commit b139a95665eb023b38695d62d9dfc28f3fb89972)\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17791)\r\n\r\n* [ssl] Add tests for Perfect Forward Secrecy criteria on SECLEVEL >= 3\r\n\r\n(manually cherry picked from commit d71151ae704847f4ac3f4a5f394ea64f1d229815)\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17791)\r\n\r\n* Document bug in openssl cms -binary\r\n\r\nDocuments a bug in openssl cms -binary for 1.1 whereby it cannot process\r\ninput using LF line endings correctly. Binary input processing was\r\nreworked substantially for 3.0 and backporting these changes doesn't\r\nappear reasonable.\r\n\r\nFixes #17797.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17810)\r\n\r\n* Avoid potential memory leak\r\n\r\nResolves #17827\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17828)\r\n\r\n(cherry picked from commit 175355923046921a689b500f7a72455f7095708f)\r\n\r\n* Set protocol in init_client()\r\n\r\nIf TCP is being used, protocol = 0 is passed to init_client(), then\r\nprotocol == IPPROTO_TCP fails when attempting to set BIO_SOCK_NODELAY.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Tim Hudson <tjh@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17838)\r\n\r\n(cherry picked from commit 54b6755702309487ea860e1cc3e60ccef4cf7878)\r\n\r\n* Fix issue where OBJ_nid2obj doesn't always raise an error\r\n\r\nThis was previously fixed in 3.0 but not 1.1.\r\n\r\nFixes #13008.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Todd Short <todd.short@me.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17808)\r\n\r\n* DOC: TLS compression is disabled by default\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matthias St. Pierre <Matthias.St.Pierre@ncp-e.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17854)\r\n\r\n(cherry picked from commit 2cb52118ddd1d82d7b6028372238eaa2467bbd48)\r\n\r\n* Fix OPENSSL_ENGINES in Configurations/descrip.mms.tmpl\r\n\r\nMake its value an absolute path.\r\n\r\nThis was already fixed in all other build file templates, but for some\r\nreason, not here.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17865)\r\n\r\n* Make ossltest engine use in test/recipes/20-test_dgst.t platform agnostic\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17861)\r\n\r\n(cherry picked from commit abdb2278d2b65ae87bee3121be83322e4219b396)\r\n\r\n* Fix possible infinite loop in BN_mod_sqrt()\r\n\r\nThe calculation in some cases does not finish for non-prime p.\r\n\r\nThis fixes CVE-2022-0778.\r\n\r\nBased on patch by David Benjamin <davidben@google.com>.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Add documentation of BN_mod_sqrt()\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Add a negative testcase for BN_mod_sqrt\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Update CHANGES/NEWS for new release\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Update copyright year\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Prepare for 1.1.1n release\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n\r\n* Prepare for 1.1.1o-dev\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n\r\n* Check password length only when verify is enabled.\r\n\r\nFixes #16231.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17899)\r\n\r\n* eng_dyn: Avoid spurious errors when checking for 3.x engine\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17902)\r\n\r\n* print SSL session, fix build warnings on OpenBSD.\r\n\r\ntime_t is a 64 bits type on this platform.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17917)\r\n\r\n(cherry picked from commit 9362638b080e328ccab43f89048bed27bcf2f11d)\r\n\r\n* Fix coverity 1498607: uninitialised value\r\n\r\nReviewed-by: Tim Hudson <tjh@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17897)\r\n\r\n(cherry picked from commit 70cd9a51911e9a4e2f24e29ddd84fa9fcb778b63)\r\n\r\n* Fix Coverity 1498611 & 1498608: uninitialised read\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17893)\r\n\r\n(cherry picked from commit 09134f183f76539aa1294adfef10fcc694e90267)\r\n\r\n* Fix Coverity 1201763 uninitialised pointer read\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17890)\r\n\r\n(cherry picked from commit a0238b7ed87998c48b1c92bad7fa82dcbba507f9)\r\n\r\n* Fix integer overflow in evp_EncryptDecryptUpdate\r\n\r\nFixes #17871.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17872)\r\n\r\n* Fix Coverity 1498612: integer overflow\r\n\r\nThe assert added cannot ever fail because (current & 0xFFFF) != 0 from the\r\nwhile loop and the trailing zero bit count therefore cannot be as large as 32.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17892)\r\n\r\n(cherry picked from commit 81487b65b9eb8148471e729b8c1959521d62c69e)\r\n\r\n* s390x: Hide internal cpuid symbol and function\r\n\r\nThe symbol OPENSSL_s390xcap_P and the OPENSSL_cpuid_setup function are not\r\nexported by the version script of OpenSSL.  However, if someone uses the\r\nstatic library without the version script, these symbols all of a sudden\r\nbecome global symbols and their usage in assembler code does not correctly\r\nreflect that for PIC.  Since these symbols should never be used outside of\r\nOpenSSL, hide them inside the binary.\r\n\r\nSigned-off-by: Juergen Christ <jchrist@linux.ibm.com>\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17946)\r\n\r\n(cherry picked from commit 37816ef5757e458be9648481e56bf698ee3bfbb1)\r\n\r\n* ticket_lifetime_hint may exceed 1 week in TLSv1.3\r\n\r\nFor TLSv1.3, limit ticket lifetime hint to 1 week per RFC8446\r\n\r\nFixes #17948\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Tim Hudson <tjh@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17952)\r\n\r\n(cherry picked from commit 0089cc7f9d42f6e39872161199fb8b6a99da2492)\r\n\r\n* Fix: ticket_lifetime_hint may exceed 1 week in TLSv1.3\r\n\r\nlibctx was left in cherry-pick from master/3.0 cherry-pick\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\n(Merged from https://github.com/openssl/openssl/pull/17970)\r\n\r\n* tls_process_server_hello: Disallow repeated HRR\r\n\r\nRepeated HRR must be rejected.\r\n\r\nFixes #17934\r\n\r\nReviewed-by: Todd Short <todd.short@me.com>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17936)\r\n\r\n(cherry picked from commit d204a50b898435fbf937316d5693008cebf62eef)\r\n\r\n* Test processing of a duplicated HRR\r\n\r\nReviewed-by: Todd Short <todd.short@me.com>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17936)\r\n\r\n(cherry picked from commit db44b55aaa42141921217183667800425227b658)\r\n\r\n* Fix usage of SSLfatal\r\n\r\nA cherry-pick from the master branch incorrectly introduced a usage of\r\n3 argument SSLfatal. In 1.1.1 the function code is also required.\r\n\r\nFixes #17999\r\n\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18000)\r\n\r\n* Fix failure to check result of bn_rshift_fixed_top\r\n\r\nFixes #18010.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18034)\r\n\r\n(cherry picked from commit bc6bac8561ead83d6135f376ffcbbb0b657e64fe)\r\n\r\n* err: fix crash in ERR_load_strings() when configured with no-err\r\n\r\nThis commit removes the entire initialization and cleanup of the\r\nerror string hash table (`int_error_hash`) if `no-err` is configured.\r\nThe only operative function remaining is `ERR_get_next_error_library()`.\r\nThat is the reason why the `err_string_lock` and hence the\r\n`do_err_strings_init()` function can't be removed entirely.\r\n\r\nFixes #17971\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17975)\r\n\r\n* err: fix indentation of preprocessor directive\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17975)\r\n\r\n* err: get rid of err_free_strings_int()\r\n\r\nEven though the function is not part of the public api, it is not\r\nentirely removed, in order to minimize the chance of breakage,\r\nbecause it is exported from libcrypto. Instead, we keep a dummy\r\nimplementation.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17975)\r\n\r\n* Fix -no-tls1_2 in tests\r\n\r\nThis is specific for OpenSSL_1_1_1-stable branch\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\n(Merged from https://github.com/openssl/openssl/pull/18080)\r\n\r\n* Fix a DTLS server hangup due to TLS13_AD_MISSING_EXTENSION\r\n\r\nThis causes the DTLS server to enter an error state:\r\n\r\n./openssl s_server -dtls\r\n./openssl s_client -dtls -maxfraglen 512 -sess_out s1.txt\r\n[...]\r\nQ\r\n./openssl s_client -dtls -sess_in s1.txt\r\nCONNECTED(00000003)\r\n^C\r\n./openssl s_client -dtls\r\nCONNECTED(00000003)\r\n140335537067840:error:14102410:SSL routines:dtls1_read_bytes:sslv3 alert handshake failure:ssl/record/rec_layer_d1.c:614:SSL alert number 40\r\n\r\nAt this point the dtls server needs to be restarted,\r\nbecause verify_cookie_callback always fails, because\r\nthe previous cookie is checked against the current one.\r\nThe reason for this is not fully understood.\r\n\r\nIn wireshark we see the following each time:\r\nc->s Client Hello (without cookie)\r\ns->c Hello Verify Request (with new cookie)\r\ns->c Alert (Level: Fatal, Description: Handshake Failure)\r\nc->s Client Hello (echoes new cookie)\r\n\r\nThe client gives up when the Alert arrives.\r\nThe Alert is triggered because the server calls\r\nverify_cookie_callback with the previous cookie,\r\nalthough it just sent the current cookie in the\r\nHello Verify Request.\r\n\r\nHowever this does only happen because no Alert message\r\nis sent when the client re-connects the session with\r\nthe missing -maxfraglen option.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18094)\r\n\r\n* Fix an assertion in the DTLS server code\r\n\r\nThis fixes an internal error alert from the server and\r\nan unexpected connection failure in the release version,\r\nbut a failed assertion and a server crash in the\r\ndebug version.\r\n\r\nReproduce this issue with a DTLS server/client like that:\r\n\r\n./openssl s_server -dtls -mtu 1500\r\n./openssl s_client -dtls -maxfraglen 512\r\n\r\nIn the debug version a crash happens in the Server now:\r\n\r\n./openssl s_server -dtls -mtu 1500\r\nUsing default temp DH parameters\r\nACCEPT\r\nssl/statem/statem_dtls.c:269: OpenSSL internal error: Assertion failed: len == written\r\nAborted (core dumped)\r\n\r\nWhile in the release version the handshake exceeds the\r\nnegotiated max fragment size, and fails because of this:\r\n\r\n$ ./openssl s_server -dtls -mtu 1500\r\nUsing default temp DH parameters\r\nACCEPT\r\nERROR\r\n4057152ADA7F0000:error:0A0000C2:SSL routines:do_dtls1_write:exceeds max fragment size:ssl/record/rec_layer_d1.c:826:\r\nshutting down SSL\r\nCONNECTION CLOSED\r\n\r\nFrom the client's point of view the connection fails\r\nwith an Internal Error Alert:\r\n\r\n$ ./openssl s_client -dtls -maxfraglen 512\r\nConnecting to ::1\r\nCONNECTED(00000003)\r\n40B76343377F0000:error:0A000438:SSL routines:dtls1_read_bytes:tlsv1 alert internal error:ssl/record/rec_layer_d1.c:613:SSL alert number 80\r\n\r\nand now the connection attempt fails unexpectedly.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18093)\r\n\r\n(cherry picked from commit e915c3f5381cd38ebdc1824c3ba9896ea7160103)\r\n\r\n* x509: use actual issuer name if a CA is used\r\n\r\nFixes openssl#16080.\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18129)\r\n\r\n* Revert \"[github-ci][ci.yml] Disable pyca external tests\"\r\n\r\nThis reverts commit 850ed18505631286abbd23d355d4b48f28ad89a9.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16340)\r\n\r\n* [github-ci] Sync pyca workflow with master\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16340)\r\n\r\n* add wycheproof submodule\r\n\r\nThis is used with the pyca/cryptography test suite\r\n\r\n(cherry picked from commit a09fb26ba90e46c4f731b5a597051b4d4b9aea3e)\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16340)\r\n\r\n* c_rehash: Do not use shell to invoke openssl\r\n\r\nExcept on VMS where it is safe.\r\n\r\nThis fixes CVE-2022-1292.\r\n\r\nReviewed-by: Matthias St. Pierre <Matthias.St.Pierre@ncp-e.com>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Add additional keys to release key fingerprints\r\n\r\nAdded keys for Paul Dale and Tomáš Mráz.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18156)\r\n\r\n* Update CHANGES and NEWS for new release\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nRelease: yes\r\n\r\n* Update copyright year\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nRelease: yes\r\n\r\n* Prepare for 1.1.1o release\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nRelease: yes\r\n\r\n* Prepare for 1.1.1p-dev\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nRelease: yes\r\n\r\n* (1.1) Add SSL_(CTX_)?get0_(verify|chain)_cert_store functions\r\n\r\nBackport of #18038 to 1.1.\r\n\r\nFixes #18035.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/18190)\r\n\r\n* 1_1_1-stable: Detect arm64-*-*bsd and enable assembly optimizations\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17085)\r\n\r\n* Do not send an empty supported groups extension\r\n\r\nThis allows handshake to proceed if the maximum TLS version enabled is <1.3\r\n\r\nFixes #13583\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18213)\r\n\r\n* Add test for empty supported-groups extension\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18213)\r\n\r\n* Fix leakage when the cacheline is 32-bytes in CBC_MAC_ROTATE_IN_PLACE\r\n\r\nrotated_mac is a 64-byte aligned buffer of size 64 and rotate_offset is secret.\r\nConsider a weaker leakage model(CL) where only cacheline base address is leaked,\r\ni.e address/32 for 32-byte cacheline(CL32).\r\n\r\nPrevious code used to perform two loads\r\n    1. rotated_mac[rotate_offset ^ 32] and\r\n    2. rotated_mac[rotate_offset++]\r\nwhich would leak 2q + 1, 2q for 0 <= rotate_offset < 32\r\nand 2q, 2q + 1 for 32 <= rotate_offset < 64\r\n\r\nThe proposed fix performs load operations which will always leak 2q, 2q + 1 and\r\nselects the appropriate value in constant-time.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18050)\r\n\r\n* s_serve: Report an error if init-connection fails without an attempt to read.\r\n\r\nFixes: openssl#18047.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18283)\r\n\r\n* Backport some fuzzing data files from master\r\n\r\nThis is a backport of the following commit from master:\r\n\r\ncommit 415e6ac80405e13b20b083315747e431274fbd33\r\nAuthor: Tavis Ormandy <taviso@gmail.com>\r\nDate:   Tue Sep 21 15:48:27 2021 -0700\r\n\r\n    increase x509 code coverage metrics\r\n\r\n    Reviewed-by: Matt Caswell <matt@openssl.org>\r\n    Reviewed-by: Tomas Mraz <tomas@openssl.org>\r\n    (Merged from https://github.com/openssl/openssl/pull/16651)\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18347)\r\n\r\n* Backport a missing bug-fix from master\r\n\r\nThis is a backport of the following commit from master:\r\n\r\ncommit 61b0fead5e6079ca826594df5b9ca00e65883cb0\r\nAuthor: Matt Caswell <matt@openssl.org>\r\nDate:   Thu Nov 19 13:58:21 2020 +0000\r\n\r\n    Don't Overflow when printing Thawte Strong Extranet Version\r\n\r\n    When printing human readable info on the Thawte Strong Extranet extension\r\n    the version number could overflow if the version number == LONG_MAX. This\r\n    is undefined behaviour.\r\n\r\n    Issue found by OSSFuzz.\r\n\r\n    Reviewed-by: Ben Kaduk <kaduk@mit.edu>\r\n    (Merged from https://github.com/openssl/openssl/pull/13452)\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18347)\r\n\r\n* Fix a crash in asn1_item_embed_new\r\n\r\nThis happens usually if an template object is created\r\nand there is an out of memory error before the ASN1_OP_NEW_POST\r\nmethod is called, but asn1_item_embed_free calls now the\r\nASN1_OP_FREE_POST which may crash because the object is not\r\nproperly initialized.  Apparently that is only an issue with\r\nthe ASN1_OP_FREE_POST handling of crypot/x509/x_crl.c, which\r\nought to be tolerant to incomplete initialized objects.\r\n\r\nThe error can be reproduced with the reproducible error injection patch:\r\n\r\n$ ERROR_INJECT=1652890550 ../util/shlib_wrap.sh ./asn1-test ./corpora/asn1/0ff17293911f54d1538b9896563a4048d67d9ee4\r\n    #0 0x7faae9dbeeba in __sanitizer_print_stack_trace ../../../../gcc-trunk/libsanitizer/asan/asan_stack.cpp:87\r\n    #1 0x408dc4 in my_malloc fuzz/test-corpus.c:114\r\n    #2 0x7faae99f2430 in CRYPTO_zalloc crypto/mem.c:230\r\n    #3 0x7faae97f09e5 in ASN1_STRING_type_new crypto/asn1/asn1_lib.c:341\r\n    #4 0x7faae98118f7 in asn1_primitive_new crypto/asn1/tasn_new.c:318\r\n    #5 0x7faae9812401 in asn1_item_embed_new crypto/asn1/tasn_new.c:78\r\n    #6 0x7faae9812401 in asn1_template_new crypto/asn1/tasn_new.c:240\r\n    #7 0x7faae9812315 in asn1_item_embed_new crypto/asn1/tasn_new.c:137\r\n    #8 0x7faae9812315 in asn1_template_new crypto/asn1/tasn_new.c:240\r\n    #9 0x7faae9812a54 in asn1_item_embed_new crypto/asn1/tasn_new.c:137\r\n    #10 0x7faae9812a54 in ASN1_item_ex_new crypto/asn1/tasn_new.c:39\r\n    #11 0x7faae980be51 in asn1_item_embed_d2i crypto/asn1/tasn_dec.c:325\r\n    #12 0x7faae980c813 in asn1_template_noexp_d2i crypto/asn1/tasn_dec.c:611\r\n    #13 0x7faae980d288 in asn1_template_ex_d2i crypto/asn1/tasn_dec.c:518\r\n    #14 0x7faae980b9ce in asn1_item_embed_d2i crypto/asn1/tasn_dec.c:382\r\n    #15 0x7faae980caf5 in asn1_template_noexp_d2i crypto/asn1/tasn_dec.c:643\r\n    #16 0x7faae980d7d3 in asn1_template_ex_d2i crypto/asn1/tasn_dec.c:494\r\n    #17 0x7faae980b9ce in asn1_item_embed_d2i crypto/asn1/tasn_dec.c:382\r\n    #18 0x7faae980dd1f in ASN1_item_ex_d2i crypto/asn1/tasn_dec.c:124\r\n    #19 0x7faae980de35 in ASN1_item_d2i crypto/asn1/tasn_dec.c:114\r\n    #20 0x40712c in FuzzerTestOneInput fuzz/asn1.c:301\r\n    #21 0x40893b in testfile fuzz/test-corpus.c:182\r\n    #22 0x406b86 in main fuzz/test-corpus.c:226\r\n    #23 0x7faae8eb1f44 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21f44)\r\n\r\nAddressSanitizer:DEADLYSIGNAL\r\n=================================================================\r\n==1194==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000010 (pc 0x7faae9b0625f bp 0x7fffffe41a00 sp 0x7fffffe41920 T0)\r\n==1194==The signal is caused by a READ memory access.\r\n==1194==Hint: address points to the zero page.\r\n    #0 0x7faae9b0625f in crl_cb crypto/x509/x_crl.c:258\r\n    #1 0x7faae9811255 in asn1_item_embed_free crypto/asn1/tasn_fre.c:113\r\n    #2 0x7faae9812a65 in asn1_item_embed_new crypto/asn1/tasn_new.c:150\r\n    #3 0x7faae9812a65 in ASN1_item_ex_new crypto/asn1/tasn_new.c:39\r\n    #4 0x7faae980be51 in asn1_item_embed_d2i crypto/asn1/tasn_dec.c:325\r\n    #5 0x7faae980c813 in asn1_template_noexp_d2i crypto/asn1/tasn_dec.c:611\r\n    #6 0x7faae980d288 in asn1_template_ex_d2i crypto/asn1/tasn_dec.c:518\r\n    #7 0x7faae980b9ce in asn1_item_embed_d2i crypto/asn1/tasn_dec.c:382\r\n    #8 0x7faae980caf5 in asn1_template_noexp_d2i crypto/asn1/tasn_dec.c:643\r\n    #9 0x7faae980d7d3 in asn1_template_ex_d2i crypto/asn1/tasn_dec.c:494\r\n    #10 0x7faae980b9ce in asn1_item_embed_d2i crypto/asn1/tasn_dec.c:382\r\n    #11 0x7faae980dd1f in ASN1_item_ex_d2i crypto/asn1/tasn_dec.c:124\r\n    #12 0x7faae980de35 in ASN1_item_d2i crypto/asn1/tasn_dec.c:114\r\n    #13 0x40712c in FuzzerTestOneInput fuzz/asn1.c:301\r\n    #14 0x40893b in testfile fuzz/test-corpus.c:182\r\n    #15 0x406b86 in main fuzz/test-corpus.c:226\r\n    #16 0x7faae8eb1f44 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21f44)\r\n\r\nAddressSanitizer can not provide additional info.\r\nSUMMARY: AddressSanitizer: SEGV crypto/x509/x_crl.c:258 in crl_cb\r\n==1194==ABORTING\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/18360)\r\n\r\n(cherry picked from commit 557825acd622f98fc21423aba092e374db84f483)\r\n\r\n* Fix a memory leak in ec_key_simple_oct2priv\r\n\r\nThis is reproducible with my error injection patch:\r\n\r\n$ ERROR_INJECT=1652710284 ../util/shlib_wrap.sh ./server-test ./corpora/server/4e48da8aecce6b9b58e8e4dbbf0523e6d2dd56dc\r\n140587884632000:error:03078041:bignum routines:bn_expand_internal:malloc failure:crypto/bn/bn_lib.c:282:\r\n140587884632000:error:10103003:elliptic curve routines:ec_key_simple_oct2priv:BN lib:crypto/ec/ec_key.c:662:\r\n140587884632000:error:100DE08E:elliptic curve routines:old_ec_priv_decode:decode error:crypto/ec/ec_ameth.c:464:\r\n140587884632000:error:0D0680A8:asn1 encoding routines:asn1_check_tlen:wrong tag:crypto/asn1/tasn_dec.c:1149:\r\n140587884632000:error:0D07803A:asn1 encoding routines:asn1_item_embed_d2i:nested asn1 error:crypto/asn1/tasn_dec.c:309:Type=X509_ALGOR\r\n140587884632000:error:0D08303A:asn1 encoding routines:asn1_template_noexp_d2i:nested asn1 error:crypto/asn1/tasn_dec.c:646:Field=pkeyalg, Type=PKCS8_PRIV_KEY_INFO\r\n140587884632000:error:0907B00D:PEM routines:PEM_read_bio_PrivateKey:ASN1 lib:crypto/pem/pem_pkey.c:88:\r\n\r\n=================================================================\r\n==19676==ERROR: LeakSanitizer: detected memory leaks\r\n\r\nDirect leak of 24 byte(s) in 1 object(s) allocated from:\r\n    #0 0x7fdd2a6bb09f in __interceptor_malloc ../../../../gcc-trunk/libsanitizer/asan/asan_malloc_linux.cpp:69\r\n    #1 0x7fdd2a2fa430 in CRYPTO_zalloc crypto/mem.c:230\r\n    #2 0x7fdd2a15df11 in BN_new crypto/bn/bn_lib.c:246\r\n    #3 0x7fdd2a15df88 in BN_secure_new crypto/bn/bn_lib.c:257\r\n    #4 0x7fdd2a247390 in ec_key_simple_oct2priv crypto/ec/ec_key.c:655\r\n    #5 0x7fdd2a241fc5 in d2i_ECPrivateKey crypto/ec/ec_asn1.c:1030\r\n    #6 0x7fdd2a23dac5 in old_ec_priv_decode crypto/ec/ec_ameth.c:463\r\n    #7 0x7fdd2a109db7 in d2i_Pri…","distinct":true,"url":"https://api.github.com/repos/open-quantum-safe/openssl/commits/63b48cdde3cdf8dab966e31ea277e03e2d233f57"}]},"public":true,"created_at":"2022-11-21T16:03:54Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
