{"id":"22718330180","type":"PushEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":153498496,"name":"open-quantum-safe/ci-containers","url":"https://api.github.com/repos/open-quantum-safe/ci-containers"},"payload":{"push_id":10357540819,"size":1,"distinct_size":1,"ref":"refs/heads/main","head":"832dc17ebcc576ed78b128ac965303b469cbae5d","before":"27a2bcfa1d376fd937382c0996d0733f636e5255","commits":[{"sha":"832dc17ebcc576ed78b128ac965303b469cbae5d","author":{"email":"57787676+baentsch@users.noreply.github.com","name":"Michael Baentsch"},"message":"enable profiling analysis (#60)\n\n* enable profiling analysis\r\n\r\n* doxygen only for amd64","distinct":true,"url":"https://api.github.com/repos/open-quantum-safe/ci-containers/commits/832dc17ebcc576ed78b128ac965303b469cbae5d"}]},"public":true,"created_at":"2022-07-06T05:43:59Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"22718343090","type":"PushEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"push_id":10357547150,"size":1,"distinct_size":1,"ref":"refs/heads/OQS-OpenSSL_1_1_1-stable","head":"907fdfd3e66cbde3b02584bb4c404161e50512af","before":"7e8053fc09b003de788750e8a0178d3a66411883","commits":[{"sha":"907fdfd3e66cbde3b02584bb4c404161e50512af","author":{"email":"57787676+baentsch@users.noreply.github.com","name":"Michael Baentsch"},"message":"upstream 111q merge (#377)\n\n* make update (adds a new function code)\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16027)\r\n\r\n* Avoid \"excessive message size\" for session tickets\r\n\r\nWe received a report of an \"excessive message size\" for a received\r\nsession ticket. Our maximum size was significantly less than the theoretical\r\nmaximum. The server may put any data it likes in the session ticket\r\nincluding (for example) the full certificate chain so we should be able to\r\nhandle longer tickets. Update the value to the maximum allowed by the spec.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/15877)\r\n\r\n(cherry picked from commit e54f0c9b2fe3dd2dcb5e8100e2c69e5b2f6eb681)\r\n\r\n* BIO_lookup_ex: use AI_ADDRCONFIG only if explicit host name is given\r\n\r\nThe flag only affects which record types are queried via DNS (A or\r\nAAAA, or both).  When node is NULL and AF_UNSPEC is used, it prevents\r\ngetaddrinfo returning the right address associated with the loopback\r\ninterface.\r\n\r\nSigned-off-by: Daiki Ueno <dueno@redhat.com>\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16039)\r\n\r\n* Avoid empty lines in nmake rule bodies\r\n\r\nnmake is tolerant of those empty lines, but jom isn't.  That tolerance\r\nisn't standard make behaviour, so we lean towards avoiding them.\r\n\r\nWe simply use '@rem' instead.\r\n\r\nFixes #16014\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16047)\r\n\r\n* apps: Use the first detected address family if IPv6 is not available\r\n\r\nThis is a follow up of 15729bef385211bc2a0497e2d53a45c45d677d2c.  Even\r\nwhen the host does not support IPv6 at all, BIO_lookup_ex may now\r\nreturn IN6ADDR_ANY in addition to INADDR_ANY, as the second element of\r\nthe ai_next field.\r\n\r\nAfter eee8a40aa5e06841eed6fa8eb4f6109238d59aea, the do_server function\r\nprefers the IPv6 address and fails on the BIO_socket call.  This adds\r\na fallback code to retry with the IPv4 address returned as the first\r\nelement to avoid the error.\r\n\r\nThe failure had been partially avoided in the previous code with\r\nAI_ADDRCONFIG, because getaddrinfo returns only IPv4 address if no\r\nIPv6 address is associated with external interface.  However, it would\r\nbe still a problem if the external interface has an IPv6 address\r\nassigned, while the loopback interface doesn't.\r\n\r\nSigned-off-by: Daiki Ueno <dueno@redhat.com>\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16078)\r\n\r\n* Don't reset the packet pointer in ssl3_setup_read_buffer\r\n\r\nSometimes this function gets called when the buffers have already been\r\nset up. If there is already a partial packet in the read buffer then the\r\npacket pointer will be set to an incorrect value. The packet pointer already\r\ngets reset to the correct value when we first read a packet anyway, so we\r\ndon't also need to do it in ssl3_setup_read_buffer.\r\n\r\nFixes #13729\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16098)\r\n\r\n* Disallow SSL_key_update() if there are writes pending\r\n\r\nIf an application is halfway through writing application data it should\r\nnot be allowed to attempt an SSL_key_update() operation. Instead the\r\nSSL_write() operation should be completed.\r\n\r\nFixes #12485\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16098)\r\n\r\n* Fix some minor record layer issues\r\n\r\nVarious comments referred to s->packet and s->packet_length instead of\r\ns->rlayer.packet and s->rlayer.packet_length. Also fixed is a spot where\r\nRECORD_LAYER_write_pending() should have been used. Based on the review\r\ncomments in #16077.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\n\r\n(cherry picked from commit ca001524971ccd595bc0e9843611e6784adfc981)\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16105)\r\n\r\n* Fix a read buffer overrun in X509_aux_print().\r\n\r\nThe ASN1_STRING_get0_data(3) manual explitely cautions the reader\r\nthat the data is not necessarily NUL-terminated, and the function\r\nX509_alias_set1(3) does not sanitize the data passed into it in any\r\nway either, so we must assume the return value from X509_alias_get0(3)\r\nis merely a byte array and not necessarily a string in the sense\r\nof the C language.\r\n\r\nI found this bug while writing manual pages for X509_print_ex(3)\r\nand related functions.  Theo Buehler <tb@openbsd.org> checked my\r\npatch to fix the same bug in LibreSSL, see\r\n\r\nhttp://cvsweb.openbsd.org/src/lib/libcrypto/asn1/t_x509a.c#rev1.9\r\n\r\nAs an aside, note that the function still produces incomplete and\r\nmisleading results when the data contains a NUL byte in the middle\r\nand that error handling is consistently absent throughout, even\r\nthough the function provides an \"int\" return value obviously intended\r\nto be 1 for success and 0 for failure, and even though this function\r\nis called by another function that also wants to return 1 for success\r\nand 0 for failure and even does so in many of its code paths, though\r\nnot in others.  But let's stay focussed.  Many things would be nice\r\nto have in the wide wild world, but a buffer overflow must not be\r\nallowed to remain in our backyard.\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Tim Hudson <tjh@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16108)\r\n\r\n(cherry picked from commit c5dc9ab965f2a69bca964c709e648158f3e4cd67)\r\n\r\n* DSA/RSA_print(): Fix potential memory leak\r\n\r\nFixes #10777\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16130)\r\n\r\n(cherry picked from commit 40184c96103a388209939c1c19920971c05bb78c)\r\n\r\n* [doc/man3] documentation: BN_cmp manpage updates\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16214)\r\n\r\n(cherry picked from commit 3d4ca443b4778e3230ff23f17625f58f815a9142)\r\n\r\n* Revert \"make update (adds a new function code)\"\r\n\r\nThis reverts commit ea26844c4f624ef515d9228d3b623761a369b049.\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16308)\r\n\r\n* Revert \"Fix test/asn1_encode_test.c to handle encoding/decoding failure\"\r\n\r\nThis reverts commit f1d97905bbd8679b7647c992b97f526791069040.\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16308)\r\n\r\n* Revert \"Fix test/asn1_encode_test.c to not use ASN1_FBOOLEAN\"\r\n\r\nThis reverts commit 5434acb6c4d56507d761b28f7e142ccab808a8fa.\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16308)\r\n\r\n* Revert \"ASN.1: Refuse to encode to DER if non-optional items are missing\"\r\n\r\nThis reverts commit 006906cddda37e24a66443199444ef4476697477.\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16308)\r\n\r\n* Revert \"TEST: Check that i2d refuses to encode non-optional items with no content\"\r\n\r\nThis reverts commit 12e9b74c513a8ed3c1c260cf25221a465ae14b84.\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16308)\r\n\r\n* Fix potential double-free\r\n\r\nThe `sk` variable is assigned to `s->session->peer_chain`.\r\nIf `ssl3_digest_cached_records()` were to fail, then `sk` would still be\r\nnon-NULL, and subsequently freed on the error return. When the session\r\nis freed, it will then attempt to free `s->session->peer_chain`,\r\nresulting in a double-free (of `sk`).\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16309)\r\n\r\n(cherry picked from commit 0449702abc95a3af24c049cb02c01ca6a8015cef)\r\n\r\n* s390x: AES OFB/CFB: Maintain running IV from cipher context\r\n\r\nCopy the current IV from the cipher context into the kmo/kmf param before\r\nthe operation, and copy the modified IV back to the context afterwards.\r\nWithout this, an application that obtains the running IV from the context\r\nwould still get the original IV, but not the updated one.\r\n\r\nSigned-off-by: Ingo Franzki <ifranzki@linux.ibm.com>\r\n\r\nReviewed-by: Patrick Steuer <patrick.steuer@de.ibm.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16292)\r\n\r\n* Test EVP Cipher updating the context's IV\r\n\r\nEnsure that an EVP_CipherUpdate operation updates the context's\r\nIV for AES CBC, CFB, OFB, and CTR. An application can get the\r\nupdated IV via EVP_CIPHER_CTX_iv().\r\n\r\nThe s390x implementation of the CFB and OFB ciphers did not\r\nupdate the IV in the context, but only within its s390x specific\r\ncontext data.\r\n\r\nSigned-off-by: Ingo Franzki <ifranzki@linux.ibm.com>\r\n\r\nReviewed-by: Patrick Steuer <patrick.steuer@de.ibm.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16292)\r\n\r\n* pkcs12: check for zero length digest to avoid division by zero\r\n\r\nFixes #16331\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\nReviewed-by: Kurt Roeckx <kurt@roeckx.be>\r\n(Merged from https://github.com/openssl/openssl/pull/16333)\r\n\r\n* [github-ci] Sync ci.yml workflow with master\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci] Import windows.yml workflow from master\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci] Import cross-compiles.yml workflow from master\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci] Import run-checker workflows from master\r\n\r\nThis commit does not include the daily run-checker workflow.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci] Import run-checker daily workflow from master\r\n\r\nThe daily run-checker is scheduled to start at 6:42, instead of the\r\nstart of the hour.\r\n\r\nThe official GitHub documentation remarks the following regarding\r\nscheduled workflows:\r\n\r\n> Note: The schedule event can be delayed during periods of high loads\r\n> of GitHub Actions workflow runs. High load times include the start of\r\n> every hour. To decrease the chance of delay, schedule your workflow to\r\n> run at a different time of the hour.\r\n\r\n42, obviously, has been picked because it is the answer to the ultimate\r\nquestion of life, the universe, and everything.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci][cross-compiles.yml] Disable sparcv9\r\n\r\nThis commit temporarily disables cross-compiling tests for sparcv9, due\r\nto failures to be investigated in a dedicated PR.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci][ci.yml] Disable krb5 external tests\r\n\r\nThis commit temporarily disables krb5 external tests,\r\ndue to failures to be investigated in a dedicated PR.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci][ci.yml] Disable pyca external tests\r\n\r\nThis commit temporarily disables pyca external tests,\r\ndue to failures to be investigated in a dedicated PR.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci][run-checker-ci.yml] Disable no-tls1_3 tests\r\n\r\nThis commit temporarily disables tests for no-tls1_3,\r\ndue to failures to be investigated in a dedicated PR.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci][ci.yml] Disable memory sanitizer build\r\n\r\nIn 1.1.1 currently we do not support running multiple tests in parallel,\r\nand the `--debug -O1` msan build required more than 3h to run the tests.\r\n\r\nThis commit temporarily disables this build configuration.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci][run-checker-merge.yml] Disable ubsan build\r\n\r\nThis commit temporarily disables the ubsan build,\r\ndue to failures to be investigated in a dedicated PR.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* [github-ci] Add comment about our approach to GitHub Actions CI\r\n\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16252)\r\n\r\n* Revert \"[github-ci][cross-compiles.yml] Disable sparcv9\"\r\n\r\nThis reverts commit aa23aa759cf33b4f481fc719d42cb7bae8b2eaf0.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16336)\r\n\r\n* sparc: fix cross compile build\r\n\r\n(cherry picked from commit 64fac96de81d3dc19cc0c9045c341f0dec818075)\r\n\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16336)\r\n\r\n* Fix i2v_GENERAL_NAME to not assume NUL terminated strings\r\n\r\nASN.1 strings may not be NUL terminated. Don't assume they are.\r\n\r\nCVE-2021-3712\r\n\r\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n* Fix POLICYINFO printing to not assume NUL terminated strings\r\n\r\nASN.1 strings may not be NUL terminated. Don't assume they are.\r\n\r\nCVE-2021-3712\r\n\r\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n* Fix printing of PROXY_CERT_INFO_EXTENSION to not assume NUL terminated strings\r\n\r\nASN.1 strings may not be NUL terminated. Don't assume they are.\r\n\r\nCVE-2021-3712\r\n\r\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n* Fix the name constraints code to not assume NUL terminated strings\r\n\r\nASN.1 strings may not be NUL terminated. Don't assume they are.\r\n\r\nCVE-2021-3712\r\n\r\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n* Fix test code to not assume NUL terminated strings\r\n\r\nASN.1 strings may not be NUL terminated. Don't assume they are.\r\n\r\nCVE-2021-3712\r\n\r\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n* Fix append_ia5 function to not assume NUL terminated strings\r\n\r\nASN.1 strings may not be NUL terminated. Don't assume they are.\r\n\r\nCVE-2021-3712\r\n\r\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n* Fix NETSCAPE_SPKI_print function to not assume NUL terminated strings\r\n\r\nASN.1 strings may not be NUL terminated. Don't assume they are.\r\n\r\nCVE-2021-3712\r\n\r\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n* Fix EC_GROUP_new_from_ecparameters to check the base length\r\n\r\nCheck that there's at least one byte in params->base before trying to\r\nread it.\r\n\r\nCVE-2021-3712\r\n\r\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n* Allow fuzz builds to detect string overruns\r\n\r\nIf FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION is defined then we don't NUL\r\nterminate ASN1_STRING datatypes. This shouldn't be necessary but we add it\r\nany for safety in normal builds.\r\n\r\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n* Fix the error handling in i2v_AUTHORITY_KEYID\r\n\r\nPreviously if an error path is entered a leak could result.\r\n\r\nReviewed-by: Viktor Dukhovni <viktor@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n* Correctly calculate the length of SM2 plaintext given the ciphertext\r\n\r\nPreviously the length of the SM2 plaintext could be incorrectly calculated.\r\nThe plaintext length was calculated by taking the ciphertext length and\r\ntaking off an \"overhead\" value.\r\n\r\nThe overhead value was assumed to have a \"fixed\" element of 10 bytes.\r\nThis is incorrect since in some circumstances it can be more than 10 bytes.\r\nAdditionally the overhead included the length of two integers C1x and C1y,\r\nwhich were assumed to be the same length as the field size (32 bytes for\r\nthe SM2 curve). However in some cases these integers can have an additional\r\npadding byte when the msb is set, to disambiguate them from negative\r\nintegers. Additionally the integers can also be less than 32 bytes in\r\nlength in some cases.\r\n\r\nIf the calculated overhead is incorrect and larger than the actual value\r\nthis can result in the calculated plaintext length being too small.\r\nApplications are likely to allocate buffer sizes based on this and therefore\r\na buffer overrun can occur.\r\n\r\nCVE-2021-3711\r\n\r\nIssue reported by John Ouyang.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\n\r\n* Extend tests for SM2 decryption\r\n\r\nCheck the case where C1y < 32 bytes in length (i.e. short overhead), and\r\nalso the case with longer plaintext and C1x and C1y > 32 bytes in length\r\n(i.e. long overhead)\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\n\r\n* Check the plaintext buffer is large enough when decrypting SM2\r\n\r\nPreviously there was no check that the supplied buffer was large enough.\r\nIt was just assumed to be sufficient. Instead we should check and fail if\r\nnot.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\n\r\n* Updates to CHANGES and NEWS for the new release\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Update copyright year\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Run make update\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Prepare for 1.1.1l release\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Prepare for 1.1.1m-dev\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Fix the array size of dtlsseq in tls1_enc\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16385)\r\n\r\n(cherry picked from commit 562d4cd3c35b32f2bc6ac0770b80ce394f8d76a4)\r\n\r\n* Avoid using undefined value in generate_stateless_cookie_callback\r\n\r\nReviewed-by: Paul Yang <kaishen.yy@antfin.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16381)\r\n\r\n* Fix some strict gcc-12 warnings\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16375)\r\n\r\n* apps/ciphers: Fix wrong return value when using -convert parameter\r\n\r\nCommand 'openssl ciphers -convert <name>' always returns failure,\r\nthis patch set the correct return value.\r\n\r\nSigned-off-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>\r\n\r\nReviewed-by: Paul Yang <kaishen.yy@antfin.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16383)\r\n\r\n(cherry picked from commit 8b4e9c5265ffd3457ad37133502a9d8a4e8daccd)\r\n\r\n* Check for null-pointer dereference in dh_cms_set_peerkey\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16382)\r\n\r\n* ts: fix memleaks caused by TS_VERIFY_CTX_set_imprint\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16347)\r\n\r\n(cherry picked from commit 62bae84d4587ec9a56d0ce830e36e4a5b2fa8a33)\r\n\r\n* Darwin platform allows to build on releases before Yosemite/ios 8.\r\n\r\nissue #16407 #16408\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16409)\r\n\r\n* cms: fix memleaks in cms_env.c\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16403)\r\n\r\n* Fix instances of pointer addition with the NULL pointer\r\n\r\nubsan found undefined pointer addtions in\r\ncrypto/bio/bss_mem.c (mem_ctrl),\r\ncrypto/pem/pem_lib.c (PEM_read_bio_ex),\r\ntest/testutil/format_output.c (test_fail_string_common,\r\ntest_fail_memory_common).\r\n\r\nMostly a straight back-port-of: a07dc81\r\n\r\nAdditionally enable the ubsan run-checker, to prevent regressions.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16423)\r\n\r\n* Fix enable-asan with C++ buildtest\r\n\r\nthe following config:\r\n\r\n./config no-shared enable-asan enable-buildtest-c++ enable-external-tests\r\n\r\nfails to build with unresolved asan symbols when linking\r\ntest/ossl_shim/ossl_shim\r\n\r\nFixed by passing all sanitizer-flags to cxxflags.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16434)\r\n\r\n* Fix the \"Out of memory\" EVP KDF scrypt test\r\n\r\nThis test did not really execute, since usually\r\nthe OPENSSL_malloc(0) will fail and prevent the\r\nexecution of the KDF.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16446)\r\n\r\n* Ensure that _GNU_SOURCE is defined for bss_dgram.c\r\n\r\nThis fixes the following error with gcc10 under strict ANSI conditions:\r\n\r\n.../crypto/bio/bss_dgram.c:373:20: error: 'const struct in6_addr' has no member named 's6_addr32'\r\n\r\nCLA: trivial\r\nFixes #16449\r\n\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16451)\r\n\r\n(cherry picked from commit e8e1f6d1a9e599d575431f559200018b8f822e0f)\r\n\r\n* Fix no-tls1_3 tests\r\n\r\nThis recently added test needs DH2048 to work without tls1_3.\r\n\r\nFixes: #16335\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16453)\r\n\r\n* Add tests for i2d_TYPE_fp and d2i_TYPE_fp\r\n\r\nThese functions are part of the public API but we don't have tests\r\ncovering their usage.\r\nThey are actually implemented as macros and the absence of tests has\r\ncaused them to fall out-of-sync with the latest changes to ASN1 related\r\nfunctions and cause compilation warnings.\r\n\r\n@@ Note: This commit limits to ECPKParameters as a type.\r\n\r\n(cherry picked from commit ea1128e94e36fa9fa25278dc6b3f5b42d8735782)\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/12457)\r\n\r\n* Fix d2i_ECPKParameters_fp and i2d_ECPKParameters_fp macros\r\n\r\nThese functions are part of the public API but we don't have tests\r\ncovering their usage.\r\nThey are actually implemented as macros and the absence of tests has\r\ncaused them to fall out-of-sync with the latest changes to ASN1 related\r\nfunctions and cause compilation warnings.\r\n\r\nThis commit fixes the public headers to reflect these changes.\r\n\r\nFixes #12443\r\n\r\n(cherry picked from commit cca8a4cedaafe63b0b5729b72133661ece24ff08)\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/12457)\r\n\r\n* [ec] Do not default to OPENSSL_EC_NAMED_CURVE for curves without OID\r\n\r\nSome curves don't have an associated OID: for those we should not\r\ndefault to `OPENSSL_EC_NAMED_CURVE` encoding of parameters and instead\r\nset the ASN1 flag to `OPENSSL_EC_EXPLICIT_CURVE`.\r\n\r\nThis is a follow-up to https://github.com/openssl/openssl/pull/12312\r\n\r\n(cherry picked from commit 7aa3dfc42104588f65301d20324388ac2c9a6b11)\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/12457)\r\n\r\n* Use applink to fix windows tests\r\n\r\n(cherry picked from commit <https://github.com/bernd-edlinger/openssl/commit/96a463cede0070aa5c86629d683a214657a9ba9e>)\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/12457)\r\n\r\n* Make the -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION pass tests\r\n\r\nFixes #16428\r\n\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16441)\r\n\r\n* ci: Add -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION to asan build\r\n\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16441)\r\n\r\n* Openssl fails to compile on Debian with kfreebsd kernels\r\n(kfreebsd-amd64, kfreebsd-i386). The error reported by the compiler\r\nis:\r\n\r\n../crypto/uid.c: In function 'OPENSSL_issetugid':\r\n../crypto/uid.c:50:22: error: 'AT_SECURE' undeclared (first use in this function)\r\n   50 |     return getauxval(AT_SECURE) != 0;\r\n      |                      ^~~~~~~~~\r\n\r\nThis commit changes the code to use the freebsd code in this case.\r\nThis fixes the compilation.\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16477)\r\n\r\n(cherry picked from commit 3a1fa0116a92235ba200228e4bb60d6a3a7f4113)\r\n\r\n* doc: document the rsa_oaep_md: pkeyopt\r\n\r\nThis was missing but essential for using non-SHA1 digests with OAEP.\r\n\r\nFixes #15998\r\n\r\nManual backport of #16410\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Tim Hudson <tjh@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16488)\r\n\r\n* Prioritise DANE TLSA issuer certs over peer certs\r\n\r\nWhen building the certificate chain, prioritise any Cert(0) Full(0)\r\ncertificates from TLSA records over certificates received from the peer.\r\n\r\nThis is important when the server sends a cross cert, but TLSA records include\r\nthe underlying root CA cert.  We want to construct a chain with the issuer from\r\nthe TLSA record, which can then match the TLSA records (while the associated\r\ncross cert may not).\r\n\r\nReviewed-by: Tomáš Mráz <tomas@openssl.org>\r\n\r\n* Test for DANE cross cert fix\r\n\r\nReviewed-by: Tomáš Mráz <tomas@openssl.org>\r\n\r\n* test/ec_internal_test: link with libapps.a too\r\n\r\nWhenever the source from $target{apps_init_src} is added to the source\r\nof a test program, it needs to be linked with libapps.a as well.  Some\r\ninit sources depend on that.\r\n\r\nWithout this, builds break on VMS because of the unresolved symbol\r\n'app_malloc'.\r\n\r\nOn platforms that do not need anything from libapps.a, adding it is a\r\nno-op.\r\n\r\nThis is for OpenSSL 1.1.1 only.  OpenSSL 3.0 and beyond have a\r\ndifferent solution.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16512)\r\n\r\n* VMS: Compensate for compiler type incompatibility\r\n\r\nThe compiler says that 'unsigned long long' isn't the same as\r\n'unsigned __int64'.  Sure, and considering that crypto/rand/rand_vms.c\r\nis specific VMS only code, it's easy to just change the type to the\r\nexact same as what's specified in the system headers.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/15613)\r\n\r\n* DOCS: Update the page for 'openssl passwd' to not duplicate some info\r\n\r\nThe options -1 and -apr1 were mentioned in DESCRIPTION, not mentioning\r\nany other options or even mentioning that there are more algorithms.\r\nThe simple fix is to remove that sentence and let the OPTIONS section\r\nspeak for itself.\r\n\r\nFixes #16529\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16531)\r\n\r\n(cherry picked from commit 116799ff6a8fc803ec4685fc432c7329d0511e23)\r\n\r\n* VMS: Fix misspelt type\r\n\r\n'__int64', not 'int64_t'\r\n\r\nRef: commit 2e5cdbc18a1a26bfc817070a52689886fa0669c2\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16557)\r\n\r\n* Fix nc_email to check ASN1 strings with NULL byte in the middle\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16524)\r\n\r\n(cherry picked from commit 485d0790ac1a29a0d4e7391d804810d485890376)\r\n\r\n* MacOS prior to 10.12 does not support random API correctly\r\n\r\nFixes #16517\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16587)\r\n\r\n* Clarify what SSL_get_session() does on the server side in TLSv1.3\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16582)\r\n\r\n(cherry picked from commit 9e51f877930dbd4216438a5da3c9612bf4d0a918)\r\n\r\n* Correct the documentation for SSL_set_num_tickets()\r\n\r\nThe behaviour for what happens in a resumption connection was not quite\r\ndescribed correctly.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16582)\r\n\r\n(cherry picked from commit 4603b782e6dbed493d2f38db111abc05df66fb99)\r\n\r\n* ssl: Correct filename in README\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16671)\r\n\r\n* Add sm2 encryption test case from GM/T 0003.5-2012\r\n\r\nReviewed-by: Nicola Tuveri <nic.tuv@gmail.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16511)\r\n\r\n(cherry picked from commit 8ba65c35ea3af347c3b2adc8e665066b541a1c35)\r\n\r\n* doc/man3/SSL_set_fd.pod: add note about Windows compiler warning\r\n\r\nAccording to an old stackoverflow thread [1], citing an even older comment by\r\nAndy Polyakov (1875e6db29, Pull up Win64 support from 0.9.8., 2005-07-05),\r\na cast of 'SOCKET' (UINT_PTR) to 'int' does not create a problem, because although\r\nthe documentation [2] claims that the upper limit is INVALID_SOCKET-1 (2^64 - 2),\r\nin practice the socket() implementation on Windows returns an index into the kernel\r\nhandle table, the size of which is limited to 2^24 [3].\r\n\r\nAdd this note to the manual page to avoid unnecessary roundtrips to StackOverflow.\r\n\r\n[1] https://stackoverflow.com/questions/1953639/is-it-safe-to-cast-socket-to-int-under-win64\r\n[2] https://docs.microsoft.com/en-us/windows/win32/winsock/socket-data-type-2\r\n[3] https://docs.microsoft.com/en-us/windows/win32/sysinfo/kernel-objects\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16699)\r\n\r\n(cherry picked from commit f8dd5869bca047a23599ac925aace70efcf487ad)\r\n\r\n* Fix a NPD bug in engines/e_dasync.c\r\n\r\nThe dasync_aes_128_cbc_hmac_sha1 cipher depends on\r\nEVP_aes_128_cbc_hmac_sha1() returning a NON-NULL value.\r\nWe should simply not advertise this cipher otherwise.\r\n\r\nFixes: #7950\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16722)\r\n\r\n* Fix a memory leak in the afalg engine\r\n\r\nFixes: #16743\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16744)\r\n\r\n(cherry picked from commit 6f6a5e0c7c41b6b3639e51f435cd98bb3ae061bc)\r\n\r\n* Fix some possible memory leaks in EVP_CipherInit_ex\r\n\r\nAn EVP_CONTEXT with zero cipher but non-zero engine,\r\nand/or cipher_data is possible if an error happens\r\nin EVP_CTRL_INIT or in EVP_CTRL_COPY, the error handling\r\nwill just clear the cipher in that case.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16756)\r\n\r\n* Fix double-free in e_dasync.c\r\n\r\nWhen the cipher is copied, the inner_cihper_data\r\nneed to be copied as well, using the EVP_CTRL_COPY method.\r\nThe EVP_CIPH_CUSTOM_COPY bit needs to be set as well.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16751)\r\n\r\n* Bindhost/bindport should be freed\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16775)\r\n\r\n(cherry picked from commit 0ce0c455862ed29bd7f2acdbddbe8d0b1783c1c9)\r\n\r\n* New extensions can be sent in a certificate request\r\n\r\nNormally we expect a client to send new  extensions in the ClientHello,\r\nwhich may be echoed back by the server in subsequent messages. However the\r\nserver can also send a new extension in the certificate request message to\r\nbe echoed back in a certificate message\r\n\r\nFixes #16632\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16634)\r\n\r\n(cherry picked from commit cbb862fbaaa1ec5a3e33836bc92a6dbea97ceba0)\r\n\r\n* Extend custom extension testing\r\n\r\nTest the scenario where we add a custom extension to a cetificate\r\nrequest and expect a response in the client's certificate message.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16634)\r\n\r\n(cherry picked from commit 0db3a9904fa00569905be130854a31dab7b8f49d)\r\n\r\n* Fix test/recipes/01-test_symbol_presence.t to allow for stripped libraries\r\n\r\nIt's a small change to the 'nm' call, to have it look at dynamic symbols\r\nrather than the normal ones.\r\n\r\nFixes #16810\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16822)\r\n\r\n(cherry picked from commit a85b4de6a6cbe03c46219d4b1c3b2828ca3fd51c)\r\n\r\n* Fix test/recipes/01-test_symbol_presence.t to disregard version info\r\n\r\nThe output of 'nm -DPg' contains version info attached to the symbols,\r\nwhich makes the test fail.  Simply dropping the version info makes the\r\ntest work again.\r\n\r\nFixes #16810 (followup)\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16840)\r\n\r\n(cherry picked from commit 73970cb91fdf8e7b4b434d479b875a47a0aa0dbc)\r\n\r\n* test/ssl_old_test.c: Fix potential leak\r\n\r\nReviewed-by: Kurt Roeckx <kurt@roeckx.be>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16806)\r\n\r\n(cherry picked from commit 34563be5368fb8e6ade7d06d8376522ba83cd6ac)\r\n\r\n* Ensure pkey_set_type handles ENGINE references correctly\r\n\r\npkey_set_type should not consume the ENGINE references that may be\r\npassed to it.\r\n\r\nFixes #16757\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16860)\r\n\r\n* Add tests for ENGINE problems\r\n\r\nAdd some tests which would have caught the issues fixed in the previous\r\ncommit related to engine handling.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16860)\r\n\r\n* Fix some documentation errors related to return values\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16794)\r\n\r\n(cherry picked from commit f1d077f1108b1bc2334350a4d53a46e29e082910)\r\n\r\n* Fix BIO_get_md_ctx return value check\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16792)\r\n\r\n* Fix the s_server psk_server_cb for use in DTLS\r\n\r\nCommit 0007ff257c added a protocol version check to psk_server_cb but\r\nfailed to take account of DTLS causing DTLS based psk connections to\r\nfail.\r\n\r\nFixes #16707\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\n(Merged from https://github.com/openssl/openssl/pull/16838)\r\n\r\n(cherry picked from commit 8b09a9c76d873f62c2507fa9628a9c96c1d66d5c)\r\n\r\n* Fix no-cmac\r\n\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16894)\r\n\r\n(cherry picked from commit ef2fb64f9dfde1965cb0b8a5f8765c4f467c1604)\r\n\r\n* Fix a gcc 11.2.0 warning\r\n\r\ngcc 11.2.0 is the default on Ubuntu 21.10. It emits a (spurious) warning\r\nwhen compiling test/packettest.c, which causes --strict-warnings builds\r\nto fail. A simple fix avoids the warning.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/16887)\r\n\r\n(cherry picked from commit 37467b2752f75ce80437120f704452982b7c1998)\r\n\r\n* speed: range check the argument given to -multi for 1.1.1\r\n\r\nFixes #16899 for 1.1.1 branch.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16922)\r\n\r\n* check the return value of BN_new() and BN_dup()\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16948)\r\n\r\n(cherry picked from commit d99004fe5de934120765d342586f08d22131b8ed)\r\n\r\n* Fix a memory leak in tls_parse_stoc_key_share\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16957)\r\n\r\n* Fix a memory leak in ssl_create_cipher_list\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16955)\r\n\r\n* Fix: invoking x509_name_cannon improperly\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16974)\r\n\r\n(cherry picked from commit 09235289c377ff998964bb6b074bb2a3ad768fd2)\r\n\r\n* Reset the rwstate before calling ASYNC_start_job()\r\n\r\nIf an async job pauses while processing a TLS connection then the\r\nrwstate gets set to SSL_ASYNC_PAUSED. When resuming the job we should\r\nreset the rwstate back to SSL_NOTHING. In fact we can do this\r\nunconditionally since if we're about to call ASYNC_start_job() then either\r\nwe are about to start the async job for the first time (in which case the\r\nrwstate should already by SSL_NOTHING), or we are restarting it after a\r\npause (in which case reseting it to SSL_NOTHING is the correct action).\r\n\r\nFixes #16809\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17013)\r\n\r\n(cherry picked from commit 07f620e3acf0dd76a3a03ada9911c544aa483aa7)\r\n\r\n* free the Post-Handshake Auth digest when there is an error saving the digest\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/16924)\r\n\r\n* evp: fix EVP_PKEY_get0_EC_KEY when EC_KEY is SM2\r\n\r\nEVP_PKEY_set_alias_type(pkey, EVP_PKEY_SM2) will change pkey->type to EVP_PKEY_SM2\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17015)\r\n\r\n* Avoid loading of a dynamic engine twice\r\n\r\nUse the address of the bind function as a DYNAMIC_ID,\r\nsince the true name of the engine is not known\r\nbefore the bind function returns,\r\nbut invoking the bind function before the engine\r\nis unloaded results in memory corruption.\r\n\r\nFixes #17023\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17073)\r\n\r\n(cherry picked from commit e2571e02d2b0cd83ed1c79d384fe941f27e603c0)\r\n\r\n* ERR: Add a missing common reason string\r\n\r\nThere was no string present for ERR_R_PASSED_INVALID_ARGUMENT\r\n\r\nReviewed-by: David von Oheimb <david.von.oheimb@siemens.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17069)\r\n\r\n* Add a test case for duplicate engine loading\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17083)\r\n\r\n* DOC: Add a few previously documented functions\r\n\r\nd2i_X509_bio(), d2i_X509_fp(), i2d_X509_bio(), and i2d_X509_fp()\r\nwere documented in OpenSSL 1.0.2.  In a grand unification of the\r\ndocumentation of (almost) all d2i and i2d functions, these were\r\ndropped, most likely by mistake.\r\n\r\nThis simply adds them back.\r\n\r\nFixes #17091\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17093)\r\n\r\n* Fix detection of ARMv7 and ARM64 CPU features on FreeBSD\r\n\r\nOpenSSL assumes AT_HWCAP = 16 (as on Linux), but on FreeBSD AT_HWCAP = 25\r\nSwitch to using AT_HWCAP, and setting it to 16 if it is not defined.\r\n\r\nOpenSSL calls elf_auxv_info() with AT_CANARY which returns ENOENT\r\nresulting in all ARM acceleration features being disabled.\r\n\r\nCLA: trivial\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17082)\r\n\r\n(cherry picked from commit c1dabe26e3e96cdce0ffc929e9677840ad089ba5)\r\n\r\n* Clarify and correct the EVP_CTRL_AEAD_SET_TAG docs\r\n\r\nThe restriction about setting a tag length prior to setting the IV only\r\napplies to OCB mode. We clarify when in the process EVP_CTRL_AEAD_SET_TAG\r\ncan be called.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17111)\r\n\r\n(cherry picked from commit 3607b8ad8ee1980a079e985333a196e0c79f8f00)\r\n\r\n* doc: fix macro name\r\n\r\nOSSL_STORE_INFO_X509 doesn't exist.  It should be OSSL_STORE_INFO_CERT.\r\n\r\nFixes #17121\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17125)\r\n\r\n(cherry picked from commit 01fde90eec721b64bc0e1c01cd94a9fd431adcc6)\r\n\r\n* BIO_push.pod: fix confusing text and add details on corner cases\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17086)\r\n\r\n(cherry picked from commit 7a37fd09a8f3607ed8acf55e03479861595be069)\r\n\r\n* Fix speed, use OPENSSL_free instead of free\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17132)\r\n\r\n* TEST: Enable and fix test_bn2padded() in test/bntest.c\r\n\r\nThis looks like old code, written when the padded variety of BN_bn2bin()\r\nwas developped, and disabled by default...  and forgotten.\r\n\r\nA few simple changes to update it to the current API is all that was\r\nneeded to enable it.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17133)\r\n\r\n(cherry picked from commit 23750f677ef61b6bea4e81f23f335ad08fc49b51)\r\n\r\n* No EtM for GOST ciphers\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17158)\r\n\r\n* Fix ssl_free() and thus BIO_free() to respect BIO_NOCLOSE\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17135)\r\n\r\n* BIO_f_ssl.pod: Make clear where an SSL BIOs are expected as an argument\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17135)\r\n\r\n* Fix documentation for tlsext_ticket_key\r\n\r\nThe tlsext_ticket_key functions are documented as returning 0 on success.\r\nIn fact they return 1 on success.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17210)\r\n\r\n(cherry picked from commit b0be101326f369f0dd547556d2f3eb3ef5ed0e33)\r\n\r\n* OBJ_nid2obj.pod: Replace remaining 'B<' by 'I<' were appropriate\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17221)\r\n\r\n* Fix a deadlock in OBJ_NAME_add\r\n\r\nThis happened after an out of memory error:\r\nCRYPTO_THREAD_write_lock may hang in OBJ_NAME_add.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17236)\r\n\r\n* CI: Replace windows-2016 with windows-2022\r\n\r\nWindows 2016 environment is going to be discontinued.\r\n\r\nWe also replace windows-latest with windows-2019 so\r\nthere aren't two identical builds done once windows-latest\r\nis switched to mean windows-2022.\r\n\r\nFixes #17177\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17211)\r\n\r\n* Fix faulty detail in BN_rand() manual\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17131)\r\n\r\n* Fix a carry overflow bug in bn_sqr_comba4/8 for mips 32-bit targets\r\n\r\nbn_sqr_comba8 does for instance compute a wrong result for the value:\r\na=0x4aaac919 62056c84 fba7334e 1a6be678 022181ba fd3aa878 899b2346 ee210f45\r\n\r\nThe correct result is:\r\nr=0x15c72e32 605a3061 d11b1012 3c187483 6df96999 bd0c22ba d3e7d437 4724a82f\r\n    912c5e61 6a187efe 8f7c47fc f6945fe5 75be8e3d 97ed17d4 7950b465 3cb32899\r\n\r\nbut the actual result was:\r\nr=0x15c72e32 605a3061 d11b1012 3c187483 6df96999 bd0c22ba d3e7d437 4724a82f\r\n    912c5e61 6a187efe 8f7c47fc f6945fe5 75be8e3c 97ed17d4 7950b465 3cb32899\r\n\r\nso the forth word of the result was 0x75be8e3c but should have been\r\n0x75be8e3d instead.\r\n\r\nLikewise bn_sqr_comba4 has an identical bug for the same value as well:\r\na=0x022181ba fd3aa878 899b2346 ee210f45\r\n\r\ncorrect result:\r\nr=0x00048a69 9fe82f8b 62bd2ed1 88781335 75be8e3d 97ed17d4 7950b465 3cb32899\r\n\r\nwrong result:\r\nr=0x00048a69 9fe82f8b 62bd2ed1 88781335 75be8e3c 97ed17d4 7950b465 3cb32899\r\n\r\nFortunately the bn_mul_comba4/8 code paths are not affected.\r\n\r\nAlso the mips64 target does in fact not handle the carry propagation\r\ncorrectly.\r\n\r\nExample:\r\na=0x4aaac91900000000 62056c8400000000 fba7334e00000000 1a6be67800000000\r\n    022181ba00000000 fd3aa87800000000 899b234635dad283 ee210f4500000001\r\n\r\ncorrect result:\r\nr=0x15c72e32272c4471 392debf018c679c8 b85496496bf8254c d0204f36611e2be1\r\n    0cdb3db8f3c081d8 c94ba0e1bacc5061 191b83d47ff929f6 5be0aebfc13ae68d\r\n    3eea7a7fdf2f5758 42f7ec656cab3cb5 6a28095be34756f2 64f24687bf37de06\r\n    2822309cd1d292f9 6fa698c972372f09 771e97d3a868cda0 dc421e8a00000001\r\n\r\nwrong result:\r\nr=0x15c72e32272c4471 392debf018c679c8 b85496496bf8254c d0204f36611e2be1\r\n    0cdb3db8f3c081d8 c94ba0e1bacc5061 191b83d47ff929f6 5be0aebfc13ae68d\r\n    3eea7a7fdf2f5758 42f7ec656cab3cb5 6a28095be34756f2 64f24687bf37de06\r\n    2822309cd1d292f8 6fa698c972372f09 771e97d3a868cda0 dc421e8a00000001\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17258)\r\n\r\n(cherry picked from commit 336923c0c8d705cb8af5216b29a205662db0d590)\r\n\r\n* Add some CHANGES entries for 1.1.1m\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17269)\r\n\r\n* Update copyright year\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17271)\r\n\r\n* Update NEWS for 1.1.1m\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17273)\r\n\r\n* Prepare for 1.1.1m release\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Prepare for 1.1.1n-dev\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n\r\n* Fix the null pointer dereference\r\n\r\nFixed #17296\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17302)\r\n\r\n* Fix Configure variable spill\r\n\r\n* Evaluating code-refs in Configure can sometimes set the default\r\nvariable `$_`\r\n* Prevent spillage influencing the target property by using named\r\nvariable in loop\r\n\r\nCLA: trivial\r\n\r\nFixes gh-17321\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17322)\r\n\r\n(cherry picked from commit a595e3286ae9f033c56452967b3add2145f9085f)\r\n\r\n* document additional stack push error code\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17351)\r\n\r\n* Ensure s_client sends SNI data when used with -proxy\r\n\r\nThe use of -proxy prevented s_client from correctly sending the target\r\nhostname as SNI data.\r\n\r\nFixes #17232\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17249)\r\n\r\n* Add support for BSD-riscv64 target\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n\r\n(cherry picked from commit c2d1ad0e048dd3bfa60e6aa0b5ee343cc6d97a15)\r\n(cherry picked from commit fb72a093f88f7332069659994b67f6b19aceb865)\r\n\r\n(Merged from https://github.com/openssl/openssl/pull/17341)\r\n\r\n* OBJ_obj2txt(): fix off-by-one documentation of the result\r\n\r\nThis backports the doc improvements of #17188.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n\r\n(cherry picked from commit e36d10925396b6519e1abd338e1ef62cd5b1c9e6)\r\n\r\n* Update troublesome copyright years of auto-generated files to 2022\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17401)\r\n\r\n* apps/passwd.c: free before error exiting\r\n\r\nuse goto instead of returning directly while error handling\r\n\r\nSigned-off-by: Peiwei Hu <jlu.hpw@foxmail.com>\r\n\r\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17404)\r\n\r\n(cherry picked from commit ea4d16bc60dee53feb71997c1e78379eeb69b7ac)\r\n\r\n* close_console: Always unlock as the lock is always held\r\n\r\nFixes #17364\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17395)\r\n\r\n* Fix password_callback to handle short passwords\r\n\r\nFixes #17426\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17439)\r\n\r\n* Remove unsafe call to OPENSSL_cpuid_setup\r\n\r\nThis function is inherently thread-unsafe,\r\nand moreover it is unnecessary here, because\r\nOPENSSL_init_crypto always calls it in a thread-safe way.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17468)\r\n\r\n* Fix a leak in EVP_DigestInit_ex()\r\n\r\nIf an EVP_MD_CTX is reused then memory allocated and stored in md_data\r\ncan be leaked unless the EVP_MD's cleanup function is called.\r\n\r\nFixes #17149\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\n(Merged from https://github.com/openssl/openssl/pull/17472)\r\n\r\n* Add a test for a custom digest created via EVP_MD_meth_new()\r\n\r\nWe check that the init and cleanup functions for the custom method are\r\ncalled as expected.\r\n\r\nBased on an original reproducer by Dmitry Belyavsky from issue #17149.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\r\n(Merged from https://github.com/openssl/openssl/pull/17472)\r\n\r\n* lhash: Avoid 32 bit right shift of a 32 bit value\r\n\r\nFixes #17583\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17589)\r\n\r\n(cherry picked from commit 2ce0a3d19005271e7e3c351b562d9da93e2d4c80)\r\n\r\n* Ensure X509_STORE_CTX_purpose_inherit handles a 0 default purpose\r\n\r\nThe function X509_STORE_CTX_purpose_inherit() can be called with a 0\r\ndefault purpose. If the main purpose was set to X509_PURPOSE_ANY this\r\nwould case the function to incorrectly return an error response.\r\n\r\nFixes #17367\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17604)\r\n\r\n* Add a test for X509_STORE_CTX_set_purpose()\r\n\r\nThis function was previously incorrectly failing if it is called with\r\nX509_PURPOSE_ANY. Add a test to catch this.\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17604)\r\n\r\n* Document purpose and trust setting functions\r\n\r\nIn particular:\r\nX509_STORE_CTX_set_purpose()\r\nX509_STORE_CTX_set_trust();\r\nX509_STORE_CTX_purpose_inherit();\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17604)\r\n\r\n* Fix builds with DJGPP\r\n\r\nCLA: trivial\r\n\r\nTo get the master branch compiled with DJGPP some minor\r\nadjustments are required. They will have no impact on any other ports.\r\nThe DJGPP port uses the Watt-32 library to provide the required network\r\nfunctionality and some of its headers need to be included.\r\n\r\nNeither DJGPP nor the Watt-32 library provide in_addr_t thus it must be\r\nprovided as it is done for OPENSSL_SYS_WINDOWS in crypto/bio/b_addr.c.\r\n\r\nIn the DJGPP section of include/internal/sockets.h the following Watt-32\r\nheaders must be added:\r\n\r\n  -  arpa/inet.h: to provide declaration of inet_ntoa required in crypto/bio/b_addr.c\r\n  -  netinet/tcp.h: to provide defintion of TCP_NODELAY required in crypto/bio/b_sock2.c\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17623)\r\n\r\n(cherry picked from commit b9b211fcb6b9068ef1d8729a4971fbe693fd2cde)\r\n\r\n* Don't link test/ec_internal_test with libapps.a\r\n\r\nIt's not at all necessary, and on some platforms, it's disruptive\r\n(leads to unresolved symbols because of object files that get included\r\nin the link that depend on libssl).\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17637)\r\n\r\n* Correct return type for BIO_ptr_ctrl\r\n\r\nFixes #17549\r\nCLA: trivial\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17636)\r\n\r\n(cherry picked from commit 984cc9a0284ee4800862aa305f9f178827baf459)\r\n\r\n* scrypt: increase memory usage beyond limit\r\n\r\nThis brings these tests in line with 3.0 and master and makes them\r\nfail correctly.\r\n\r\nFixes #17612\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17619)\r\n\r\n* Prevent crash with engine using different openssl runtime\r\n\r\nThis problem happens usually because an application\r\nlinks libcrypto and/or libssl statically which\r\ninstalls an atexit handler, but later an engine using\r\na shared instance of libcrypto is installed.\r\nThe problem is in simple words that both instances\r\nof libcrypto have an atexit handler installed,\r\nbut both are unable to coordinate with each other,\r\nwhich causes a crash, typically a use-after-free\r\nin the engine's destroy function.\r\n\r\nWork around that by preventing the engine's\r\nlibcrypto to install the atexit handler.\r\nThis may result in a small memory leak, but that\r\nmemory is still reachable.\r\n\r\nFixes #15898\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17541)\r\n\r\n* Check for presence of 3.x openssl runtime\r\n\r\nif the newly loaded engine contains the symbol\r\nEVP_PKEY_get_base_id, we know it is linked to 3.x openssl.\r\nAbort loading this engine, as it will definitely crash.\r\n\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17541)\r\n\r\n* crypto/x509/v3_utl.c: Add missing check for OPENSSL_strndup\r\n\r\nSince the potential failure of memory allocation, it\r\nshould be better to check the return value of the\r\nOPENSSL_strndup(), like x509v3_add_len_value().\r\nAnd following the comment of 'if (astrlen < 0)',\r\nreturn -1 if fails.\r\n\r\nSigned-off-by: Jiasheng Jiang <jiasheng@iscas.ac.cn>\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17737)\r\n\r\n(cherry picked from commit 366a16263959c0b6599f0b9ec18124d75560c6ef)\r\n\r\n* Improve documentation of BIO_FLAGS_BASE64_NO_NL flag.\r\n\r\nFixes #12491.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17744)\r\n\r\n(cherry picked from commit 8bfb7506d210841f2ee4eda8afe96441a0e33fa5)\r\n\r\n* Fix NULL pointer dereference for BN_mod_exp2_mont\r\n\r\nThis fixes a bug whereby BN_mod_exp2_mont can dereference a NULL pointer\r\nif BIGNUM argument m represents zero.\r\n\r\nRegression test added. Fixes #17648. Backport from master to 1.1.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Todd Short <todd.short@me.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17787)\r\n\r\n* VMS: move copy_argc to its own module and make it an aux source\r\n\r\ncopy_argv was never initialization code.\r\n\r\nMake it self-cleaning too.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17746)\r\n\r\n* [ssl] Prefer SSL_k(EC)?DHE to the SSL_kE(EC)?DH alias\r\n\r\n`SSL_kECDHE` and `SSL_kEECDH`, and `SSL_kDHE` and `SSL_kEDH` are already\r\nmarked as aliases of each other in the headers.\r\nThis commit, for each pair, replaces the leftover uses of the latter\r\nsynonym with the first one, which is considered more common.\r\n\r\n(manually cherry picked from commit 66914fc024cfe0fec00dc0f2c7bd8a7957da5ec4)\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17791)\r\n\r\n* [ssl] Add SSL_kDHEPSK and SSL_kECDHEPSK as PFS ciphersuites for SECLEVEL >= 3\r\n\r\nFixes #17743\r\n\r\n(manually cherry picked from commit b139a95665eb023b38695d62d9dfc28f3fb89972)\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17791)\r\n\r\n* [ssl] Add tests for Perfect Forward Secrecy criteria on SECLEVEL >= 3\r\n\r\n(manually cherry picked from commit d71151ae704847f4ac3f4a5f394ea64f1d229815)\r\n\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17791)\r\n\r\n* Document bug in openssl cms -binary\r\n\r\nDocuments a bug in openssl cms -binary for 1.1 whereby it cannot process\r\ninput using LF line endings correctly. Binary input processing was\r\nreworked substantially for 3.0 and backporting these changes doesn't\r\nappear reasonable.\r\n\r\nFixes #17797.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17810)\r\n\r\n* Avoid potential memory leak\r\n\r\nResolves #17827\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17828)\r\n\r\n(cherry picked from commit 175355923046921a689b500f7a72455f7095708f)\r\n\r\n* Set protocol in init_client()\r\n\r\nIf TCP is being used, protocol = 0 is passed to init_client(), then\r\nprotocol == IPPROTO_TCP fails when attempting to set BIO_SOCK_NODELAY.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Tim Hudson <tjh@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17838)\r\n\r\n(cherry picked from commit 54b6755702309487ea860e1cc3e60ccef4cf7878)\r\n\r\n* Fix issue where OBJ_nid2obj doesn't always raise an error\r\n\r\nThis was previously fixed in 3.0 but not 1.1.\r\n\r\nFixes #13008.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Todd Short <todd.short@me.com>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17808)\r\n\r\n* DOC: TLS compression is disabled by default\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matthias St. Pierre <Matthias.St.Pierre@ncp-e.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17854)\r\n\r\n(cherry picked from commit 2cb52118ddd1d82d7b6028372238eaa2467bbd48)\r\n\r\n* Fix OPENSSL_ENGINES in Configurations/descrip.mms.tmpl\r\n\r\nMake its value an absolute path.\r\n\r\nThis was already fixed in all other build file templates, but for some\r\nreason, not here.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17865)\r\n\r\n* Make ossltest engine use in test/recipes/20-test_dgst.t platform agnostic\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17861)\r\n\r\n(cherry picked from commit abdb2278d2b65ae87bee3121be83322e4219b396)\r\n\r\n* Fix possible infinite loop in BN_mod_sqrt()\r\n\r\nThe calculation in some cases does not finish for non-prime p.\r\n\r\nThis fixes CVE-2022-0778.\r\n\r\nBased on patch by David Benjamin <davidben@google.com>.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Add documentation of BN_mod_sqrt()\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Add a negative testcase for BN_mod_sqrt\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Update CHANGES/NEWS for new release\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Update copyright year\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\n\r\n* Prepare for 1.1.1n release\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n\r\n* Prepare for 1.1.1o-dev\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n\r\n* Check password length only when verify is enabled.\r\n\r\nFixes #16231.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17899)\r\n\r\n* eng_dyn: Avoid spurious errors when checking for 3.x engine\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Richard Levitte <levitte@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17902)\r\n\r\n* print SSL session, fix build warnings on OpenBSD.\r\n\r\ntime_t is a 64 bits type on this platform.\r\n\r\nReviewed-by: Matt Caswell <matt@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17917)\r\n\r\n(cherry picked from commit 9362638b080e328ccab43f89048bed27bcf2f11d)\r\n\r\n* Fix coverity 1498607: uninitialised value\r\n\r\nReviewed-by: Tim Hudson <tjh@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17897)\r\n\r\n(cherry picked from commit 70cd9a51911e9a4e2f24e29ddd84fa9fcb778b63)\r\n\r\n* Fix Coverity 1498611 & 1498608: uninitialised read\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17893)\r\n\r\n(cherry picked from commit 09134f183f76539aa1294adfef10fcc694e90267)\r\n\r\n* Fix Coverity 1201763 uninitialised pointer read\r\n\r\nReviewed-by: Shane Lontis <shane.lontis@oracle.com>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17890)\r\n\r\n(cherry picked from commit a0238b7ed87998c48b1c92bad7fa82dcbba507f9)\r\n\r\n* Fix integer overflow in evp_EncryptDecryptUpdate\r\n\r\nFixes #17871.\r\n\r\nReviewed-by: Paul Dale <pauli@openssl.org>\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\n(Merged from https://github.com/openssl/openssl/pull/17872)\r\n\r\n* Fix Coverity 1498612: integer overflow\r\n\r\nThe assert added cannot ever fail because (current & 0xFFFF) != 0 from the\r\nwhile loop and the trailing zero bit count therefore cannot be as large as 32.\r\n\r\nReviewed-by: Tomas Mraz <tomas@openssl.org>\r\nReviewed-by: Dmitry Belyavskiy <beldmit@gmail.com>\r\n(Merged from https://github.com/openssl/openssl/pull/17892)\r\n\r\n(cherry picked from commit 81487b65b9eb8148471e729b8c1959521d62c69e)\r\n\r\n* s390x: Hide internal cpuid symbol and function\r\n\r\nThe symbol OPENSSL_s390xcap_P and the OPENSSL_cpuid_setup function are not\r\nexported by the version script of OpenSSL.  However, if someone uses the\r\nstatic library without the version script, these symbols all of a sudden\r\nbecome global symbols and their usage in assembler code does not correctly\r\nreflect that for PIC.  Since these symbols should never be used outside of\r\nOpenSSL, hide them inside the binary.\r\n\r\nSigned-off-by: Juergen Christ <jchrist@linux.ibm.com>\r\n\r\nReviewed-by: Paul Dale <pauli@opens…","distinct":true,"url":"https://api.github.com/repos/open-quantum-safe/openssl/commits/907fdfd3e66cbde3b02584bb4c404161e50512af"}]},"public":true,"created_at":"2022-07-06T05:44:56Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
