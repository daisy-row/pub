{"id":"38362914078","type":"PullRequestReviewCommentEvent","actor":{"id":39264796,"login":"SWilson4","display_login":"SWilson4","gravatar_id":"","url":"https://api.github.com/users/SWilson4","avatar_url":"https://avatars.githubusercontent.com/u/39264796?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/comments/1600065202","pull_request_review_id":2055416794,"id":1600065202,"node_id":"PRRC_kwDOA-eq3c5fXw6y","diff_hunk":"@@ -0,0 +1,813 @@\n+// SPDX-License-Identifier: MIT\n+\n+#include <string.h>\n+#include <oqs/oqs.h>\n+#include \"sig_stfl_lms.h\"\n+#include \"external/config.h\"\n+#include \"external/hss_verify_inc.h\"\n+#include \"external/hss_sign_inc.h\"\n+#include \"external/hss.h\"\n+#include \"external/endian.h\"\n+#include \"external/hss_internal.h\"\n+#include \"sig_stfl_lms_wrap.h\"\n+\n+#ifdef __GNUC__\n+#define UNUSED __attribute__((unused))\n+#else\n+#define UNUSED\n+#endif\n+\n+#define DEFAULT_AUX_DATA 10916   /* Use 10+k of aux data (which works well */\n+/* with the above default parameter set)  */\n+/**\n+ * @brief OQS_LMS_KEY object for HSS key pair\n+ */\n+\n+typedef struct OQS_LMS_KEY_DATA {\n+\n+\t/* Tree levels. */\n+\tuint32_t levels;\n+\n+\t/* Array, 8 levels max, of LMS types */\n+\tparam_set_t lm_type[8];\n+\n+\t/* Array, 8 levels max, of LM OTS types */\n+\tparam_set_t lm_ots_type[8];\n+\n+\t/* LMS public key */\n+\tuint8_t public_key[60];\n+\n+\t/* Length of aux data */\n+\tsize_t len_aux_data;\n+\t/* internal nodes info of the Merkle tree */\n+\tuint8_t *aux_data;\n+\n+\t/* Length of sec_key */\n+\tsize_t len_sec_key;\n+\n+\t/* secret key data */\n+\tuint8_t *sec_key;\n+\n+\t/* app specific */\n+\tvoid *context;\n+} oqs_lms_key_data;\n+\n+#ifndef OQS_ALLOW_LMS_KEY_AND_SIG_GEN\n+OQS_API OQS_STATUS OQS_SIG_STFL_alg_lms_sign(UNUSED uint8_t *signature, UNUSED size_t *signature_length, UNUSED const uint8_t *message,\n+        UNUSED size_t message_len, UNUSED OQS_SIG_STFL_SECRET_KEY *secret_key) {\n+\treturn OQS_ERROR;\n+}\n+#else\n+OQS_API OQS_STATUS OQS_SIG_STFL_alg_lms_sign(uint8_t *signature, size_t *signature_length, const uint8_t *message,\n+        size_t message_len, OQS_SIG_STFL_SECRET_KEY *secret_key) {\n+\tOQS_STATUS status = OQS_ERROR;\n+\tOQS_STATUS rc_keyupdate = OQS_ERROR;\n+\toqs_lms_key_data *lms_key_data = NULL;\n+\tuint8_t *sk_key_buf = NULL;\n+\tsize_t sk_key_buf_len = 0;\n+\tvoid *context;\n+\n+\tif (secret_key == NULL || message == NULL || signature == NULL || signature_length == NULL) {\n+\t\treturn OQS_ERROR;\n+\t}\n+\n+\t/* Lock secret to ensure OTS use */\n+\tif ((secret_key->lock_key) && (secret_key->mutex)) {\n+\t\tsecret_key->lock_key(secret_key->mutex);\n+\t}\n+\n+\t/*\n+\t * Don't even attempt signing without a way to safe the updated private key\n+\t */\n+\tif (secret_key->secure_store_scrt_key == NULL) {\n+\t\tfprintf(stderr, \"No Secure-store set for secret key.\\n.\");\n+\t\tgoto err;\n+\t}\n+\n+\tlms_key_data = (oqs_lms_key_data *)secret_key->secret_key_data;\n+\tif (lms_key_data == NULL) {\n+\t\tgoto err;\n+\t}\n+\n+\tif (oqs_sig_stfl_lms_sign(secret_key, signature,\n+\t                          signature_length,\n+\t                          message, message_len) != 0) {\n+\t\tgoto err;\n+\t}\n+\n+\t/*\n+\t * serialize and securely store the updated private key\n+\t * but, delete signature and the serialized key other wise\n+\t */\n+\n+\trc_keyupdate = oqs_serialize_lms_key(&sk_key_buf, &sk_key_buf_len, secret_key);\n+\tif (rc_keyupdate != OQS_SUCCESS) {\n+\t\tgoto err;\n+\t}\n+\n+\tcontext = secret_key->context;\n+\trc_keyupdate = secret_key->secure_store_scrt_key(sk_key_buf, sk_key_buf_len, context);\n+\tif (rc_keyupdate != OQS_SUCCESS) {\n+\t\tgoto err;\n+\t}\n+\n+\tstatus = OQS_SUCCESS;\n+\tgoto passed;\n+\n+err:\n+\tif (*signature_length) {\n+\t\tmemset(signature, 0, *signature_length);\n+\t}\n+\t*signature_length = 0;\n+\n+passed:\n+\tOQS_MEM_secure_free(sk_key_buf, sk_key_buf_len);\n+\n+\t/* Unlock secret to ensure OTS use */\n+\tif ((secret_key->unlock_key) && (secret_key->mutex)) {\n+\t\tsecret_key->unlock_key(secret_key->mutex);\n+\t}\n+\treturn status;\n+}\n+#endif\n+\n+OQS_API OQS_STATUS OQS_SIG_STFL_alg_lms_verify(const uint8_t *message, size_t message_len,\n+        const uint8_t *signature, size_t signature_len, const uint8_t *public_key) {\n+\n+\tif (message == NULL || signature == NULL || public_key == NULL) {\n+\t\treturn OQS_ERROR;\n+\t}\n+\n+\tif (oqs_sig_stfl_lms_verify(message, message_len,\n+\t                            signature, signature_len,\n+\t                            public_key) != 0 ) {\n+\t\treturn OQS_ERROR;\n+\t}\n+\n+\treturn OQS_SUCCESS;\n+}\n+\n+OQS_API OQS_STATUS OQS_SIG_STFL_lms_sigs_left(unsigned long long *remain, const OQS_SIG_STFL_SECRET_KEY *secret_key) {\n+\tOQS_STATUS status;\n+\tuint8_t *priv_key = NULL;\n+\tunsigned long long total_sigs = 0;\n+\tsequence_t current_count = 0;\n+\toqs_lms_key_data *oqs_key_data = NULL;\n+\n+\tif (remain == NULL  || secret_key == NULL) {\n+\t\treturn OQS_ERROR;\n+\t}\n+\n+\tstatus = OQS_SIG_STFL_lms_sigs_total(&total_sigs, secret_key);\n+\tif (status != OQS_SUCCESS) {\n+\t\treturn OQS_ERROR;\n+\t}\n+\n+\t/* Lock secret key to ensure data integrity use */\n+\tif ((secret_key->lock_key) && (secret_key->mutex)) {\n+\t\tsecret_key->lock_key(secret_key->mutex);\n+\t}\n+\n+\toqs_key_data = secret_key->secret_key_data;\n+\tif (oqs_key_data == NULL) {\n+\t\tgoto err;\n+\t}\n+\tpriv_key = oqs_key_data->sec_key;\n+\tif (priv_key == NULL) {\n+\t\tgoto err;\n+\t}\n+\n+\tcurrent_count = get_bigendian(priv_key + PRIVATE_KEY_INDEX, PRIVATE_KEY_INDEX_LEN /*0, 8 */);\n+\t*remain =  (total_sigs - (unsigned long long)current_count);\n+\n+err:\n+\t/* Unlock secret key */\n+\tif ((secret_key->unlock_key) && (secret_key->mutex)) {\n+\t\tsecret_key->unlock_key(secret_key->mutex);\n+\t}\n+\treturn OQS_SUCCESS;\n+}\n+\n+OQS_API OQS_STATUS OQS_SIG_STFL_lms_sigs_total(unsigned long long *total, const OQS_SIG_STFL_SECRET_KEY *secret_key) {\n+\n+\tuint8_t *priv_key = NULL;\n+\toqs_lms_key_data *oqs_key_data = NULL;\n+\tstruct hss_working_key *working_key = NULL;\n+\n+\tif (total == NULL  || secret_key == NULL) {\n+\t\treturn OQS_ERROR;\n+\t}\n+\n+\toqs_key_data = secret_key->secret_key_data;\n+\tif (!oqs_key_data) {\n+\t\treturn OQS_ERROR;\n+\t}\n+\n+\tpriv_key = oqs_key_data->sec_key;\n+\tif (!priv_key) {\n+\t\treturn OQS_ERROR;\n+\t}\n+\n+\tworking_key = hss_load_private_key(NULL, priv_key,\n+\t                                   0,\n+\t                                   NULL,\n+\t                                   0,\n+\t                                   0);\n+\tif (!working_key) {\n+\t\treturn OQS_ERROR;\n+\t}\n+\n+\t*total = (unsigned long long)working_key->max_count;\n+\thss_free_working_key(working_key);\n+\treturn OQS_SUCCESS;\n+}\n+\n+/* LMS wrapper functions use internal OIDs to\n+ * identify the parameter set to be used\n+ */\n+\n+bool LMS_randombytes(void *buffer, size_t length) {\n+\n+\tOQS_randombytes((uint8_t *)buffer, length);\n+\treturn true;\n+}\n+\n+#ifndef OQS_ALLOW_LMS_KEY_AND_SIG_GEN\n+int oqs_sig_stfl_lms_keypair(UNUSED uint8_t *pk, UNUSED OQS_SIG_STFL_SECRET_KEY *sk, UNUSED const uint32_t oid) {\n+\treturn -1;\n+}\n+#else\n+int oqs_sig_stfl_lms_keypair(uint8_t *pk, OQS_SIG_STFL_SECRET_KEY *sk, const uint32_t oid) {\n+\n+\tint ret = -1;\n+\tbool b_ret;\n+\tint parse_err = 0;\n+\n+\tsize_t len_public_key = 60;\n+\toqs_lms_key_data *oqs_key_data = NULL;\n+\n+\tif (!pk || !sk || !oid) {\n+\t\treturn -1;\n+\t}\n+\n+\tif (sk->secret_key_data) {\n+\t\t//this means a key pair has already been recreated\n+\t\t//TODO log error.\n+\t\treturn -1;\n+\t}\n+\n+\toqs_key_data = malloc(sizeof(oqs_lms_key_data));\n+\tif (oqs_key_data == NULL) {\n+\t\treturn -1;\n+\t}\n+\n+\tmemset(oqs_key_data, 0, sizeof(oqs_lms_key_data));\n+\tif (sk->length_secret_key == 0) {\n+\t\tOQS_MEM_insecure_free(oqs_key_data);\n+\t\toqs_key_data = NULL;\n+\t\treturn -1;\n+\t}\n+\n+\toqs_key_data->levels = 1;\n+\toqs_key_data->len_sec_key = sk->length_secret_key;\n+\toqs_key_data->sec_key = (uint8_t *)malloc(sk->length_secret_key * sizeof(uint8_t));\n+\tif (oqs_key_data->sec_key == NULL) {\n+\t\tOQS_MEM_insecure_free(oqs_key_data);\n+\t\toqs_key_data = NULL;\n+\t\treturn -1;\n+\t}\n+\n+\tmemset(oqs_key_data->sec_key, 0, sk->length_secret_key);\n+\n+\t//Aux Data\n+\tsize_t len_aux_data = DEFAULT_AUX_DATA;\n+\tuint8_t *aux_data =  malloc(sizeof(uint8_t) * len_aux_data);\n+\tif (aux_data == NULL) {\n+\t\tOQS_MEM_insecure_free( oqs_key_data->sec_key);\n+\t\tOQS_MEM_insecure_free(oqs_key_data);\n+\t\treturn -1;\n+\t}\n+\n+\toqs_key_data->aux_data = aux_data;\n+\toqs_key_data->len_aux_data = len_aux_data;\n+\toqs_key_data->context = sk->context;\n+\n+\t/* Set lms param set */\n+\tswitch (oid) {\n+\tcase OQS_LMS_ID_sha256_h5_w1:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H5;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W1;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h5_w2:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H5;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W2;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h5_w4:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H5;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W4;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h5_w8:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H5;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\n+\tcase OQS_LMS_ID_sha256_h10_w1:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W1;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h10_w2:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W2;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h10_w4:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W4;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h10_w8:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\n+\tcase OQS_LMS_ID_sha256_h15_w1:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H15;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W1;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h15_w2:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H15;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W2;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h15_w4:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H15;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W4;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h15_w8:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H15;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\n+\tcase OQS_LMS_ID_sha256_h20_w1:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H20;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W1;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h20_w2:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H20;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W2;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h20_w4:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H20;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W4;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h20_w8:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H20;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\n+\tcase OQS_LMS_ID_sha256_h25_w1:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H25;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W1;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h25_w2:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H25;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W2;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h25_w4:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H25;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W4;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h25_w8:\n+\t\toqs_key_data->lm_type[0] = LMS_SHA256_N32_H25;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h5_w8_h5_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H5;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H5;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h10_w8_h5_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H5;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h10_w2_h10_w2:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W2;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W2;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h10_w4_h5_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W4;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H5;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h10_w4_h10_w4:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W4;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W4;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h10_w8_h10_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h15_w8_h5_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H15;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H5;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h15_w8_h10_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H15;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h15_w8_h15_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H15;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H15;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h20_w8_h5_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H20;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H5;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h20_w8_h10_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H20;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H10;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h20_w8_h15_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H20;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H15;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tcase OQS_LMS_ID_sha256_h20_w8_h20_w8:\n+\t\toqs_key_data->levels = 2;\n+\t\toqs_key_data->lm_type[0]     = LMS_SHA256_N32_H20;\n+\t\toqs_key_data->lm_ots_type[0] = LMOTS_SHA256_N32_W8;\n+\t\toqs_key_data->lm_type[1]     = LMS_SHA256_N32_H20;\n+\t\toqs_key_data->lm_ots_type[1] = LMOTS_SHA256_N32_W8;\n+\t\tbreak;\n+\tdefault:\n+\t\toqs_key_data->lm_type[0] = 0;\n+\t\toqs_key_data->lm_ots_type[0] = 0;\n+\t\tparse_err = 1;\n+\t\tbreak;\n+\t}\n+\n+\tif (parse_err) {\n+\t\tOQS_MEM_insecure_free(oqs_key_data->sec_key);\n+\t\tOQS_MEM_insecure_free(oqs_key_data->aux_data);\n+\t\tOQS_MEM_insecure_free(oqs_key_data);\n+\t\toqs_key_data = NULL;\n+\t\treturn -1;\n+\t}\n+\n+\t/*\n+\t * This creates a private key (and the correspond public key, and optionally\n+\t * the aux data for that key)\n+\t * Parameters:\n+\t * generate_random - the function to be called to generate randomness.  This\n+\t *       is assumed to be a pointer to a cryptographically secure rng,\n+\t *       otherwise all security is lost.  This function is expected to fill\n+\t *       output with 'length' uniformly distributed bits, and return 1 on\n+\t *       success, 0 if something went wrong\n+\t * levels - the number of levels for the key pair (2-8)\n+\t * lm_type - an array of the LM registry entries for the various levels;\n+\t *      entry 0 is the topmost\n+\t * lm_ots_type - an array of the LM-OTS registry entries for the various\n+\t *      levels; again, entry 0 is the topmost\n+\t * update_private_key, context - the function that is called when the\n+\t *      private key is generated; it is expected to store it to secure NVRAM\n+\t *      If this is NULL, then the context pointer is reinterpretted to mean\n+\t *      where in RAM the private key is expected to be placed\n+\t * public_key - where to store the public key\n+\t * len_public_key - length of the above buffer; see hss_get_public_key_len\n+\t *      if you need a hint.\n+\t * aux_data - where to store the optional aux data.  This is not required, but\n+\t *      if provided, can be used to speed up the hss_generate_working_key\n+\t *      process;\n+\t * len_aux_data - the length of the above buffer.  This is not fixed length;\n+\t *      the function will run different time/memory trade-offs based on the\n+\t *      length provided\n+\t *\n+\t * This returns true on success, false on failure\n+\t */\n+\tb_ret = hss_generate_private_key(\n+\t            LMS_randombytes,\n+\t            oqs_key_data->levels,\n+\t            oqs_key_data->lm_type,\n+\t            oqs_key_data->lm_ots_type,\n+\t            NULL, //File handler function?\n+\t            oqs_key_data->sec_key,\n+\t            oqs_key_data->public_key, len_public_key,\n+\t            oqs_key_data->aux_data, oqs_key_data->len_aux_data,\n+\t            NULL);\n+\tif (b_ret) {\n+\t\tmemcpy(pk, oqs_key_data->public_key, len_public_key);\n+\t\tsk->secret_key_data = oqs_key_data;\n+\t} else {\n+\t\tOQS_MEM_secure_free(oqs_key_data->sec_key, sk->length_secret_key * sizeof(uint8_t));\n+\t\tOQS_MEM_insecure_free(oqs_key_data->aux_data);\n+\t\tOQS_MEM_insecure_free(oqs_key_data);\n+\t\toqs_key_data = NULL;\n+\t\treturn -1;\n+\t}\n+\n+\t/* TODO: store key pair, file handler */\n+\n+\tret = 0;\n+\treturn ret;\n+}\n+#endif\n+\n+#ifndef OQS_ALLOW_LMS_KEY_AND_SIG_GEN\n+int oqs_sig_stfl_lms_sign(UNUSED OQS_SIG_STFL_SECRET_KEY *sk, UNUSED uint8_t *sm, UNUSED size_t *smlen,\n+                          UNUSED const uint8_t *m, UNUSED size_t mlen) {\n+\treturn -1;\n+}\n+#else\n+int oqs_sig_stfl_lms_sign(OQS_SIG_STFL_SECRET_KEY *sk,\n+                          uint8_t *sm, size_t *smlen,\n+                          const uint8_t *m, size_t mlen) {\n+\n+\tsize_t sig_len;\n+\tbool status;\n+\tuint8_t *sig = NULL;\n+\tuint8_t *priv_key = NULL;\n+\toqs_lms_key_data *oqs_key_data = NULL;\n+\tstruct hss_working_key *w = NULL;\n+\tstruct hss_sign_inc ctx;\n+\tif (sk) {\n+\t\toqs_key_data = sk->secret_key_data;\n+\t\tpriv_key = oqs_key_data->sec_key;\n+\t} else {\n+\t\treturn -1;\n+\t}\n+\tw = hss_load_private_key(NULL, priv_key,\n+\t                         0,\n+\t                         NULL,\n+\t                         0,\n+\t                         0);\n+\tif (!w) {\n+\t\thss_free_working_key(w);\n+\t\treturn 0;\n+\t}\n+\n+\t/* Now, go through the file list, and generate the signatures for each */\n+\n+\t/* Look up the signature length */\n+\n+\tsig_len = hss_get_signature_len_from_working_key(w);\n+\tif (sig_len == 0) {\n+\t\thss_free_working_key(w);\n+\t\treturn 0;\n+\t}\n+\n+\tsig = malloc(sig_len);\n+\tif (!sig) {\n+\t\thss_free_working_key(w);\n+\t\treturn -1;\n+\t}\n+\n+\t(void)hss_sign_init(","path":"src/sig_stfl/lms/sig_stfl_lms_functions.c","commit_id":"4ebd1b94ebd71181a43653e441700226d537026f","original_commit_id":"3f6aeac235672add0edc9ab406f38429702fa307","user":{"login":"SWilson4","id":39264796,"node_id":"MDQ6VXNlcjM5MjY0Nzk2","avatar_url":"https://avatars.githubusercontent.com/u/39264796?v=4","gravatar_id":"","url":"https://api.github.com/users/SWilson4","html_url":"https://github.com/SWilson4","followers_url":"https://api.github.com/users/SWilson4/followers","following_url":"https://api.github.com/users/SWilson4/following{/other_user}","gists_url":"https://api.github.com/users/SWilson4/gists{/gist_id}","starred_url":"https://api.github.com/users/SWilson4/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SWilson4/subscriptions","organizations_url":"https://api.github.com/users/SWilson4/orgs","repos_url":"https://api.github.com/users/SWilson4/repos","events_url":"https://api.github.com/users/SWilson4/events{/privacy}","received_events_url":"https://api.github.com/users/SWilson4/received_events","type":"User","site_admin":false},"body":"For posterity: an error status is carried through in the `ctx`, and each of the incremental signing functions checks the status before doing anything. It suffices to error-check only `hss_sign_finalize`.","created_at":"2024-05-14T13:40:23Z","updated_at":"2024-05-14T13:40:23Z","html_url":"https://github.com/open-quantum-safe/liboqs/pull/1650#discussion_r1600065202","pull_request_url":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/1650","author_association":"MEMBER","_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/comments/1600065202"},"html":{"href":"https://github.com/open-quantum-safe/liboqs/pull/1650#discussion_r1600065202"},"pull_request":{"href":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/1650"}},"reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/comments/1600065202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"start_line":null,"original_start_line":null,"start_side":null,"line":594,"original_line":594,"side":"RIGHT","in_reply_to_id":1500086027,"original_position":594,"position":594,"subject_type":"line"},"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/1650","id":1663975754,"node_id":"PR_kwDOA-eq3c5jLkFK","html_url":"https://github.com/open-quantum-safe/liboqs/pull/1650","diff_url":"https://github.com/open-quantum-safe/liboqs/pull/1650.diff","patch_url":"https://github.com/open-quantum-safe/liboqs/pull/1650.patch","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1650","number":1650,"state":"open","locked":false,"title":"Add Stateful Signature (XMSS and LMS)","user":{"login":"ashman-p","id":23340773,"node_id":"MDQ6VXNlcjIzMzQwNzcz","avatar_url":"https://avatars.githubusercontent.com/u/23340773?v=4","gravatar_id":"","url":"https://api.github.com/users/ashman-p","html_url":"https://github.com/ashman-p","followers_url":"https://api.github.com/users/ashman-p/followers","following_url":"https://api.github.com/users/ashman-p/following{/other_user}","gists_url":"https://api.github.com/users/ashman-p/gists{/gist_id}","starred_url":"https://api.github.com/users/ashman-p/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashman-p/subscriptions","organizations_url":"https://api.github.com/users/ashman-p/orgs","repos_url":"https://api.github.com/users/ashman-p/repos","events_url":"https://api.github.com/users/ashman-p/events{/privacy}","received_events_url":"https://api.github.com/users/ashman-p/received_events","type":"User","site_admin":false},"body":"<!-- Please give a brief explanation of the purpose of this pull request. -->\r\nAdds implementations of stateful signatures to liboqs for XMSS and LMS. The feature include new OQS APIs to generate key-pairs, signature generation, verification, and secret key state-management. Actual secret key storage is left up to the application.\r\n\r\nThis PR also includes an enhancement to OQS SHA2 API to allow handling updates with arbitrary length buffers.\r\n\r\n<!-- Does this PR resolve any issue?  If so, please reference it using automatic-closing keywords like \"Fixes #123.\" -->\r\n\r\n<!-- Any PR adding a new feature is expected to contain a test; the test should be part of CI testing, preferably within the \".github/workflows\" directory tree. Please add an explanation to the PR if/when (why) this cannot be done. -->\r\n\r\n<!-- Please answer the following questions to help manage version and changes across projects. -->\r\n\r\n* [ No ] Does this PR change the input/output behaviour of a cryptographic algorithm (i.e., does it change known answer test values)?  (If so, a version bump will be required from *x.y.z* to *x.(y+1).0*.)\r\n* [ Yes ] Does this PR change the list of algorithms available -- either adding, removing, or renaming? Does this PR otherwise change an API? (If so, PRs in fully supported downstream projects dependent on these, i.e., [oqs-provider](https://github.com/open-quantum-safe/oqs-provider) and [OQS-OpenSSH](https://github.com/open-quantum-safe/openssh) will also need to be ready for review and merge by the time this is merged.)\r\nOQS provider support is a separate and forthcoming feature. This is separated because of the need to manage the stateful of secret keys.\r\n<!-- Once your pull request is ready for review and passing continuous integration tests, please convert from a draft PR to a normal PR, and request a review from one of the OQS core team members. -->\r\n\r\n","created_at":"2024-01-04T00:49:00Z","updated_at":"2024-05-14T13:40:23Z","closed_at":null,"merged_at":null,"merge_commit_sha":"81024774e22042039672bdbf04e9b88d6b95f9c9","assignee":null,"assignees":[],"requested_reviewers":[{"login":"tomato42","id":618246,"node_id":"MDQ6VXNlcjYxODI0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/618246?v=4","gravatar_id":"","url":"https://api.github.com/users/tomato42","html_url":"https://github.com/tomato42","followers_url":"https://api.github.com/users/tomato42/followers","following_url":"https://api.github.com/users/tomato42/following{/other_user}","gists_url":"https://api.github.com/users/tomato42/gists{/gist_id}","starred_url":"https://api.github.com/users/tomato42/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomato42/subscriptions","organizations_url":"https://api.github.com/users/tomato42/orgs","repos_url":"https://api.github.com/users/tomato42/repos","events_url":"https://api.github.com/users/tomato42/events{/privacy}","received_events_url":"https://api.github.com/users/tomato42/received_events","type":"User","site_admin":false},{"login":"simo5","id":8332609,"node_id":"MDQ6VXNlcjgzMzI2MDk=","avatar_url":"https://avatars.githubusercontent.com/u/8332609?v=4","gravatar_id":"","url":"https://api.github.com/users/simo5","html_url":"https://github.com/simo5","followers_url":"https://api.github.com/users/simo5/followers","following_url":"https://api.github.com/users/simo5/following{/other_user}","gists_url":"https://api.github.com/users/simo5/gists{/gist_id}","starred_url":"https://api.github.com/users/simo5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simo5/subscriptions","organizations_url":"https://api.github.com/users/simo5/orgs","repos_url":"https://api.github.com/users/simo5/repos","events_url":"https://api.github.com/users/simo5/events{/privacy}","received_events_url":"https://api.github.com/users/simo5/received_events","type":"User","site_admin":false},{"login":"hartm","id":16846129,"node_id":"MDQ6VXNlcjE2ODQ2MTI5","avatar_url":"https://avatars.githubusercontent.com/u/16846129?v=4","gravatar_id":"","url":"https://api.github.com/users/hartm","html_url":"https://github.com/hartm","followers_url":"https://api.github.com/users/hartm/followers","following_url":"https://api.github.com/users/hartm/following{/other_user}","gists_url":"https://api.github.com/users/hartm/gists{/gist_id}","starred_url":"https://api.github.com/users/hartm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hartm/subscriptions","organizations_url":"https://api.github.com/users/hartm/orgs","repos_url":"https://api.github.com/users/hartm/repos","events_url":"https://api.github.com/users/hartm/events{/privacy}","received_events_url":"https://api.github.com/users/hartm/received_events","type":"User","site_admin":false},{"login":"SWilson4","id":39264796,"node_id":"MDQ6VXNlcjM5MjY0Nzk2","avatar_url":"https://avatars.githubusercontent.com/u/39264796?v=4","gravatar_id":"","url":"https://api.github.com/users/SWilson4","html_url":"https://github.com/SWilson4","followers_url":"https://api.github.com/users/SWilson4/followers","following_url":"https://api.github.com/users/SWilson4/following{/other_user}","gists_url":"https://api.github.com/users/SWilson4/gists{/gist_id}","starred_url":"https://api.github.com/users/SWilson4/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SWilson4/subscriptions","organizations_url":"https://api.github.com/users/SWilson4/orgs","repos_url":"https://api.github.com/users/SWilson4/repos","events_url":"https://api.github.com/users/SWilson4/events{/privacy}","received_events_url":"https://api.github.com/users/SWilson4/received_events","type":"User","site_admin":false},{"login":"ducnguyen-sb","id":106774416,"node_id":"U_kgDOBl0_kA","avatar_url":"https://avatars.githubusercontent.com/u/106774416?v=4","gravatar_id":"","url":"https://api.github.com/users/ducnguyen-sb","html_url":"https://github.com/ducnguyen-sb","followers_url":"https://api.github.com/users/ducnguyen-sb/followers","following_url":"https://api.github.com/users/ducnguyen-sb/following{/other_user}","gists_url":"https://api.github.com/users/ducnguyen-sb/gists{/gist_id}","starred_url":"https://api.github.com/users/ducnguyen-sb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ducnguyen-sb/subscriptions","organizations_url":"https://api.github.com/users/ducnguyen-sb/orgs","repos_url":"https://api.github.com/users/ducnguyen-sb/repos","events_url":"https://api.github.com/users/ducnguyen-sb/events{/privacy}","received_events_url":"https://api.github.com/users/ducnguyen-sb/received_events","type":"User","site_admin":false}],"requested_teams":[],"labels":[],"milestone":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/milestones/25","html_url":"https://github.com/open-quantum-safe/liboqs/milestone/25","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/milestones/25/labels","id":10823145,"node_id":"MI_kwDOA-eq3c4ApSXp","number":25,"title":"0.11.0","description":"","creator":{"login":"dstebila","id":8843219,"node_id":"MDQ6VXNlcjg4NDMyMTk=","avatar_url":"https://avatars.githubusercontent.com/u/8843219?v=4","gravatar_id":"","url":"https://api.github.com/users/dstebila","html_url":"https://github.com/dstebila","followers_url":"https://api.github.com/users/dstebila/followers","following_url":"https://api.github.com/users/dstebila/following{/other_user}","gists_url":"https://api.github.com/users/dstebila/gists{/gist_id}","starred_url":"https://api.github.com/users/dstebila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dstebila/subscriptions","organizations_url":"https://api.github.com/users/dstebila/orgs","repos_url":"https://api.github.com/users/dstebila/repos","events_url":"https://api.github.com/users/dstebila/events{/privacy}","received_events_url":"https://api.github.com/users/dstebila/received_events","type":"User","site_admin":false},"open_issues":5,"closed_issues":0,"state":"open","created_at":"2024-04-16T00:06:48Z","updated_at":"2024-05-07T16:54:40Z","due_on":null,"closed_at":null},"draft":false,"commits_url":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/1650/commits","review_comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/1650/comments","review_comment_url":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/comments{/number}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1650/comments","statuses_url":"https://api.github.com/repos/open-quantum-safe/liboqs/statuses/4ebd1b94ebd71181a43653e441700226d537026f","head":{"label":"open-quantum-safe:stateful-sigs","ref":"stateful-sigs","sha":"4ebd1b94ebd71181a43653e441700226d537026f","user":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"repo":{"id":65514205,"node_id":"MDEwOlJlcG9zaXRvcnk2NTUxNDIwNQ==","name":"liboqs","full_name":"open-quantum-safe/liboqs","private":false,"owner":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/open-quantum-safe/liboqs","description":"C library for prototyping and experimenting with quantum-resistant cryptography","fork":false,"url":"https://api.github.com/repos/open-quantum-safe/liboqs","forks_url":"https://api.github.com/repos/open-quantum-safe/liboqs/forks","keys_url":"https://api.github.com/repos/open-quantum-safe/liboqs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/open-quantum-safe/liboqs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/open-quantum-safe/liboqs/teams","hooks_url":"https://api.github.com/repos/open-quantum-safe/liboqs/hooks","issue_events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/events{/number}","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/events","assignees_url":"https://api.github.com/repos/open-quantum-safe/liboqs/assignees{/user}","branches_url":"https://api.github.com/repos/open-quantum-safe/liboqs/branches{/branch}","tags_url":"https://api.github.com/repos/open-quantum-safe/liboqs/tags","blobs_url":"https://api.github.com/repos/open-quantum-safe/liboqs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/open-quantum-safe/liboqs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/open-quantum-safe/liboqs/git/refs{/sha}","trees_url":"https://api.github.com/repos/open-quantum-safe/liboqs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/open-quantum-safe/liboqs/statuses/{sha}","languages_url":"https://api.github.com/repos/open-quantum-safe/liboqs/languages","stargazers_url":"https://api.github.com/repos/open-quantum-safe/liboqs/stargazers","contributors_url":"https://api.github.com/repos/open-quantum-safe/liboqs/contributors","subscribers_url":"https://api.github.com/repos/open-quantum-safe/liboqs/subscribers","subscription_url":"https://api.github.com/repos/open-quantum-safe/liboqs/subscription","commits_url":"https://api.github.com/repos/open-quantum-safe/liboqs/commits{/sha}","git_commits_url":"https://api.github.com/repos/open-quantum-safe/liboqs/git/commits{/sha}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/comments{/number}","issue_comment_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments{/number}","contents_url":"https://api.github.com/repos/open-quantum-safe/liboqs/contents/{+path}","compare_url":"https://api.github.com/repos/open-quantum-safe/liboqs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/open-quantum-safe/liboqs/merges","archive_url":"https://api.github.com/repos/open-quantum-safe/liboqs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/open-quantum-safe/liboqs/downloads","issues_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues{/number}","pulls_url":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls{/number}","milestones_url":"https://api.github.com/repos/open-quantum-safe/liboqs/milestones{/number}","notifications_url":"https://api.github.com/repos/open-quantum-safe/liboqs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/labels{/name}","releases_url":"https://api.github.com/repos/open-quantum-safe/liboqs/releases{/id}","deployments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/deployments","created_at":"2016-08-12T01:46:12Z","updated_at":"2024-05-13T15:00:47Z","pushed_at":"2024-05-14T13:20:12Z","git_url":"git://github.com/open-quantum-safe/liboqs.git","ssh_url":"git@github.com:open-quantum-safe/liboqs.git","clone_url":"https://github.com/open-quantum-safe/liboqs.git","svn_url":"https://github.com/open-quantum-safe/liboqs","homepage":"https://openquantumsafe.org/","size":143464,"stargazers_count":1628,"watchers_count":1628,"language":"C","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":406,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":58,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":true,"topics":["cryptography","key-exchange-algorithms","lattice-based-crypto","post-quantum-cryptography"],"visibility":"public","forks":406,"open_issues":58,"watchers":1628,"default_branch":"main"}},"base":{"label":"open-quantum-safe:main","ref":"main","sha":"a5ec23cf19763d36a558b8358345823ae45d57e5","user":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"repo":{"id":65514205,"node_id":"MDEwOlJlcG9zaXRvcnk2NTUxNDIwNQ==","name":"liboqs","full_name":"open-quantum-safe/liboqs","private":false,"owner":{"login":"open-quantum-safe","id":20689385,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwNjg5Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/20689385?v=4","gravatar_id":"","url":"https://api.github.com/users/open-quantum-safe","html_url":"https://github.com/open-quantum-safe","followers_url":"https://api.github.com/users/open-quantum-safe/followers","following_url":"https://api.github.com/users/open-quantum-safe/following{/other_user}","gists_url":"https://api.github.com/users/open-quantum-safe/gists{/gist_id}","starred_url":"https://api.github.com/users/open-quantum-safe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/open-quantum-safe/subscriptions","organizations_url":"https://api.github.com/users/open-quantum-safe/orgs","repos_url":"https://api.github.com/users/open-quantum-safe/repos","events_url":"https://api.github.com/users/open-quantum-safe/events{/privacy}","received_events_url":"https://api.github.com/users/open-quantum-safe/received_events","type":"Organization","site_admin":false},"html_url":"https://github.com/open-quantum-safe/liboqs","description":"C library for prototyping and experimenting with quantum-resistant cryptography","fork":false,"url":"https://api.github.com/repos/open-quantum-safe/liboqs","forks_url":"https://api.github.com/repos/open-quantum-safe/liboqs/forks","keys_url":"https://api.github.com/repos/open-quantum-safe/liboqs/keys{/key_id}","collaborators_url":"https://api.github.com/repos/open-quantum-safe/liboqs/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/open-quantum-safe/liboqs/teams","hooks_url":"https://api.github.com/repos/open-quantum-safe/liboqs/hooks","issue_events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/events{/number}","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/events","assignees_url":"https://api.github.com/repos/open-quantum-safe/liboqs/assignees{/user}","branches_url":"https://api.github.com/repos/open-quantum-safe/liboqs/branches{/branch}","tags_url":"https://api.github.com/repos/open-quantum-safe/liboqs/tags","blobs_url":"https://api.github.com/repos/open-quantum-safe/liboqs/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/open-quantum-safe/liboqs/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/open-quantum-safe/liboqs/git/refs{/sha}","trees_url":"https://api.github.com/repos/open-quantum-safe/liboqs/git/trees{/sha}","statuses_url":"https://api.github.com/repos/open-quantum-safe/liboqs/statuses/{sha}","languages_url":"https://api.github.com/repos/open-quantum-safe/liboqs/languages","stargazers_url":"https://api.github.com/repos/open-quantum-safe/liboqs/stargazers","contributors_url":"https://api.github.com/repos/open-quantum-safe/liboqs/contributors","subscribers_url":"https://api.github.com/repos/open-quantum-safe/liboqs/subscribers","subscription_url":"https://api.github.com/repos/open-quantum-safe/liboqs/subscription","commits_url":"https://api.github.com/repos/open-quantum-safe/liboqs/commits{/sha}","git_commits_url":"https://api.github.com/repos/open-quantum-safe/liboqs/git/commits{/sha}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/comments{/number}","issue_comment_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments{/number}","contents_url":"https://api.github.com/repos/open-quantum-safe/liboqs/contents/{+path}","compare_url":"https://api.github.com/repos/open-quantum-safe/liboqs/compare/{base}...{head}","merges_url":"https://api.github.com/repos/open-quantum-safe/liboqs/merges","archive_url":"https://api.github.com/repos/open-quantum-safe/liboqs/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/open-quantum-safe/liboqs/downloads","issues_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues{/number}","pulls_url":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls{/number}","milestones_url":"https://api.github.com/repos/open-quantum-safe/liboqs/milestones{/number}","notifications_url":"https://api.github.com/repos/open-quantum-safe/liboqs/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/labels{/name}","releases_url":"https://api.github.com/repos/open-quantum-safe/liboqs/releases{/id}","deployments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/deployments","created_at":"2016-08-12T01:46:12Z","updated_at":"2024-05-13T15:00:47Z","pushed_at":"2024-05-14T13:20:12Z","git_url":"git://github.com/open-quantum-safe/liboqs.git","ssh_url":"git@github.com:open-quantum-safe/liboqs.git","clone_url":"https://github.com/open-quantum-safe/liboqs.git","svn_url":"https://github.com/open-quantum-safe/liboqs","homepage":"https://openquantumsafe.org/","size":143464,"stargazers_count":1628,"watchers_count":1628,"language":"C","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":406,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":58,"license":{"key":"other","name":"Other","spdx_id":"NOASSERTION","url":null,"node_id":"MDc6TGljZW5zZTA="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":true,"topics":["cryptography","key-exchange-algorithms","lattice-based-crypto","post-quantum-cryptography"],"visibility":"public","forks":406,"open_issues":58,"watchers":1628,"default_branch":"main"}},"_links":{"self":{"href":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/1650"},"html":{"href":"https://github.com/open-quantum-safe/liboqs/pull/1650"},"issue":{"href":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1650"},"comments":{"href":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1650/comments"},"review_comments":{"href":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/1650/comments"},"review_comment":{"href":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/comments{/number}"},"commits":{"href":"https://api.github.com/repos/open-quantum-safe/liboqs/pulls/1650/commits"},"statuses":{"href":"https://api.github.com/repos/open-quantum-safe/liboqs/statuses/4ebd1b94ebd71181a43653e441700226d537026f"}},"author_association":"COLLABORATOR","auto_merge":null,"active_lock_reason":null}},"public":true,"created_at":"2024-05-14T13:40:23Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
