{"id":"10354450125","type":"IssueCommentEvent","actor":{"id":25283073,"login":"RicardoGaGu","display_login":"RicardoGaGu","gravatar_id":"","url":"https://api.github.com/users/RicardoGaGu","avatar_url":"https://avatars.githubusercontent.com/u/25283073?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/103","id":472766958,"node_id":"MDU6SXNzdWU0NzI3NjY5NTg=","number":103,"title":"Failing to compile NGINX with PQ openssl fork","user":{"login":"RicardoGaGu","id":25283073,"node_id":"MDQ6VXNlcjI1MjgzMDcz","avatar_url":"https://avatars3.githubusercontent.com/u/25283073?v=4","gravatar_id":"","url":"https://api.github.com/users/RicardoGaGu","html_url":"https://github.com/RicardoGaGu","followers_url":"https://api.github.com/users/RicardoGaGu/followers","following_url":"https://api.github.com/users/RicardoGaGu/following{/other_user}","gists_url":"https://api.github.com/users/RicardoGaGu/gists{/gist_id}","starred_url":"https://api.github.com/users/RicardoGaGu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RicardoGaGu/subscriptions","organizations_url":"https://api.github.com/users/RicardoGaGu/orgs","repos_url":"https://api.github.com/users/RicardoGaGu/repos","events_url":"https://api.github.com/users/RicardoGaGu/events{/privacy}","received_events_url":"https://api.github.com/users/RicardoGaGu/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2019-07-25T09:42:07Z","updated_at":"2019-09-05T13:46:50Z","closed_at":null,"author_association":"NONE","body":"HI! I'm trying to compile the PQ OpenSSL fork into NGINX, I've run into some problems when building nginx wirth openssl underneath. I'll show my Dockerfile to clarify my procedure for installing Nginx. I have tested the TLS demo and works fine, but when configuring Nginx on Ubuntu 18.04 it fails. I kindly ask if anyone know how to solve this problem.\r\n\r\n```\r\nFROM ubuntu:18.04\r\n\r\n### Building NGINX from source with post quantum openssl for TLS connections\r\nRUN apt update && apt upgrade -y\r\nRUN apt install wget autoconf automake libtool libssl-dev make unzip xsltproc git -y\r\nRUN apt install build-essential -y\r\n\r\n### Step 1: Build required libraries: pcre, zlib and quantum safe openssl\r\n\r\n### PCRE\r\nRUN wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.42.tar.gz && \\\r\n tar -zxf pcre-8.42.tar.gz && \\\r\n cd pcre-8.42 && \\\r\n ./configure && \\\r\n make && \\\r\n make install\r\n### ZLIB\r\nRUN wget http://zlib.net/zlib-1.2.11.tar.gz && \\\r\n tar -zxf zlib-1.2.11.tar.gz && \\\r\n cd zlib-1.2.11 && \\\r\n ./configure && \\\r\n make && \\\r\n make install\r\n\r\n\r\n### Install liboqs\r\nWORKDIR /usr/local/\r\n\r\nRUN git clone --branch OQS-OpenSSL_1_1_1-stable https://github.com/open-quantum-safe/openssl.git\r\n\r\nRUN git clone --branch master https://github.com/open-quantum-safe/liboqs.git\r\n\r\nWORKDIR /usr/local/liboqs\r\nRUN autoreconf -i\r\nRUN ./configure --prefix=/usr/local/openssl/oqs --enable-shared=no\r\nRUN make -j\r\nRUN make install\r\n\r\n### Install openssl\r\nWORKDIR /usr/local/openssl\r\nRUN ./config --prefix=/usr/local/openssl -Wl,-rpath -Wl,/usr/local/openssl/oqs/lib\r\nRUN make -j\r\n\r\nRUN cp libcrypto.so.1.1 ./oqs/lib\r\nRUN cp libssl.so.1.1 ./oqs/lib\r\n\r\nWORKDIR /\r\n\r\n### Step 2: Download NGINX and RTMP module\r\nRUN wget https://nginx.org/download/nginx-1.15.11.tar.gz && \\\r\n tar zxf nginx-1.15.11.tar.gz\r\n\r\nRUN wget https://github.com/arut/nginx-rtmp-module/archive/master.zip && \\\r\n unzip master.zip\r\n\r\nRUN rm -rf *.tar.gz\r\n\r\n### Step 3: Build and install NGINX\r\nRUN wget https://nginx.org/download/nginx-1.15.11.tar.gz && \\\r\n tar zxf nginx-1.15.11.tar.gz\r\n\r\nRUN   cd nginx-1.15.11 && ./configure \\\r\n--with-cc-opt=\"-I /usr/local/openssl/oqs/include/\" \\\r\n--with-ld-opt=\"-L /usr/local/openssl/oqs/lib/\"\\\r\n--sbin-path=/usr/local/nginx/nginx \\\r\n--conf-path=/usr/local/nginx/nginx.conf \\\r\n--pid-path=/usr/local/nginx/nginx.pid \\\r\n--with-pcre=../pcre-8.42 \\\r\n--with-zlib=../zlib-1.2.11 \\\r\n--with-openssl=/usr/local/openssl \\\r\n--with-http_ssl_module \\\r\n--with-stream \\\r\n--with-mail=dynamic \\\r\n--add-module=/nginx-rtmp-module-master && \\\r\nmake && \\\r\nmake install\r\n```\r\n\r\nThe error is the following:\r\n\r\n/usr/local/openssl/.openssl/lib/libssl.a(s3_lib.o): In function `ssl3_clear':\r\ns3_lib.c:(.text+0x51b): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_clnt.o): In function `tls_construct_ctos_key_share':\r\nextensions_clnt.c:(.text+0x18af): undefined reference to `OQS_KEM_new'\r\nextensions_clnt.c:(.text+0x1952): undefined reference to `OQS_KEM_keypair'\r\nextensions_clnt.c:(.text+0x199c): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x19a4): undefined reference to `OQS_MEM_insecure_free'\r\nextensions_clnt.c:(.text+0x19c2): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_clnt.o): In function `tls_parse_stoc_key_share':\r\nextensions_clnt.c:(.text+0x3c96): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x3cb4): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x3cd2): undefined reference to `OQS_KEM_free'\r\nextensions_clnt.c:(.text+0x3d77): undefined reference to `OQS_KEM_decaps'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_srvr.o): In function `tls_construct_stoc_key_share':\r\nextensions_srvr.c:(.text+0x3769): undefined reference to `OQS_KEM_new'\r\nextensions_srvr.c:(.text+0x37be): undefined reference to `OQS_KEM_encaps'\r\nextensions_srvr.c:(.text+0x3906): undefined reference to `OQS_MEM_secure_free'\r\nextensions_srvr.c:(.text+0x390e): undefined reference to `OQS_KEM_free'\r\nextensions_srvr.c:(.text+0x3aeb): undefined reference to `OQS_MEM_secure_free'\r\nextensions_srvr.c:(.text+0x3af3): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_digestverify':\r\noqs_meth.c:(.text+0x101): undefined reference to `OQS_SIG_verify'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_digestsign':\r\noqs_meth.c:(.text+0x62f): undefined reference to `OQS_SIG_sign'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_free':\r\noqs_meth.c:(.text+0x1d0e): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_key_init':\r\noqs_meth.c:(.text+0x1df9): undefined reference to `OQS_SIG_new'\r\noqs_meth.c:(.text+0x1f30): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_priv_decode':\r\noqs_meth.c:(.text+0x22f6): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_keygen':\r\noqs_meth.c:(.text+0x2528): undefined reference to `OQS_SIG_new'\r\noqs_meth.c:(.text+0x273c): undefined reference to `OQS_SIG_keypair'\r\noqs_meth.c:(.text+0x2778): undefined reference to `OQS_SIG_free'\r\noqs_meth.c:(.text+0x2810): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_pub_decode':\r\noqs_meth.c:(.text+0x2b6a): undefined reference to `OQS_SIG_free'\r\ncollect2: error: ld returned 1 exit status\r\nobjs/Makefile:323: recipe for target 'objs/nginx' failed\r\nmake[1]: Leaving directory '/nginx-1.15.11'\r\nmake[1]: *** [objs/nginx] Error 1\r\nMakefile:8: recipe for target 'build' failed\r\nmake: *** [build] Error 2\r\n\r\n\r\nThanks!"},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/528372695","html_url":"https://github.com/open-quantum-safe/openssl/issues/103#issuecomment-528372695","issue_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103","id":528372695,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODM3MjY5NQ==","user":{"login":"RicardoGaGu","id":25283073,"node_id":"MDQ6VXNlcjI1MjgzMDcz","avatar_url":"https://avatars3.githubusercontent.com/u/25283073?v=4","gravatar_id":"","url":"https://api.github.com/users/RicardoGaGu","html_url":"https://github.com/RicardoGaGu","followers_url":"https://api.github.com/users/RicardoGaGu/followers","following_url":"https://api.github.com/users/RicardoGaGu/following{/other_user}","gists_url":"https://api.github.com/users/RicardoGaGu/gists{/gist_id}","starred_url":"https://api.github.com/users/RicardoGaGu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RicardoGaGu/subscriptions","organizations_url":"https://api.github.com/users/RicardoGaGu/orgs","repos_url":"https://api.github.com/users/RicardoGaGu/repos","events_url":"https://api.github.com/users/RicardoGaGu/events{/privacy}","received_events_url":"https://api.github.com/users/RicardoGaGu/received_events","type":"User","site_admin":false},"created_at":"2019-09-05T13:46:50Z","updated_at":"2019-09-05T13:46:50Z","author_association":"NONE","body":"Hi, I feel obligated to comment here again. I did succeed to compile the pqc enabled openssl fork on a nginx web server and did some succesful tests with another pqc openssl client container, but I've built the docker image without cache settings (I follow all the steps of wiki documentation in the dockerfile instructions) and it seems that some modifications on the stable branch of this openssl fork have introduced some new errors during the building of the nginx. They seem to be openssl related and that's why I suspect some changes have been going on. Nonetheless, I post here the error to see if anyone can make sense out of it:\r\n\r\n> src/event/ngx_event_openssl.c: In function 'ngx_ssl_session_id_context':\r\nsrc/event/ngx_event_openssl.c:3123:10: error: implicit declaration of function 'EVP_MD_CTX_create'; did you mean 'EVP_MD_CTX_free'? [-Werror=implicit-function-declaration]\r\n     md = EVP_MD_CTX_create();\r\n          ^~~~~~~~~~~~~~~~~\r\n          EVP_MD_CTX_free\r\nsrc/event/ngx_event_openssl.c:3123:8: error: assignment makes pointer from integer without a cast [-Werror=int-conversion]\r\n     md = EVP_MD_CTX_create();\r\n        ^\r\nsrc/event/ngx_event_openssl.c:3203:5: error: implicit declaration of function 'EVP_MD_CTX_destroy'; did you mean 'EVP_MD_CTX_reset'? [-Werror=implicit-function-declaration]\r\n     EVP_MD_CTX_destroy(md);\r\n     ^~~~~~~~~~~~~~~~~~\r\n     EVP_MD_CTX_reset\r\ncc1: all warnings being treated as errors\r\nobjs/Makefile:848: recipe for target 'objs/src/event/ngx_event_openssl.o' failed\r\nmake[1]: Leaving directory '/nginx-1.17.0'\r\nmake[1]: *** [objs/src/event/ngx_event_openssl.o] Error 1\r\nmake: *** [build] Error 2\r\nMakefile:8: recipe for target 'build' failed\r\nThe command '/bin/sh -c make' returned a non-zero code: 2\r\n\r\n\r\n\r\nAlso, these are warnings , but the compilation of Nginx goes with the -Werror flags that automatically converts them into errors during building. I tried avoiding this flag but the built nginx service start results on a segmentation fault (core dump).\r\n\r\nThank you."}},"public":true,"created_at":"2019-09-05T13:46:50Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"10354615041","type":"IssueCommentEvent","actor":{"id":8843219,"login":"dstebila","display_login":"dstebila","gravatar_id":"","url":"https://api.github.com/users/dstebila","avatar_url":"https://avatars.githubusercontent.com/u/8843219?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/103","id":472766958,"node_id":"MDU6SXNzdWU0NzI3NjY5NTg=","number":103,"title":"Failing to compile NGINX with PQ openssl fork","user":{"login":"RicardoGaGu","id":25283073,"node_id":"MDQ6VXNlcjI1MjgzMDcz","avatar_url":"https://avatars3.githubusercontent.com/u/25283073?v=4","gravatar_id":"","url":"https://api.github.com/users/RicardoGaGu","html_url":"https://github.com/RicardoGaGu","followers_url":"https://api.github.com/users/RicardoGaGu/followers","following_url":"https://api.github.com/users/RicardoGaGu/following{/other_user}","gists_url":"https://api.github.com/users/RicardoGaGu/gists{/gist_id}","starred_url":"https://api.github.com/users/RicardoGaGu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RicardoGaGu/subscriptions","organizations_url":"https://api.github.com/users/RicardoGaGu/orgs","repos_url":"https://api.github.com/users/RicardoGaGu/repos","events_url":"https://api.github.com/users/RicardoGaGu/events{/privacy}","received_events_url":"https://api.github.com/users/RicardoGaGu/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2019-07-25T09:42:07Z","updated_at":"2019-09-05T14:05:05Z","closed_at":null,"author_association":"NONE","body":"HI! I'm trying to compile the PQ OpenSSL fork into NGINX, I've run into some problems when building nginx wirth openssl underneath. I'll show my Dockerfile to clarify my procedure for installing Nginx. I have tested the TLS demo and works fine, but when configuring Nginx on Ubuntu 18.04 it fails. I kindly ask if anyone know how to solve this problem.\r\n\r\n```\r\nFROM ubuntu:18.04\r\n\r\n### Building NGINX from source with post quantum openssl for TLS connections\r\nRUN apt update && apt upgrade -y\r\nRUN apt install wget autoconf automake libtool libssl-dev make unzip xsltproc git -y\r\nRUN apt install build-essential -y\r\n\r\n### Step 1: Build required libraries: pcre, zlib and quantum safe openssl\r\n\r\n### PCRE\r\nRUN wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.42.tar.gz && \\\r\n tar -zxf pcre-8.42.tar.gz && \\\r\n cd pcre-8.42 && \\\r\n ./configure && \\\r\n make && \\\r\n make install\r\n### ZLIB\r\nRUN wget http://zlib.net/zlib-1.2.11.tar.gz && \\\r\n tar -zxf zlib-1.2.11.tar.gz && \\\r\n cd zlib-1.2.11 && \\\r\n ./configure && \\\r\n make && \\\r\n make install\r\n\r\n\r\n### Install liboqs\r\nWORKDIR /usr/local/\r\n\r\nRUN git clone --branch OQS-OpenSSL_1_1_1-stable https://github.com/open-quantum-safe/openssl.git\r\n\r\nRUN git clone --branch master https://github.com/open-quantum-safe/liboqs.git\r\n\r\nWORKDIR /usr/local/liboqs\r\nRUN autoreconf -i\r\nRUN ./configure --prefix=/usr/local/openssl/oqs --enable-shared=no\r\nRUN make -j\r\nRUN make install\r\n\r\n### Install openssl\r\nWORKDIR /usr/local/openssl\r\nRUN ./config --prefix=/usr/local/openssl -Wl,-rpath -Wl,/usr/local/openssl/oqs/lib\r\nRUN make -j\r\n\r\nRUN cp libcrypto.so.1.1 ./oqs/lib\r\nRUN cp libssl.so.1.1 ./oqs/lib\r\n\r\nWORKDIR /\r\n\r\n### Step 2: Download NGINX and RTMP module\r\nRUN wget https://nginx.org/download/nginx-1.15.11.tar.gz && \\\r\n tar zxf nginx-1.15.11.tar.gz\r\n\r\nRUN wget https://github.com/arut/nginx-rtmp-module/archive/master.zip && \\\r\n unzip master.zip\r\n\r\nRUN rm -rf *.tar.gz\r\n\r\n### Step 3: Build and install NGINX\r\nRUN wget https://nginx.org/download/nginx-1.15.11.tar.gz && \\\r\n tar zxf nginx-1.15.11.tar.gz\r\n\r\nRUN   cd nginx-1.15.11 && ./configure \\\r\n--with-cc-opt=\"-I /usr/local/openssl/oqs/include/\" \\\r\n--with-ld-opt=\"-L /usr/local/openssl/oqs/lib/\"\\\r\n--sbin-path=/usr/local/nginx/nginx \\\r\n--conf-path=/usr/local/nginx/nginx.conf \\\r\n--pid-path=/usr/local/nginx/nginx.pid \\\r\n--with-pcre=../pcre-8.42 \\\r\n--with-zlib=../zlib-1.2.11 \\\r\n--with-openssl=/usr/local/openssl \\\r\n--with-http_ssl_module \\\r\n--with-stream \\\r\n--with-mail=dynamic \\\r\n--add-module=/nginx-rtmp-module-master && \\\r\nmake && \\\r\nmake install\r\n```\r\n\r\nThe error is the following:\r\n\r\n/usr/local/openssl/.openssl/lib/libssl.a(s3_lib.o): In function `ssl3_clear':\r\ns3_lib.c:(.text+0x51b): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_clnt.o): In function `tls_construct_ctos_key_share':\r\nextensions_clnt.c:(.text+0x18af): undefined reference to `OQS_KEM_new'\r\nextensions_clnt.c:(.text+0x1952): undefined reference to `OQS_KEM_keypair'\r\nextensions_clnt.c:(.text+0x199c): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x19a4): undefined reference to `OQS_MEM_insecure_free'\r\nextensions_clnt.c:(.text+0x19c2): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_clnt.o): In function `tls_parse_stoc_key_share':\r\nextensions_clnt.c:(.text+0x3c96): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x3cb4): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x3cd2): undefined reference to `OQS_KEM_free'\r\nextensions_clnt.c:(.text+0x3d77): undefined reference to `OQS_KEM_decaps'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_srvr.o): In function `tls_construct_stoc_key_share':\r\nextensions_srvr.c:(.text+0x3769): undefined reference to `OQS_KEM_new'\r\nextensions_srvr.c:(.text+0x37be): undefined reference to `OQS_KEM_encaps'\r\nextensions_srvr.c:(.text+0x3906): undefined reference to `OQS_MEM_secure_free'\r\nextensions_srvr.c:(.text+0x390e): undefined reference to `OQS_KEM_free'\r\nextensions_srvr.c:(.text+0x3aeb): undefined reference to `OQS_MEM_secure_free'\r\nextensions_srvr.c:(.text+0x3af3): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_digestverify':\r\noqs_meth.c:(.text+0x101): undefined reference to `OQS_SIG_verify'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_digestsign':\r\noqs_meth.c:(.text+0x62f): undefined reference to `OQS_SIG_sign'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_free':\r\noqs_meth.c:(.text+0x1d0e): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_key_init':\r\noqs_meth.c:(.text+0x1df9): undefined reference to `OQS_SIG_new'\r\noqs_meth.c:(.text+0x1f30): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_priv_decode':\r\noqs_meth.c:(.text+0x22f6): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_keygen':\r\noqs_meth.c:(.text+0x2528): undefined reference to `OQS_SIG_new'\r\noqs_meth.c:(.text+0x273c): undefined reference to `OQS_SIG_keypair'\r\noqs_meth.c:(.text+0x2778): undefined reference to `OQS_SIG_free'\r\noqs_meth.c:(.text+0x2810): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_pub_decode':\r\noqs_meth.c:(.text+0x2b6a): undefined reference to `OQS_SIG_free'\r\ncollect2: error: ld returned 1 exit status\r\nobjs/Makefile:323: recipe for target 'objs/nginx' failed\r\nmake[1]: Leaving directory '/nginx-1.15.11'\r\nmake[1]: *** [objs/nginx] Error 1\r\nMakefile:8: recipe for target 'build' failed\r\nmake: *** [build] Error 2\r\n\r\n\r\nThanks!"},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/528380809","html_url":"https://github.com/open-quantum-safe/openssl/issues/103#issuecomment-528380809","issue_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103","id":528380809,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODM4MDgwOQ==","user":{"login":"dstebila","id":8843219,"node_id":"MDQ6VXNlcjg4NDMyMTk=","avatar_url":"https://avatars0.githubusercontent.com/u/8843219?v=4","gravatar_id":"","url":"https://api.github.com/users/dstebila","html_url":"https://github.com/dstebila","followers_url":"https://api.github.com/users/dstebila/followers","following_url":"https://api.github.com/users/dstebila/following{/other_user}","gists_url":"https://api.github.com/users/dstebila/gists{/gist_id}","starred_url":"https://api.github.com/users/dstebila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dstebila/subscriptions","organizations_url":"https://api.github.com/users/dstebila/orgs","repos_url":"https://api.github.com/users/dstebila/repos","events_url":"https://api.github.com/users/dstebila/events{/privacy}","received_events_url":"https://api.github.com/users/dstebila/received_events","type":"User","site_admin":false},"created_at":"2019-09-05T14:05:05Z","updated_at":"2019-09-05T14:05:05Z","author_association":"MEMBER","body":"Are you using our OpenSSL 1.0.2 branch or our OpenSSL 1.1.1 branch?  OpenSSL changed names of some EVP\\_MD\\_CTX function names from 1.0.2 to 1.1.1, so that may be related to the error you are experiencing.  "}},"public":true,"created_at":"2019-09-05T14:05:05Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"10354668840","type":"IssueCommentEvent","actor":{"id":25283073,"login":"RicardoGaGu","display_login":"RicardoGaGu","gravatar_id":"","url":"https://api.github.com/users/RicardoGaGu","avatar_url":"https://avatars.githubusercontent.com/u/25283073?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/103","id":472766958,"node_id":"MDU6SXNzdWU0NzI3NjY5NTg=","number":103,"title":"Failing to compile NGINX with PQ openssl fork","user":{"login":"RicardoGaGu","id":25283073,"node_id":"MDQ6VXNlcjI1MjgzMDcz","avatar_url":"https://avatars3.githubusercontent.com/u/25283073?v=4","gravatar_id":"","url":"https://api.github.com/users/RicardoGaGu","html_url":"https://github.com/RicardoGaGu","followers_url":"https://api.github.com/users/RicardoGaGu/followers","following_url":"https://api.github.com/users/RicardoGaGu/following{/other_user}","gists_url":"https://api.github.com/users/RicardoGaGu/gists{/gist_id}","starred_url":"https://api.github.com/users/RicardoGaGu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RicardoGaGu/subscriptions","organizations_url":"https://api.github.com/users/RicardoGaGu/orgs","repos_url":"https://api.github.com/users/RicardoGaGu/repos","events_url":"https://api.github.com/users/RicardoGaGu/events{/privacy}","received_events_url":"https://api.github.com/users/RicardoGaGu/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2019-07-25T09:42:07Z","updated_at":"2019-09-05T14:11:06Z","closed_at":null,"author_association":"NONE","body":"HI! I'm trying to compile the PQ OpenSSL fork into NGINX, I've run into some problems when building nginx wirth openssl underneath. I'll show my Dockerfile to clarify my procedure for installing Nginx. I have tested the TLS demo and works fine, but when configuring Nginx on Ubuntu 18.04 it fails. I kindly ask if anyone know how to solve this problem.\r\n\r\n```\r\nFROM ubuntu:18.04\r\n\r\n### Building NGINX from source with post quantum openssl for TLS connections\r\nRUN apt update && apt upgrade -y\r\nRUN apt install wget autoconf automake libtool libssl-dev make unzip xsltproc git -y\r\nRUN apt install build-essential -y\r\n\r\n### Step 1: Build required libraries: pcre, zlib and quantum safe openssl\r\n\r\n### PCRE\r\nRUN wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.42.tar.gz && \\\r\n tar -zxf pcre-8.42.tar.gz && \\\r\n cd pcre-8.42 && \\\r\n ./configure && \\\r\n make && \\\r\n make install\r\n### ZLIB\r\nRUN wget http://zlib.net/zlib-1.2.11.tar.gz && \\\r\n tar -zxf zlib-1.2.11.tar.gz && \\\r\n cd zlib-1.2.11 && \\\r\n ./configure && \\\r\n make && \\\r\n make install\r\n\r\n\r\n### Install liboqs\r\nWORKDIR /usr/local/\r\n\r\nRUN git clone --branch OQS-OpenSSL_1_1_1-stable https://github.com/open-quantum-safe/openssl.git\r\n\r\nRUN git clone --branch master https://github.com/open-quantum-safe/liboqs.git\r\n\r\nWORKDIR /usr/local/liboqs\r\nRUN autoreconf -i\r\nRUN ./configure --prefix=/usr/local/openssl/oqs --enable-shared=no\r\nRUN make -j\r\nRUN make install\r\n\r\n### Install openssl\r\nWORKDIR /usr/local/openssl\r\nRUN ./config --prefix=/usr/local/openssl -Wl,-rpath -Wl,/usr/local/openssl/oqs/lib\r\nRUN make -j\r\n\r\nRUN cp libcrypto.so.1.1 ./oqs/lib\r\nRUN cp libssl.so.1.1 ./oqs/lib\r\n\r\nWORKDIR /\r\n\r\n### Step 2: Download NGINX and RTMP module\r\nRUN wget https://nginx.org/download/nginx-1.15.11.tar.gz && \\\r\n tar zxf nginx-1.15.11.tar.gz\r\n\r\nRUN wget https://github.com/arut/nginx-rtmp-module/archive/master.zip && \\\r\n unzip master.zip\r\n\r\nRUN rm -rf *.tar.gz\r\n\r\n### Step 3: Build and install NGINX\r\nRUN wget https://nginx.org/download/nginx-1.15.11.tar.gz && \\\r\n tar zxf nginx-1.15.11.tar.gz\r\n\r\nRUN   cd nginx-1.15.11 && ./configure \\\r\n--with-cc-opt=\"-I /usr/local/openssl/oqs/include/\" \\\r\n--with-ld-opt=\"-L /usr/local/openssl/oqs/lib/\"\\\r\n--sbin-path=/usr/local/nginx/nginx \\\r\n--conf-path=/usr/local/nginx/nginx.conf \\\r\n--pid-path=/usr/local/nginx/nginx.pid \\\r\n--with-pcre=../pcre-8.42 \\\r\n--with-zlib=../zlib-1.2.11 \\\r\n--with-openssl=/usr/local/openssl \\\r\n--with-http_ssl_module \\\r\n--with-stream \\\r\n--with-mail=dynamic \\\r\n--add-module=/nginx-rtmp-module-master && \\\r\nmake && \\\r\nmake install\r\n```\r\n\r\nThe error is the following:\r\n\r\n/usr/local/openssl/.openssl/lib/libssl.a(s3_lib.o): In function `ssl3_clear':\r\ns3_lib.c:(.text+0x51b): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_clnt.o): In function `tls_construct_ctos_key_share':\r\nextensions_clnt.c:(.text+0x18af): undefined reference to `OQS_KEM_new'\r\nextensions_clnt.c:(.text+0x1952): undefined reference to `OQS_KEM_keypair'\r\nextensions_clnt.c:(.text+0x199c): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x19a4): undefined reference to `OQS_MEM_insecure_free'\r\nextensions_clnt.c:(.text+0x19c2): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_clnt.o): In function `tls_parse_stoc_key_share':\r\nextensions_clnt.c:(.text+0x3c96): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x3cb4): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x3cd2): undefined reference to `OQS_KEM_free'\r\nextensions_clnt.c:(.text+0x3d77): undefined reference to `OQS_KEM_decaps'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_srvr.o): In function `tls_construct_stoc_key_share':\r\nextensions_srvr.c:(.text+0x3769): undefined reference to `OQS_KEM_new'\r\nextensions_srvr.c:(.text+0x37be): undefined reference to `OQS_KEM_encaps'\r\nextensions_srvr.c:(.text+0x3906): undefined reference to `OQS_MEM_secure_free'\r\nextensions_srvr.c:(.text+0x390e): undefined reference to `OQS_KEM_free'\r\nextensions_srvr.c:(.text+0x3aeb): undefined reference to `OQS_MEM_secure_free'\r\nextensions_srvr.c:(.text+0x3af3): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_digestverify':\r\noqs_meth.c:(.text+0x101): undefined reference to `OQS_SIG_verify'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_digestsign':\r\noqs_meth.c:(.text+0x62f): undefined reference to `OQS_SIG_sign'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_free':\r\noqs_meth.c:(.text+0x1d0e): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_key_init':\r\noqs_meth.c:(.text+0x1df9): undefined reference to `OQS_SIG_new'\r\noqs_meth.c:(.text+0x1f30): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_priv_decode':\r\noqs_meth.c:(.text+0x22f6): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_keygen':\r\noqs_meth.c:(.text+0x2528): undefined reference to `OQS_SIG_new'\r\noqs_meth.c:(.text+0x273c): undefined reference to `OQS_SIG_keypair'\r\noqs_meth.c:(.text+0x2778): undefined reference to `OQS_SIG_free'\r\noqs_meth.c:(.text+0x2810): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_pub_decode':\r\noqs_meth.c:(.text+0x2b6a): undefined reference to `OQS_SIG_free'\r\ncollect2: error: ld returned 1 exit status\r\nobjs/Makefile:323: recipe for target 'objs/nginx' failed\r\nmake[1]: Leaving directory '/nginx-1.15.11'\r\nmake[1]: *** [objs/nginx] Error 1\r\nMakefile:8: recipe for target 'build' failed\r\nmake: *** [build] Error 2\r\n\r\n\r\nThanks!"},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/528383241","html_url":"https://github.com/open-quantum-safe/openssl/issues/103#issuecomment-528383241","issue_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103","id":528383241,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODM4MzI0MQ==","user":{"login":"RicardoGaGu","id":25283073,"node_id":"MDQ6VXNlcjI1MjgzMDcz","avatar_url":"https://avatars3.githubusercontent.com/u/25283073?v=4","gravatar_id":"","url":"https://api.github.com/users/RicardoGaGu","html_url":"https://github.com/RicardoGaGu","followers_url":"https://api.github.com/users/RicardoGaGu/followers","following_url":"https://api.github.com/users/RicardoGaGu/following{/other_user}","gists_url":"https://api.github.com/users/RicardoGaGu/gists{/gist_id}","starred_url":"https://api.github.com/users/RicardoGaGu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RicardoGaGu/subscriptions","organizations_url":"https://api.github.com/users/RicardoGaGu/orgs","repos_url":"https://api.github.com/users/RicardoGaGu/repos","events_url":"https://api.github.com/users/RicardoGaGu/events{/privacy}","received_events_url":"https://api.github.com/users/RicardoGaGu/received_events","type":"User","site_admin":false},"created_at":"2019-09-05T14:11:06Z","updated_at":"2019-09-05T14:11:06Z","author_association":"NONE","body":"I'm using the OQS-OpenSSL_1_1_1-stable branch."}},"public":true,"created_at":"2019-09-05T14:11:06Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"10354877544","type":"IssueCommentEvent","actor":{"id":24617764,"login":"csosto-pk","display_login":"csosto-pk","gravatar_id":"","url":"https://api.github.com/users/csosto-pk","avatar_url":"https://avatars.githubusercontent.com/u/24617764?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/103","id":472766958,"node_id":"MDU6SXNzdWU0NzI3NjY5NTg=","number":103,"title":"Failing to compile NGINX with PQ openssl fork","user":{"login":"RicardoGaGu","id":25283073,"node_id":"MDQ6VXNlcjI1MjgzMDcz","avatar_url":"https://avatars3.githubusercontent.com/u/25283073?v=4","gravatar_id":"","url":"https://api.github.com/users/RicardoGaGu","html_url":"https://github.com/RicardoGaGu","followers_url":"https://api.github.com/users/RicardoGaGu/followers","following_url":"https://api.github.com/users/RicardoGaGu/following{/other_user}","gists_url":"https://api.github.com/users/RicardoGaGu/gists{/gist_id}","starred_url":"https://api.github.com/users/RicardoGaGu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RicardoGaGu/subscriptions","organizations_url":"https://api.github.com/users/RicardoGaGu/orgs","repos_url":"https://api.github.com/users/RicardoGaGu/repos","events_url":"https://api.github.com/users/RicardoGaGu/events{/privacy}","received_events_url":"https://api.github.com/users/RicardoGaGu/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2019-07-25T09:42:07Z","updated_at":"2019-09-05T14:33:57Z","closed_at":null,"author_association":"NONE","body":"HI! I'm trying to compile the PQ OpenSSL fork into NGINX, I've run into some problems when building nginx wirth openssl underneath. I'll show my Dockerfile to clarify my procedure for installing Nginx. I have tested the TLS demo and works fine, but when configuring Nginx on Ubuntu 18.04 it fails. I kindly ask if anyone know how to solve this problem.\r\n\r\n```\r\nFROM ubuntu:18.04\r\n\r\n### Building NGINX from source with post quantum openssl for TLS connections\r\nRUN apt update && apt upgrade -y\r\nRUN apt install wget autoconf automake libtool libssl-dev make unzip xsltproc git -y\r\nRUN apt install build-essential -y\r\n\r\n### Step 1: Build required libraries: pcre, zlib and quantum safe openssl\r\n\r\n### PCRE\r\nRUN wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.42.tar.gz && \\\r\n tar -zxf pcre-8.42.tar.gz && \\\r\n cd pcre-8.42 && \\\r\n ./configure && \\\r\n make && \\\r\n make install\r\n### ZLIB\r\nRUN wget http://zlib.net/zlib-1.2.11.tar.gz && \\\r\n tar -zxf zlib-1.2.11.tar.gz && \\\r\n cd zlib-1.2.11 && \\\r\n ./configure && \\\r\n make && \\\r\n make install\r\n\r\n\r\n### Install liboqs\r\nWORKDIR /usr/local/\r\n\r\nRUN git clone --branch OQS-OpenSSL_1_1_1-stable https://github.com/open-quantum-safe/openssl.git\r\n\r\nRUN git clone --branch master https://github.com/open-quantum-safe/liboqs.git\r\n\r\nWORKDIR /usr/local/liboqs\r\nRUN autoreconf -i\r\nRUN ./configure --prefix=/usr/local/openssl/oqs --enable-shared=no\r\nRUN make -j\r\nRUN make install\r\n\r\n### Install openssl\r\nWORKDIR /usr/local/openssl\r\nRUN ./config --prefix=/usr/local/openssl -Wl,-rpath -Wl,/usr/local/openssl/oqs/lib\r\nRUN make -j\r\n\r\nRUN cp libcrypto.so.1.1 ./oqs/lib\r\nRUN cp libssl.so.1.1 ./oqs/lib\r\n\r\nWORKDIR /\r\n\r\n### Step 2: Download NGINX and RTMP module\r\nRUN wget https://nginx.org/download/nginx-1.15.11.tar.gz && \\\r\n tar zxf nginx-1.15.11.tar.gz\r\n\r\nRUN wget https://github.com/arut/nginx-rtmp-module/archive/master.zip && \\\r\n unzip master.zip\r\n\r\nRUN rm -rf *.tar.gz\r\n\r\n### Step 3: Build and install NGINX\r\nRUN wget https://nginx.org/download/nginx-1.15.11.tar.gz && \\\r\n tar zxf nginx-1.15.11.tar.gz\r\n\r\nRUN   cd nginx-1.15.11 && ./configure \\\r\n--with-cc-opt=\"-I /usr/local/openssl/oqs/include/\" \\\r\n--with-ld-opt=\"-L /usr/local/openssl/oqs/lib/\"\\\r\n--sbin-path=/usr/local/nginx/nginx \\\r\n--conf-path=/usr/local/nginx/nginx.conf \\\r\n--pid-path=/usr/local/nginx/nginx.pid \\\r\n--with-pcre=../pcre-8.42 \\\r\n--with-zlib=../zlib-1.2.11 \\\r\n--with-openssl=/usr/local/openssl \\\r\n--with-http_ssl_module \\\r\n--with-stream \\\r\n--with-mail=dynamic \\\r\n--add-module=/nginx-rtmp-module-master && \\\r\nmake && \\\r\nmake install\r\n```\r\n\r\nThe error is the following:\r\n\r\n/usr/local/openssl/.openssl/lib/libssl.a(s3_lib.o): In function `ssl3_clear':\r\ns3_lib.c:(.text+0x51b): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_clnt.o): In function `tls_construct_ctos_key_share':\r\nextensions_clnt.c:(.text+0x18af): undefined reference to `OQS_KEM_new'\r\nextensions_clnt.c:(.text+0x1952): undefined reference to `OQS_KEM_keypair'\r\nextensions_clnt.c:(.text+0x199c): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x19a4): undefined reference to `OQS_MEM_insecure_free'\r\nextensions_clnt.c:(.text+0x19c2): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_clnt.o): In function `tls_parse_stoc_key_share':\r\nextensions_clnt.c:(.text+0x3c96): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x3cb4): undefined reference to `OQS_MEM_secure_free'\r\nextensions_clnt.c:(.text+0x3cd2): undefined reference to `OQS_KEM_free'\r\nextensions_clnt.c:(.text+0x3d77): undefined reference to `OQS_KEM_decaps'\r\n/usr/local/openssl/.openssl/lib/libssl.a(extensions_srvr.o): In function `tls_construct_stoc_key_share':\r\nextensions_srvr.c:(.text+0x3769): undefined reference to `OQS_KEM_new'\r\nextensions_srvr.c:(.text+0x37be): undefined reference to `OQS_KEM_encaps'\r\nextensions_srvr.c:(.text+0x3906): undefined reference to `OQS_MEM_secure_free'\r\nextensions_srvr.c:(.text+0x390e): undefined reference to `OQS_KEM_free'\r\nextensions_srvr.c:(.text+0x3aeb): undefined reference to `OQS_MEM_secure_free'\r\nextensions_srvr.c:(.text+0x3af3): undefined reference to `OQS_KEM_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_digestverify':\r\noqs_meth.c:(.text+0x101): undefined reference to `OQS_SIG_verify'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_digestsign':\r\noqs_meth.c:(.text+0x62f): undefined reference to `OQS_SIG_sign'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_free':\r\noqs_meth.c:(.text+0x1d0e): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_key_init':\r\noqs_meth.c:(.text+0x1df9): undefined reference to `OQS_SIG_new'\r\noqs_meth.c:(.text+0x1f30): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_priv_decode':\r\noqs_meth.c:(.text+0x22f6): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `pkey_oqs_keygen':\r\noqs_meth.c:(.text+0x2528): undefined reference to `OQS_SIG_new'\r\noqs_meth.c:(.text+0x273c): undefined reference to `OQS_SIG_keypair'\r\noqs_meth.c:(.text+0x2778): undefined reference to `OQS_SIG_free'\r\noqs_meth.c:(.text+0x2810): undefined reference to `OQS_SIG_free'\r\n/usr/local/openssl/.openssl/lib/libcrypto.a(oqs_meth.o): In function `oqs_pub_decode':\r\noqs_meth.c:(.text+0x2b6a): undefined reference to `OQS_SIG_free'\r\ncollect2: error: ld returned 1 exit status\r\nobjs/Makefile:323: recipe for target 'objs/nginx' failed\r\nmake[1]: Leaving directory '/nginx-1.15.11'\r\nmake[1]: *** [objs/nginx] Error 1\r\nMakefile:8: recipe for target 'build' failed\r\nmake: *** [build] Error 2\r\n\r\n\r\nThanks!"},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/528393172","html_url":"https://github.com/open-quantum-safe/openssl/issues/103#issuecomment-528393172","issue_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/103","id":528393172,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODM5MzE3Mg==","user":{"login":"csosto-pk","id":24617764,"node_id":"MDQ6VXNlcjI0NjE3NzY0","avatar_url":"https://avatars3.githubusercontent.com/u/24617764?v=4","gravatar_id":"","url":"https://api.github.com/users/csosto-pk","html_url":"https://github.com/csosto-pk","followers_url":"https://api.github.com/users/csosto-pk/followers","following_url":"https://api.github.com/users/csosto-pk/following{/other_user}","gists_url":"https://api.github.com/users/csosto-pk/gists{/gist_id}","starred_url":"https://api.github.com/users/csosto-pk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/csosto-pk/subscriptions","organizations_url":"https://api.github.com/users/csosto-pk/orgs","repos_url":"https://api.github.com/users/csosto-pk/repos","events_url":"https://api.github.com/users/csosto-pk/events{/privacy}","received_events_url":"https://api.github.com/users/csosto-pk/received_events","type":"User","site_admin":false},"created_at":"2019-09-05T14:33:57Z","updated_at":"2019-09-05T14:33:57Z","author_association":"NONE","body":"> I'm using the OQS-OpenSSL_1_1_1-stable branch. Could it be that another configured openssl library is on my docker image? All the path point to the pqc enabled openssl fork though.\r\n\r\n@RicardoGaGu  , we dealt with this issue when building the latest nginx with OQS-OpenSSL_1_1_1-stable as well. The reason is the one @dstebila mentions. OpenSSL 1.1.1 changed the EVP_MD_CTX calls and nginx uses the ones from OpenSSL 1.0.2. \r\n\r\nTo fix it  we had to go in src/event/ngx_event_openssl.c in the nginx source directory and rename the ```EVP_MD_CTX_create()``` and ```EVP_MD_CTX_destroy()``` calls to ```EVP_MD_CTX_new()``` and ```EVP_MD_CTX_free()```. respectively. And then build nginx again of course. "}},"public":true,"created_at":"2019-09-05T14:33:58Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"10358359409","type":"IssueCommentEvent","actor":{"id":6188943,"login":"vsoftco","display_login":"vsoftco","gravatar_id":"","url":"https://api.github.com/users/vsoftco","avatar_url":"https://avatars.githubusercontent.com/u/6188943?"},"repo":{"id":162497174,"name":"open-quantum-safe/liboqs-python","url":"https://api.github.com/repos/open-quantum-safe/liboqs-python"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-python/issues/16","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs-python","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs-python/issues/16/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs-python/issues/16/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs-python/issues/16/events","html_url":"https://github.com/open-quantum-safe/liboqs-python/issues/16","id":475138028,"node_id":"MDU6SXNzdWU0NzUxMzgwMjg=","number":16,"title":"Update is_enabled checks based on new liboqs API","user":{"login":"dstebila","id":8843219,"node_id":"MDQ6VXNlcjg4NDMyMTk=","avatar_url":"https://avatars0.githubusercontent.com/u/8843219?v=4","gravatar_id":"","url":"https://api.github.com/users/dstebila","html_url":"https://github.com/dstebila","followers_url":"https://api.github.com/users/dstebila/followers","following_url":"https://api.github.com/users/dstebila/following{/other_user}","gists_url":"https://api.github.com/users/dstebila/gists{/gist_id}","starred_url":"https://api.github.com/users/dstebila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dstebila/subscriptions","organizations_url":"https://api.github.com/users/dstebila/orgs","repos_url":"https://api.github.com/users/dstebila/repos","events_url":"https://api.github.com/users/dstebila/events{/privacy}","received_events_url":"https://api.github.com/users/dstebila/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2019-07-31T13:14:53Z","updated_at":"2019-09-05T22:56:13Z","closed_at":"2019-09-05T22:54:48Z","author_association":"MEMBER","body":"See open-quantum-safe/liboqs#530"},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs-python/issues/comments/528623526","html_url":"https://github.com/open-quantum-safe/liboqs-python/issues/16#issuecomment-528623526","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs-python/issues/16","id":528623526,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODYyMzUyNg==","user":{"login":"vsoftco","id":6188943,"node_id":"MDQ6VXNlcjYxODg5NDM=","avatar_url":"https://avatars2.githubusercontent.com/u/6188943?v=4","gravatar_id":"","url":"https://api.github.com/users/vsoftco","html_url":"https://github.com/vsoftco","followers_url":"https://api.github.com/users/vsoftco/followers","following_url":"https://api.github.com/users/vsoftco/following{/other_user}","gists_url":"https://api.github.com/users/vsoftco/gists{/gist_id}","starred_url":"https://api.github.com/users/vsoftco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vsoftco/subscriptions","organizations_url":"https://api.github.com/users/vsoftco/orgs","repos_url":"https://api.github.com/users/vsoftco/repos","events_url":"https://api.github.com/users/vsoftco/events{/privacy}","received_events_url":"https://api.github.com/users/vsoftco/received_events","type":"User","site_admin":false},"created_at":"2019-09-05T22:56:13Z","updated_at":"2019-09-05T22:56:13Z","author_association":"MEMBER","body":"Done, as of the latest commit"}},"public":true,"created_at":"2019-09-05T22:56:13Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
