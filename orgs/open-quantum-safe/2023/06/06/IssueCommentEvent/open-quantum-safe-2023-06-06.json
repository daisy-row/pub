{"id":"29551561870","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/174","id":1736360515,"node_id":"I_kwDOE_A9l85nfsJD","number":174,"title":"Master fails oqs_tlssig test on MacOS","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":16,"created_at":"2023-06-01T13:42:41Z","updated_at":"2023-06-06T05:04:26Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nCurrent master fails `oqs_tlssig` test:\r\n```text\r\nSuccessful build for source-based OpenSSL\r\nUri's DYLD_LIBRARY_PATH=\"/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\"\r\nTest setup:\r\nLD_LIBRARY_PATH=/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\r\nOPENSSL_APP=/Users/ur20980/openssl-3/bin/openssl\r\nOPENSSL_CONF=/Users/ur20980/openssl-3/etc/openssl.cnf\r\nOPENSSL_MODULES=/Users/ur20980/openssl-3/lib/ossl-modules\r\nDYLD_LIBRARY_PATH=/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\r\nNo OQS-OpenSSL111 interop test because of absence of docker\r\nVersion information:\r\nOpenSSL 3.2.0-dev  (Library: OpenSSL 3.2.0-dev )\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n    build info: OQS Provider v.0.5.0-dev (5dc4bbf) based on liboqs v.0.8.0-rc1\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  oqsprovider\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n    build info: OQS Provider v.0.5.0-dev (5dc4bbf) based on liboqs v.0.8.0-rc1\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\nCert gen/verify, CMS sign/verify, CA tests for all enabled OQS signature algorithms commencing: \r\n\r\nTest project /Users/ur20980/src/oqs-provider/_build\r\n    Start 1: oqs_signatures\r\n1/5 Test #1: oqs_signatures ...................   Passed    4.01 sec\r\n    Start 2: oqs_kems\r\n2/5 Test #2: oqs_kems .........................   Passed    0.43 sec\r\n    Start 3: oqs_groups\r\n3/5 Test #3: oqs_groups .......................   Passed    0.56 sec\r\n    Start 4: oqs_tlssig\r\n4/5 Test #4: oqs_tlssig .......................***Failed    0.24 sec\r\n    Start 5: oqs_endecode\r\n5/5 Test #5: oqs_endecode .....................   Passed    5.16 sec\r\n\r\n80% tests passed, 1 tests failed out of 5\r\n\r\nTotal Test time (real) =  10.41 sec\r\n\r\nThe following tests FAILED:\r\n\t  4 - oqs_tlssig (Failed)\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Run and observe. ;-)\r\n\r\n**Expected behavior**\r\nAll tests passing, like:\r\n```text\r\nTest project /Users/ur20980/src/oqs-provider/_build\r\n    Start 1: oqs_signatures\r\n1/5 Test #1: oqs_signatures ...................   Passed    3.99 sec\r\n    Start 2: oqs_kems\r\n2/5 Test #2: oqs_kems .........................   Passed    0.45 sec\r\n    Start 3: oqs_groups\r\n3/5 Test #3: oqs_groups .......................   Passed    0.55 sec\r\n    Start 4: oqs_tlssig\r\n4/5 Test #4: oqs_tlssig .......................   Passed    0.15 sec\r\n    Start 5: oqs_endecode\r\n5/5 Test #5: oqs_endecode .....................   Passed    5.74 sec\r\n\r\n100% tests passed, 0 tests failed out of 5\r\n```\r\n\r\n**Logs**\r\n\r\n**Build that is failing tests** (OpenSSL-3.2.0-dev):\r\n[tests-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625820/tests-out-s.txt)\r\n[build-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625821/build-out-s.txt)\r\n\r\n[LastTest.log](https://github.com/open-quantum-safe/oqs-provider/files/11625851/LastTest.log)\r\n\r\n\r\n**Build that passes the tests** (OpenSSL-3.1.0):\r\n[tests-out.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625822/tests-out.txt)\r\n[build-out.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625823/build-out.txt)\r\n\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Platform: Apple computers, **both** Intel x86_64 and M2 Apple Silicon\r\n - OS: MacOS Ventura 13.4\r\n - OpenSSL version: 3.2.0-dev (failing)\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1577910767","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/174#issuecomment-1577910767","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174","id":1577910767,"node_id":"IC_kwDOE_A9l85eDQHv","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-06-06T05:04:25Z","updated_at":"2023-06-06T05:04:25Z","author_association":"MEMBER","body":"> I would very much prefer if there was a way to tell the script to (a) stop wiping out the certs it created when it thinks they aren't needed anymore, and (b) list the content of the tmp/ and maybe other relevant directories, so we can better guess what happened based on the files present, rather than merely on the console output.\r\n\r\nThis is exactly what should happen. There's no code deleting interop.log or tmp dir. Also, there's output missing in your \"tests-out-s.txt\" between lines 51 and 53 (exactly that showing the cert-gen & testing of all sig algs). Here's the relevant code that shows what should happen (on branch `mb-preprel`): https://github.com/open-quantum-safe/oqs-provider/blob/9c2a750d154b400ce79e500a01056e399294c65c/scripts/runtests.sh#L159-L176\r\n\r\nSo can you please provide the output of `git status && git diff` (and/or verify that those lines are present unchanged in your copy of \"script/runtests.sh\")? Please also feel free to add the instruction \"$OPENSSL_APP list -signature-algorithms\" right above the line \"# Run interop-tests:\": I have the gut feeling it will return no output in your setup. I do not understand, though, how it can proceed to execute the remaining tests as the (then unset) variable `certsgenerated` should prohibit this.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1577910767/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-06-06T05:04:26Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"29560389957","type":"IssueCommentEvent","actor":{"id":5923577,"login":"mouse07410","display_login":"mouse07410","gravatar_id":"","url":"https://api.github.com/users/mouse07410","avatar_url":"https://avatars.githubusercontent.com/u/5923577?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/174","id":1736360515,"node_id":"I_kwDOE_A9l85nfsJD","number":174,"title":"Master fails oqs_tlssig test on MacOS","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":17,"created_at":"2023-06-01T13:42:41Z","updated_at":"2023-06-06T11:43:32Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nCurrent master fails `oqs_tlssig` test:\r\n```text\r\nSuccessful build for source-based OpenSSL\r\nUri's DYLD_LIBRARY_PATH=\"/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\"\r\nTest setup:\r\nLD_LIBRARY_PATH=/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\r\nOPENSSL_APP=/Users/ur20980/openssl-3/bin/openssl\r\nOPENSSL_CONF=/Users/ur20980/openssl-3/etc/openssl.cnf\r\nOPENSSL_MODULES=/Users/ur20980/openssl-3/lib/ossl-modules\r\nDYLD_LIBRARY_PATH=/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\r\nNo OQS-OpenSSL111 interop test because of absence of docker\r\nVersion information:\r\nOpenSSL 3.2.0-dev  (Library: OpenSSL 3.2.0-dev )\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n    build info: OQS Provider v.0.5.0-dev (5dc4bbf) based on liboqs v.0.8.0-rc1\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  oqsprovider\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n    build info: OQS Provider v.0.5.0-dev (5dc4bbf) based on liboqs v.0.8.0-rc1\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\nCert gen/verify, CMS sign/verify, CA tests for all enabled OQS signature algorithms commencing: \r\n\r\nTest project /Users/ur20980/src/oqs-provider/_build\r\n    Start 1: oqs_signatures\r\n1/5 Test #1: oqs_signatures ...................   Passed    4.01 sec\r\n    Start 2: oqs_kems\r\n2/5 Test #2: oqs_kems .........................   Passed    0.43 sec\r\n    Start 3: oqs_groups\r\n3/5 Test #3: oqs_groups .......................   Passed    0.56 sec\r\n    Start 4: oqs_tlssig\r\n4/5 Test #4: oqs_tlssig .......................***Failed    0.24 sec\r\n    Start 5: oqs_endecode\r\n5/5 Test #5: oqs_endecode .....................   Passed    5.16 sec\r\n\r\n80% tests passed, 1 tests failed out of 5\r\n\r\nTotal Test time (real) =  10.41 sec\r\n\r\nThe following tests FAILED:\r\n\t  4 - oqs_tlssig (Failed)\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Run and observe. ;-)\r\n\r\n**Expected behavior**\r\nAll tests passing, like:\r\n```text\r\nTest project /Users/ur20980/src/oqs-provider/_build\r\n    Start 1: oqs_signatures\r\n1/5 Test #1: oqs_signatures ...................   Passed    3.99 sec\r\n    Start 2: oqs_kems\r\n2/5 Test #2: oqs_kems .........................   Passed    0.45 sec\r\n    Start 3: oqs_groups\r\n3/5 Test #3: oqs_groups .......................   Passed    0.55 sec\r\n    Start 4: oqs_tlssig\r\n4/5 Test #4: oqs_tlssig .......................   Passed    0.15 sec\r\n    Start 5: oqs_endecode\r\n5/5 Test #5: oqs_endecode .....................   Passed    5.74 sec\r\n\r\n100% tests passed, 0 tests failed out of 5\r\n```\r\n\r\n**Logs**\r\n\r\n**Build that is failing tests** (OpenSSL-3.2.0-dev):\r\n[tests-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625820/tests-out-s.txt)\r\n[build-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625821/build-out-s.txt)\r\n\r\n[LastTest.log](https://github.com/open-quantum-safe/oqs-provider/files/11625851/LastTest.log)\r\n\r\n\r\n**Build that passes the tests** (OpenSSL-3.1.0):\r\n[tests-out.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625822/tests-out.txt)\r\n[build-out.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625823/build-out.txt)\r\n\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Platform: Apple computers, **both** Intel x86_64 and M2 Apple Silicon\r\n - OS: MacOS Ventura 13.4\r\n - OpenSSL version: 3.2.0-dev (failing)\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1578579337","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/174#issuecomment-1578579337","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174","id":1578579337,"node_id":"IC_kwDOE_A9l85eFzWJ","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"created_at":"2023-06-06T11:43:32Z","updated_at":"2023-06-06T11:43:32Z","author_association":"NONE","body":"```sh\r\n$ git status\r\nOn branch main\r\nYour branch is up to date with 'origin/main'.\r\n\r\nUntracked files:\r\n  (use \"git add <file>...\" to include in what will be committed)\r\n\tbuild-out-s.txt\r\n\tbuild-out.txt\r\n\ttests-out-s.txt\r\n\ttests-out.txt\r\n\r\nnothing added to commit but untracked files present (use \"git add\" to track)\r\n$ git diff\r\n$ pwd\r\n/Users/ur20980/src/oqs-provider\r\n$ git remote -v\r\norigin\thttps://github.com/open-quantum-safe/oqs-provider.git (fetch)\r\norigin\thttps://github.com/open-quantum-safe/oqs-provider.git (push)\r\n$ \r\n```","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1578579337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-06-06T11:43:32Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"29562028711","type":"IssueCommentEvent","actor":{"id":5923577,"login":"mouse07410","display_login":"mouse07410","gravatar_id":"","url":"https://api.github.com/users/mouse07410","avatar_url":"https://avatars.githubusercontent.com/u/5923577?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/174","id":1736360515,"node_id":"I_kwDOE_A9l85nfsJD","number":174,"title":"Master fails oqs_tlssig test on MacOS","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":18,"created_at":"2023-06-01T13:42:41Z","updated_at":"2023-06-06T12:46:45Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nCurrent master fails `oqs_tlssig` test:\r\n```text\r\nSuccessful build for source-based OpenSSL\r\nUri's DYLD_LIBRARY_PATH=\"/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\"\r\nTest setup:\r\nLD_LIBRARY_PATH=/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\r\nOPENSSL_APP=/Users/ur20980/openssl-3/bin/openssl\r\nOPENSSL_CONF=/Users/ur20980/openssl-3/etc/openssl.cnf\r\nOPENSSL_MODULES=/Users/ur20980/openssl-3/lib/ossl-modules\r\nDYLD_LIBRARY_PATH=/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\r\nNo OQS-OpenSSL111 interop test because of absence of docker\r\nVersion information:\r\nOpenSSL 3.2.0-dev  (Library: OpenSSL 3.2.0-dev )\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n    build info: OQS Provider v.0.5.0-dev (5dc4bbf) based on liboqs v.0.8.0-rc1\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  oqsprovider\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n    build info: OQS Provider v.0.5.0-dev (5dc4bbf) based on liboqs v.0.8.0-rc1\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\nCert gen/verify, CMS sign/verify, CA tests for all enabled OQS signature algorithms commencing: \r\n\r\nTest project /Users/ur20980/src/oqs-provider/_build\r\n    Start 1: oqs_signatures\r\n1/5 Test #1: oqs_signatures ...................   Passed    4.01 sec\r\n    Start 2: oqs_kems\r\n2/5 Test #2: oqs_kems .........................   Passed    0.43 sec\r\n    Start 3: oqs_groups\r\n3/5 Test #3: oqs_groups .......................   Passed    0.56 sec\r\n    Start 4: oqs_tlssig\r\n4/5 Test #4: oqs_tlssig .......................***Failed    0.24 sec\r\n    Start 5: oqs_endecode\r\n5/5 Test #5: oqs_endecode .....................   Passed    5.16 sec\r\n\r\n80% tests passed, 1 tests failed out of 5\r\n\r\nTotal Test time (real) =  10.41 sec\r\n\r\nThe following tests FAILED:\r\n\t  4 - oqs_tlssig (Failed)\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Run and observe. ;-)\r\n\r\n**Expected behavior**\r\nAll tests passing, like:\r\n```text\r\nTest project /Users/ur20980/src/oqs-provider/_build\r\n    Start 1: oqs_signatures\r\n1/5 Test #1: oqs_signatures ...................   Passed    3.99 sec\r\n    Start 2: oqs_kems\r\n2/5 Test #2: oqs_kems .........................   Passed    0.45 sec\r\n    Start 3: oqs_groups\r\n3/5 Test #3: oqs_groups .......................   Passed    0.55 sec\r\n    Start 4: oqs_tlssig\r\n4/5 Test #4: oqs_tlssig .......................   Passed    0.15 sec\r\n    Start 5: oqs_endecode\r\n5/5 Test #5: oqs_endecode .....................   Passed    5.74 sec\r\n\r\n100% tests passed, 0 tests failed out of 5\r\n```\r\n\r\n**Logs**\r\n\r\n**Build that is failing tests** (OpenSSL-3.2.0-dev):\r\n[tests-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625820/tests-out-s.txt)\r\n[build-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625821/build-out-s.txt)\r\n\r\n[LastTest.log](https://github.com/open-quantum-safe/oqs-provider/files/11625851/LastTest.log)\r\n\r\n\r\n**Build that passes the tests** (OpenSSL-3.1.0):\r\n[tests-out.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625822/tests-out.txt)\r\n[build-out.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625823/build-out.txt)\r\n\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Platform: Apple computers, **both** Intel x86_64 and M2 Apple Silicon\r\n - OS: MacOS Ventura 13.4\r\n - OpenSSL version: 3.2.0-dev (failing)\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1578703483","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/174#issuecomment-1578703483","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174","id":1578703483,"node_id":"IC_kwDOE_A9l85eGRp7","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"created_at":"2023-06-06T12:46:45Z","updated_at":"2023-06-06T12:46:45Z","author_association":"NONE","body":"OK. more work - more info.\r\n\r\nFirst, I polished your `runtests.sh` script a bit, to make sure it does the right things:\r\n```diff\r\ndiff --git a/scripts/runtests.sh b/scripts/runtests.sh\r\nindex b9975e4..dfc06b7 100755\r\n--- a/scripts/runtests.sh\r\n+++ b/scripts/runtests.sh\r\n@@ -113,7 +113,7 @@ echo \"OPENSSL_APP=$OPENSSL_APP\"\r\n echo \"OPENSSL_CONF=$OPENSSL_CONF\"\r\n echo \"OPENSSL_MODULES=$OPENSSL_MODULES\"\r\n if [[ \"$OSTYPE\" == \"darwin\"* ]]; then\r\n-echo \"DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH\"\r\n+   echo \"DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH\"\r\n fi\r\n \r\n # check if we can use docker or not:\r\n@@ -130,21 +130,23 @@ fi\r\n export LOCALTESTONLY=\"Yes\"\r\n \r\n echo \"Version information:\"\r\n-$OPENSSL_APP version\r\n+${OPENSSL_APP} version\r\n \r\n # Disable testing for version 3.0.1: Buggy as hell:\r\n-$OPENSSL_APP version | grep \"OpenSSL 3.0.1\" > /dev/null\r\n+${OPENSSL_APP} version | grep \"OpenSSL 3.0.1\" > /dev/null\r\n if [ $? -eq 0 ]; then\r\n    echo \"Skipping testing of buggy OpenSSL 3.0.1\"\r\n    exit 0\r\n fi\r\n \r\n-$OPENSSL_APP list -providers -verbose -provider-path _build/lib -provider oqsprovider\r\n+${OPENSSL_APP} list -providers -verbose -provider-path _build/lib -provider oqsprovider\r\n if [ $? -ne 0 ]; then\r\n    echo \"Baseline openssl invocation failed. Exiting test.\"\r\n    exit 1\r\n fi\r\n \r\n+${OPENSSL_APP} list -signature-algorithms | tee \"${PWD}/sig-algs.txt\"\r\n+\r\n # Run interop-tests:\r\n echo \"Cert gen/verify, CMS sign/verify, CA tests for all enabled OQS signature algorithms commencing: \"\r\n for alg in `$OPENSSL_APP list -signature-algorithms | grep oqsprovider | sed -e \"s/ @ oqsprovider//g\" | sed -e \"s/^  //g\"`\r\n```\r\n\r\nHere are the logs:\r\n[tests-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11664759/tests-out-s.txt)\r\n[sig-algs.txt](https://github.com/open-quantum-safe/oqs-provider/files/11664760/sig-algs.txt)\r\n[build-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11664761/build-out-s.txt)\r\n\r\nNow, if you see at the line 241 and following of `tests-out-s.txt`, you'll see that it did **not** (for whatever reason) pick _your_ `oqs.cnf`, but used the system-wide `openssl.cnf` from the `$OPENSSL_ROOT_DIR`. And that config, naturally, has no `oqsprovider`, only `oqs` provider.\r\n\r\nSo, the problem seems to be - `OPENSSL_CONF` is messed up for that test. \r\n\r\nAlso, note that other tests/scripts that apparently exercise OQS signatures, seem to work just fine.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1578703483/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-06-06T12:46:45Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"29566526800","type":"IssueCommentEvent","actor":{"id":5923577,"login":"mouse07410","display_login":"mouse07410","gravatar_id":"","url":"https://api.github.com/users/mouse07410","avatar_url":"https://avatars.githubusercontent.com/u/5923577?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/174","id":1736360515,"node_id":"I_kwDOE_A9l85nfsJD","number":174,"title":"Master fails oqs_tlssig test on MacOS","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":19,"created_at":"2023-06-01T13:42:41Z","updated_at":"2023-06-06T15:14:19Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nCurrent master fails `oqs_tlssig` test:\r\n```text\r\nSuccessful build for source-based OpenSSL\r\nUri's DYLD_LIBRARY_PATH=\"/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\"\r\nTest setup:\r\nLD_LIBRARY_PATH=/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\r\nOPENSSL_APP=/Users/ur20980/openssl-3/bin/openssl\r\nOPENSSL_CONF=/Users/ur20980/openssl-3/etc/openssl.cnf\r\nOPENSSL_MODULES=/Users/ur20980/openssl-3/lib/ossl-modules\r\nDYLD_LIBRARY_PATH=/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\r\nNo OQS-OpenSSL111 interop test because of absence of docker\r\nVersion information:\r\nOpenSSL 3.2.0-dev  (Library: OpenSSL 3.2.0-dev )\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n    build info: OQS Provider v.0.5.0-dev (5dc4bbf) based on liboqs v.0.8.0-rc1\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  oqsprovider\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n    build info: OQS Provider v.0.5.0-dev (5dc4bbf) based on liboqs v.0.8.0-rc1\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\nCert gen/verify, CMS sign/verify, CA tests for all enabled OQS signature algorithms commencing: \r\n\r\nTest project /Users/ur20980/src/oqs-provider/_build\r\n    Start 1: oqs_signatures\r\n1/5 Test #1: oqs_signatures ...................   Passed    4.01 sec\r\n    Start 2: oqs_kems\r\n2/5 Test #2: oqs_kems .........................   Passed    0.43 sec\r\n    Start 3: oqs_groups\r\n3/5 Test #3: oqs_groups .......................   Passed    0.56 sec\r\n    Start 4: oqs_tlssig\r\n4/5 Test #4: oqs_tlssig .......................***Failed    0.24 sec\r\n    Start 5: oqs_endecode\r\n5/5 Test #5: oqs_endecode .....................   Passed    5.16 sec\r\n\r\n80% tests passed, 1 tests failed out of 5\r\n\r\nTotal Test time (real) =  10.41 sec\r\n\r\nThe following tests FAILED:\r\n\t  4 - oqs_tlssig (Failed)\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Run and observe. ;-)\r\n\r\n**Expected behavior**\r\nAll tests passing, like:\r\n```text\r\nTest project /Users/ur20980/src/oqs-provider/_build\r\n    Start 1: oqs_signatures\r\n1/5 Test #1: oqs_signatures ...................   Passed    3.99 sec\r\n    Start 2: oqs_kems\r\n2/5 Test #2: oqs_kems .........................   Passed    0.45 sec\r\n    Start 3: oqs_groups\r\n3/5 Test #3: oqs_groups .......................   Passed    0.55 sec\r\n    Start 4: oqs_tlssig\r\n4/5 Test #4: oqs_tlssig .......................   Passed    0.15 sec\r\n    Start 5: oqs_endecode\r\n5/5 Test #5: oqs_endecode .....................   Passed    5.74 sec\r\n\r\n100% tests passed, 0 tests failed out of 5\r\n```\r\n\r\n**Logs**\r\n\r\n**Build that is failing tests** (OpenSSL-3.2.0-dev):\r\n[tests-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625820/tests-out-s.txt)\r\n[build-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625821/build-out-s.txt)\r\n\r\n[LastTest.log](https://github.com/open-quantum-safe/oqs-provider/files/11625851/LastTest.log)\r\n\r\n\r\n**Build that passes the tests** (OpenSSL-3.1.0):\r\n[tests-out.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625822/tests-out.txt)\r\n[build-out.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625823/build-out.txt)\r\n\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Platform: Apple computers, **both** Intel x86_64 and M2 Apple Silicon\r\n - OS: MacOS Ventura 13.4\r\n - OpenSSL version: 3.2.0-dev (failing)\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1578957961","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/174#issuecomment-1578957961","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174","id":1578957961,"node_id":"IC_kwDOE_A9l85eHPyJ","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"created_at":"2023-06-06T15:14:19Z","updated_at":"2023-06-06T15:14:19Z","author_association":"NONE","body":"I don't understand. \r\n\r\nWhen I run the following script, all the tests pass:\r\n```bash\r\n#!/bin/bash\r\n\r\n# Cleaning up previous builds\r\nmake clean\r\n#rm -rf tmp/*\r\nrm -f interop.log #interop-3.log\r\n\r\n# Set env var - flags\r\nOQSPROV=1\r\nOQSKM=1\r\nOQSKEY=1\r\n\r\nunset OPENSSL_INSTALL\r\n\r\nset DYLD=\"${DYLD_LIBRARY_PATH}\"\r\n\r\n# Build for local sources of master branch of OpenSSL-3.2+\r\nif [ -d $HOME/openssl-3 ]; then\r\n\trm -rf _build\r\n\r\n\texport DYLD_LIBRARY_PATH=\"${HOME}/openssl-3/lib:/usr/local/lib:/opt/local/lib:${DYLD}\"\r\n\texport LD_LIBRARY_PATH=\"${DYLD_LIBRARY_PATH}\"\r\n\r\n\tOPENSSL_ROOT_DIR=\"$HOME/openssl-3\"\r\n\tOPENSSL_DIR=\"$OPENSSL_ROOT_DIR\"\r\n\tOPENSSL_INSTALL=\"$OPENSSL_DIR\"\r\n\tOPENSSL_APP=\"$OPENSSL_ROOT_DIR/bin/openssl\"\r\n\tOPENSSL=\"$OPENSSL_APP\"\r\n\tOPENSSL_LIB_DIR=\"$OPENSSL_ROOT_DIR/lib\"\r\n\tOPENSSL_INCLUDE_DIR=\"$OPENSSL_ROOT_DIR/include\"\r\n\r\n\t#OPENSSL_MODULES=\"$OPENSSL_ROOT_DIR/lib/ossl-modules\"\r\n\tOPENSSL_MODULES=\"${PWD}/_build/lib\"\r\n        #unset OPENSSL_MODULES\r\n\r\n\t#OPENSSL_CONF=\"$OPENSSL_ROOT_DIR/etc/openssl.cnf\"\r\n\tOPENSSL_CONF=\"${PWD}/tests/oqs.cnf\"\r\n        #unset OPENSSL_CONF\r\n\r\n\techo \"Building for source-based OpenSSL-3.2.x-dev...\"\r\n\tenv | grep OPENSSL > build-out-s.txt\r\n\techo \"\" >> build-out-s.txt\r\n\tcmake -DCMAKE_BUILD_TYPE=Debug -DUSE_ENCODING_LIB=OFF -DOPENSSL_ROOT_DIR=\"$HOME/src/openssl\" -DCMAKE_C_FLAGS=\"$CFLAGS -g -I${OPENSSL_INCLUDE_DIR} -L${OPENSSL_LIB_DIR} \" -DCMAKE_VERBOSE_MAKEFILE:BOOL=True -S . -B _build 2>&1 | tee -a build-out-s.txt\r\n\tcmake --build _build 2>&1 | tee -a build-out-s.txt\r\n\tif [ -x _build/lib/oqsprovider.dylib ]; then\r\n\t\techo \"Successful build for source-based OpenSSL\"\r\n\t\techo \"Uri's DYLD_LIBRARY_PATH=\\\"${DYLD_LIBRARY_PATH}\\\"\"\r\n\t\tscripts/runtests.sh -V 2>&1 | tee tests-out-s.txt\r\n\t\t#cp _build/lib/oqsprovider.0.5.0-dev.dylib \"$OPENSSL_MODULES\"\r\n\telse\r\n\t\techo \"Apparently, building for source-based OpenSSL-3.2.x-dev failed\"\r\n\t\techo \"\"\r\n\tfi\r\n        mv \"interop.log\" \"interop-3.log\"\r\nelse\r\n\techo \"\"\r\n\techo \"Sources of OpenSSL-3.2.x-dev not found, skipping...\"\r\n\techo \"\"\r\nfi\r\n\r\nexit\r\n```\r\n[build-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11666065/build-out-s.txt)\r\n[tests-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11666066/tests-out-s.txt)\r\n[sig-algs.txt](https://github.com/open-quantum-safe/oqs-provider/files/11666067/sig-algs.txt)\r\n\r\nHowever, you can see that `sig-algs.txt` shows no OQS algorithms at all!\r\n\r\nBut when I try to check for them manually:\r\n```sh\r\n$ pwd\r\n/Users/ur20980/src/oqs-provider\r\n$ OPENSSL_MODULES=_build/lib OPENSSL_CONF=test/oqs.cnf openssl list -signature-algorithms | grep oqs | sed -e \"s/ @ oqs.*//g\"\r\n  p384_dilithium3\r\n  p521_dilithium5\r\n  falcon512\r\n  p256_falcon512\r\n  rsa3072_falcon512\r\n  falcon1024\r\n  p521_falcon1024\r\n  sphincssha2128fsimple\r\n  p256_sphincssha2128fsimple\r\n  rsa3072_sphincssha2128fsimple\r\n  sphincssha2128ssimple\r\n  p256_sphincssha2128ssimple\r\n  rsa3072_sphincssha2128ssimple\r\n  sphincssha2192fsimple\r\n  p384_sphincssha2192fsimple\r\n  sphincsshake128fsimple\r\n  p256_sphincsshake128fsimple\r\n  rsa3072_sphincsshake128fsimple\r\n  dilithium2\r\n  p256_dilithium2\r\n  rsa3072_dilithium2\r\n  dilithium3\r\n  dilithium5\r\n$ \r\n```\r\n\r\n-------------------------\r\nHere's my modified version of `runtests.sh`:\r\n```diff\r\ndiff --git a/scripts/runtests.sh b/scripts/runtests.sh\r\nindex b9975e4..525f0bc 100755\r\n--- a/scripts/runtests.sh\r\n+++ b/scripts/runtests.sh\r\n@@ -113,7 +113,7 @@ echo \"OPENSSL_APP=$OPENSSL_APP\"\r\n echo \"OPENSSL_CONF=$OPENSSL_CONF\"\r\n echo \"OPENSSL_MODULES=$OPENSSL_MODULES\"\r\n if [[ \"$OSTYPE\" == \"darwin\"* ]]; then\r\n-echo \"DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH\"\r\n+   echo \"DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH\"\r\n fi\r\n \r\n # check if we can use docker or not:\r\n@@ -130,24 +130,29 @@ fi\r\n export LOCALTESTONLY=\"Yes\"\r\n \r\n echo \"Version information:\"\r\n-$OPENSSL_APP version\r\n+${OPENSSL_APP} version\r\n \r\n # Disable testing for version 3.0.1: Buggy as hell:\r\n-$OPENSSL_APP version | grep \"OpenSSL 3.0.1\" > /dev/null\r\n+${OPENSSL_APP} version | grep \"OpenSSL 3.0.1\" > /dev/null\r\n if [ $? -eq 0 ]; then\r\n    echo \"Skipping testing of buggy OpenSSL 3.0.1\"\r\n    exit 0\r\n fi\r\n \r\n-$OPENSSL_APP list -providers -verbose -provider-path _build/lib -provider oqsprovider\r\n+${OPENSSL_APP} list -providers -verbose -provider-path _build/lib -provider oqsprovider\r\n if [ $? -ne 0 ]; then\r\n    echo \"Baseline openssl invocation failed. Exiting test.\"\r\n    exit 1\r\n fi\r\n \r\n+echo \"\"\r\n+echo \"Known signature algorithms:\"\r\n+${OPENSSL_APP} list -signature-algorithms | tee \"${PWD}/sig-algs.txt\"\r\n+echo \"\"\r\n+\r\n # Run interop-tests:\r\n echo \"Cert gen/verify, CMS sign/verify, CA tests for all enabled OQS signature algorithms commencing: \"\r\n-for alg in `$OPENSSL_APP list -signature-algorithms | grep oqsprovider | sed -e \"s/ @ oqsprovider//g\" | sed -e \"s/^  //g\"`\r\n+for alg in `$OPENSSL_APP list -signature-algorithms | grep oqs | sed -e \"s/ @ oqs.*//g\" | sed -e \"s/^  //g\"`\r\n do \r\n    if [ \"$1\" = \"-V\" ]; then\r\n       echo \"Testing $alg\"\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1578957961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-06-06T15:14:20Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"29567406795","type":"IssueCommentEvent","actor":{"id":5923577,"login":"mouse07410","display_login":"mouse07410","gravatar_id":"","url":"https://api.github.com/users/mouse07410","avatar_url":"https://avatars.githubusercontent.com/u/5923577?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/174","id":1736360515,"node_id":"I_kwDOE_A9l85nfsJD","number":174,"title":"Master fails oqs_tlssig test on MacOS","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":20,"created_at":"2023-06-01T13:42:41Z","updated_at":"2023-06-06T15:46:00Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nCurrent master fails `oqs_tlssig` test:\r\n```text\r\nSuccessful build for source-based OpenSSL\r\nUri's DYLD_LIBRARY_PATH=\"/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\"\r\nTest setup:\r\nLD_LIBRARY_PATH=/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\r\nOPENSSL_APP=/Users/ur20980/openssl-3/bin/openssl\r\nOPENSSL_CONF=/Users/ur20980/openssl-3/etc/openssl.cnf\r\nOPENSSL_MODULES=/Users/ur20980/openssl-3/lib/ossl-modules\r\nDYLD_LIBRARY_PATH=/Users/ur20980/openssl-3/lib:/usr/local/lib:/opt/local/lib:\r\nNo OQS-OpenSSL111 interop test because of absence of docker\r\nVersion information:\r\nOpenSSL 3.2.0-dev  (Library: OpenSSL 3.2.0-dev )\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n    build info: OQS Provider v.0.5.0-dev (5dc4bbf) based on liboqs v.0.8.0-rc1\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  oqsprovider\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n    build info: OQS Provider v.0.5.0-dev (5dc4bbf) based on liboqs v.0.8.0-rc1\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.2.0\r\n    status: active\r\n    build info: 3.2.0-dev\r\n    gettable provider parameters:\r\n      name: pointer to a UTF8 encoded string (arbitrary size)\r\n      version: pointer to a UTF8 encoded string (arbitrary size)\r\n      buildinfo: pointer to a UTF8 encoded string (arbitrary size)\r\n      status: integer (arbitrary size)\r\nCert gen/verify, CMS sign/verify, CA tests for all enabled OQS signature algorithms commencing: \r\n\r\nTest project /Users/ur20980/src/oqs-provider/_build\r\n    Start 1: oqs_signatures\r\n1/5 Test #1: oqs_signatures ...................   Passed    4.01 sec\r\n    Start 2: oqs_kems\r\n2/5 Test #2: oqs_kems .........................   Passed    0.43 sec\r\n    Start 3: oqs_groups\r\n3/5 Test #3: oqs_groups .......................   Passed    0.56 sec\r\n    Start 4: oqs_tlssig\r\n4/5 Test #4: oqs_tlssig .......................***Failed    0.24 sec\r\n    Start 5: oqs_endecode\r\n5/5 Test #5: oqs_endecode .....................   Passed    5.16 sec\r\n\r\n80% tests passed, 1 tests failed out of 5\r\n\r\nTotal Test time (real) =  10.41 sec\r\n\r\nThe following tests FAILED:\r\n\t  4 - oqs_tlssig (Failed)\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Run and observe. ;-)\r\n\r\n**Expected behavior**\r\nAll tests passing, like:\r\n```text\r\nTest project /Users/ur20980/src/oqs-provider/_build\r\n    Start 1: oqs_signatures\r\n1/5 Test #1: oqs_signatures ...................   Passed    3.99 sec\r\n    Start 2: oqs_kems\r\n2/5 Test #2: oqs_kems .........................   Passed    0.45 sec\r\n    Start 3: oqs_groups\r\n3/5 Test #3: oqs_groups .......................   Passed    0.55 sec\r\n    Start 4: oqs_tlssig\r\n4/5 Test #4: oqs_tlssig .......................   Passed    0.15 sec\r\n    Start 5: oqs_endecode\r\n5/5 Test #5: oqs_endecode .....................   Passed    5.74 sec\r\n\r\n100% tests passed, 0 tests failed out of 5\r\n```\r\n\r\n**Logs**\r\n\r\n**Build that is failing tests** (OpenSSL-3.2.0-dev):\r\n[tests-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625820/tests-out-s.txt)\r\n[build-out-s.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625821/build-out-s.txt)\r\n\r\n[LastTest.log](https://github.com/open-quantum-safe/oqs-provider/files/11625851/LastTest.log)\r\n\r\n\r\n**Build that passes the tests** (OpenSSL-3.1.0):\r\n[tests-out.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625822/tests-out.txt)\r\n[build-out.txt](https://github.com/open-quantum-safe/oqs-provider/files/11625823/build-out.txt)\r\n\r\n\r\n\r\n**Environment (please complete the following information):**\r\n - Platform: Apple computers, **both** Intel x86_64 and M2 Apple Silicon\r\n - OS: MacOS Ventura 13.4\r\n - OpenSSL version: 3.2.0-dev (failing)\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1579016854","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/174#issuecomment-1579016854","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/174","id":1579016854,"node_id":"IC_kwDOE_A9l85eHeKW","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"created_at":"2023-06-06T15:46:00Z","updated_at":"2023-06-06T15:46:00Z","author_association":"NONE","body":"Apparently,  `${OPENSSL_APP}  list -signature-algorithms` fails to list any from the `oqsprovider`. \r\n\r\nHowever, when explicitly specified like `${OPENSSL_APP}  list -signature-algorithms -provider-path _build/lib -provider oqsprovider`, it lists all of them appropriately. ","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1579016854/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-06-06T15:46:00Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
