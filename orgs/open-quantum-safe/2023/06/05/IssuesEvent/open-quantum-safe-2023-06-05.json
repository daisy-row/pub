{"id":"29543330069","type":"IssuesEvent","actor":{"id":5923577,"login":"mouse07410","display_login":"mouse07410","gravatar_id":"","url":"https://api.github.com/users/mouse07410","avatar_url":"https://avatars.githubusercontent.com/u/5923577?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"closed","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/171","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/171/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/171/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/171/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/171","id":1724303930,"node_id":"I_kwDOE_A9l85mxso6","number":171,"title":"MacOS: fails to find liboqs","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":21,"created_at":"2023-05-24T15:51:30Z","updated_at":"2023-06-05T19:16:55Z","closed_at":"2023-06-05T19:16:55Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nTests should - but do not - look in `/opt/local/lib` for libraries like `liboqs.dylib`.\r\n\r\n```text\r\nLD_LIBRARY_PATH=/Users/ur20980/src/oqs-provider/.local/lib64\r\nOPENSSL_APP=/opt/local/libexec/openssl3/bin/openssl\r\nOPENSSL_CONF=/opt/local/libexec/openssl3/etc/openssl/openssl.cnf\r\nOPENSSL_MODULES=/opt/local/libexec/openssl3/lib/ossl-modules\r\nVersion information:\r\nOpenSSL 3.1.0 14 Mar 2023 (Library: OpenSSL 3.1.0 14 Mar 2023)\r\nlist: unable to load provider oqsprovider\r\nHint: use -provider-path option or OPENSSL_MODULES environment variable.\r\n40664950F87F0000:error:12800067:DSO support routines:dlfcn_load:could not load the shared library:crypto/dso/dso_dlfcn.c:118:filename(_build/lib/oqsprovider.dylib): dlopen(_build/lib/oqsprovider.dylib, 0x0002): Library not loaded: @rpath/liboqs.3.dylib\r\n  Referenced from: <DE45930A-2ABF-3032-BFF3-19F96D0064A6> /Users/ur20980/src/oqs-provider/_build/lib/oqsprovider.0.5.0-dev.dylib\r\n  Reason: tried: '/usr/local/lib/liboqs.3.dylib' (no such file), '/usr/lib/liboqs.3.dylib' (no such file, not in dyld cache)\r\n40664950F87F0000:error:12800067:DSO support routines:DSO_load:could not load the shared library:crypto/dso/dso_lib.c:152:\r\n40664950F87F0000:error:07880025:common libcrypto routines:provider_init:reason(524325):crypto/provider_core.c:904:name=oqsprovider\r\nBaseline openssl invocation failed. Exiting test.\r\n```\r\n\r\n`LD_LIBRARY_PATH` is not an answer, because (a) MacOS uses `DYLD_LIBRARY_PATH` and ignores `LD_LIBRARY_PATH`, and (b) setting that env var would limit where the loader searches for missing libraries, i.e., we'd risk that it would now find what's in `$DYLD_LIBRARY_PATH` but stops finding what's not there.\r\n\r\n**To Reproduce**\r\nSee above.\r\n\r\n**Expected behavior**\r\nTests passing, with all the relevant libraries located correctly.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS Ventura 13.4\r\n - OpenSSL version: 3.2.0-dev and 3.1.0\r\n\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/171/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/171/timeline","performed_via_github_app":null,"state_reason":"completed"}},"public":true,"created_at":"2023-06-05T19:16:56Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
