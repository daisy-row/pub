{"id":"28153538070","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132","id":1642717023,"node_id":"I_kwDOE_A9l85h6d9f","number":132,"title":"Unable to run tests","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":32,"created_at":"2023-03-27T19:52:52Z","updated_at":"2023-04-03T05:01:11Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n`ctest` crashes with `SIGTRAP`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Build or get installed OpenSSL. For this test I used OpenSSL-3.1.0.\r\n2. Build and install liboqs. I used its current master.\r\n3. Clone, build, and install this provider (don't forget to edit `openssl.cnf` as appropriate).\r\n4. `mkdir -p openssl/apps; ln -s /opt/local/bin/openssl openssl/apps`\r\n5. Go to `_build` and do `ctest --output-on-failure`\r\n6. Observe the error report.\r\n\r\n**Expected behavior**\r\nTests passing.\r\n\r\n**Screenshots**\r\n<img width=\"718\" alt=\"Screenshot 2023-03-27 at 3 49 24 PM\" src=\"https://user-images.githubusercontent.com/5923577/228050759-876766f2-d3de-4c42-bf1c-1f4dab9978a2.png\">\r\n\r\n**Crash report**\r\n```\r\nTranslated Report (Full Report Below)\r\n-------------------------------------\r\n\r\nProcess:               oqs_test_kems [17508]\r\nPath:                  /Users/USER/*/oqs_test_kems\r\nIdentifier:            oqs_test_kems\r\nVersion:               ???\r\nCode Type:             ARM-64 (Native)\r\nParent Process:        ctest [17500]\r\nResponsible:           Terminal [983]\r\nUser ID:               501\r\n\r\nDate/Time:             2023-03-27 15:39:40.6519 -0400\r\nOS Version:            macOS 13.2.1 (22D68)\r\nReport Version:        12\r\nAnonymous UUID:        161C054B-E964-CDD3-5EBC-5A9DBE3E2AE2\r\n\r\n\r\nTime Awake Since Boot: 66000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_BREAKPOINT (SIGTRAP)\r\nException Codes:       0x0000000000000001, 0x00000001a6283108\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 5 Trace/BPT trap: 5\r\nTerminating Process:   exc handler [17508]\r\n\r\nApplication Specific Information:\r\nBUG IN CLIENT OF LIBPLATFORM: Trying to recursively lock an os_once_t\r\nAbort Cause 259\r\n\r\n\r\nThread 0 Crashed::  Dispatch queue: com.apple.main-thread\r\n0   libsystem_platform.dylib      \t       0x1a6283108 _os_once_gate_recursive_abort + 36\r\n1   libsystem_platform.dylib      \t       0x1a627f710 _os_once_gate_wait + 348\r\n2   libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n3   libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n4   libcrypto.3.dylib             \t       0x1012d0ea4 ossl_obj_add_object + 236\r\n5   gostprov.dylib                \t       0x1015bf5b4 populate_gost_engine + 116\r\n6   gostprov.dylib                \t       0x1015bd478 OSSL_provider_init + 116\r\n7   libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n8   libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n9   libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n10  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n11  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n12  libcrypto.3.dylib             \t       0x101213738 ossl_config_int + 68\r\n13  libcrypto.3.dylib             \t       0x1012b2400 ossl_init_config_ossl_ + 16\r\n14  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n15  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n16  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n17  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n18  libcrypto.3.dylib             \t       0x1012b2208 OPENSSL_init_crypto + 1104\r\n19  libcrypto.3.dylib             \t       0x1012d1098 obj_lock_initialise_ossl_ + 20\r\n20  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n21  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n22  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n23  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n24  libcrypto.3.dylib             \t       0x1012d0408 OBJ_sn2nid + 112\r\n25  libcrypto.3.dylib             \t       0x1012d02f4 OBJ_txt2obj + 216\r\n26  libcrypto.3.dylib             \t       0x1012d0944 OBJ_txt2nid + 20\r\n27  libcrypto.3.dylib             \t       0x1012bd048 core_obj_create + 36\r\n28  oqsprovider.0.5.0-dev.dylib   \t       0x100f73678 OSSL_provider_init + 292\r\n29  libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n30  libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n31  libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n32  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n33  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n34  libcrypto.3.dylib             \t       0x1012af1a4 OSSL_LIB_CTX_load_config + 20\r\n35  oqs_test_kems                 \t       0x100de7420 main + 80\r\n36  dyld                          \t       0x1a5f27e50 start + 2544\r\n\r\n\r\nThread 0 crashed with ARM Thread State (64-bit):\r\n    x0: 0x0000000000000103   x1: 0x000000016f019b90   x2: 0x00000001a624dda0   x3: 0x0000000000000103\r\n    x4: 0x000000000000000a   x5: 0x0000000024200000   x6: 0x0000000000000000   x7: 0x0000000000000500\r\n    x8: 0x0000000000000103   x9: 0x0000000000000103  x10: 0x0000000000000103  x11: 0x0000600000fb8000\r\n   x12: 0x0000000000000010  x13: 0x00000000fffffcee  x14: 0x00000000000007fb  x15: 0x00000000a4188ffb\r\n   x16: 0x00000001a627d760  x17: 0x00000002066400a0  x18: 0x0000000000000000  x19: 0x0000000101438d58\r\n   x20: 0x0000000000000103  x21: 0x00000001a624dda0  x22: 0x000000016f019b90  x23: 0x0000000000000103\r\n   x24: 0x0000000000000103  x25: 0x0000000000000000  x26: 0x0000000000000002  x27: 0x0000000000000002\r\n   x28: 0x0000600000fa4000   fp: 0x000000016f019b80   lr: 0x00000001a627f710\r\n    sp: 0x000000016f019b50   pc: 0x00000001a6283108 cpsr: 0x60001000\r\n   far: 0x00000001ff2bc0b8  esr: 0xf2000001 (Breakpoint) brk 1\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS Ventura 13.2.1\r\n - OpenSSL version 3.1.0\r\n - This provider version: current master (0.5.0-dev)\r\n\r\n**Additional context**\r\nThis is on MacBook Pro - Apple Silicon M2 chip. Similar problem on Intel-based iMac (used same process as above).\r\n\r\n**Note:** commenting out, e.g., GOST provider in `openssl.cnf` did not help.\r\n\r\n```\r\n$ openssl version\r\nOpenSSL 3.1.0 14 Mar 2023 (Library: OpenSSL 3.1.0 14 Mar 2023)\r\n$ openssl list -providers\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.1.0\r\n    status: active\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.1.0\r\n    status: active\r\n  gost\r\n    name: OpenSSL GOST Provider\r\n    status: active\r\n  legacy\r\n    name: OpenSSL Legacy Provider\r\n    version: 3.1.0\r\n    status: active\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.1.0\r\n    status: active\r\n$ \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1493663102","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132#issuecomment-1493663102","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","id":1493663102,"node_id":"IC_kwDOE_A9l85ZB31-","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T05:01:11Z","updated_at":"2023-04-03T05:01:11Z","author_association":"MEMBER","body":"> Does it happen with the proposed upstream fix?\r\n\r\n@beldmit Could you please point at some documentation how to enable/build GOST provider? I'd then try https://github.com/openssl/openssl/pull/20662","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1493663102/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T05:01:12Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28161022885","type":"IssueCommentEvent","actor":{"id":149199,"login":"bhess","display_login":"bhess","gravatar_id":"","url":"https://api.github.com/users/bhess","avatar_url":"https://avatars.githubusercontent.com/u/149199?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131","id":1640578879,"node_id":"PR_kwDOE_A9l85M5RP3","number":131,"title":"get encoder library from smaller repo, avoid silently failing if enco…","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2023-03-25T16:40:34Z","updated_at":"2023-04-03T10:43:38Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/pulls/131","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131","diff_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131.diff","patch_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131.patch","merged_at":null},"body":"- Gets encoder library from smaller repository\r\n- Avoid encoding tests silently fail if algorithm/encoding is not found\r\n- Points to new upstream encoder version with updated OID\r\n\r\nFixes #129 \r\nFixes #130 ","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494089836","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131#issuecomment-1494089836","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131","id":1494089836,"node_id":"IC_kwDOE_A9l85ZDgBs","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T10:43:37Z","updated_at":"2023-04-03T10:43:37Z","author_association":"NONE","body":"> I could reproduce the error, however, I get an error even without changing the OID (Falcon1024 looks fine, Falcon512 shows the error). I will need to investigate why. There shouldn't be any OID dependency.\r\n\r\nI didn't set all env variables correctly when testing this. Trying again, it seems to all work ok, including changing the OID.\r\n\r\nTesting Falcon with changed OIDs:\r\n\r\n```\r\nexport OQS_ENCODING_FALCON512=draft-uni-qsckeys-falcon-00/sk-pk\r\nexport OQS_ENCODING_FALCON1024=draft-uni-qsckeys-falcon-00/sk-pk\r\nexport OQS_ENCODING_FALCON512_ALGNAME=Falcon512\r\nexport OQS_ENCODING_FALCON1024_ALGNAME=Falcon1024\r\nexport OQS_OID_FALCON512=1.3.9999.3.20\r\nexport OQS_OID_FALCON1024=1.3.9999.3.21\r\n```\r\n\r\n- run `scripts/runtests_encodings.sh`\r\n\r\n- test Falcon1024\r\n```\r\n$ OPENSSL_MODULES=_build/lib LD_LIBRARY_PATH=.local/lib64 .local/bin/openssl x509 -in tmp/falcon1024.crt -text -noout -provider oqsprovider -provider default\r\nCertificate:\r\n    Data:\r\n        Version: 3 (0x2)\r\n        Serial Number:\r\n            52:1a:85:d8:b7:66:c8:0f:f6:86:07:4a:eb:24:6c:c9:55:94:8b:7d\r\n        Signature Algorithm: falcon1024\r\n        Issuer: CN=test CA\r\n        Validity\r\n            Not Before: Jan 23 08:00:00 2015 GMT\r\n            Not After : Aug 23 09:00:00 2025 GMT\r\n        Subject: CN=test Server\r\n        Subject Public Key Info:\r\n            Public Key Algorithm: falcon1024\r\n                falcon1024 public key:\r\n                PQ key material:\r\n                    0a:70:9a:b5:96:8c:e7:e3:80:ae:9b:80:3c:21:c0:\r\n```\r\n\r\n- test Falcon512\r\n```\r\n% OPENSSL_MODULES=_build/lib LD_LIBRARY_PATH=.local/lib64 .local/bin/openssl x509 -in tmp/falcon512.crt -text -noout -provider oqsprovider -provider default \r\nCertificate:\r\n    Data:\r\n        Version: 3 (0x2)\r\n        Serial Number:\r\n            13:b7:60:75:a4:0e:99:d8:a9:6f:07:61:5d:7d:e1:aa:05:9a:1f:15\r\n        Signature Algorithm: falcon512\r\n        Issuer: CN=test CA\r\n        Validity\r\n            Not Before: Jan 23 08:00:00 2015 GMT\r\n            Not After : Aug 23 09:00:00 2025 GMT\r\n        Subject: CN=test Server\r\n        Subject Public Key Info:\r\n            Public Key Algorithm: falcon512\r\n                falcon512 public key:\r\n                PQ key material:\r\n                    09:b4:d2:f4:28:df:03:a1:42:3d:89:c9:a4:26:4c:\r\n```\r\n\r\nAfter `unset OQS_OID_FALCON512`, the above test fails as expected with a decoding error.\r\n\r\n\r\n> What did I do? Changed the Falcon512 OID. --> Is there still some dependency on it?\r\n\r\n@baentsch looking at your test command a `OQS_OID_FALCON512=...` might be missing.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494089836/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T10:43:38Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28161134255","type":"IssueCommentEvent","actor":{"id":149199,"login":"bhess","display_login":"bhess","gravatar_id":"","url":"https://api.github.com/users/bhess","avatar_url":"https://avatars.githubusercontent.com/u/149199?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/139","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/139/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/139/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/139/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/139","id":1651739589,"node_id":"I_kwDOE_A9l85ic4vF","number":139,"title":"Re-enable offline build","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-04-03T10:00:02Z","updated_at":"2023-04-03T10:48:32Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"The qsc-encoder integration requires an online connection even when only running `make`. This disables the possibility to develop code when offline. \r\n\r\nIs this something easily remedied, @bhess? If not, would you mind I set USE_ENCODING_LIB=OFF by default?\r\n\r\nAlso, what happens in case of a release? Will all required code be included or will this online dependency be permeated into a ZIP file?","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/139/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494095527","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/139#issuecomment-1494095527","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/139","id":1494095527,"node_id":"IC_kwDOE_A9l85ZDhan","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T10:48:32Z","updated_at":"2023-04-03T10:48:32Z","author_association":"NONE","body":"> The qsc-encoder integration requires an online connection even when only running `make`. This disables the possibility to develop code when offline.\r\n> \r\n> Is this something easily remedied, @bhess?\r\n\r\nYes this is easy by adding a `UPDATE_DISCONNECTED 1` to the cmake `ExternalProject_Add`. This way no update will be attempted on `make`. I'll add it to #131.\r\n\r\n> Also, what happens in case of a release? Will all required code be included or will this online dependency be permeated into a ZIP file?\r\n\r\nHow is it done with other dependencies (e.g. liboqs), are they included in the release? I'd follow the the same procedure with the encoder lib.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494095527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T10:48:33Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28162215790","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132","id":1642717023,"node_id":"I_kwDOE_A9l85h6d9f","number":132,"title":"Unable to run tests","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":34,"created_at":"2023-03-27T19:52:52Z","updated_at":"2023-04-03T11:32:56Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n`ctest` crashes with `SIGTRAP`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Build or get installed OpenSSL. For this test I used OpenSSL-3.1.0.\r\n2. Build and install liboqs. I used its current master.\r\n3. Clone, build, and install this provider (don't forget to edit `openssl.cnf` as appropriate).\r\n4. `mkdir -p openssl/apps; ln -s /opt/local/bin/openssl openssl/apps`\r\n5. Go to `_build` and do `ctest --output-on-failure`\r\n6. Observe the error report.\r\n\r\n**Expected behavior**\r\nTests passing.\r\n\r\n**Screenshots**\r\n<img width=\"718\" alt=\"Screenshot 2023-03-27 at 3 49 24 PM\" src=\"https://user-images.githubusercontent.com/5923577/228050759-876766f2-d3de-4c42-bf1c-1f4dab9978a2.png\">\r\n\r\n**Crash report**\r\n```\r\nTranslated Report (Full Report Below)\r\n-------------------------------------\r\n\r\nProcess:               oqs_test_kems [17508]\r\nPath:                  /Users/USER/*/oqs_test_kems\r\nIdentifier:            oqs_test_kems\r\nVersion:               ???\r\nCode Type:             ARM-64 (Native)\r\nParent Process:        ctest [17500]\r\nResponsible:           Terminal [983]\r\nUser ID:               501\r\n\r\nDate/Time:             2023-03-27 15:39:40.6519 -0400\r\nOS Version:            macOS 13.2.1 (22D68)\r\nReport Version:        12\r\nAnonymous UUID:        161C054B-E964-CDD3-5EBC-5A9DBE3E2AE2\r\n\r\n\r\nTime Awake Since Boot: 66000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_BREAKPOINT (SIGTRAP)\r\nException Codes:       0x0000000000000001, 0x00000001a6283108\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 5 Trace/BPT trap: 5\r\nTerminating Process:   exc handler [17508]\r\n\r\nApplication Specific Information:\r\nBUG IN CLIENT OF LIBPLATFORM: Trying to recursively lock an os_once_t\r\nAbort Cause 259\r\n\r\n\r\nThread 0 Crashed::  Dispatch queue: com.apple.main-thread\r\n0   libsystem_platform.dylib      \t       0x1a6283108 _os_once_gate_recursive_abort + 36\r\n1   libsystem_platform.dylib      \t       0x1a627f710 _os_once_gate_wait + 348\r\n2   libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n3   libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n4   libcrypto.3.dylib             \t       0x1012d0ea4 ossl_obj_add_object + 236\r\n5   gostprov.dylib                \t       0x1015bf5b4 populate_gost_engine + 116\r\n6   gostprov.dylib                \t       0x1015bd478 OSSL_provider_init + 116\r\n7   libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n8   libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n9   libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n10  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n11  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n12  libcrypto.3.dylib             \t       0x101213738 ossl_config_int + 68\r\n13  libcrypto.3.dylib             \t       0x1012b2400 ossl_init_config_ossl_ + 16\r\n14  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n15  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n16  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n17  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n18  libcrypto.3.dylib             \t       0x1012b2208 OPENSSL_init_crypto + 1104\r\n19  libcrypto.3.dylib             \t       0x1012d1098 obj_lock_initialise_ossl_ + 20\r\n20  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n21  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n22  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n23  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n24  libcrypto.3.dylib             \t       0x1012d0408 OBJ_sn2nid + 112\r\n25  libcrypto.3.dylib             \t       0x1012d02f4 OBJ_txt2obj + 216\r\n26  libcrypto.3.dylib             \t       0x1012d0944 OBJ_txt2nid + 20\r\n27  libcrypto.3.dylib             \t       0x1012bd048 core_obj_create + 36\r\n28  oqsprovider.0.5.0-dev.dylib   \t       0x100f73678 OSSL_provider_init + 292\r\n29  libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n30  libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n31  libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n32  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n33  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n34  libcrypto.3.dylib             \t       0x1012af1a4 OSSL_LIB_CTX_load_config + 20\r\n35  oqs_test_kems                 \t       0x100de7420 main + 80\r\n36  dyld                          \t       0x1a5f27e50 start + 2544\r\n\r\n\r\nThread 0 crashed with ARM Thread State (64-bit):\r\n    x0: 0x0000000000000103   x1: 0x000000016f019b90   x2: 0x00000001a624dda0   x3: 0x0000000000000103\r\n    x4: 0x000000000000000a   x5: 0x0000000024200000   x6: 0x0000000000000000   x7: 0x0000000000000500\r\n    x8: 0x0000000000000103   x9: 0x0000000000000103  x10: 0x0000000000000103  x11: 0x0000600000fb8000\r\n   x12: 0x0000000000000010  x13: 0x00000000fffffcee  x14: 0x00000000000007fb  x15: 0x00000000a4188ffb\r\n   x16: 0x00000001a627d760  x17: 0x00000002066400a0  x18: 0x0000000000000000  x19: 0x0000000101438d58\r\n   x20: 0x0000000000000103  x21: 0x00000001a624dda0  x22: 0x000000016f019b90  x23: 0x0000000000000103\r\n   x24: 0x0000000000000103  x25: 0x0000000000000000  x26: 0x0000000000000002  x27: 0x0000000000000002\r\n   x28: 0x0000600000fa4000   fp: 0x000000016f019b80   lr: 0x00000001a627f710\r\n    sp: 0x000000016f019b50   pc: 0x00000001a6283108 cpsr: 0x60001000\r\n   far: 0x00000001ff2bc0b8  esr: 0xf2000001 (Breakpoint) brk 1\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS Ventura 13.2.1\r\n - OpenSSL version 3.1.0\r\n - This provider version: current master (0.5.0-dev)\r\n\r\n**Additional context**\r\nThis is on MacBook Pro - Apple Silicon M2 chip. Similar problem on Intel-based iMac (used same process as above).\r\n\r\n**Note:** commenting out, e.g., GOST provider in `openssl.cnf` did not help.\r\n\r\n```\r\n$ openssl version\r\nOpenSSL 3.1.0 14 Mar 2023 (Library: OpenSSL 3.1.0 14 Mar 2023)\r\n$ openssl list -providers\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.1.0\r\n    status: active\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.1.0\r\n    status: active\r\n  gost\r\n    name: OpenSSL GOST Provider\r\n    status: active\r\n  legacy\r\n    name: OpenSSL Legacy Provider\r\n    version: 3.1.0\r\n    status: active\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.1.0\r\n    status: active\r\n$ \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494156802","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132#issuecomment-1494156802","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","id":1494156802,"node_id":"IC_kwDOE_A9l85ZDwYC","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T11:32:56Z","updated_at":"2023-04-03T11:32:56Z","author_association":"MEMBER","body":"@beldmit : Disregard the above: Found and build gostprov; \"unfortunately\" oqsprovider `ctest` for me runs just fine (on Linux) even when gostprov is active (at least `strace` says it's been loaded...). Now I understand why @t8m labels https://github.com/openssl/openssl/pull/20662 \"tests: exempted\".... Will now try to reproduce this on OSX...","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494156802/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T11:32:56Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28162221556","type":"IssueCommentEvent","actor":{"id":13785747,"login":"beldmit","display_login":"beldmit","gravatar_id":"","url":"https://api.github.com/users/beldmit","avatar_url":"https://avatars.githubusercontent.com/u/13785747?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132","id":1642717023,"node_id":"I_kwDOE_A9l85h6d9f","number":132,"title":"Unable to run tests","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":35,"created_at":"2023-03-27T19:52:52Z","updated_at":"2023-04-03T11:33:11Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n`ctest` crashes with `SIGTRAP`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Build or get installed OpenSSL. For this test I used OpenSSL-3.1.0.\r\n2. Build and install liboqs. I used its current master.\r\n3. Clone, build, and install this provider (don't forget to edit `openssl.cnf` as appropriate).\r\n4. `mkdir -p openssl/apps; ln -s /opt/local/bin/openssl openssl/apps`\r\n5. Go to `_build` and do `ctest --output-on-failure`\r\n6. Observe the error report.\r\n\r\n**Expected behavior**\r\nTests passing.\r\n\r\n**Screenshots**\r\n<img width=\"718\" alt=\"Screenshot 2023-03-27 at 3 49 24 PM\" src=\"https://user-images.githubusercontent.com/5923577/228050759-876766f2-d3de-4c42-bf1c-1f4dab9978a2.png\">\r\n\r\n**Crash report**\r\n```\r\nTranslated Report (Full Report Below)\r\n-------------------------------------\r\n\r\nProcess:               oqs_test_kems [17508]\r\nPath:                  /Users/USER/*/oqs_test_kems\r\nIdentifier:            oqs_test_kems\r\nVersion:               ???\r\nCode Type:             ARM-64 (Native)\r\nParent Process:        ctest [17500]\r\nResponsible:           Terminal [983]\r\nUser ID:               501\r\n\r\nDate/Time:             2023-03-27 15:39:40.6519 -0400\r\nOS Version:            macOS 13.2.1 (22D68)\r\nReport Version:        12\r\nAnonymous UUID:        161C054B-E964-CDD3-5EBC-5A9DBE3E2AE2\r\n\r\n\r\nTime Awake Since Boot: 66000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_BREAKPOINT (SIGTRAP)\r\nException Codes:       0x0000000000000001, 0x00000001a6283108\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 5 Trace/BPT trap: 5\r\nTerminating Process:   exc handler [17508]\r\n\r\nApplication Specific Information:\r\nBUG IN CLIENT OF LIBPLATFORM: Trying to recursively lock an os_once_t\r\nAbort Cause 259\r\n\r\n\r\nThread 0 Crashed::  Dispatch queue: com.apple.main-thread\r\n0   libsystem_platform.dylib      \t       0x1a6283108 _os_once_gate_recursive_abort + 36\r\n1   libsystem_platform.dylib      \t       0x1a627f710 _os_once_gate_wait + 348\r\n2   libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n3   libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n4   libcrypto.3.dylib             \t       0x1012d0ea4 ossl_obj_add_object + 236\r\n5   gostprov.dylib                \t       0x1015bf5b4 populate_gost_engine + 116\r\n6   gostprov.dylib                \t       0x1015bd478 OSSL_provider_init + 116\r\n7   libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n8   libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n9   libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n10  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n11  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n12  libcrypto.3.dylib             \t       0x101213738 ossl_config_int + 68\r\n13  libcrypto.3.dylib             \t       0x1012b2400 ossl_init_config_ossl_ + 16\r\n14  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n15  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n16  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n17  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n18  libcrypto.3.dylib             \t       0x1012b2208 OPENSSL_init_crypto + 1104\r\n19  libcrypto.3.dylib             \t       0x1012d1098 obj_lock_initialise_ossl_ + 20\r\n20  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n21  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n22  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n23  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n24  libcrypto.3.dylib             \t       0x1012d0408 OBJ_sn2nid + 112\r\n25  libcrypto.3.dylib             \t       0x1012d02f4 OBJ_txt2obj + 216\r\n26  libcrypto.3.dylib             \t       0x1012d0944 OBJ_txt2nid + 20\r\n27  libcrypto.3.dylib             \t       0x1012bd048 core_obj_create + 36\r\n28  oqsprovider.0.5.0-dev.dylib   \t       0x100f73678 OSSL_provider_init + 292\r\n29  libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n30  libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n31  libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n32  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n33  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n34  libcrypto.3.dylib             \t       0x1012af1a4 OSSL_LIB_CTX_load_config + 20\r\n35  oqs_test_kems                 \t       0x100de7420 main + 80\r\n36  dyld                          \t       0x1a5f27e50 start + 2544\r\n\r\n\r\nThread 0 crashed with ARM Thread State (64-bit):\r\n    x0: 0x0000000000000103   x1: 0x000000016f019b90   x2: 0x00000001a624dda0   x3: 0x0000000000000103\r\n    x4: 0x000000000000000a   x5: 0x0000000024200000   x6: 0x0000000000000000   x7: 0x0000000000000500\r\n    x8: 0x0000000000000103   x9: 0x0000000000000103  x10: 0x0000000000000103  x11: 0x0000600000fb8000\r\n   x12: 0x0000000000000010  x13: 0x00000000fffffcee  x14: 0x00000000000007fb  x15: 0x00000000a4188ffb\r\n   x16: 0x00000001a627d760  x17: 0x00000002066400a0  x18: 0x0000000000000000  x19: 0x0000000101438d58\r\n   x20: 0x0000000000000103  x21: 0x00000001a624dda0  x22: 0x000000016f019b90  x23: 0x0000000000000103\r\n   x24: 0x0000000000000103  x25: 0x0000000000000000  x26: 0x0000000000000002  x27: 0x0000000000000002\r\n   x28: 0x0000600000fa4000   fp: 0x000000016f019b80   lr: 0x00000001a627f710\r\n    sp: 0x000000016f019b50   pc: 0x00000001a6283108 cpsr: 0x60001000\r\n   far: 0x00000001ff2bc0b8  esr: 0xf2000001 (Breakpoint) brk 1\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS Ventura 13.2.1\r\n - OpenSSL version 3.1.0\r\n - This provider version: current master (0.5.0-dev)\r\n\r\n**Additional context**\r\nThis is on MacBook Pro - Apple Silicon M2 chip. Similar problem on Intel-based iMac (used same process as above).\r\n\r\n**Note:** commenting out, e.g., GOST provider in `openssl.cnf` did not help.\r\n\r\n```\r\n$ openssl version\r\nOpenSSL 3.1.0 14 Mar 2023 (Library: OpenSSL 3.1.0 14 Mar 2023)\r\n$ openssl list -providers\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.1.0\r\n    status: active\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.1.0\r\n    status: active\r\n  gost\r\n    name: OpenSSL GOST Provider\r\n    status: active\r\n  legacy\r\n    name: OpenSSL Legacy Provider\r\n    version: 3.1.0\r\n    status: active\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.1.0\r\n    status: active\r\n$ \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494157101","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132#issuecomment-1494157101","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","id":1494157101,"node_id":"IC_kwDOE_A9l85ZDwct","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T11:33:11Z","updated_at":"2023-04-03T11:33:11Z","author_association":"NONE","body":"https://github.com/gost-engine/engine/blob/master/INSTALL.md provides some minimal information. Both engine and provider are built, and you are to place gostprov.so to the OpenSSL provider folder and activate it via config.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494157101/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T11:33:11Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28162249599","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132","id":1642717023,"node_id":"I_kwDOE_A9l85h6d9f","number":132,"title":"Unable to run tests","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":36,"created_at":"2023-03-27T19:52:52Z","updated_at":"2023-04-03T11:34:23Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n`ctest` crashes with `SIGTRAP`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Build or get installed OpenSSL. For this test I used OpenSSL-3.1.0.\r\n2. Build and install liboqs. I used its current master.\r\n3. Clone, build, and install this provider (don't forget to edit `openssl.cnf` as appropriate).\r\n4. `mkdir -p openssl/apps; ln -s /opt/local/bin/openssl openssl/apps`\r\n5. Go to `_build` and do `ctest --output-on-failure`\r\n6. Observe the error report.\r\n\r\n**Expected behavior**\r\nTests passing.\r\n\r\n**Screenshots**\r\n<img width=\"718\" alt=\"Screenshot 2023-03-27 at 3 49 24 PM\" src=\"https://user-images.githubusercontent.com/5923577/228050759-876766f2-d3de-4c42-bf1c-1f4dab9978a2.png\">\r\n\r\n**Crash report**\r\n```\r\nTranslated Report (Full Report Below)\r\n-------------------------------------\r\n\r\nProcess:               oqs_test_kems [17508]\r\nPath:                  /Users/USER/*/oqs_test_kems\r\nIdentifier:            oqs_test_kems\r\nVersion:               ???\r\nCode Type:             ARM-64 (Native)\r\nParent Process:        ctest [17500]\r\nResponsible:           Terminal [983]\r\nUser ID:               501\r\n\r\nDate/Time:             2023-03-27 15:39:40.6519 -0400\r\nOS Version:            macOS 13.2.1 (22D68)\r\nReport Version:        12\r\nAnonymous UUID:        161C054B-E964-CDD3-5EBC-5A9DBE3E2AE2\r\n\r\n\r\nTime Awake Since Boot: 66000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_BREAKPOINT (SIGTRAP)\r\nException Codes:       0x0000000000000001, 0x00000001a6283108\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 5 Trace/BPT trap: 5\r\nTerminating Process:   exc handler [17508]\r\n\r\nApplication Specific Information:\r\nBUG IN CLIENT OF LIBPLATFORM: Trying to recursively lock an os_once_t\r\nAbort Cause 259\r\n\r\n\r\nThread 0 Crashed::  Dispatch queue: com.apple.main-thread\r\n0   libsystem_platform.dylib      \t       0x1a6283108 _os_once_gate_recursive_abort + 36\r\n1   libsystem_platform.dylib      \t       0x1a627f710 _os_once_gate_wait + 348\r\n2   libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n3   libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n4   libcrypto.3.dylib             \t       0x1012d0ea4 ossl_obj_add_object + 236\r\n5   gostprov.dylib                \t       0x1015bf5b4 populate_gost_engine + 116\r\n6   gostprov.dylib                \t       0x1015bd478 OSSL_provider_init + 116\r\n7   libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n8   libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n9   libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n10  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n11  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n12  libcrypto.3.dylib             \t       0x101213738 ossl_config_int + 68\r\n13  libcrypto.3.dylib             \t       0x1012b2400 ossl_init_config_ossl_ + 16\r\n14  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n15  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n16  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n17  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n18  libcrypto.3.dylib             \t       0x1012b2208 OPENSSL_init_crypto + 1104\r\n19  libcrypto.3.dylib             \t       0x1012d1098 obj_lock_initialise_ossl_ + 20\r\n20  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n21  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n22  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n23  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n24  libcrypto.3.dylib             \t       0x1012d0408 OBJ_sn2nid + 112\r\n25  libcrypto.3.dylib             \t       0x1012d02f4 OBJ_txt2obj + 216\r\n26  libcrypto.3.dylib             \t       0x1012d0944 OBJ_txt2nid + 20\r\n27  libcrypto.3.dylib             \t       0x1012bd048 core_obj_create + 36\r\n28  oqsprovider.0.5.0-dev.dylib   \t       0x100f73678 OSSL_provider_init + 292\r\n29  libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n30  libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n31  libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n32  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n33  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n34  libcrypto.3.dylib             \t       0x1012af1a4 OSSL_LIB_CTX_load_config + 20\r\n35  oqs_test_kems                 \t       0x100de7420 main + 80\r\n36  dyld                          \t       0x1a5f27e50 start + 2544\r\n\r\n\r\nThread 0 crashed with ARM Thread State (64-bit):\r\n    x0: 0x0000000000000103   x1: 0x000000016f019b90   x2: 0x00000001a624dda0   x3: 0x0000000000000103\r\n    x4: 0x000000000000000a   x5: 0x0000000024200000   x6: 0x0000000000000000   x7: 0x0000000000000500\r\n    x8: 0x0000000000000103   x9: 0x0000000000000103  x10: 0x0000000000000103  x11: 0x0000600000fb8000\r\n   x12: 0x0000000000000010  x13: 0x00000000fffffcee  x14: 0x00000000000007fb  x15: 0x00000000a4188ffb\r\n   x16: 0x00000001a627d760  x17: 0x00000002066400a0  x18: 0x0000000000000000  x19: 0x0000000101438d58\r\n   x20: 0x0000000000000103  x21: 0x00000001a624dda0  x22: 0x000000016f019b90  x23: 0x0000000000000103\r\n   x24: 0x0000000000000103  x25: 0x0000000000000000  x26: 0x0000000000000002  x27: 0x0000000000000002\r\n   x28: 0x0000600000fa4000   fp: 0x000000016f019b80   lr: 0x00000001a627f710\r\n    sp: 0x000000016f019b50   pc: 0x00000001a6283108 cpsr: 0x60001000\r\n   far: 0x00000001ff2bc0b8  esr: 0xf2000001 (Breakpoint) brk 1\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS Ventura 13.2.1\r\n - OpenSSL version 3.1.0\r\n - This provider version: current master (0.5.0-dev)\r\n\r\n**Additional context**\r\nThis is on MacBook Pro - Apple Silicon M2 chip. Similar problem on Intel-based iMac (used same process as above).\r\n\r\n**Note:** commenting out, e.g., GOST provider in `openssl.cnf` did not help.\r\n\r\n```\r\n$ openssl version\r\nOpenSSL 3.1.0 14 Mar 2023 (Library: OpenSSL 3.1.0 14 Mar 2023)\r\n$ openssl list -providers\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.1.0\r\n    status: active\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.1.0\r\n    status: active\r\n  gost\r\n    name: OpenSSL GOST Provider\r\n    status: active\r\n  legacy\r\n    name: OpenSSL Legacy Provider\r\n    version: 3.1.0\r\n    status: active\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.1.0\r\n    status: active\r\n$ \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494158556","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132#issuecomment-1494158556","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","id":1494158556,"node_id":"IC_kwDOE_A9l85ZDwzc","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T11:34:23Z","updated_at":"2023-04-03T11:34:23Z","author_association":"MEMBER","body":"A comment at the same moment. Impressive :)\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494158556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T11:34:24Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28162322379","type":"IssueCommentEvent","actor":{"id":13785747,"login":"beldmit","display_login":"beldmit","gravatar_id":"","url":"https://api.github.com/users/beldmit","avatar_url":"https://avatars.githubusercontent.com/u/13785747?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132","id":1642717023,"node_id":"I_kwDOE_A9l85h6d9f","number":132,"title":"Unable to run tests","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":36,"created_at":"2023-03-27T19:52:52Z","updated_at":"2023-04-03T11:37:33Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n`ctest` crashes with `SIGTRAP`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Build or get installed OpenSSL. For this test I used OpenSSL-3.1.0.\r\n2. Build and install liboqs. I used its current master.\r\n3. Clone, build, and install this provider (don't forget to edit `openssl.cnf` as appropriate).\r\n4. `mkdir -p openssl/apps; ln -s /opt/local/bin/openssl openssl/apps`\r\n5. Go to `_build` and do `ctest --output-on-failure`\r\n6. Observe the error report.\r\n\r\n**Expected behavior**\r\nTests passing.\r\n\r\n**Screenshots**\r\n<img width=\"718\" alt=\"Screenshot 2023-03-27 at 3 49 24 PM\" src=\"https://user-images.githubusercontent.com/5923577/228050759-876766f2-d3de-4c42-bf1c-1f4dab9978a2.png\">\r\n\r\n**Crash report**\r\n```\r\nTranslated Report (Full Report Below)\r\n-------------------------------------\r\n\r\nProcess:               oqs_test_kems [17508]\r\nPath:                  /Users/USER/*/oqs_test_kems\r\nIdentifier:            oqs_test_kems\r\nVersion:               ???\r\nCode Type:             ARM-64 (Native)\r\nParent Process:        ctest [17500]\r\nResponsible:           Terminal [983]\r\nUser ID:               501\r\n\r\nDate/Time:             2023-03-27 15:39:40.6519 -0400\r\nOS Version:            macOS 13.2.1 (22D68)\r\nReport Version:        12\r\nAnonymous UUID:        161C054B-E964-CDD3-5EBC-5A9DBE3E2AE2\r\n\r\n\r\nTime Awake Since Boot: 66000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_BREAKPOINT (SIGTRAP)\r\nException Codes:       0x0000000000000001, 0x00000001a6283108\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 5 Trace/BPT trap: 5\r\nTerminating Process:   exc handler [17508]\r\n\r\nApplication Specific Information:\r\nBUG IN CLIENT OF LIBPLATFORM: Trying to recursively lock an os_once_t\r\nAbort Cause 259\r\n\r\n\r\nThread 0 Crashed::  Dispatch queue: com.apple.main-thread\r\n0   libsystem_platform.dylib      \t       0x1a6283108 _os_once_gate_recursive_abort + 36\r\n1   libsystem_platform.dylib      \t       0x1a627f710 _os_once_gate_wait + 348\r\n2   libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n3   libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n4   libcrypto.3.dylib             \t       0x1012d0ea4 ossl_obj_add_object + 236\r\n5   gostprov.dylib                \t       0x1015bf5b4 populate_gost_engine + 116\r\n6   gostprov.dylib                \t       0x1015bd478 OSSL_provider_init + 116\r\n7   libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n8   libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n9   libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n10  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n11  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n12  libcrypto.3.dylib             \t       0x101213738 ossl_config_int + 68\r\n13  libcrypto.3.dylib             \t       0x1012b2400 ossl_init_config_ossl_ + 16\r\n14  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n15  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n16  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n17  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n18  libcrypto.3.dylib             \t       0x1012b2208 OPENSSL_init_crypto + 1104\r\n19  libcrypto.3.dylib             \t       0x1012d1098 obj_lock_initialise_ossl_ + 20\r\n20  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n21  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n22  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n23  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n24  libcrypto.3.dylib             \t       0x1012d0408 OBJ_sn2nid + 112\r\n25  libcrypto.3.dylib             \t       0x1012d02f4 OBJ_txt2obj + 216\r\n26  libcrypto.3.dylib             \t       0x1012d0944 OBJ_txt2nid + 20\r\n27  libcrypto.3.dylib             \t       0x1012bd048 core_obj_create + 36\r\n28  oqsprovider.0.5.0-dev.dylib   \t       0x100f73678 OSSL_provider_init + 292\r\n29  libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n30  libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n31  libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n32  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n33  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n34  libcrypto.3.dylib             \t       0x1012af1a4 OSSL_LIB_CTX_load_config + 20\r\n35  oqs_test_kems                 \t       0x100de7420 main + 80\r\n36  dyld                          \t       0x1a5f27e50 start + 2544\r\n\r\n\r\nThread 0 crashed with ARM Thread State (64-bit):\r\n    x0: 0x0000000000000103   x1: 0x000000016f019b90   x2: 0x00000001a624dda0   x3: 0x0000000000000103\r\n    x4: 0x000000000000000a   x5: 0x0000000024200000   x6: 0x0000000000000000   x7: 0x0000000000000500\r\n    x8: 0x0000000000000103   x9: 0x0000000000000103  x10: 0x0000000000000103  x11: 0x0000600000fb8000\r\n   x12: 0x0000000000000010  x13: 0x00000000fffffcee  x14: 0x00000000000007fb  x15: 0x00000000a4188ffb\r\n   x16: 0x00000001a627d760  x17: 0x00000002066400a0  x18: 0x0000000000000000  x19: 0x0000000101438d58\r\n   x20: 0x0000000000000103  x21: 0x00000001a624dda0  x22: 0x000000016f019b90  x23: 0x0000000000000103\r\n   x24: 0x0000000000000103  x25: 0x0000000000000000  x26: 0x0000000000000002  x27: 0x0000000000000002\r\n   x28: 0x0000600000fa4000   fp: 0x000000016f019b80   lr: 0x00000001a627f710\r\n    sp: 0x000000016f019b50   pc: 0x00000001a6283108 cpsr: 0x60001000\r\n   far: 0x00000001ff2bc0b8  esr: 0xf2000001 (Breakpoint) brk 1\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS Ventura 13.2.1\r\n - OpenSSL version 3.1.0\r\n - This provider version: current master (0.5.0-dev)\r\n\r\n**Additional context**\r\nThis is on MacBook Pro - Apple Silicon M2 chip. Similar problem on Intel-based iMac (used same process as above).\r\n\r\n**Note:** commenting out, e.g., GOST provider in `openssl.cnf` did not help.\r\n\r\n```\r\n$ openssl version\r\nOpenSSL 3.1.0 14 Mar 2023 (Library: OpenSSL 3.1.0 14 Mar 2023)\r\n$ openssl list -providers\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.1.0\r\n    status: active\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.1.0\r\n    status: active\r\n  gost\r\n    name: OpenSSL GOST Provider\r\n    status: active\r\n  legacy\r\n    name: OpenSSL Legacy Provider\r\n    version: 3.1.0\r\n    status: active\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.1.0\r\n    status: active\r\n$ \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494162485","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132#issuecomment-1494162485","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","id":1494162485,"node_id":"IC_kwDOE_A9l85ZDxw1","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T11:37:33Z","updated_at":"2023-04-03T11:37:33Z","author_association":"NONE","body":"> In the above backtrace - any idea why `CONF_modules_load` appears at 31, and again at 9? Likewise, `CRYPTO_THREAD_run_once` appears _trice_ at 22, 16, and 3?\r\n\r\nI have some ideas - the initialization of OpenSSL is quite complicated. `CONF_modules_load` may be invoked several times, and should be noop in case of they are already initialized.\r\n> \r\n> > This backtrace does not show any gost-engine problem\r\n> \r\n> OK, you know your engine better - but why presence of no other engine seems to cause this problem? What's so \"special\" about GOST engine?\r\n\r\nProbably object registration (where you - and some other people - found a problem). Probably presense of non-standard algorithms (all the other providers and engines except the OQS provider reimplement classic algorithms). Looks like Mac is also undertested.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494162485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T11:37:33Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28162697069","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/437","id":1651525819,"node_id":"I_kwDOA_fpb85icEi7","number":437,"title":"update falcon IDs for openssl 1.1.1","user":{"login":"k-Artin","id":120385775,"node_id":"U_kgDOByzw7w","avatar_url":"https://avatars.githubusercontent.com/u/120385775?v=4","gravatar_id":"","url":"https://api.github.com/users/k-Artin","html_url":"https://github.com/k-Artin","followers_url":"https://api.github.com/users/k-Artin/followers","following_url":"https://api.github.com/users/k-Artin/following{/other_user}","gists_url":"https://api.github.com/users/k-Artin/gists{/gist_id}","starred_url":"https://api.github.com/users/k-Artin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k-Artin/subscriptions","organizations_url":"https://api.github.com/users/k-Artin/orgs","repos_url":"https://api.github.com/users/k-Artin/repos","events_url":"https://api.github.com/users/k-Artin/events{/privacy}","received_events_url":"https://api.github.com/users/k-Artin/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-04-03T07:48:51Z","updated_at":"2023-04-03T11:53:49Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"hello \r\ni want to use tls connection with falcon signature with openssl 1.1.1 (server) and openssl 3 (client).\r\nafter this **https://github.com/open-quantum-safe/oqs-provider/pull/125** i can not use this signature (falcon).\r\nplease update the falcon (O)IDs in openssl 1.1.1.\r\n\r\nThank you in advance!\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/1494181596","html_url":"https://github.com/open-quantum-safe/openssl/issues/437#issuecomment-1494181596","issue_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437","id":1494181596,"node_id":"IC_kwDOA_fpb85ZD2bc","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T11:53:49Z","updated_at":"2023-04-03T11:53:49Z","author_association":"MEMBER","body":"Thanks for this reminder. Could I ask you in turn to chime in to [this discussion](https://github.com/open-quantum-safe/openssl/discussions/434)? What are your arguments for keeping maintaining OQS-OpenSSL111? What is it that you cannot do with OpenSSL3+oqsprovider?","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/1494181596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T11:53:50Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28162782136","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131","id":1640578879,"node_id":"PR_kwDOE_A9l85M5RP3","number":131,"title":"get encoder library from smaller repo, avoid silently failing if enco…","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2023-03-25T16:40:34Z","updated_at":"2023-04-03T11:57:20Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/pulls/131","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131","diff_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131.diff","patch_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131.patch","merged_at":null},"body":"- Gets encoder library from smaller repository\r\n- Avoid encoding tests silently fail if algorithm/encoding is not found\r\n- Points to new upstream encoder version with updated OID\r\n- Adds `UPDATE_DISCONNECTED 1` to allow offline build (#139)\r\n\r\nFixes #129 \r\nFixes #130 ","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494185972","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131#issuecomment-1494185972","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131","id":1494185972,"node_id":"IC_kwDOE_A9l85ZD3f0","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T11:57:20Z","updated_at":"2023-04-03T11:57:20Z","author_association":"MEMBER","body":"> @baentsch looking at your test command a OQS_OID_FALCON512=... might be missing.\r\n\r\nNope. I changed `generate.yml` for the test...","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494185972/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T11:57:21Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28163515624","type":"IssueCommentEvent","actor":{"id":120385775,"login":"k-Artin","display_login":"k-Artin","gravatar_id":"","url":"https://api.github.com/users/k-Artin","avatar_url":"https://avatars.githubusercontent.com/u/120385775?"},"repo":{"id":66578799,"name":"open-quantum-safe/openssl","url":"https://api.github.com/repos/open-quantum-safe/openssl"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437","repository_url":"https://api.github.com/repos/open-quantum-safe/openssl","labels_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437/comments","events_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437/events","html_url":"https://github.com/open-quantum-safe/openssl/issues/437","id":1651525819,"node_id":"I_kwDOA_fpb85icEi7","number":437,"title":"update falcon IDs for openssl 1.1.1","user":{"login":"k-Artin","id":120385775,"node_id":"U_kgDOByzw7w","avatar_url":"https://avatars.githubusercontent.com/u/120385775?v=4","gravatar_id":"","url":"https://api.github.com/users/k-Artin","html_url":"https://github.com/k-Artin","followers_url":"https://api.github.com/users/k-Artin/followers","following_url":"https://api.github.com/users/k-Artin/following{/other_user}","gists_url":"https://api.github.com/users/k-Artin/gists{/gist_id}","starred_url":"https://api.github.com/users/k-Artin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k-Artin/subscriptions","organizations_url":"https://api.github.com/users/k-Artin/orgs","repos_url":"https://api.github.com/users/k-Artin/repos","events_url":"https://api.github.com/users/k-Artin/events{/privacy}","received_events_url":"https://api.github.com/users/k-Artin/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-04-03T07:48:51Z","updated_at":"2023-04-03T12:24:32Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"hello \r\ni want to use tls connection with falcon signature with openssl 1.1.1 (server) and openssl 3 (client).\r\nafter this **https://github.com/open-quantum-safe/oqs-provider/pull/125** i can not use this signature (falcon).\r\nplease update the falcon (O)IDs in openssl 1.1.1.\r\n\r\nThank you in advance!\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/1494229189","html_url":"https://github.com/open-quantum-safe/openssl/issues/437#issuecomment-1494229189","issue_url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/437","id":1494229189,"node_id":"IC_kwDOA_fpb85ZECDF","user":{"login":"k-Artin","id":120385775,"node_id":"U_kgDOByzw7w","avatar_url":"https://avatars.githubusercontent.com/u/120385775?v=4","gravatar_id":"","url":"https://api.github.com/users/k-Artin","html_url":"https://github.com/k-Artin","followers_url":"https://api.github.com/users/k-Artin/followers","following_url":"https://api.github.com/users/k-Artin/following{/other_user}","gists_url":"https://api.github.com/users/k-Artin/gists{/gist_id}","starred_url":"https://api.github.com/users/k-Artin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k-Artin/subscriptions","organizations_url":"https://api.github.com/users/k-Artin/orgs","repos_url":"https://api.github.com/users/k-Artin/repos","events_url":"https://api.github.com/users/k-Artin/events{/privacy}","received_events_url":"https://api.github.com/users/k-Artin/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T12:24:31Z","updated_at":"2023-04-03T12:24:31Z","author_association":"NONE","body":"> Thanks for this reminder. Could I ask you in turn to chime in to [this discussion](https://github.com/open-quantum-safe/openssl/discussions/434)? What are your arguments for keeping maintaining OQS-OpenSSL111? What is it that you cannot do with OpenSSL3+oqsprovider?\r\n\r\nnothing just i want to remind you.\r\nthank you for updating (O)IDs.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/openssl/issues/comments/1494229189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T12:24:32Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28165489902","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131","id":1640578879,"node_id":"PR_kwDOE_A9l85M5RP3","number":131,"title":"get encoder library from smaller repo, avoid silently failing if enco…","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2023-03-25T16:40:34Z","updated_at":"2023-04-03T13:33:37Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/pulls/131","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131","diff_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131.diff","patch_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131.patch","merged_at":null},"body":"- Gets encoder library from smaller repository\r\n- Avoid encoding tests silently fail if algorithm/encoding is not found\r\n- Points to new upstream encoder version with updated OID\r\n- Adds `UPDATE_DISCONNECTED 1` to allow offline build (#139)\r\n\r\nFixes #129 \r\nFixes #130 ","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494334464","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131#issuecomment-1494334464","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131","id":1494334464,"node_id":"IC_kwDOE_A9l85ZEbwA","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T13:33:37Z","updated_at":"2023-04-03T13:33:37Z","author_association":"MEMBER","body":"Thanks for these fixes. I hope you can forgive me now being a \"bit nervous\" about the robustness of all this -- my question thus: Does https://github.com/IETF-Hackathon/pqc-certificates/pull/43 contain proper (proper in the sense of \"in line with your RFC\") certificates? Or should this data set be re-done after landing this PR to permit others to test \"the right stuff\"? Last question: Are you going to rebase the PR to remove the conflict?","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494334464/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T13:33:37Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28166611367","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132","id":1642717023,"node_id":"I_kwDOE_A9l85h6d9f","number":132,"title":"Unable to run tests","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":38,"created_at":"2023-03-27T19:52:52Z","updated_at":"2023-04-03T14:11:04Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n`ctest` crashes with `SIGTRAP`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Build or get installed OpenSSL. For this test I used OpenSSL-3.1.0.\r\n2. Build and install liboqs. I used its current master.\r\n3. Clone, build, and install this provider (don't forget to edit `openssl.cnf` as appropriate).\r\n4. `mkdir -p openssl/apps; ln -s /opt/local/bin/openssl openssl/apps`\r\n5. Go to `_build` and do `ctest --output-on-failure`\r\n6. Observe the error report.\r\n\r\n**Expected behavior**\r\nTests passing.\r\n\r\n**Screenshots**\r\n<img width=\"718\" alt=\"Screenshot 2023-03-27 at 3 49 24 PM\" src=\"https://user-images.githubusercontent.com/5923577/228050759-876766f2-d3de-4c42-bf1c-1f4dab9978a2.png\">\r\n\r\n**Crash report**\r\n```\r\nTranslated Report (Full Report Below)\r\n-------------------------------------\r\n\r\nProcess:               oqs_test_kems [17508]\r\nPath:                  /Users/USER/*/oqs_test_kems\r\nIdentifier:            oqs_test_kems\r\nVersion:               ???\r\nCode Type:             ARM-64 (Native)\r\nParent Process:        ctest [17500]\r\nResponsible:           Terminal [983]\r\nUser ID:               501\r\n\r\nDate/Time:             2023-03-27 15:39:40.6519 -0400\r\nOS Version:            macOS 13.2.1 (22D68)\r\nReport Version:        12\r\nAnonymous UUID:        161C054B-E964-CDD3-5EBC-5A9DBE3E2AE2\r\n\r\n\r\nTime Awake Since Boot: 66000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_BREAKPOINT (SIGTRAP)\r\nException Codes:       0x0000000000000001, 0x00000001a6283108\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 5 Trace/BPT trap: 5\r\nTerminating Process:   exc handler [17508]\r\n\r\nApplication Specific Information:\r\nBUG IN CLIENT OF LIBPLATFORM: Trying to recursively lock an os_once_t\r\nAbort Cause 259\r\n\r\n\r\nThread 0 Crashed::  Dispatch queue: com.apple.main-thread\r\n0   libsystem_platform.dylib      \t       0x1a6283108 _os_once_gate_recursive_abort + 36\r\n1   libsystem_platform.dylib      \t       0x1a627f710 _os_once_gate_wait + 348\r\n2   libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n3   libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n4   libcrypto.3.dylib             \t       0x1012d0ea4 ossl_obj_add_object + 236\r\n5   gostprov.dylib                \t       0x1015bf5b4 populate_gost_engine + 116\r\n6   gostprov.dylib                \t       0x1015bd478 OSSL_provider_init + 116\r\n7   libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n8   libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n9   libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n10  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n11  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n12  libcrypto.3.dylib             \t       0x101213738 ossl_config_int + 68\r\n13  libcrypto.3.dylib             \t       0x1012b2400 ossl_init_config_ossl_ + 16\r\n14  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n15  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n16  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n17  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n18  libcrypto.3.dylib             \t       0x1012b2208 OPENSSL_init_crypto + 1104\r\n19  libcrypto.3.dylib             \t       0x1012d1098 obj_lock_initialise_ossl_ + 20\r\n20  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n21  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n22  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n23  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n24  libcrypto.3.dylib             \t       0x1012d0408 OBJ_sn2nid + 112\r\n25  libcrypto.3.dylib             \t       0x1012d02f4 OBJ_txt2obj + 216\r\n26  libcrypto.3.dylib             \t       0x1012d0944 OBJ_txt2nid + 20\r\n27  libcrypto.3.dylib             \t       0x1012bd048 core_obj_create + 36\r\n28  oqsprovider.0.5.0-dev.dylib   \t       0x100f73678 OSSL_provider_init + 292\r\n29  libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n30  libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n31  libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n32  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n33  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n34  libcrypto.3.dylib             \t       0x1012af1a4 OSSL_LIB_CTX_load_config + 20\r\n35  oqs_test_kems                 \t       0x100de7420 main + 80\r\n36  dyld                          \t       0x1a5f27e50 start + 2544\r\n\r\n\r\nThread 0 crashed with ARM Thread State (64-bit):\r\n    x0: 0x0000000000000103   x1: 0x000000016f019b90   x2: 0x00000001a624dda0   x3: 0x0000000000000103\r\n    x4: 0x000000000000000a   x5: 0x0000000024200000   x6: 0x0000000000000000   x7: 0x0000000000000500\r\n    x8: 0x0000000000000103   x9: 0x0000000000000103  x10: 0x0000000000000103  x11: 0x0000600000fb8000\r\n   x12: 0x0000000000000010  x13: 0x00000000fffffcee  x14: 0x00000000000007fb  x15: 0x00000000a4188ffb\r\n   x16: 0x00000001a627d760  x17: 0x00000002066400a0  x18: 0x0000000000000000  x19: 0x0000000101438d58\r\n   x20: 0x0000000000000103  x21: 0x00000001a624dda0  x22: 0x000000016f019b90  x23: 0x0000000000000103\r\n   x24: 0x0000000000000103  x25: 0x0000000000000000  x26: 0x0000000000000002  x27: 0x0000000000000002\r\n   x28: 0x0000600000fa4000   fp: 0x000000016f019b80   lr: 0x00000001a627f710\r\n    sp: 0x000000016f019b50   pc: 0x00000001a6283108 cpsr: 0x60001000\r\n   far: 0x00000001ff2bc0b8  esr: 0xf2000001 (Breakpoint) brk 1\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS Ventura 13.2.1\r\n - OpenSSL version 3.1.0\r\n - This provider version: current master (0.5.0-dev)\r\n\r\n**Additional context**\r\nThis is on MacBook Pro - Apple Silicon M2 chip. Similar problem on Intel-based iMac (used same process as above).\r\n\r\n**Note:** commenting out, e.g., GOST provider in `openssl.cnf` did not help.\r\n\r\n```\r\n$ openssl version\r\nOpenSSL 3.1.0 14 Mar 2023 (Library: OpenSSL 3.1.0 14 Mar 2023)\r\n$ openssl list -providers\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.1.0\r\n    status: active\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.1.0\r\n    status: active\r\n  gost\r\n    name: OpenSSL GOST Provider\r\n    status: active\r\n  legacy\r\n    name: OpenSSL Legacy Provider\r\n    version: 3.1.0\r\n    status: active\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.1.0\r\n    status: active\r\n$ \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494399675","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132#issuecomment-1494399675","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","id":1494399675,"node_id":"IC_kwDOE_A9l85ZErq7","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T14:11:03Z","updated_at":"2023-04-03T14:11:03Z","author_association":"MEMBER","body":"> Looks like Mac is also undertested.\r\n\r\nThat's a bit of an understatement: When trying to reproduce the problem on OSX using `oqsprovider`, I noted that not even one of the \"external\" OpenSSL tests pass on OSX (Python: `ldd` not existing; krb5: \"cannot compute sizeof (time_t)\"; gost&oqsprovider: Cannot find `libcrypto.3.dylib`, i.e., (DY)LD_LIBRARY_PATH issues). @mattcaswell: Is this known/acceptable, worth while an OpenSSL issue or am I doing sth wrong?","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494399675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T14:11:04Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28167508971","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132","id":1642717023,"node_id":"I_kwDOE_A9l85h6d9f","number":132,"title":"Unable to run tests","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":39,"created_at":"2023-03-27T19:52:52Z","updated_at":"2023-04-03T14:40:11Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n`ctest` crashes with `SIGTRAP`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Build or get installed OpenSSL. For this test I used OpenSSL-3.1.0.\r\n2. Build and install liboqs. I used its current master.\r\n3. Clone, build, and install this provider (don't forget to edit `openssl.cnf` as appropriate).\r\n4. `mkdir -p openssl/apps; ln -s /opt/local/bin/openssl openssl/apps`\r\n5. Go to `_build` and do `ctest --output-on-failure`\r\n6. Observe the error report.\r\n\r\n**Expected behavior**\r\nTests passing.\r\n\r\n**Screenshots**\r\n<img width=\"718\" alt=\"Screenshot 2023-03-27 at 3 49 24 PM\" src=\"https://user-images.githubusercontent.com/5923577/228050759-876766f2-d3de-4c42-bf1c-1f4dab9978a2.png\">\r\n\r\n**Crash report**\r\n```\r\nTranslated Report (Full Report Below)\r\n-------------------------------------\r\n\r\nProcess:               oqs_test_kems [17508]\r\nPath:                  /Users/USER/*/oqs_test_kems\r\nIdentifier:            oqs_test_kems\r\nVersion:               ???\r\nCode Type:             ARM-64 (Native)\r\nParent Process:        ctest [17500]\r\nResponsible:           Terminal [983]\r\nUser ID:               501\r\n\r\nDate/Time:             2023-03-27 15:39:40.6519 -0400\r\nOS Version:            macOS 13.2.1 (22D68)\r\nReport Version:        12\r\nAnonymous UUID:        161C054B-E964-CDD3-5EBC-5A9DBE3E2AE2\r\n\r\n\r\nTime Awake Since Boot: 66000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_BREAKPOINT (SIGTRAP)\r\nException Codes:       0x0000000000000001, 0x00000001a6283108\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 5 Trace/BPT trap: 5\r\nTerminating Process:   exc handler [17508]\r\n\r\nApplication Specific Information:\r\nBUG IN CLIENT OF LIBPLATFORM: Trying to recursively lock an os_once_t\r\nAbort Cause 259\r\n\r\n\r\nThread 0 Crashed::  Dispatch queue: com.apple.main-thread\r\n0   libsystem_platform.dylib      \t       0x1a6283108 _os_once_gate_recursive_abort + 36\r\n1   libsystem_platform.dylib      \t       0x1a627f710 _os_once_gate_wait + 348\r\n2   libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n3   libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n4   libcrypto.3.dylib             \t       0x1012d0ea4 ossl_obj_add_object + 236\r\n5   gostprov.dylib                \t       0x1015bf5b4 populate_gost_engine + 116\r\n6   gostprov.dylib                \t       0x1015bd478 OSSL_provider_init + 116\r\n7   libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n8   libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n9   libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n10  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n11  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n12  libcrypto.3.dylib             \t       0x101213738 ossl_config_int + 68\r\n13  libcrypto.3.dylib             \t       0x1012b2400 ossl_init_config_ossl_ + 16\r\n14  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n15  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n16  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n17  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n18  libcrypto.3.dylib             \t       0x1012b2208 OPENSSL_init_crypto + 1104\r\n19  libcrypto.3.dylib             \t       0x1012d1098 obj_lock_initialise_ossl_ + 20\r\n20  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n21  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n22  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n23  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n24  libcrypto.3.dylib             \t       0x1012d0408 OBJ_sn2nid + 112\r\n25  libcrypto.3.dylib             \t       0x1012d02f4 OBJ_txt2obj + 216\r\n26  libcrypto.3.dylib             \t       0x1012d0944 OBJ_txt2nid + 20\r\n27  libcrypto.3.dylib             \t       0x1012bd048 core_obj_create + 36\r\n28  oqsprovider.0.5.0-dev.dylib   \t       0x100f73678 OSSL_provider_init + 292\r\n29  libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n30  libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n31  libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n32  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n33  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n34  libcrypto.3.dylib             \t       0x1012af1a4 OSSL_LIB_CTX_load_config + 20\r\n35  oqs_test_kems                 \t       0x100de7420 main + 80\r\n36  dyld                          \t       0x1a5f27e50 start + 2544\r\n\r\n\r\nThread 0 crashed with ARM Thread State (64-bit):\r\n    x0: 0x0000000000000103   x1: 0x000000016f019b90   x2: 0x00000001a624dda0   x3: 0x0000000000000103\r\n    x4: 0x000000000000000a   x5: 0x0000000024200000   x6: 0x0000000000000000   x7: 0x0000000000000500\r\n    x8: 0x0000000000000103   x9: 0x0000000000000103  x10: 0x0000000000000103  x11: 0x0000600000fb8000\r\n   x12: 0x0000000000000010  x13: 0x00000000fffffcee  x14: 0x00000000000007fb  x15: 0x00000000a4188ffb\r\n   x16: 0x00000001a627d760  x17: 0x00000002066400a0  x18: 0x0000000000000000  x19: 0x0000000101438d58\r\n   x20: 0x0000000000000103  x21: 0x00000001a624dda0  x22: 0x000000016f019b90  x23: 0x0000000000000103\r\n   x24: 0x0000000000000103  x25: 0x0000000000000000  x26: 0x0000000000000002  x27: 0x0000000000000002\r\n   x28: 0x0000600000fa4000   fp: 0x000000016f019b80   lr: 0x00000001a627f710\r\n    sp: 0x000000016f019b50   pc: 0x00000001a6283108 cpsr: 0x60001000\r\n   far: 0x00000001ff2bc0b8  esr: 0xf2000001 (Breakpoint) brk 1\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS Ventura 13.2.1\r\n - OpenSSL version 3.1.0\r\n - This provider version: current master (0.5.0-dev)\r\n\r\n**Additional context**\r\nThis is on MacBook Pro - Apple Silicon M2 chip. Similar problem on Intel-based iMac (used same process as above).\r\n\r\n**Note:** commenting out, e.g., GOST provider in `openssl.cnf` did not help.\r\n\r\n```\r\n$ openssl version\r\nOpenSSL 3.1.0 14 Mar 2023 (Library: OpenSSL 3.1.0 14 Mar 2023)\r\n$ openssl list -providers\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.1.0\r\n    status: active\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.1.0\r\n    status: active\r\n  gost\r\n    name: OpenSSL GOST Provider\r\n    status: active\r\n  legacy\r\n    name: OpenSSL Legacy Provider\r\n    version: 3.1.0\r\n    status: active\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.1.0\r\n    status: active\r\n$ \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494452549","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132#issuecomment-1494452549","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","id":1494452549,"node_id":"IC_kwDOE_A9l85ZE4lF","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T14:40:10Z","updated_at":"2023-04-03T14:40:10Z","author_association":"MEMBER","body":"@mouse07410 As you started this issue regarding OSX testing, may I assume you know OSX some more than I do? Most notably, is it correct that the `LD_LIBRARY_PATH` equivalent `DYLD_LIBRARY_PATH` is not getting passed to child processes (at least when SIP is active)? I'm tempted to now `export DYLD_LIBRARY_PATH=$LD_LIBRARY_PATH` in all `oqsprovider` test scripts to get them to pass in non-system install (i.e., testing) setups. Is that correct? Do you know a better way?","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494452549/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T14:40:11Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28168256792","type":"IssueCommentEvent","actor":{"id":149199,"login":"bhess","display_login":"bhess","gravatar_id":"","url":"https://api.github.com/users/bhess","avatar_url":"https://avatars.githubusercontent.com/u/149199?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131","id":1640578879,"node_id":"PR_kwDOE_A9l85M5RP3","number":131,"title":"get encoder library from smaller repo, avoid silently failing if enco…","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2023-03-25T16:40:34Z","updated_at":"2023-04-03T15:05:01Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/pulls/131","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131","diff_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131.diff","patch_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131.patch","merged_at":null},"body":"- Gets encoder library from smaller repository\r\n- Avoid encoding tests silently fail if algorithm/encoding is not found\r\n- Points to new upstream encoder version with updated OID\r\n- Adds `UPDATE_DISCONNECTED 1` to allow offline build (#139)\r\n\r\nFixes #129 \r\nFixes #130 ","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494497645","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131#issuecomment-1494497645","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131","id":1494497645,"node_id":"IC_kwDOE_A9l85ZFDlt","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T15:05:01Z","updated_at":"2023-04-03T15:05:01Z","author_association":"NONE","body":"> Thanks for these fixes. I hope you can forgive me now being a \"bit nervous\" about the robustness of all this -- my question thus: Does [IETF-Hackathon/pqc-certificates#43](https://github.com/IETF-Hackathon/pqc-certificates/pull/43) contain proper (proper in the sense of \"in line with your RFC\") certificates? Or should this data set be re-done after landing this PR to permit others to test \"the right stuff\"?\r\n\r\nThe certs produced with the \"hotfix\" docker image are equivalent with the ones now in this PR. Thanks for being extra cautious! \r\n\r\n> Last question: Are you going to rebase the PR to remove the conflict?\r\n\r\nDone.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494497645/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T15:05:02Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28168311821","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131","id":1640578879,"node_id":"PR_kwDOE_A9l85M5RP3","number":131,"title":"get encoder library from smaller repo, avoid silently failing if enco…","user":{"login":"bhess","id":149199,"node_id":"MDQ6VXNlcjE0OTE5OQ==","avatar_url":"https://avatars.githubusercontent.com/u/149199?v=4","gravatar_id":"","url":"https://api.github.com/users/bhess","html_url":"https://github.com/bhess","followers_url":"https://api.github.com/users/bhess/followers","following_url":"https://api.github.com/users/bhess/following{/other_user}","gists_url":"https://api.github.com/users/bhess/gists{/gist_id}","starred_url":"https://api.github.com/users/bhess/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bhess/subscriptions","organizations_url":"https://api.github.com/users/bhess/orgs","repos_url":"https://api.github.com/users/bhess/repos","events_url":"https://api.github.com/users/bhess/events{/privacy}","received_events_url":"https://api.github.com/users/bhess/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2023-03-25T16:40:34Z","updated_at":"2023-04-03T15:06:46Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/pulls/131","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131","diff_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131.diff","patch_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131.patch","merged_at":null},"body":"- Gets encoder library from smaller repository\r\n- Avoid encoding tests silently fail if algorithm/encoding is not found\r\n- Points to new upstream encoder version with updated OID\r\n- Adds `UPDATE_DISCONNECTED 1` to allow offline build (#139)\r\n\r\nFixes #129 \r\nFixes #130 ","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494501055","html_url":"https://github.com/open-quantum-safe/oqs-provider/pull/131#issuecomment-1494501055","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/131","id":1494501055,"node_id":"IC_kwDOE_A9l85ZFEa_","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T15:06:46Z","updated_at":"2023-04-03T15:06:46Z","author_association":"MEMBER","body":"> The certs produced with the \"hotfix\" docker image are equivalent with the ones now in this PR.\r\n\r\nThanks for checking (and re-basing).","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494501055/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T15:06:46Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28168850569","type":"IssueCommentEvent","actor":{"id":13785747,"login":"beldmit","display_login":"beldmit","gravatar_id":"","url":"https://api.github.com/users/beldmit","avatar_url":"https://avatars.githubusercontent.com/u/13785747?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426","id":1652281414,"node_id":"I_kwDOA-eq3c5ie9BG","number":1426,"title":"OQS_USE_SHA3_OPENSSL=ON makes running tests significantly slower","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-04-03T15:19:15Z","updated_at":"2023-04-03T15:25:06Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nI build liboqs-0.8.0-dev with and without OQS_USE_SHA3_OPENSSL=ON. With OQS_USE_SHA3_OPENSSL=ON I see 9 minutes for running tests and without - just 2 min. Fedora 37, OpenSSL 3.0.x\r\n\r\n**To Reproduce**\r\ncmake -GNinja -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n\r\nmake\r\ntime make test \r\n\r\nRepeat the same without  -DOQS_USE_SHA3_OPENSSL=ON\r\n\r\n(I do it as a part of RPM build, so pure difference should be in the testing)\r\n \r\n**Expected behavior**\r\nMore or less equal time.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Fedora 37\r\n - OpenSSL version: 3.0.8\r\n - Compiler version used: gcc (GCC) 12.2.1 20221121\r\n - Build variables used: -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n - liboqs version: main branch\r\n\r\n**Additional context**\r\nWe want to avoid multiple implementations of low-level algorithms (AES, SHA2, SHA3) in Fedora and want to heavily rely on OpenSSL implementation. We would like to narrow down the problem - is it the performance of low-level primitives or, say, digest fetching from openssl, or smth else.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494532404","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426#issuecomment-1494532404","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","id":1494532404,"node_id":"IC_kwDOA-eq3c5ZFME0","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T15:25:06Z","updated_at":"2023-04-03T15:25:06Z","author_association":"NONE","body":"User time is even worse: 27 mins vs 4","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494532404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T15:25:07Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28169425674","type":"IssueCommentEvent","actor":{"id":5923577,"login":"mouse07410","display_login":"mouse07410","gravatar_id":"","url":"https://api.github.com/users/mouse07410","avatar_url":"https://avatars.githubusercontent.com/u/5923577?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132","id":1642717023,"node_id":"I_kwDOE_A9l85h6d9f","number":132,"title":"Unable to run tests","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":40,"created_at":"2023-03-27T19:52:52Z","updated_at":"2023-04-03T15:46:14Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n`ctest` crashes with `SIGTRAP`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Build or get installed OpenSSL. For this test I used OpenSSL-3.1.0.\r\n2. Build and install liboqs. I used its current master.\r\n3. Clone, build, and install this provider (don't forget to edit `openssl.cnf` as appropriate).\r\n4. `mkdir -p openssl/apps; ln -s /opt/local/bin/openssl openssl/apps`\r\n5. Go to `_build` and do `ctest --output-on-failure`\r\n6. Observe the error report.\r\n\r\n**Expected behavior**\r\nTests passing.\r\n\r\n**Screenshots**\r\n<img width=\"718\" alt=\"Screenshot 2023-03-27 at 3 49 24 PM\" src=\"https://user-images.githubusercontent.com/5923577/228050759-876766f2-d3de-4c42-bf1c-1f4dab9978a2.png\">\r\n\r\n**Crash report**\r\n```\r\nTranslated Report (Full Report Below)\r\n-------------------------------------\r\n\r\nProcess:               oqs_test_kems [17508]\r\nPath:                  /Users/USER/*/oqs_test_kems\r\nIdentifier:            oqs_test_kems\r\nVersion:               ???\r\nCode Type:             ARM-64 (Native)\r\nParent Process:        ctest [17500]\r\nResponsible:           Terminal [983]\r\nUser ID:               501\r\n\r\nDate/Time:             2023-03-27 15:39:40.6519 -0400\r\nOS Version:            macOS 13.2.1 (22D68)\r\nReport Version:        12\r\nAnonymous UUID:        161C054B-E964-CDD3-5EBC-5A9DBE3E2AE2\r\n\r\n\r\nTime Awake Since Boot: 66000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_BREAKPOINT (SIGTRAP)\r\nException Codes:       0x0000000000000001, 0x00000001a6283108\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 5 Trace/BPT trap: 5\r\nTerminating Process:   exc handler [17508]\r\n\r\nApplication Specific Information:\r\nBUG IN CLIENT OF LIBPLATFORM: Trying to recursively lock an os_once_t\r\nAbort Cause 259\r\n\r\n\r\nThread 0 Crashed::  Dispatch queue: com.apple.main-thread\r\n0   libsystem_platform.dylib      \t       0x1a6283108 _os_once_gate_recursive_abort + 36\r\n1   libsystem_platform.dylib      \t       0x1a627f710 _os_once_gate_wait + 348\r\n2   libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n3   libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n4   libcrypto.3.dylib             \t       0x1012d0ea4 ossl_obj_add_object + 236\r\n5   gostprov.dylib                \t       0x1015bf5b4 populate_gost_engine + 116\r\n6   gostprov.dylib                \t       0x1015bd478 OSSL_provider_init + 116\r\n7   libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n8   libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n9   libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n10  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n11  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n12  libcrypto.3.dylib             \t       0x101213738 ossl_config_int + 68\r\n13  libcrypto.3.dylib             \t       0x1012b2400 ossl_init_config_ossl_ + 16\r\n14  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n15  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n16  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n17  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n18  libcrypto.3.dylib             \t       0x1012b2208 OPENSSL_init_crypto + 1104\r\n19  libcrypto.3.dylib             \t       0x1012d1098 obj_lock_initialise_ossl_ + 20\r\n20  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n21  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n22  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n23  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n24  libcrypto.3.dylib             \t       0x1012d0408 OBJ_sn2nid + 112\r\n25  libcrypto.3.dylib             \t       0x1012d02f4 OBJ_txt2obj + 216\r\n26  libcrypto.3.dylib             \t       0x1012d0944 OBJ_txt2nid + 20\r\n27  libcrypto.3.dylib             \t       0x1012bd048 core_obj_create + 36\r\n28  oqsprovider.0.5.0-dev.dylib   \t       0x100f73678 OSSL_provider_init + 292\r\n29  libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n30  libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n31  libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n32  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n33  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n34  libcrypto.3.dylib             \t       0x1012af1a4 OSSL_LIB_CTX_load_config + 20\r\n35  oqs_test_kems                 \t       0x100de7420 main + 80\r\n36  dyld                          \t       0x1a5f27e50 start + 2544\r\n\r\n\r\nThread 0 crashed with ARM Thread State (64-bit):\r\n    x0: 0x0000000000000103   x1: 0x000000016f019b90   x2: 0x00000001a624dda0   x3: 0x0000000000000103\r\n    x4: 0x000000000000000a   x5: 0x0000000024200000   x6: 0x0000000000000000   x7: 0x0000000000000500\r\n    x8: 0x0000000000000103   x9: 0x0000000000000103  x10: 0x0000000000000103  x11: 0x0000600000fb8000\r\n   x12: 0x0000000000000010  x13: 0x00000000fffffcee  x14: 0x00000000000007fb  x15: 0x00000000a4188ffb\r\n   x16: 0x00000001a627d760  x17: 0x00000002066400a0  x18: 0x0000000000000000  x19: 0x0000000101438d58\r\n   x20: 0x0000000000000103  x21: 0x00000001a624dda0  x22: 0x000000016f019b90  x23: 0x0000000000000103\r\n   x24: 0x0000000000000103  x25: 0x0000000000000000  x26: 0x0000000000000002  x27: 0x0000000000000002\r\n   x28: 0x0000600000fa4000   fp: 0x000000016f019b80   lr: 0x00000001a627f710\r\n    sp: 0x000000016f019b50   pc: 0x00000001a6283108 cpsr: 0x60001000\r\n   far: 0x00000001ff2bc0b8  esr: 0xf2000001 (Breakpoint) brk 1\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS Ventura 13.2.1\r\n - OpenSSL version 3.1.0\r\n - This provider version: current master (0.5.0-dev)\r\n\r\n**Additional context**\r\nThis is on MacBook Pro - Apple Silicon M2 chip. Similar problem on Intel-based iMac (used same process as above).\r\n\r\n**Note:** commenting out, e.g., GOST provider in `openssl.cnf` did not help.\r\n\r\n```\r\n$ openssl version\r\nOpenSSL 3.1.0 14 Mar 2023 (Library: OpenSSL 3.1.0 14 Mar 2023)\r\n$ openssl list -providers\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.1.0\r\n    status: active\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.1.0\r\n    status: active\r\n  gost\r\n    name: OpenSSL GOST Provider\r\n    status: active\r\n  legacy\r\n    name: OpenSSL Legacy Provider\r\n    version: 3.1.0\r\n    status: active\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.1.0\r\n    status: active\r\n$ \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494564007","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132#issuecomment-1494564007","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","id":1494564007,"node_id":"IC_kwDOE_A9l85ZFTyn","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T15:46:14Z","updated_at":"2023-04-03T15:46:14Z","author_association":"NONE","body":"1. Yes `DYLD_LIBRARY_PATH` is MacOS analog of `LD_LIBRARY_PATH`, so your intuition is correct. `LD_LIBRARY_PATH` is stinky ignored on Mac, AFAIK.\n2. There's also `DYLD_FALLBACK_LIBRARY_PATH` (please check the spelling - I could transpose the words), which is used when the library needed was not found in `DYLD_LIBRARY_PATH`. \n\nSometimes `@rpath` does good, but for me it usually just caused more problems. \n\nUnfortunately, I don't know about possible SIP effects on passing `DYLD_LIBRARY_PATH`. In my case, defaults usually worked. Also, please keep in mind that, e.g., Macports places it's systemwide shared libraries in `/opt/local/lib`, and `DYLD_LIBRARY_PATH` would override it. ","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1494564007/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T15:46:15Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28169516366","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426","id":1652281414,"node_id":"I_kwDOA-eq3c5ie9BG","number":1426,"title":"OQS_USE_SHA3_OPENSSL=ON makes running tests significantly slower","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-04-03T15:19:15Z","updated_at":"2023-04-03T15:49:38Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nI build liboqs-0.8.0-dev with and without OQS_USE_SHA3_OPENSSL=ON. With OQS_USE_SHA3_OPENSSL=ON I see 9 minutes for running tests and without - just 2 min. Fedora 37, OpenSSL 3.0.x\r\n\r\n**To Reproduce**\r\ncmake -GNinja -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n\r\nmake\r\ntime make test \r\n\r\nRepeat the same without  -DOQS_USE_SHA3_OPENSSL=ON\r\n\r\n(I do it as a part of RPM build, so pure difference should be in the testing)\r\n \r\n**Expected behavior**\r\nMore or less equal time.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Fedora 37\r\n - OpenSSL version: 3.0.8\r\n - Compiler version used: gcc (GCC) 12.2.1 20221121\r\n - Build variables used: -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n - liboqs version: main branch\r\n\r\n**Additional context**\r\nWe want to avoid multiple implementations of low-level algorithms (AES, SHA2, SHA3) in Fedora and want to heavily rely on OpenSSL implementation. We would like to narrow down the problem - is it the performance of low-level primitives or, say, digest fetching from openssl, or smth else.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494569097","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426#issuecomment-1494569097","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","id":1494569097,"node_id":"IC_kwDOA-eq3c5ZFVCJ","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T15:49:37Z","updated_at":"2023-04-03T15:49:37Z","author_association":"MEMBER","body":">  With OQS_USE_SHA3_OPENSSL=ON I see 9 minutes for running tests and without - just 2 min. Fedora 37, OpenSSL 3.0.x\r\n\r\n> Expected behavior \r\n> More or less equal time.\r\n\r\nWhy do you expect this? \"OQS_USE_SHA3_OPENSSL=OFF\" activates a local XKCP version, so entirely different code from OpenSSL's. What SHA3 code base does OpenSSL use? The same? Then indeed I'd understand your surprise. \r\n\r\n> We would like to narrow down the problem - is it the performance of low-level primitives or, say, digest fetching from openssl, or smth else.\r\n\r\nFWIW, the speed differential is clearly visible even in the built-in artificial speed tests -- but not a factor of 6:\r\n\r\n```\r\n$ ./build/tests/speed_common \r\nConfiguration info\r\n==================\r\nTarget platform:  x86_64-Linux-5.19.0-38-generic\r\nCompiler:         gcc (11.3.0)\r\nCompile options:  [-Wa,--noexecstack;-Wstrict-overflow;-ggdb3;-Wbad-function-cast]\r\nOQS version:      0.8.0-dev\r\nGit commit:       d61d81c526da8bb62e363f5a75191689572151cb\r\nOpenSSL enabled:  Yes (OpenSSL 3.0.2 15 Mar 2022)\r\nAES:              NI\r\nSHA-2:            OpenSSL\r\nSHA-3:            C\r\nOQS build flags:  BUILD_SHARED_LIBS OQS_DIST_BUILD OQS_OPT_TARGET=generic CMAKE_BUILD_TYPE=Debug \r\nCPU exts active:  ADX AES AVX AVX2 BMI1 BMI2 PCLMULQDQ POPCNT SSE SSE2 SSE3\r\nSpeed test\r\n==========\r\nStarted at 2023-04-03 17:40:31\r\nOperation                            | Iterations | Total time (s) | Time (us): mean | pop. stdev | CPU cycles: mean          | pop. stdev\r\n------------------------------------ | ----------:| --------------:| ---------------:| ----------:| -------------------------:| ----------:\r\nOQS_AES128_ECB_load+free_sch         |    4495481 |          1.000 |           0.222 |      0.416 |                       371 |         26\r\nOQS_AES128_ECB_enc_sch               |    4961547 |          1.000 |           0.202 |      0.401 |                       294 |         24\r\nOQS_AES128_ECB_enc                   |    2511140 |          1.000 |           0.398 |      0.490 |                       706 |         38\r\nOQS_AES256_ECB_load+free_sch         |    5163286 |          1.000 |           0.194 |      0.396 |                       317 |         32\r\nOQS_AES256_ECB_enc_sch               |    3699662 |          1.000 |           0.270 |      0.445 |                       400 |         45\r\nOQS_AES256_ECB_enc                   |    2341165 |          1.000 |           0.427 |      0.495 |                       759 |         46\r\nOQS_AES256_CTR_init+iv+free          |    4956465 |          1.000 |           0.202 |      0.402 |                       332 |         32\r\nOQS_AES256_CTR_inc_stream_iv         |    7567083 |          1.000 |           0.132 |      0.339 |                       200 |         19\r\nOQS_AES256_CTR_inc_stream_blks       |    7917212 |          1.000 |           0.126 |      0.332 |                       189 |         20\r\nOQS_SHA2_sha256                      |    3303524 |          1.000 |           0.303 |      0.468 |                       524 |        165\r\nOQS_SHA2_sha384                      |    2454523 |          1.000 |           0.407 |      0.492 |                       723 |         43\r\nOQS_SHA2_sha512                      |    2401595 |          1.000 |           0.416 |      0.493 |                       739 |         40\r\nOQS_SHA3_sha3_256                    |    2675547 |          1.000 |           0.374 |      0.492 |                       658 |        188\r\nOQS_SHA3_sha3_384                    |    2671477 |          1.000 |           0.374 |      0.492 |                       659 |        190\r\nOQS_SHA3_sha3_512                    |    2688687 |          1.000 |           0.372 |      0.491 |                       654 |        187\r\nOQS_SHA3_shake128                    |    2577158 |          1.000 |           0.388 |      0.497 |                       685 |        213\r\nOQS_SHA3_shake256                    |    2568989 |          1.000 |           0.389 |      0.498 |                       687 |        213\r\nEnded at 2023-04-03 17:40:50\r\n\r\n$ ./build-openssl/tests/speed_common \r\nConfiguration info\r\n==================\r\nTarget platform:  x86_64-Linux-5.19.0-38-generic\r\nCompiler:         gcc (11.3.0)\r\nCompile options:  [-Wa,--noexecstack;-Wstrict-overflow;-ggdb3;-Wbad-function-cast]\r\nOQS version:      0.8.0-dev\r\nGit commit:       d61d81c526da8bb62e363f5a75191689572151cb\r\nOpenSSL enabled:  Yes (OpenSSL 3.0.2 15 Mar 2022)\r\nAES:              NI\r\nSHA-2:            OpenSSL\r\nSHA-3:            OpenSSL\r\nOQS build flags:  BUILD_SHARED_LIBS OQS_DIST_BUILD OQS_OPT_TARGET=generic CMAKE_BUILD_TYPE=Debug \r\nCPU exts active:  ADX AES AVX AVX2 BMI1 BMI2 PCLMULQDQ POPCNT SSE SSE2 SSE3\r\nSpeed test\r\n==========\r\nStarted at 2023-04-03 17:40:58\r\nOperation                            | Iterations | Total time (s) | Time (us): mean | pop. stdev | CPU cycles: mean          | pop. stdev\r\n------------------------------------ | ----------:| --------------:| ---------------:| ----------:| -------------------------:| ----------:\r\nOQS_AES128_ECB_load+free_sch         |    4487752 |          1.000 |           0.223 |      0.419 |                       372 |         93\r\nOQS_AES128_ECB_enc_sch               |    5086516 |          1.000 |           0.197 |      0.400 |                       291 |         83\r\nOQS_AES128_ECB_enc                   |    2507581 |          1.000 |           0.399 |      0.490 |                       707 |         33\r\nOQS_AES256_ECB_load+free_sch         |    5149337 |          1.000 |           0.194 |      0.396 |                       312 |         27\r\nOQS_AES256_ECB_enc_sch               |    3762857 |          1.000 |           0.266 |      0.442 |                       389 |         35\r\nOQS_AES256_ECB_enc                   |    2328186 |          1.000 |           0.430 |      0.499 |                       763 |        119\r\nOQS_AES256_CTR_init+iv+free          |    4915280 |          1.000 |           0.203 |      0.405 |                       334 |         86\r\nOQS_AES256_CTR_inc_stream_iv         |    7548342 |          1.000 |           0.132 |      0.339 |                       200 |         20\r\nOQS_AES256_CTR_inc_stream_blks       |    7887930 |          1.000 |           0.127 |      0.333 |                       190 |         31\r\nOQS_SHA2_sha256                      |    3296287 |          1.000 |           0.303 |      0.471 |                       525 |        192\r\nOQS_SHA2_sha384                      |    2417810 |          1.000 |           0.414 |      0.497 |                       734 |        125\r\nOQS_SHA2_sha512                      |    2415321 |          1.000 |           0.414 |      0.497 |                       735 |        126\r\nOQS_SHA3_sha3_256                    |    1901105 |          1.000 |           0.526 |      0.505 |                       946 |        136\r\nOQS_SHA3_sha3_384                    |    1924791 |          1.000 |           0.520 |      0.506 |                       934 |        142\r\nOQS_SHA3_sha3_512                    |    1916460 |          1.000 |           0.522 |      0.504 |                       940 |        129\r\nOQS_SHA3_shake128                    |    1842362 |          1.000 |           0.543 |      0.499 |                       979 |         50\r\nOQS_SHA3_shake256                    |    1882932 |          1.000 |           0.531 |      0.499 |                       958 |         44\r\nEnded at 2023-04-03 17:41:17\r\n\r\n```","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494569097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T15:49:38Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28169874876","type":"IssueCommentEvent","actor":{"id":13785747,"login":"beldmit","display_login":"beldmit","gravatar_id":"","url":"https://api.github.com/users/beldmit","avatar_url":"https://avatars.githubusercontent.com/u/13785747?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426","id":1652281414,"node_id":"I_kwDOA-eq3c5ie9BG","number":1426,"title":"OQS_USE_SHA3_OPENSSL=ON makes running tests significantly slower","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-04-03T15:19:15Z","updated_at":"2023-04-03T16:02:29Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nI build liboqs-0.8.0-dev with and without OQS_USE_SHA3_OPENSSL=ON. With OQS_USE_SHA3_OPENSSL=ON I see 9 minutes for running tests and without - just 2 min. Fedora 37, OpenSSL 3.0.x\r\n\r\n**To Reproduce**\r\ncmake -GNinja -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n\r\nmake\r\ntime make test \r\n\r\nRepeat the same without  -DOQS_USE_SHA3_OPENSSL=ON\r\n\r\n(I do it as a part of RPM build, so pure difference should be in the testing)\r\n \r\n**Expected behavior**\r\nMore or less equal time.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Fedora 37\r\n - OpenSSL version: 3.0.8\r\n - Compiler version used: gcc (GCC) 12.2.1 20221121\r\n - Build variables used: -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n - liboqs version: main branch\r\n\r\n**Additional context**\r\nWe want to avoid multiple implementations of low-level algorithms (AES, SHA2, SHA3) in Fedora and want to heavily rely on OpenSSL implementation. We would like to narrow down the problem - is it the performance of low-level primitives or, say, digest fetching from openssl, or smth else.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494591453","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426#issuecomment-1494591453","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","id":1494591453,"node_id":"IC_kwDOA-eq3c5ZFafd","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T16:02:29Z","updated_at":"2023-04-03T16:02:29Z","author_association":"NONE","body":"So you have just a better implementation of SHA3, right? Is it yours implementation? (All my OpenSSL-related hats on) Could it be brought to OpenSSL? (All my OpenSSL-related hats off)\r\n\r\nI'm aware of the following antipattern - in 3.0. using old methods like EVP_sha3_256() instead of fetching a digest object via EVP_MD_fetch and using a fetched object gives a performance penalty. See https://github.com/openssl/openssl/pull/20354/files#diff-86fbd44f96c9f78b9c4a27d8b5fb9d83aa787b9a7d92c6774d9172c5952b791f for example. If it is the case (and looks like it is), it's worth fixing","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494591453/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T16:02:29Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28170014574","type":"IssueCommentEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426","id":1652281414,"node_id":"I_kwDOA-eq3c5ie9BG","number":1426,"title":"OQS_USE_SHA3_OPENSSL=ON makes running tests significantly slower","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2023-04-03T15:19:15Z","updated_at":"2023-04-03T16:07:26Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nI build liboqs-0.8.0-dev with and without OQS_USE_SHA3_OPENSSL=ON. With OQS_USE_SHA3_OPENSSL=ON I see 9 minutes for running tests and without - just 2 min. Fedora 37, OpenSSL 3.0.x\r\n\r\n**To Reproduce**\r\ncmake -GNinja -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n\r\nmake\r\ntime make test \r\n\r\nRepeat the same without  -DOQS_USE_SHA3_OPENSSL=ON\r\n\r\n(I do it as a part of RPM build, so pure difference should be in the testing)\r\n \r\n**Expected behavior**\r\nMore or less equal time.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Fedora 37\r\n - OpenSSL version: 3.0.8\r\n - Compiler version used: gcc (GCC) 12.2.1 20221121\r\n - Build variables used: -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n - liboqs version: main branch\r\n\r\n**Additional context**\r\nWe want to avoid multiple implementations of low-level algorithms (AES, SHA2, SHA3) in Fedora and want to heavily rely on OpenSSL implementation. We would like to narrow down the problem - is it the performance of low-level primitives or, say, digest fetching from openssl, or smth else.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494600267","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426#issuecomment-1494600267","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","id":1494600267,"node_id":"IC_kwDOA-eq3c5ZFcpL","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T16:07:26Z","updated_at":"2023-04-03T16:07:26Z","author_association":"MEMBER","body":"> So you have just a better implementation of SHA3, right? \r\n\r\nDefine \"better\". \"Faster\": Probably. \"More secure\": Not sure.\r\n\r\n> Is it yours implementation?\r\n\r\nNope: This is basically https://github.com/XKCP/XKCP, right @jschanck ?","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494600267/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T16:07:27Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28170161146","type":"IssueCommentEvent","actor":{"id":13785747,"login":"beldmit","display_login":"beldmit","gravatar_id":"","url":"https://api.github.com/users/beldmit","avatar_url":"https://avatars.githubusercontent.com/u/13785747?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426","id":1652281414,"node_id":"I_kwDOA-eq3c5ie9BG","number":1426,"title":"OQS_USE_SHA3_OPENSSL=ON makes running tests significantly slower","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2023-04-03T15:19:15Z","updated_at":"2023-04-03T16:13:03Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nI build liboqs-0.8.0-dev with and without OQS_USE_SHA3_OPENSSL=ON. With OQS_USE_SHA3_OPENSSL=ON I see 9 minutes for running tests and without - just 2 min. Fedora 37, OpenSSL 3.0.x\r\n\r\n**To Reproduce**\r\ncmake -GNinja -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n\r\nmake\r\ntime make test \r\n\r\nRepeat the same without  -DOQS_USE_SHA3_OPENSSL=ON\r\n\r\n(I do it as a part of RPM build, so pure difference should be in the testing)\r\n \r\n**Expected behavior**\r\nMore or less equal time.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Fedora 37\r\n - OpenSSL version: 3.0.8\r\n - Compiler version used: gcc (GCC) 12.2.1 20221121\r\n - Build variables used: -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n - liboqs version: main branch\r\n\r\n**Additional context**\r\nWe want to avoid multiple implementations of low-level algorithms (AES, SHA2, SHA3) in Fedora and want to heavily rely on OpenSSL implementation. We would like to narrow down the problem - is it the performance of low-level primitives or, say, digest fetching from openssl, or smth else.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494608978","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426#issuecomment-1494608978","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","id":1494608978,"node_id":"IC_kwDOA-eq3c5ZFexS","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T16:13:03Z","updated_at":"2023-04-03T16:13:03Z","author_association":"NONE","body":"Sure, I mean \"faster\". I still think that the antipattern I mentioned is worth fixing, both for SHA3 and SHA2.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494608978/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T16:13:03Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28173253685","type":"IssueCommentEvent","actor":{"id":25615540,"login":"jschanck","display_login":"jschanck","gravatar_id":"","url":"https://api.github.com/users/jschanck","avatar_url":"https://avatars.githubusercontent.com/u/25615540?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426","id":1652281414,"node_id":"I_kwDOA-eq3c5ie9BG","number":1426,"title":"OQS_USE_SHA3_OPENSSL=ON makes running tests significantly slower","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2023-04-03T15:19:15Z","updated_at":"2023-04-03T18:29:34Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nI build liboqs-0.8.0-dev with and without OQS_USE_SHA3_OPENSSL=ON. With OQS_USE_SHA3_OPENSSL=ON I see 9 minutes for running tests and without - just 2 min. Fedora 37, OpenSSL 3.0.x\r\n\r\n**To Reproduce**\r\ncmake -GNinja -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n\r\nmake\r\ntime make test \r\n\r\nRepeat the same without  -DOQS_USE_SHA3_OPENSSL=ON\r\n\r\n(I do it as a part of RPM build, so pure difference should be in the testing)\r\n \r\n**Expected behavior**\r\nMore or less equal time.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Fedora 37\r\n - OpenSSL version: 3.0.8\r\n - Compiler version used: gcc (GCC) 12.2.1 20221121\r\n - Build variables used: -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n - liboqs version: main branch\r\n\r\n**Additional context**\r\nWe want to avoid multiple implementations of low-level algorithms (AES, SHA2, SHA3) in Fedora and want to heavily rely on OpenSSL implementation. We would like to narrow down the problem - is it the performance of low-level primitives or, say, digest fetching from openssl, or smth else.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494785838","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426#issuecomment-1494785838","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","id":1494785838,"node_id":"IC_kwDOA-eq3c5ZGJ8u","user":{"login":"jschanck","id":25615540,"node_id":"MDQ6VXNlcjI1NjE1NTQw","avatar_url":"https://avatars.githubusercontent.com/u/25615540?v=4","gravatar_id":"","url":"https://api.github.com/users/jschanck","html_url":"https://github.com/jschanck","followers_url":"https://api.github.com/users/jschanck/followers","following_url":"https://api.github.com/users/jschanck/following{/other_user}","gists_url":"https://api.github.com/users/jschanck/gists{/gist_id}","starred_url":"https://api.github.com/users/jschanck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jschanck/subscriptions","organizations_url":"https://api.github.com/users/jschanck/orgs","repos_url":"https://api.github.com/users/jschanck/repos","events_url":"https://api.github.com/users/jschanck/events{/privacy}","received_events_url":"https://api.github.com/users/jschanck/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T18:29:34Z","updated_at":"2023-04-03T18:29:34Z","author_association":"CONTRIBUTOR","body":"OpenSSL doesn't expose a streaming API for XOF output, which several PQ schemes require. The slowdown you're seeing is due to the `XXX` in our code here: https://github.com/open-quantum-safe/liboqs/blob/main/src/common/sha3/ossl_sha3.c#L146.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494785838/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T18:29:35Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28174611358","type":"IssueCommentEvent","actor":{"id":13785747,"login":"beldmit","display_login":"beldmit","gravatar_id":"","url":"https://api.github.com/users/beldmit","avatar_url":"https://avatars.githubusercontent.com/u/13785747?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426","id":1652281414,"node_id":"I_kwDOA-eq3c5ie9BG","number":1426,"title":"OQS_USE_SHA3_OPENSSL=ON makes running tests significantly slower","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2023-04-03T15:19:15Z","updated_at":"2023-04-03T19:34:20Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nI build liboqs-0.8.0-dev with and without OQS_USE_SHA3_OPENSSL=ON. With OQS_USE_SHA3_OPENSSL=ON I see 9 minutes for running tests and without - just 2 min. Fedora 37, OpenSSL 3.0.x\r\n\r\n**To Reproduce**\r\ncmake -GNinja -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n\r\nmake\r\ntime make test \r\n\r\nRepeat the same without  -DOQS_USE_SHA3_OPENSSL=ON\r\n\r\n(I do it as a part of RPM build, so pure difference should be in the testing)\r\n \r\n**Expected behavior**\r\nMore or less equal time.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**Environment (please complete the following information):**\r\n - OS: Fedora 37\r\n - OpenSSL version: 3.0.8\r\n - Compiler version used: gcc (GCC) 12.2.1 20221121\r\n - Build variables used: -DBUILD_SHARED_LIBS=ON -DOQS_ALGS_ENABLED=STD -DOQS_USE_SHA3_OPENSSL=ON -DCMAKE_BUILD_TYPE=Debug -DOQS_USE_AVX2_INSTRUCTIONS=OFF -DOQS_USE_AVX512_INSTRUCTIONS=OFF\r\n - liboqs version: main branch\r\n\r\n**Additional context**\r\nWe want to avoid multiple implementations of low-level algorithms (AES, SHA2, SHA3) in Fedora and want to heavily rely on OpenSSL implementation. We would like to narrow down the problem - is it the performance of low-level primitives or, say, digest fetching from openssl, or smth else.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494866814","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1426#issuecomment-1494866814","issue_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1426","id":1494866814,"node_id":"IC_kwDOA-eq3c5ZGdt-","user":{"login":"beldmit","id":13785747,"node_id":"MDQ6VXNlcjEzNzg1NzQ3","avatar_url":"https://avatars.githubusercontent.com/u/13785747?v=4","gravatar_id":"","url":"https://api.github.com/users/beldmit","html_url":"https://github.com/beldmit","followers_url":"https://api.github.com/users/beldmit/followers","following_url":"https://api.github.com/users/beldmit/following{/other_user}","gists_url":"https://api.github.com/users/beldmit/gists{/gist_id}","starred_url":"https://api.github.com/users/beldmit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/beldmit/subscriptions","organizations_url":"https://api.github.com/users/beldmit/orgs","repos_url":"https://api.github.com/users/beldmit/repos","events_url":"https://api.github.com/users/beldmit/events{/privacy}","received_events_url":"https://api.github.com/users/beldmit/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T19:34:20Z","updated_at":"2023-04-03T19:34:20Z","author_association":"NONE","body":"I agree, but it's a different problem.","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/comments/1494866814/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T19:34:20Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"28176925473","type":"IssueCommentEvent","actor":{"id":5923577,"login":"mouse07410","display_login":"mouse07410","gravatar_id":"","url":"https://api.github.com/users/mouse07410","avatar_url":"https://avatars.githubusercontent.com/u/5923577?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"created","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132","id":1642717023,"node_id":"I_kwDOE_A9l85h6d9f","number":132,"title":"Unable to run tests","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":42,"created_at":"2023-03-27T19:52:52Z","updated_at":"2023-04-03T21:32:00Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\n`ctest` crashes with `SIGTRAP`.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Build or get installed OpenSSL. For this test I used OpenSSL-3.1.0.\r\n2. Build and install liboqs. I used its current master.\r\n3. Clone, build, and install this provider (don't forget to edit `openssl.cnf` as appropriate).\r\n4. `mkdir -p openssl/apps; ln -s /opt/local/bin/openssl openssl/apps`\r\n5. Go to `_build` and do `ctest --output-on-failure`\r\n6. Observe the error report.\r\n\r\n**Expected behavior**\r\nTests passing.\r\n\r\n**Screenshots**\r\n<img width=\"718\" alt=\"Screenshot 2023-03-27 at 3 49 24 PM\" src=\"https://user-images.githubusercontent.com/5923577/228050759-876766f2-d3de-4c42-bf1c-1f4dab9978a2.png\">\r\n\r\n**Crash report**\r\n```\r\nTranslated Report (Full Report Below)\r\n-------------------------------------\r\n\r\nProcess:               oqs_test_kems [17508]\r\nPath:                  /Users/USER/*/oqs_test_kems\r\nIdentifier:            oqs_test_kems\r\nVersion:               ???\r\nCode Type:             ARM-64 (Native)\r\nParent Process:        ctest [17500]\r\nResponsible:           Terminal [983]\r\nUser ID:               501\r\n\r\nDate/Time:             2023-03-27 15:39:40.6519 -0400\r\nOS Version:            macOS 13.2.1 (22D68)\r\nReport Version:        12\r\nAnonymous UUID:        161C054B-E964-CDD3-5EBC-5A9DBE3E2AE2\r\n\r\n\r\nTime Awake Since Boot: 66000 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_BREAKPOINT (SIGTRAP)\r\nException Codes:       0x0000000000000001, 0x00000001a6283108\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 5 Trace/BPT trap: 5\r\nTerminating Process:   exc handler [17508]\r\n\r\nApplication Specific Information:\r\nBUG IN CLIENT OF LIBPLATFORM: Trying to recursively lock an os_once_t\r\nAbort Cause 259\r\n\r\n\r\nThread 0 Crashed::  Dispatch queue: com.apple.main-thread\r\n0   libsystem_platform.dylib      \t       0x1a6283108 _os_once_gate_recursive_abort + 36\r\n1   libsystem_platform.dylib      \t       0x1a627f710 _os_once_gate_wait + 348\r\n2   libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n3   libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n4   libcrypto.3.dylib             \t       0x1012d0ea4 ossl_obj_add_object + 236\r\n5   gostprov.dylib                \t       0x1015bf5b4 populate_gost_engine + 116\r\n6   gostprov.dylib                \t       0x1015bd478 OSSL_provider_init + 116\r\n7   libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n8   libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n9   libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n10  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n11  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n12  libcrypto.3.dylib             \t       0x101213738 ossl_config_int + 68\r\n13  libcrypto.3.dylib             \t       0x1012b2400 ossl_init_config_ossl_ + 16\r\n14  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n15  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n16  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n17  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n18  libcrypto.3.dylib             \t       0x1012b2208 OPENSSL_init_crypto + 1104\r\n19  libcrypto.3.dylib             \t       0x1012d1098 obj_lock_initialise_ossl_ + 20\r\n20  libsystem_pthread.dylib       \t       0x1a624ddec __pthread_once_handler + 76\r\n21  libsystem_platform.dylib      \t       0x1a627d7e0 _os_once_callout + 32\r\n22  libsystem_pthread.dylib       \t       0x1a624dd84 pthread_once + 100\r\n23  libcrypto.3.dylib             \t       0x1012bdfcc CRYPTO_THREAD_run_once + 12\r\n24  libcrypto.3.dylib             \t       0x1012d0408 OBJ_sn2nid + 112\r\n25  libcrypto.3.dylib             \t       0x1012d02f4 OBJ_txt2obj + 216\r\n26  libcrypto.3.dylib             \t       0x1012d0944 OBJ_txt2nid + 20\r\n27  libcrypto.3.dylib             \t       0x1012bd048 core_obj_create + 36\r\n28  oqsprovider.0.5.0-dev.dylib   \t       0x100f73678 OSSL_provider_init + 292\r\n29  libcrypto.3.dylib             \t       0x1012bbddc provider_activate + 260\r\n30  libcrypto.3.dylib             \t       0x1012bbc48 ossl_provider_activate + 56\r\n31  libcrypto.3.dylib             \t       0x1012ba93c provider_conf_init + 608\r\n32  libcrypto.3.dylib             \t       0x101212c4c CONF_modules_load + 856\r\n33  libcrypto.3.dylib             \t       0x101212ee8 CONF_modules_load_file_ex + 120\r\n34  libcrypto.3.dylib             \t       0x1012af1a4 OSSL_LIB_CTX_load_config + 20\r\n35  oqs_test_kems                 \t       0x100de7420 main + 80\r\n36  dyld                          \t       0x1a5f27e50 start + 2544\r\n\r\n\r\nThread 0 crashed with ARM Thread State (64-bit):\r\n    x0: 0x0000000000000103   x1: 0x000000016f019b90   x2: 0x00000001a624dda0   x3: 0x0000000000000103\r\n    x4: 0x000000000000000a   x5: 0x0000000024200000   x6: 0x0000000000000000   x7: 0x0000000000000500\r\n    x8: 0x0000000000000103   x9: 0x0000000000000103  x10: 0x0000000000000103  x11: 0x0000600000fb8000\r\n   x12: 0x0000000000000010  x13: 0x00000000fffffcee  x14: 0x00000000000007fb  x15: 0x00000000a4188ffb\r\n   x16: 0x00000001a627d760  x17: 0x00000002066400a0  x18: 0x0000000000000000  x19: 0x0000000101438d58\r\n   x20: 0x0000000000000103  x21: 0x00000001a624dda0  x22: 0x000000016f019b90  x23: 0x0000000000000103\r\n   x24: 0x0000000000000103  x25: 0x0000000000000000  x26: 0x0000000000000002  x27: 0x0000000000000002\r\n   x28: 0x0000600000fa4000   fp: 0x000000016f019b80   lr: 0x00000001a627f710\r\n    sp: 0x000000016f019b50   pc: 0x00000001a6283108 cpsr: 0x60001000\r\n   far: 0x00000001ff2bc0b8  esr: 0xf2000001 (Breakpoint) brk 1\r\n```\r\n\r\n**Environment (please complete the following information):**\r\n - OS: MacOS Ventura 13.2.1\r\n - OpenSSL version 3.1.0\r\n - This provider version: current master (0.5.0-dev)\r\n\r\n**Additional context**\r\nThis is on MacBook Pro - Apple Silicon M2 chip. Similar problem on Intel-based iMac (used same process as above).\r\n\r\n**Note:** commenting out, e.g., GOST provider in `openssl.cnf` did not help.\r\n\r\n```\r\n$ openssl version\r\nOpenSSL 3.1.0 14 Mar 2023 (Library: OpenSSL 3.1.0 14 Mar 2023)\r\n$ openssl list -providers\r\nProviders:\r\n  base\r\n    name: OpenSSL Base Provider\r\n    version: 3.1.0\r\n    status: active\r\n  default\r\n    name: OpenSSL Default Provider\r\n    version: 3.1.0\r\n    status: active\r\n  gost\r\n    name: OpenSSL GOST Provider\r\n    status: active\r\n  legacy\r\n    name: OpenSSL Legacy Provider\r\n    version: 3.1.0\r\n    status: active\r\n  oqs\r\n    name: OpenSSL OQS Provider\r\n    version: 0.5.0-dev\r\n    status: active\r\n  pkcs11\r\n    name: PKCS#11 Provider\r\n    version: 3.1.0\r\n    status: active\r\n$ \r\n```\r\n","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1495013124","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/132#issuecomment-1495013124","issue_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/132","id":1495013124,"node_id":"IC_kwDOE_A9l85ZHBcE","user":{"login":"mouse07410","id":5923577,"node_id":"MDQ6VXNlcjU5MjM1Nzc=","avatar_url":"https://avatars.githubusercontent.com/u/5923577?v=4","gravatar_id":"","url":"https://api.github.com/users/mouse07410","html_url":"https://github.com/mouse07410","followers_url":"https://api.github.com/users/mouse07410/followers","following_url":"https://api.github.com/users/mouse07410/following{/other_user}","gists_url":"https://api.github.com/users/mouse07410/gists{/gist_id}","starred_url":"https://api.github.com/users/mouse07410/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mouse07410/subscriptions","organizations_url":"https://api.github.com/users/mouse07410/orgs","repos_url":"https://api.github.com/users/mouse07410/repos","events_url":"https://api.github.com/users/mouse07410/events{/privacy}","received_events_url":"https://api.github.com/users/mouse07410/received_events","type":"User","site_admin":false},"created_at":"2023-04-03T21:31:59Z","updated_at":"2023-04-03T21:31:59Z","author_association":"NONE","body":"> > Looks like Mac is also undertested.\r\n> \r\n> That's a bit of an understatement: When trying to reproduce the problem on OSX using `oqsprovider`, I noted that not even one of the \"external\" OpenSSL tests pass on OSX (Python: `ldd` not existing; krb5: \"cannot compute sizeof (time_t)\"; gost&oqsprovider: Cannot find `libcrypto.3.dylib`, i.e., (DY)LD_LIBRARY_PATH issues). @mattcaswell: Is this known/acceptable, worth while an OpenSSL issue or am I doing sth wrong?\r\n\r\n@baentsch I'm not sure what to say, but both building OpenSSL-3.2.0-dev from the source _and_ running its full test-suite succeeds on my MacOS, for both Intel and Apple Silicon machines.\r\n\r\nSo, I'd say being even unable to find `libcrypto.3.dylib` is _not_ acceptable - it indicates that something is badly wrong.\r\n\r\nTests of `oqsprovider` also all pass. Also, when I patch `ssltestlib.c` the way I showed, symlink `ln -s $HOME/src/openssl $HOME/src/oqs-provider/`, then configure, build and run tests - all the `oqs-provider` tests pass.\r\n\r\nYou asked about dynamic loading. From `man dyld`:\r\n```text\r\nNAME\r\n       dyld - the dynamic linker\r\n\r\nSYNOPSIS\r\n       DYLD_FRAMEWORK_PATH\r\n       DYLD_FALLBACK_FRAMEWORK_PATH\r\n       DYLD_VERSIONED_FRAMEWORK_PATH\r\n       DYLD_LIBRARY_PATH\r\n       DYLD_FALLBACK_LIBRARY_PATH\r\n       DYLD_VERSIONED_LIBRARY_PATH\r\n       DYLD_IMAGE_SUFFIX\r\n       DYLD_INSERT_LIBRARIES\r\n       DYLD_PRINT_TO_FILE\r\n       DYLD_PRINT_LIBRARIES\r\n       DYLD_PRINT_LOADERS\r\n       DYLD_PRINT_SEARCHING\r\n       DYLD_PRINT_APIS\r\n       DYLD_PRINT_BINDINGS\r\n       DYLD_PRINT_INITIALIZERS\r\n       DYLD_PRINT_SEGMENTS\r\n       DYLD_PRINT_ENV\r\n       DYLD_SHARED_REGION\r\n       DYLD_SHARED_CACHE_DIR\r\n\r\nDESCRIPTION\r\n       The dynamic linker (dyld) checks the following environment variables during the launch of\r\n       each process.\r\n       Note: If System Integrity Protection is enabled, these environment variables are\r\n       ignored when executing binaries protected by System Integrity Protection.\r\n```\r\nFirst, it tells you what env vars control dynamic loading. Second, it tells you that **only** SIP-protected binaries (i.e., part of the OS or system commands, like what's in `/usr/bin`) would ignore those env vars.\r\n\r\nThere's no `ldd` on MacOS - but use `otool -L` instead, like\r\n```sh\r\n$ otool -L /opt/local/lib/ossl-modules/oqsprovider.dylib \r\n/opt/local/lib/ossl-modules/oqsprovider.dylib:\r\n\t@rpath/oqsprovider.1.dylib (compatibility version 1.0.0, current version 0.5.0)\r\n\t@rpath/liboqs.2.dylib (compatibility version 2.0.0, current version 0.8.0)\r\n\t/opt/local/libexec/openssl3/lib/libcrypto.3.dylib (compatibility version 3.0.0, current version 3.0.0)\r\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1319.100.3)\r\n$ \r\n```\r\n\r\nFeel free to ask more specific questions - I'll do my best to answer. ","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/comments/1495013124/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null}},"public":true,"created_at":"2023-04-03T21:32:00Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
