{"id":"29358650652","type":"IssuesEvent","actor":{"id":74731594,"login":"kamlesh0hrs","display_login":"kamlesh0hrs","gravatar_id":"","url":"https://api.github.com/users/kamlesh0hrs","avatar_url":"https://avatars.githubusercontent.com/u/74731594?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"opened","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1484","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1484/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1484/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1484/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1484","id":1728947818,"node_id":"I_kwDOA-eq3c5nDaZq","number":1484,"title":"Error while building liboqs  with \"-DDILITHIUM_USE_AES\" enabled","user":{"login":"kamlesh0hrs","id":74731594,"node_id":"MDQ6VXNlcjc0NzMxNTk0","avatar_url":"https://avatars.githubusercontent.com/u/74731594?v=4","gravatar_id":"","url":"https://api.github.com/users/kamlesh0hrs","html_url":"https://github.com/kamlesh0hrs","followers_url":"https://api.github.com/users/kamlesh0hrs/followers","following_url":"https://api.github.com/users/kamlesh0hrs/following{/other_user}","gists_url":"https://api.github.com/users/kamlesh0hrs/gists{/gist_id}","starred_url":"https://api.github.com/users/kamlesh0hrs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kamlesh0hrs/subscriptions","organizations_url":"https://api.github.com/users/kamlesh0hrs/orgs","repos_url":"https://api.github.com/users/kamlesh0hrs/repos","events_url":"https://api.github.com/users/kamlesh0hrs/events{/privacy}","received_events_url":"https://api.github.com/users/kamlesh0hrs/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-05-27T21:16:53Z","updated_at":"2023-05-27T21:16:53Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Getting error when trying to build liboqs for dilithium5 with  -DDILITHIUM_USE_AES enabled.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n       1. Modify  src/sig/dilithium/CMakeLists.txt file to enable DILITHIUM_USE_AES\r\n       \r\n\r\n                diff --git a/src/sig/dilithium/CMakeLists.txt b/src/sig/dilithium/CMakeLists.txt          \r\n                index b992392b..7c14b103 100644\r\n                --- a/src/sig/dilithium/CMakeLists.txt\r\n                +++ b/src/sig/dilithium/CMakeLists.txt\r\n                @@ -59,7 +59,7 @@ endif()\r\n                if(OQS_ENABLE_SIG_dilithium_5)\r\n                  add_library(dilithium_5_ref OBJECT sig_dilithium_5.c pqcrystals-dilithium_dilithium5_ref/ntt.c pqcrystals- \r\n                   dilithium_dilithium5_ref/packing.c pqcrystals-dilithium_dilithium5_ref/poly.c pqcrystals- \r\n                   dilithium_dilithium5_ref/polyvec.c pqcrystals-dilithium_dilithium5_ref/reduce.c pqcrystals- \r\n                   dilithium_dilithium5_ref/rounding.c pqcrystals-dilithium_dilithium5_ref/sign.c pqcrystals- \r\n                   dilithium_dilithium5_ref/symmetric-shake.c)\r\n                -    target_compile_options(dilithium_5_ref PUBLIC -DDILITHIUM_MODE=5 -DDILITHIUM_RANDOMIZED_SIGNING)\r\n               +    target_compile_options(dilithium_5_ref PUBLIC -DDILITHIUM_MODE=5 -DDILITHIUM_RANDOMIZED_SIGNING  -DDILITHIUM_USE_AES)\r\n                    target_include_directories(dilithium_5_ref PRIVATE ${CMAKE_CURRENT_LIST_DIR}/pqcrystals-dilithium_dilithium5_ref)\r\n                    target_include_directories(dilithium_5_ref PRIVATE ${PROJECT_SOURCE_DIR}/src/common/pqclean_shims)\r\n                    target_compile_options(dilithium_5_ref PUBLIC -DDILITHIUM_MODE=5 -DDILITHIUM_RANDOMIZED_SIGNING)\r\n\r\n2.  Run build command\r\n                 **cmake -DCMAKE_INSTALL_PREFIX=$INSTALLDIR -S . -B _build  -DBUILD_SHARED_LIBS=ON -DOPENSSL_ROOT_DIR=$OPENSSLINSTALL -DCMAKE_BUILD_TYPE=Debug**\r\n\r\n**Error:**\r\nScanning dependencies of target oqs\r\n[ 94%] Building C object src/CMakeFiles/oqs.dir/kem/kem.c.o\r\n[ 94%] Building C object src/CMakeFiles/oqs.dir/sig/sig.c.o\r\n[ 95%] Linking C shared library ../lib/liboqs.so\r\n[ 95%] Built target oqs\r\nScanning dependencies of target speed_sig\r\n[ 95%] Building C object tests/CMakeFiles/speed_sig.dir/speed_sig.c.o\r\n[ 96%] Linking C executable speed_sig\r\n/usr/bin/ld: ../lib/liboqs.so.0.8.0-dev: undefined reference to `pqcrystals_dilithium5_ref_verify'\r\n/usr/bin/ld: ../lib/liboqs.so.0.8.0-dev: undefined reference to `pqcrystals_dilithium5_ref_keypair'\r\n/usr/bin/ld: ../lib/liboqs.so.0.8.0-dev: undefined reference to `pqcrystals_dilithium5aes_ref_dilithium_aes256ctr_init'\r\n/usr/bin/ld: ../lib/liboqs.so.0.8.0-dev: undefined reference to `pqcrystals_dilithium5_ref_signature'\r\ncollect2: error: ld returned 1 exit status\r\nmake[2]: *** [tests/CMakeFiles/speed_sig.dir/build.make:85: tests/speed_sig] Error 1\r\nmake[1]: *** [CMakeFiles/Makefile2:1665: tests/CMakeFiles/speed_sig.dir/all] Error 2\r\nmake: *** [Makefile:152: all] Error 2\r\n\r\n\r\n**liboqs - master-dev**\r\n**openssl - 3.2-dev**\r\n\r\nCould you please help if I am doing it the right way, or am i missing something?\r\n\r\nThanks,\r\nKamlesh","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1484/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1484/timeline","performed_via_github_app":null,"state_reason":null}},"public":true,"created_at":"2023-05-27T21:16:53Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
