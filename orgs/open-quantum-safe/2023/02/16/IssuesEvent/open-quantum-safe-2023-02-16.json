{"id":"27126821573","type":"IssuesEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":334511511,"name":"open-quantum-safe/oqs-provider","url":"https://api.github.com/repos/open-quantum-safe/oqs-provider"},"payload":{"action":"opened","issue":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/115","repository_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider","labels_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/115/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/115/comments","events_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/115/events","html_url":"https://github.com/open-quantum-safe/oqs-provider/issues/115","id":1587093897,"node_id":"I_kwDOE_A9l85emSGJ","number":115,"title":"Enable correct operation of openssl ca","user":{"login":"baentsch","id":57787676,"node_id":"MDQ6VXNlcjU3Nzg3Njc2","avatar_url":"https://avatars.githubusercontent.com/u/57787676?v=4","gravatar_id":"","url":"https://api.github.com/users/baentsch","html_url":"https://github.com/baentsch","followers_url":"https://api.github.com/users/baentsch/followers","following_url":"https://api.github.com/users/baentsch/following{/other_user}","gists_url":"https://api.github.com/users/baentsch/gists{/gist_id}","starred_url":"https://api.github.com/users/baentsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/baentsch/subscriptions","organizations_url":"https://api.github.com/users/baentsch/orgs","repos_url":"https://api.github.com/users/baentsch/repos","events_url":"https://api.github.com/users/baentsch/events{/privacy}","received_events_url":"https://api.github.com/users/baentsch/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-02-16T06:19:56Z","updated_at":"2023-02-16T06:19:56Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"### Discussed in https://github.com/open-quantum-safe/oqs-provider/discussions/110\r\n\r\n<div type='discussions-op-text'>\r\n\r\n<sup>Originally posted by **Dechen2333** February  8, 2023</sup>\r\nHello,\r\n\r\nI want to create my own CA and OCSP server to test a program with oqsprovider implementation.\r\nI'm using the docker image provided by this link:\r\nhttps://github.com/open-quantum-safe/oqs-provider/wiki/Interoperability#ietf-115-hackathon\r\nIn the container, I created a falcon1024 key and selfsigned certification for the CA, a dilithium2 key and then sign the dilithium2 key with the falcon CA key. If I verify the dilithium certification using the CAfile, it ends up with an error in asn1 encoding routines. If I use a rsa 2048 key as root CA key instead, everything will be fine.\r\n\r\nStep to reproduce:\r\n1. docker run -it openquantumsafe/oqs-ossl3:ietf115\r\n2. mkdir -p demoCA/newcerts\r\n3. touch demoCA/index.txt\r\n4. echo '01' > demoCA/serial\r\n5. openssl req -x509 -new -newkey falcon1024 -keyout falc_rootCA.key -out falc_rootCA.crt -subj \"/CN=test CA\" -nodes\r\n6. openssl req -new -newkey dilithium2 -keyout dilithium2.key -out dilithium2.csr -nodes -config openssl.cnf -subj \"/CN=test Server\"\r\n7. openssl ca -batch -startdate 150123080000Z -enddate 250823090000Z -keyfile falc_rootCA.key -cert falc_rootCA.crt -policy policy_anything -config openssl.cnf -notext -out dilithium2.crt -infiles dilithium2.csr\r\n8. openssl verify -CAfile falc_rootCA.crt dilithium2.crt\r\n\r\nThen I receive the error codes:\r\nerror 7 at 0 depth lookup: certificate signature failure\r\nerror dilithium2.crt: verification failed\r\n487BBAB4387F0000:error:4000000E:lib(128):oqs_sig_verify:reason(14):/opt/oqs-provider/oqsprov/oqs_sig.c:405:\r\n487BBAB4387F0000:error:06880006:asn1 encoding routines:ASN1_item_verify_ctx:EVP lib:crypto/asn1/a_verify.c:215:\r\n\r\nopenssl version:\r\nOpenSSL 3.2.0-dev-pr19312  (Library: OpenSSL 3.2.0-dev-pr19312 )\r\n\r\nIf I use the certification that signed by a PQC CA key in my program with oqsprovider implementation, the same error appear while the TLS handshake\r\n\r\noqsprovider version:\r\nOQS Provider v.0.5.0-dev-nopub based on liboqs v.0.7.3-dev\r\n\r\nopenssl.cnf:\r\nhttps://github.com/Dechen2333/opensslcnf/blob/main/openssl.cnf\r\n </div>","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/115/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/oqs-provider/issues/115/timeline","performed_via_github_app":null,"state_reason":null}},"public":true,"created_at":"2023-02-16T06:19:56Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
{"id":"27140356589","type":"IssuesEvent","actor":{"id":57787676,"login":"baentsch","display_login":"baentsch","gravatar_id":"","url":"https://api.github.com/users/baentsch","avatar_url":"https://avatars.githubusercontent.com/u/57787676?"},"repo":{"id":65514205,"name":"open-quantum-safe/liboqs","url":"https://api.github.com/repos/open-quantum-safe/liboqs"},"payload":{"action":"reopened","issue":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1315","repository_url":"https://api.github.com/repos/open-quantum-safe/liboqs","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1315/labels{/name}","comments_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1315/comments","events_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1315/events","html_url":"https://github.com/open-quantum-safe/liboqs/issues/1315","id":1434869943,"node_id":"I_kwDOA-eq3c5VhmC3","number":1315,"title":"Malleable Falcon signatures, may need upgrade to v1.2 spec","user":{"login":"WizardOfMenlo","id":9511741,"node_id":"MDQ6VXNlcjk1MTE3NDE=","avatar_url":"https://avatars.githubusercontent.com/u/9511741?v=4","gravatar_id":"","url":"https://api.github.com/users/WizardOfMenlo","html_url":"https://github.com/WizardOfMenlo","followers_url":"https://api.github.com/users/WizardOfMenlo/followers","following_url":"https://api.github.com/users/WizardOfMenlo/following{/other_user}","gists_url":"https://api.github.com/users/WizardOfMenlo/gists{/gist_id}","starred_url":"https://api.github.com/users/WizardOfMenlo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WizardOfMenlo/subscriptions","organizations_url":"https://api.github.com/users/WizardOfMenlo/orgs","repos_url":"https://api.github.com/users/WizardOfMenlo/repos","events_url":"https://api.github.com/users/WizardOfMenlo/events{/privacy}","received_events_url":"https://api.github.com/users/WizardOfMenlo/received_events","type":"User","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/milestones/18","html_url":"https://github.com/open-quantum-safe/liboqs/milestone/18","labels_url":"https://api.github.com/repos/open-quantum-safe/liboqs/milestones/18/labels","id":7069955,"node_id":"MI_kwDOA-eq3c4Aa-ED","number":18,"title":"0.8.0","description":"See https://github.com/open-quantum-safe/liboqs/issues/1245#issuecomment-1319218926 for table of algorithm updates.","creator":{"login":"dstebila","id":8843219,"node_id":"MDQ6VXNlcjg4NDMyMTk=","avatar_url":"https://avatars.githubusercontent.com/u/8843219?v=4","gravatar_id":"","url":"https://api.github.com/users/dstebila","html_url":"https://github.com/dstebila","followers_url":"https://api.github.com/users/dstebila/followers","following_url":"https://api.github.com/users/dstebila/following{/other_user}","gists_url":"https://api.github.com/users/dstebila/gists{/gist_id}","starred_url":"https://api.github.com/users/dstebila/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dstebila/subscriptions","organizations_url":"https://api.github.com/users/dstebila/orgs","repos_url":"https://api.github.com/users/dstebila/repos","events_url":"https://api.github.com/users/dstebila/events{/privacy}","received_events_url":"https://api.github.com/users/dstebila/received_events","type":"User","site_admin":false},"open_issues":5,"closed_issues":5,"state":"open","created_at":"2021-08-18T14:40:17Z","updated_at":"2023-02-16T15:56:31Z","due_on":"2023-03-31T07:00:00Z","closed_at":null},"comments":2,"created_at":"2022-11-03T15:37:15Z","updated_at":"2023-02-16T15:56:31Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"Hi there,\r\n\r\nThe clean/avx2 implementations of Falcon-512 and Falcon-1024 seem to be unaligned with some changes introduced in v1.2 of the spec.\r\n\r\nIn particular, the implementation of the signature verification algorithm currently in libOQS accepts mauled signatures due to how `comp_decode` in `codec.c` is implemented. I attached an example program for ease of inspection.\r\n\r\nFollowing Section 3.11.2 and Algorithms 17-18 in the Falcon spec v1.2, I believe that in order to enforce a unique encoding of compressed signatures, the decode implementation should not accept 100000001 (\"-0\") as a valid encoding of 0, and should check that signatures are padded using zeroes.\r\n\r\nKind Regards,\r\nGiacomo Fenzi\r\n\r\nAttached bug: [bug.c](https://gist.github.com/WizardOfMenlo/59e6e0457f94bf5caf13909f319007de)","reactions":{"url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1315/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/open-quantum-safe/liboqs/issues/1315/timeline","performed_via_github_app":null,"state_reason":"reopened"}},"public":true,"created_at":"2023-02-16T15:56:32Z","org":{"id":20689385,"login":"open-quantum-safe","gravatar_id":"","url":"https://api.github.com/orgs/open-quantum-safe","avatar_url":"https://avatars.githubusercontent.com/u/20689385?"}}
